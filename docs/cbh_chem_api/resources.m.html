<!doctype html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />

    <title>cbh_chem_api.resources API documentation</title>
    <meta name="description" content="This is the main module of the new ChemiReg API
It provides the webservices to add, search for and i..." />

  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300' rel='stylesheet' type='text/css'>
  
  <style type="text/css">
  
* {
  box-sizing: border-box;
}
/*! normalize.css v1.1.1 | MIT License | git.io/normalize */

/* ==========================================================================
   HTML5 display definitions
   ========================================================================== */

/**
 * Correct `block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
nav,
section,
summary {
    display: block;
}

/**
 * Correct `inline-block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

audio,
canvas,
video {
    display: inline-block;
    *display: inline;
    *zoom: 1;
}

/**
 * Prevent modern browsers from displaying `audio` without controls.
 * Remove excess height in iOS 5 devices.
 */

audio:not([controls]) {
    display: none;
    height: 0;
}

/**
 * Address styling not present in IE 7/8/9, Firefox 3, and Safari 4.
 * Known issue: no IE 6 support.
 */

[hidden] {
    display: none;
}

/* ==========================================================================
   Base
   ========================================================================== */

/**
 * 1. Prevent system color scheme's background color being used in Firefox, IE,
 *    and Opera.
 * 2. Prevent system color scheme's text color being used in Firefox, IE, and
 *    Opera.
 * 3. Correct text resizing oddly in IE 6/7 when body `font-size` is set using
 *    `em` units.
 * 4. Prevent iOS text size adjust after orientation change, without disabling
 *    user zoom.
 */

html {
    background: #fff; /* 1 */
    color: #000; /* 2 */
    font-size: 100%; /* 3 */
    -webkit-text-size-adjust: 100%; /* 4 */
    -ms-text-size-adjust: 100%; /* 4 */
}

/**
 * Address `font-family` inconsistency between `textarea` and other form
 * elements.
 */

html,
button,
input,
select,
textarea {
    font-family: sans-serif;
}

/**
 * Address margins handled incorrectly in IE 6/7.
 */

body {
    margin: 0;
}

/* ==========================================================================
   Links
   ========================================================================== */

/**
 * Address `outline` inconsistency between Chrome and other browsers.
 */

a:focus {
    outline: thin dotted;
}

/**
 * Improve readability when focused and also mouse hovered in all browsers.
 */

a:active,
a:hover {
    outline: 0;
}

/* ==========================================================================
   Typography
   ========================================================================== */

/**
 * Address font sizes and margins set differently in IE 6/7.
 * Address font sizes within `section` and `article` in Firefox 4+, Safari 5,
 * and Chrome.
 */

h1 {
    font-size: 2em;
    margin: 0.67em 0;
}

h2 {
    font-size: 1.5em;
    margin: 0.83em 0;
}

h3 {
    font-size: 1.17em;
    margin: 1em 0;
}

h4 {
    font-size: 1em;
    margin: 1.33em 0;
}

h5 {
    font-size: 0.83em;
    margin: 1.67em 0;
}

h6 {
    font-size: 0.67em;
    margin: 2.33em 0;
}

/**
 * Address styling not present in IE 7/8/9, Safari 5, and Chrome.
 */

abbr[title] {
    border-bottom: 1px dotted;
}

/**
 * Address style set to `bolder` in Firefox 3+, Safari 4/5, and Chrome.
 */

b,
strong {
    font-weight: bold;
}

blockquote {
    margin: 1em 40px;
}

/**
 * Address styling not present in Safari 5 and Chrome.
 */

dfn {
    font-style: italic;
}

/**
 * Address differences between Firefox and other browsers.
 * Known issue: no IE 6/7 normalization.
 */

hr {
    -moz-box-sizing: content-box;
    box-sizing: content-box;
    height: 0;
}

/**
 * Address styling not present in IE 6/7/8/9.
 */

mark {
    background: #ff0;
    color: #000;
}

/**
 * Address margins set differently in IE 6/7.
 */

p,
pre {
    margin: 1em 0;
}

/**
 * Correct font family set oddly in IE 6, Safari 4/5, and Chrome.
 */

code,
kbd,
pre,
samp {
    font-family: monospace, serif;
    _font-family: 'courier new', monospace;
    font-size: 1em;
}

/**
 * Improve readability of pre-formatted text in all browsers.
 */

pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
}

/**
 * Address CSS quotes not supported in IE 6/7.
 */

q {
    quotes: none;
}

/**
 * Address `quotes` property not supported in Safari 4.
 */

q:before,
q:after {
    content: '';
    content: none;
}

/**
 * Address inconsistent and variable font size in all browsers.
 */

small {
    font-size: 80%;
}

/**
 * Prevent `sub` and `sup` affecting `line-height` in all browsers.
 */

sub,
sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}

sup {
    top: -0.5em;
}

sub {
    bottom: -0.25em;
}

/* ==========================================================================
   Lists
   ========================================================================== */

/**
 * Address margins set differently in IE 6/7.
 */

dl,
menu,
ol,
ul {
    margin: 1em 0;
}

dd {
    margin: 0 0 0 40px;
}

/**
 * Address paddings set differently in IE 6/7.
 */

menu,
ol,
ul {
    padding: 0 0 0 40px;
}

/**
 * Correct list images handled incorrectly in IE 7.
 */

nav ul,
nav ol {
    list-style: none;
    list-style-image: none;
}

/* ==========================================================================
   Embedded content
   ========================================================================== */

/**
 * 1. Remove border when inside `a` element in IE 6/7/8/9 and Firefox 3.
 * 2. Improve image quality when scaled in IE 7.
 */

img {
    border: 0; /* 1 */
    -ms-interpolation-mode: bicubic; /* 2 */
}

/**
 * Correct overflow displayed oddly in IE 9.
 */

svg:not(:root) {
    overflow: hidden;
}

/* ==========================================================================
   Figures
   ========================================================================== */

/**
 * Address margin not present in IE 6/7/8/9, Safari 5, and Opera 11.
 */

figure {
    margin: 0;
}

/* ==========================================================================
   Forms
   ========================================================================== */

/**
 * Correct margin displayed oddly in IE 6/7.
 */

form {
    margin: 0;
}

/**
 * Define consistent border, margin, and padding.
 */

fieldset {
    border: 1px solid #c0c0c0;
    margin: 0 2px;
    padding: 0.35em 0.625em 0.75em;
}

/**
 * 1. Correct color not being inherited in IE 6/7/8/9.
 * 2. Correct text not wrapping in Firefox 3.
 * 3. Correct alignment displayed oddly in IE 6/7.
 */

legend {
    border: 0; /* 1 */
    padding: 0;
    white-space: normal; /* 2 */
    *margin-left: -7px; /* 3 */
}

/**
 * 1. Correct font size not being inherited in all browsers.
 * 2. Address margins set differently in IE 6/7, Firefox 3+, Safari 5,
 *    and Chrome.
 * 3. Improve appearance and consistency in all browsers.
 */

button,
input,
select,
textarea {
    font-size: 100%; /* 1 */
    margin: 0; /* 2 */
    vertical-align: baseline; /* 3 */
    *vertical-align: middle; /* 3 */
}

/**
 * Address Firefox 3+ setting `line-height` on `input` using `!important` in
 * the UA stylesheet.
 */

button,
input {
    line-height: normal;
}

/**
 * Address inconsistent `text-transform` inheritance for `button` and `select`.
 * All other form control elements do not inherit `text-transform` values.
 * Correct `button` style inheritance in Chrome, Safari 5+, and IE 6+.
 * Correct `select` style inheritance in Firefox 4+ and Opera.
 */

button,
select {
    text-transform: none;
}

/**
 * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`
 *    and `video` controls.
 * 2. Correct inability to style clickable `input` types in iOS.
 * 3. Improve usability and consistency of cursor style between image-type
 *    `input` and others.
 * 4. Remove inner spacing in IE 7 without affecting normal text inputs.
 *    Known issue: inner spacing remains in IE 6.
 */

button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
    -webkit-appearance: button; /* 2 */
    cursor: pointer; /* 3 */
    *overflow: visible;  /* 4 */
}

/**
 * Re-set default cursor for disabled elements.
 */

button[disabled],
html input[disabled] {
    cursor: default;
}

/**
 * 1. Address box sizing set to content-box in IE 8/9.
 * 2. Remove excess padding in IE 8/9.
 * 3. Remove excess padding in IE 7.
 *    Known issue: excess padding remains in IE 6.
 */

input[type="checkbox"],
input[type="radio"] {
    box-sizing: border-box; /* 1 */
    padding: 0; /* 2 */
    *height: 13px; /* 3 */
    *width: 13px; /* 3 */
}

/**
 * 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome.
 * 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome
 *    (include `-moz` to future-proof).
 */

input[type="search"] {
    -webkit-appearance: textfield; /* 1 */
    -moz-box-sizing: content-box;
    -webkit-box-sizing: content-box; /* 2 */
    box-sizing: content-box;
}

/**
 * Remove inner padding and search cancel button in Safari 5 and Chrome
 * on OS X.
 */

input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
    -webkit-appearance: none;
}

/**
 * Remove inner padding and border in Firefox 3+.
 */

button::-moz-focus-inner,
input::-moz-focus-inner {
    border: 0;
    padding: 0;
}

/**
 * 1. Remove default vertical scrollbar in IE 6/7/8/9.
 * 2. Improve readability and alignment in all browsers.
 */

textarea {
    overflow: auto; /* 1 */
    vertical-align: top; /* 2 */
}

/* ==========================================================================
   Tables
   ========================================================================== */

/**
 * Remove most spacing between table cells.
 */

table {
    border-collapse: collapse;
    border-spacing: 0;
}

  </style>

  <style type="text/css">
  
  html, body {
    margin: 0;
    padding: 0;
    min-height: 100%;
  }
  body {
    background: #fff;
    font-family: "Source Sans Pro", "Helvetica Neueue", Helvetica, sans;
    font-weight: 300;
    font-size: 16px;
    line-height: 1.6em;
  }
  #content {
    width: 70%;
    max-width: 850px;
    float: left;
    padding: 30px 60px;
    border-left: 1px solid #ddd;
  }
  #sidebar {
    width: 25%;
    float: left;
    padding: 30px;
    overflow: hidden;
  }
  #nav {
    font-size: 130%;
    margin: 0 0 15px 0;
  }

  #top {
    display: block;
    position: fixed;
    bottom: 5px;
    left: 5px;
    font-size: .85em;
    text-transform: uppercase;
  }

  #footer {
    font-size: .75em;
    padding: 5px 30px;
    border-top: 1px solid #ddd;
    text-align: right;
  }
    #footer p {
      margin: 0 0 0 30px;
      display: inline-block;
    }

  h1, h2, h3, h4, h5 {
    font-weight: 300;
  }
  h1 {
    font-size: 2.5em;
    line-height: 1.1em;
    margin: 0 0 .50em 0;
  }

  h2 {
    font-size: 1.75em;
    margin: 1em 0 .50em 0;
  }

  h3 {
    margin: 25px 0 10px 0;
  }

  h4 {
    margin: 0;
    font-size: 105%;
  }

  a {
    color: #058;
    text-decoration: none;
    transition: color .3s ease-in-out;
  }

  a:hover {
    color: #e08524;
    transition: color .3s ease-in-out;
  }

  pre, code, .mono, .name {
    font-family: "Ubuntu Mono", "Cousine", "DejaVu Sans Mono", monospace;
  }

  .title .name {
    font-weight: bold;
  }
  .section-title {
    margin-top: 2em;
  }
  .ident {
    color: #900;
  }

  code {
    background: #f9f9f9;
  } 

  pre {
    background: #fefefe;
    border: 1px solid #ddd;
    box-shadow: 2px 2px 0 #f3f3f3;
    margin: 0 30px;
    padding: 15px 30px;
  }

  .codehilite {
    margin: 0 30px 10px 30px;
  }

    .codehilite pre {
      margin: 0;
    }
    .codehilite .err { background: #ff3300; color: #fff !important; } 

  table#module-list {
    font-size: 110%;
  }

    table#module-list tr td:first-child {
      padding-right: 10px;
      white-space: nowrap;
    }

    table#module-list td {
      vertical-align: top;
      padding-bottom: 8px;
    }

      table#module-list td p {
        margin: 0 0 7px 0;
      }

  .def {
    display: table;
  }

    .def p {
      display: table-cell;
      vertical-align: top;
      text-align: left;
    }

    .def p:first-child {
      white-space: nowrap;
    }

    .def p:last-child {
      width: 100%;
    }


  #index {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
    ul#index .class_name {
      /* font-size: 110%; */
      font-weight: bold;
    }
    #index ul {
      margin: 0;
    }

  .item {
    margin: 0 0 15px 0;
  }

    .item .class {
      margin: 0 0 25px 30px;
    }

      .item .class ul.class_list {
        margin: 0 0 20px 0;
      }

    .item .name {
      background: #fafafa;
      margin: 0;
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 3px;
      display: inline-block;
      min-width: 40%;
    }
      .item .name:hover {
        background: #f6f6f6;
      }

    .item .empty_desc {
      margin: 0 0 5px 0;
      padding: 0;
    }

    .item .inheritance {
      margin: 3px 0 0 30px;
    }

    .item .inherited {
      color: #666;
    }

    .item .desc {
      padding: 0 8px;
      margin: 0;
    }

      .item .desc p {
        margin: 0 0 10px 0;
      }

    .source_cont {
      margin: 0;
      padding: 0;
    }

    .source_link a {
      background: #ffc300;
      font-weight: 400;
      font-size: .75em;
      text-transform: uppercase;
      color: #fff;
      text-shadow: 1px 1px 0 #f4b700;
      
      padding: 3px 8px;
      border-radius: 2px;
      transition: background .3s ease-in-out;
    }
      .source_link a:hover {
        background: #FF7200;
        text-shadow: none;
        transition: background .3s ease-in-out;
      }

    .source {
      display: none;
      max-height: 600px;
      overflow-y: scroll;
      margin-bottom: 15px;
    }

      .source .codehilite {
        margin: 0;
      }

  .desc h1, .desc h2, .desc h3 {
    font-size: 100% !important;
  }
  .clear {
    clear: both;
  }

  @media all and (max-width: 950px) {
    #sidebar {
      width: 35%;
    }
    #content {
      width: 65%;
    }
  }
  @media all and (max-width: 650px) {
    #top {
      display: none;
    }
    #sidebar {
      float: none;
      width: auto;
    }
    #content {
      float: none;
      width: auto;
      padding: 30px;
    }

    #index ul {
      padding: 0;
      margin-bottom: 15px;
    }
    #index ul li {
      display: inline-block;
      margin-right: 30px;
    }
    #footer {
      text-align: left;
    }
    #footer p {
      display: block;
      margin: inherit;
    }
  }

  /*****************************/

  </style>

  <style type="text/css">
  .codehilite .hll { background-color: #ffffcc }
.codehilite  { background: #f8f8f8; }
.codehilite .c { color: #408080; font-style: italic } /* Comment */
.codehilite .err { border: 1px solid #FF0000 } /* Error */
.codehilite .k { color: #008000; font-weight: bold } /* Keyword */
.codehilite .o { color: #666666 } /* Operator */
.codehilite .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.codehilite .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.codehilite .cp { color: #BC7A00 } /* Comment.Preproc */
.codehilite .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.codehilite .c1 { color: #408080; font-style: italic } /* Comment.Single */
.codehilite .cs { color: #408080; font-style: italic } /* Comment.Special */
.codehilite .gd { color: #A00000 } /* Generic.Deleted */
.codehilite .ge { font-style: italic } /* Generic.Emph */
.codehilite .gr { color: #FF0000 } /* Generic.Error */
.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.codehilite .gi { color: #00A000 } /* Generic.Inserted */
.codehilite .go { color: #888888 } /* Generic.Output */
.codehilite .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.codehilite .gs { font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.codehilite .gt { color: #0044DD } /* Generic.Traceback */
.codehilite .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.codehilite .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.codehilite .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.codehilite .kp { color: #008000 } /* Keyword.Pseudo */
.codehilite .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.codehilite .kt { color: #B00040 } /* Keyword.Type */
.codehilite .m { color: #666666 } /* Literal.Number */
.codehilite .s { color: #BA2121 } /* Literal.String */
.codehilite .na { color: #7D9029 } /* Name.Attribute */
.codehilite .nb { color: #008000 } /* Name.Builtin */
.codehilite .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.codehilite .no { color: #880000 } /* Name.Constant */
.codehilite .nd { color: #AA22FF } /* Name.Decorator */
.codehilite .ni { color: #999999; font-weight: bold } /* Name.Entity */
.codehilite .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.codehilite .nf { color: #0000FF } /* Name.Function */
.codehilite .nl { color: #A0A000 } /* Name.Label */
.codehilite .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.codehilite .nt { color: #008000; font-weight: bold } /* Name.Tag */
.codehilite .nv { color: #19177C } /* Name.Variable */
.codehilite .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.codehilite .w { color: #bbbbbb } /* Text.Whitespace */
.codehilite .mb { color: #666666 } /* Literal.Number.Bin */
.codehilite .mf { color: #666666 } /* Literal.Number.Float */
.codehilite .mh { color: #666666 } /* Literal.Number.Hex */
.codehilite .mi { color: #666666 } /* Literal.Number.Integer */
.codehilite .mo { color: #666666 } /* Literal.Number.Oct */
.codehilite .sb { color: #BA2121 } /* Literal.String.Backtick */
.codehilite .sc { color: #BA2121 } /* Literal.String.Char */
.codehilite .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.codehilite .s2 { color: #BA2121 } /* Literal.String.Double */
.codehilite .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.codehilite .sh { color: #BA2121 } /* Literal.String.Heredoc */
.codehilite .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.codehilite .sx { color: #008000 } /* Literal.String.Other */
.codehilite .sr { color: #BB6688 } /* Literal.String.Regex */
.codehilite .s1 { color: #BA2121 } /* Literal.String.Single */
.codehilite .ss { color: #19177C } /* Literal.String.Symbol */
.codehilite .bp { color: #008000 } /* Name.Builtin.Pseudo */
.codehilite .vc { color: #19177C } /* Name.Variable.Class */
.codehilite .vg { color: #19177C } /* Name.Variable.Global */
.codehilite .vi { color: #19177C } /* Name.Variable.Instance */
.codehilite .il { color: #666666 } /* Literal.Number.Integer.Long */
  </style>

  <style type="text/css">
  
/* ==========================================================================
   EXAMPLE Media Queries for Responsive Design.
   These examples override the primary ('mobile first') styles.
   Modify as content requires.
   ========================================================================== */

@media only screen and (min-width: 35em) {
    /* Style adjustments for viewports that meet the condition */
}

@media print,
       (-o-min-device-pixel-ratio: 5/4),
       (-webkit-min-device-pixel-ratio: 1.25),
       (min-resolution: 120dpi) {
    /* Style adjustments for high resolution devices */
}

/* ==========================================================================
   Print styles.
   Inlined to avoid required HTTP connection: h5bp.com/r
   ========================================================================== */

@media print {
    * {
        background: transparent !important;
        color: #000 !important; /* Black prints faster: h5bp.com/s */
        box-shadow: none !important;
        text-shadow: none !important;
    }

    a,
    a:visited {
        text-decoration: underline;
    }

    a[href]:after {
        content: " (" attr(href) ")";
    }

    abbr[title]:after {
        content: " (" attr(title) ")";
    }

    /*
     * Don't show links for images, or javascript/internal links
     */

    .ir a:after,
    a[href^="javascript:"]:after,
    a[href^="#"]:after {
        content: "";
    }

    pre,
    blockquote {
        border: 1px solid #999;
        page-break-inside: avoid;
    }

    thead {
        display: table-header-group; /* h5bp.com/t */
    }

    tr,
    img {
        page-break-inside: avoid;
    }

    img {
        max-width: 100% !important;
    }

    @page {
        margin: 0.5cm;
    }

    p,
    h2,
    h3 {
        orphans: 3;
        widows: 3;
    }

    h2,
    h3 {
        page-break-after: avoid;
    }
}

  </style>

  <script type="text/javascript">
  function toggle(id, $link) {
    $node = document.getElementById(id);
    if (!$node)
    return;
    if (!$node.style.display || $node.style.display == 'none') {
    $node.style.display = 'block';
    $link.innerHTML = 'Hide source &nequiv;';
    } else {
    $node.style.display = 'none';
    $link.innerHTML = 'Show source &equiv;';
    }
  }
  </script>
</head>
<body>
<a href="#" id="top">Top</a>

<div id="container">
    
  
  <div id="sidebar">
    <h1>Index</h1>
    <ul id="index">
    <li class="set"><h3><a href="#header-variables">Module variables</a></h3>
      
  <ul>
    <li class="mono"><a href="#cbh_chem_api.resources.ALL">ALL</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.ALL_WITH_RELATIONS">ALL_WITH_RELATIONS</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.EMPTY_ARRAY_B64">EMPTY_ARRAY_B64</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.handler400">handler400</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.handler403">handler403</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.handler404">handler404</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.handler500">handler500</a></li>
  </ul>

    </li>

    <li class="set"><h3><a href="#header-functions">Functions</a></h3>
      
  <ul>
    <li class="mono"><a href="#cbh_chem_api.resources.add_cached_projects_to_batch_list">add_cached_projects_to_batch_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.chunks">chunks</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.get_indexing_schemata">get_indexing_schemata</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.get_schemata">get_schemata</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.index_batches_in_new_index">index_batches_in_new_index</a></li>
  </ul>

    </li>

    <li class="set"><h3><a href="#header-classes">Classes</a></h3>
      <ul>
        <li class="mono">
        <span class="class_name"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></span>
        
          
  <ul>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.__init__">__init__</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.alter_deserialized_detail_data">alter_deserialized_detail_data</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.alter_deserialized_list_data">alter_deserialized_list_data</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.alter_detail_data_to_serialize">alter_detail_data_to_serialize</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.alter_list_data_to_serialize">alter_list_data_to_serialize</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.api_field_from_django_field">api_field_from_django_field</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.apply_authorization_limits">apply_authorization_limits</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.apply_filters">apply_filters</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.apply_sorting">apply_sorting</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_create_detail">authorized_create_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_create_list">authorized_create_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_delete_detail">authorized_delete_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_delete_list">authorized_delete_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_read_detail">authorized_read_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_read_list">authorized_read_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_update_detail">authorized_update_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_update_list">authorized_update_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.base_urls">base_urls</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.build_bundle">build_bundle</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.build_filters">build_filters</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.build_schema">build_schema</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.cached_obj_get">cached_obj_get</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.cached_obj_get_list">cached_obj_get_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.can_create">can_create</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.can_delete">can_delete</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.can_update">can_update</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.check_filtering">check_filtering</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.create_identifier">create_identifier</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.create_response">create_response</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.dehydrate">dehydrate</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.dehydrate_properties">dehydrate_properties</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.dehydrate_resource_uri">dehydrate_resource_uri</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.dehydrate_timestamp">dehydrate_timestamp</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.dehydrate_uuid">dehydrate_uuid</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.delete_detail">delete_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.delete_list">delete_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.deserialize">deserialize</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.detail_uri_kwargs">detail_uri_kwargs</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.determine_format">determine_format</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.dispatch">dispatch</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.dispatch_detail">dispatch_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.dispatch_list">dispatch_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.error_response">error_response</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.filter_value_to_python">filter_value_to_python</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.full_dehydrate">full_dehydrate</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.full_hydrate">full_hydrate</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.generate_cache_key">generate_cache_key</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_bundle_detail_data">get_bundle_detail_data</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_detail">get_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_fields">get_fields</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_list">get_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_multiple">get_multiple</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_object_list">get_object_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_project_specific_data">get_project_specific_data</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_resource_uri">get_resource_uri</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_schema">get_schema</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_via_uri">get_via_uri</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.hydrate">hydrate</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.hydrate_blinded_batch_id">hydrate_blinded_batch_id</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.hydrate_m2m">hydrate_m2m</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.is_authenticated">is_authenticated</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.is_valid">is_valid</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.log_throttled_access">log_throttled_access</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.lookup_kwargs_with_identifiers">lookup_kwargs_with_identifiers</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.method_check">method_check</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_create">obj_create</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_delete">obj_delete</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_delete_list">obj_delete_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_delete_list_for_update">obj_delete_list_for_update</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_get">obj_get</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_get_list">obj_get_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_update">obj_update</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.override_urls">override_urls</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.patch_detail">patch_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.patch_list">patch_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.post_detail">post_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.post_list">post_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.prepare_es_hits">prepare_es_hits</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.prepend_urls">prepend_urls</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.put_detail">put_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.put_list">put_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.remove_api_resource_names">remove_api_resource_names</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.resource_uri_kwargs">resource_uri_kwargs</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.rollback">rollback</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.save">save</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.save_m2m">save_m2m</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.save_related">save_related</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.serialize">serialize</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.should_skip_field">should_skip_field</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.throttle_check">throttle_check</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.unauthorized_result">unauthorized_result</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.update_in_place">update_in_place</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.wrap_view">wrap_view</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource">CBHChemicalSearchResource</a></span>
        
          
  <ul>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.__init__">__init__</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.add_task_id">add_task_id</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.alter_deserialized_detail_data">alter_deserialized_detail_data</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.alter_deserialized_list_data">alter_deserialized_list_data</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.alter_detail_data_to_serialize">alter_detail_data_to_serialize</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.alter_list_data_to_serialize">alter_list_data_to_serialize</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.apply_authorization_limits">apply_authorization_limits</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.apply_filters">apply_filters</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.apply_sorting">apply_sorting</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.authorized_create_detail">authorized_create_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.authorized_create_list">authorized_create_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.authorized_delete_detail">authorized_delete_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.authorized_delete_list">authorized_delete_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.authorized_read_detail">authorized_read_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.authorized_read_list">authorized_read_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.authorized_update_detail">authorized_update_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.authorized_update_list">authorized_update_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.base_urls">base_urls</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.build_bundle">build_bundle</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.build_filters">build_filters</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.build_schema">build_schema</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.cached_obj_get">cached_obj_get</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.cached_obj_get_list">cached_obj_get_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.can_create">can_create</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.can_delete">can_delete</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.can_update">can_update</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.convert_mol_string">convert_mol_string</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.create_response">create_response</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.dehydrate">dehydrate</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.dehydrate_resource_uri">dehydrate_resource_uri</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.delete_detail">delete_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.delete_list">delete_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.deserialize">deserialize</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.detail_uri_kwargs">detail_uri_kwargs</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.determine_format">determine_format</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.dispatch">dispatch</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.dispatch_detail">dispatch_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.dispatch_list">dispatch_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.error_response">error_response</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.full_dehydrate">full_dehydrate</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.full_hydrate">full_hydrate</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.generate_cache_key">generate_cache_key</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.get_bundle_detail_data">get_bundle_detail_data</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.get_detail">get_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.get_list">get_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.get_multiple">get_multiple</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.get_object_list">get_object_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.get_resource_uri">get_resource_uri</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.get_schema">get_schema</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.get_via_uri">get_via_uri</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.hydrate">hydrate</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.hydrate_m2m">hydrate_m2m</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.is_authenticated">is_authenticated</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.is_valid">is_valid</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.log_throttled_access">log_throttled_access</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.method_check">method_check</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.obj_create">obj_create</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.obj_delete">obj_delete</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.obj_delete_list">obj_delete_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.obj_delete_list_for_update">obj_delete_list_for_update</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.obj_get">obj_get</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.obj_get_list">obj_get_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.obj_update">obj_update</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.override_urls">override_urls</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.patch_detail">patch_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.patch_list">patch_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.post_detail">post_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.post_list">post_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.prepend_urls">prepend_urls</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.put_detail">put_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.put_list">put_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.remove_api_resource_names">remove_api_resource_names</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.resource_uri_kwargs">resource_uri_kwargs</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.rollback">rollback</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.serialize">serialize</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.throttle_check">throttle_check</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.unauthorized_result">unauthorized_result</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.update_in_place">update_in_place</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHChemicalSearchResource.wrap_view">wrap_view</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource">CBHCompoundBatchResource</a></span>
        
          
  <ul>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.__init__">__init__</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.alter_deserialized_detail_data">alter_deserialized_detail_data</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.alter_deserialized_list_data">alter_deserialized_list_data</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.alter_detail_data_to_serialize">alter_detail_data_to_serialize</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.alter_list_data_to_serialize">alter_list_data_to_serialize</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.api_field_from_django_field">api_field_from_django_field</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.apply_authorization_limits">apply_authorization_limits</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.apply_filters">apply_filters</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.apply_sorting">apply_sorting</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.authorized_create_detail">authorized_create_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.authorized_create_list">authorized_create_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.authorized_delete_detail">authorized_delete_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.authorized_delete_list">authorized_delete_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.authorized_read_detail">authorized_read_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.authorized_read_list">authorized_read_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.authorized_update_detail">authorized_update_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.authorized_update_list">authorized_update_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.base_urls">base_urls</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.build_bundle">build_bundle</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.build_filters">build_filters</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.build_schema">build_schema</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.cached_obj_get">cached_obj_get</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.cached_obj_get_list">cached_obj_get_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.can_create">can_create</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.can_delete">can_delete</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.can_update">can_update</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.check_filtering">check_filtering</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.create_identifier">create_identifier</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.create_response">create_response</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.dehydrate">dehydrate</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.dehydrate_properties">dehydrate_properties</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.dehydrate_resource_uri">dehydrate_resource_uri</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.dehydrate_timestamp">dehydrate_timestamp</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.dehydrate_uuid">dehydrate_uuid</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.delete_detail">delete_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.delete_list">delete_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.deserialize">deserialize</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.detail_uri_kwargs">detail_uri_kwargs</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.determine_format">determine_format</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.dispatch">dispatch</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.dispatch_detail">dispatch_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.dispatch_list">dispatch_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.error_response">error_response</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.filter_value_to_python">filter_value_to_python</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.full_dehydrate">full_dehydrate</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.full_hydrate">full_hydrate</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.generate_cache_key">generate_cache_key</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.get_bundle_detail_data">get_bundle_detail_data</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.get_detail">get_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.get_fields">get_fields</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.get_list">get_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.get_multiple">get_multiple</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.get_object_list">get_object_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.get_project_specific_data">get_project_specific_data</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.get_resource_uri">get_resource_uri</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.get_schema">get_schema</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.get_via_uri">get_via_uri</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.hydrate">hydrate</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.hydrate_blinded_batch_id">hydrate_blinded_batch_id</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.hydrate_m2m">hydrate_m2m</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.is_authenticated">is_authenticated</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.is_valid">is_valid</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.log_throttled_access">log_throttled_access</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.lookup_kwargs_with_identifiers">lookup_kwargs_with_identifiers</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.method_check">method_check</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.obj_create">obj_create</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.obj_delete">obj_delete</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.obj_delete_list">obj_delete_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.obj_delete_list_for_update">obj_delete_list_for_update</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.obj_get">obj_get</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.obj_get_list">obj_get_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.obj_update">obj_update</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.override_urls">override_urls</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.patch_detail">patch_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.patch_list">patch_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.post_detail">post_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.post_list">post_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.prepare_es_hits">prepare_es_hits</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.prepend_urls">prepend_urls</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.put_detail">put_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.put_list">put_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.remove_api_resource_names">remove_api_resource_names</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.resource_uri_kwargs">resource_uri_kwargs</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.rollback">rollback</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.save">save</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.save_m2m">save_m2m</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.save_related">save_related</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.serialize">serialize</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.should_skip_field">should_skip_field</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.throttle_check">throttle_check</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.unauthorized_result">unauthorized_result</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.update_in_place">update_in_place</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHCompoundBatchResource.wrap_view">wrap_view</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource">CBHMultipleBatchUploadResource</a></span>
        
          
  <ul>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.__init__">__init__</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.alter_deserialized_detail_data">alter_deserialized_detail_data</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.alter_deserialized_list_data">alter_deserialized_list_data</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.alter_detail_data_to_serialize">alter_detail_data_to_serialize</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.alter_list_data_to_serialize">alter_list_data_to_serialize</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.api_field_from_django_field">api_field_from_django_field</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.apply_authorization_limits">apply_authorization_limits</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.apply_filters">apply_filters</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.apply_sorting">apply_sorting</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.authorized_create_detail">authorized_create_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.authorized_create_list">authorized_create_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.authorized_delete_detail">authorized_delete_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.authorized_delete_list">authorized_delete_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.authorized_read_detail">authorized_read_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.authorized_read_list">authorized_read_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.authorized_update_detail">authorized_update_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.authorized_update_list">authorized_update_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.base_urls">base_urls</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.build_bundle">build_bundle</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.build_filters">build_filters</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.build_schema">build_schema</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.cached_obj_get">cached_obj_get</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.cached_obj_get_list">cached_obj_get_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.can_create">can_create</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.can_delete">can_delete</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.can_update">can_update</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.check_filtering">check_filtering</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.create_identifier">create_identifier</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.create_response">create_response</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.dehydrate">dehydrate</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.dehydrate_resource_uri">dehydrate_resource_uri</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.delete_detail">delete_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.delete_list">delete_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.deserialize">deserialize</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.detail_uri_kwargs">detail_uri_kwargs</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.determine_format">determine_format</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.dispatch">dispatch</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.dispatch_detail">dispatch_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.dispatch_list">dispatch_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.error_response">error_response</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.filter_value_to_python">filter_value_to_python</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.full_dehydrate">full_dehydrate</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.full_hydrate">full_hydrate</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.generate_cache_key">generate_cache_key</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.get_bundle_detail_data">get_bundle_detail_data</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.get_detail">get_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.get_fields">get_fields</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.get_list">get_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.get_multiple">get_multiple</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.get_object_list">get_object_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.get_resource_uri">get_resource_uri</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.get_schema">get_schema</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.get_via_uri">get_via_uri</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.hydrate">hydrate</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.hydrate_m2m">hydrate_m2m</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.is_authenticated">is_authenticated</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.is_valid">is_valid</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.log_throttled_access">log_throttled_access</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.lookup_kwargs_with_identifiers">lookup_kwargs_with_identifiers</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.method_check">method_check</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.obj_create">obj_create</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.obj_delete">obj_delete</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.obj_delete_list">obj_delete_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.obj_delete_list_for_update">obj_delete_list_for_update</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.obj_get">obj_get</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.obj_get_list">obj_get_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.obj_update">obj_update</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.override_urls">override_urls</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.patch_detail">patch_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.patch_list">patch_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.post_detail">post_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.post_list">post_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.prepend_urls">prepend_urls</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.put_detail">put_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.put_list">put_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.remove_api_resource_names">remove_api_resource_names</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.resource_uri_kwargs">resource_uri_kwargs</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.rollback">rollback</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.save">save</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.save_m2m">save_m2m</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.save_related">save_related</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.serialize">serialize</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.should_skip_field">should_skip_field</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.throttle_check">throttle_check</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.unauthorized_result">unauthorized_result</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.update_in_place">update_in_place</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource.wrap_view">wrap_view</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#cbh_chem_api.resources.CBHSavedSearchResource">CBHSavedSearchResource</a></span>
        
          
  <ul>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.__init__">__init__</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.alter_deserialized_detail_data">alter_deserialized_detail_data</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.alter_deserialized_list_data">alter_deserialized_list_data</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.alter_detail_data_to_serialize">alter_detail_data_to_serialize</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.alter_list_data_to_serialize">alter_list_data_to_serialize</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.api_field_from_django_field">api_field_from_django_field</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.apply_authorization_limits">apply_authorization_limits</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.apply_filters">apply_filters</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.apply_sorting">apply_sorting</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.authorized_create_detail">authorized_create_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.authorized_create_list">authorized_create_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.authorized_delete_detail">authorized_delete_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.authorized_delete_list">authorized_delete_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.authorized_read_detail">authorized_read_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.authorized_read_list">authorized_read_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.authorized_update_detail">authorized_update_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.authorized_update_list">authorized_update_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.base_urls">base_urls</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.build_bundle">build_bundle</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.build_filters">build_filters</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.build_schema">build_schema</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.cached_obj_get">cached_obj_get</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.cached_obj_get_list">cached_obj_get_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.can_create">can_create</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.can_delete">can_delete</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.can_update">can_update</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.check_filtering">check_filtering</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.create_identifier">create_identifier</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.create_response">create_response</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.dehydrate">dehydrate</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.dehydrate_properties">dehydrate_properties</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.dehydrate_resource_uri">dehydrate_resource_uri</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.dehydrate_timestamp">dehydrate_timestamp</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.dehydrate_uuid">dehydrate_uuid</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.delete_detail">delete_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.delete_list">delete_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.deserialize">deserialize</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.detail_uri_kwargs">detail_uri_kwargs</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.determine_format">determine_format</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.dispatch">dispatch</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.dispatch_detail">dispatch_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.dispatch_list">dispatch_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.error_response">error_response</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.filter_value_to_python">filter_value_to_python</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.full_dehydrate">full_dehydrate</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.full_hydrate">full_hydrate</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.generate_cache_key">generate_cache_key</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.get_bundle_detail_data">get_bundle_detail_data</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.get_detail">get_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.get_fields">get_fields</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.get_list">get_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.get_multiple">get_multiple</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.get_object_list">get_object_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.get_project_specific_data">get_project_specific_data</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.get_resource_uri">get_resource_uri</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.get_schema">get_schema</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.get_via_uri">get_via_uri</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.hydrate">hydrate</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.hydrate_blinded_batch_id">hydrate_blinded_batch_id</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.hydrate_m2m">hydrate_m2m</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.is_authenticated">is_authenticated</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.is_valid">is_valid</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.log_throttled_access">log_throttled_access</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.lookup_kwargs_with_identifiers">lookup_kwargs_with_identifiers</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.method_check">method_check</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.obj_create">obj_create</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.obj_delete">obj_delete</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.obj_delete_list">obj_delete_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.obj_delete_list_for_update">obj_delete_list_for_update</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.obj_get">obj_get</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.obj_get_list">obj_get_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.obj_update">obj_update</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.override_urls">override_urls</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.patch_detail">patch_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.patch_list">patch_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.post_detail">post_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.post_list">post_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.prepare_es_hits">prepare_es_hits</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.prepend_urls">prepend_urls</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.put_detail">put_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.put_list">put_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.remove_api_resource_names">remove_api_resource_names</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.resource_uri_kwargs">resource_uri_kwargs</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.rollback">rollback</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.save">save</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.save_m2m">save_m2m</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.save_related">save_related</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.serialize">serialize</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.should_skip_field">should_skip_field</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.throttle_check">throttle_check</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.unauthorized_result">unauthorized_result</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.update_in_place">update_in_place</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CBHSavedSearchResource.wrap_view">wrap_view</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#cbh_chem_api.resources.CompoundPropertiesResource">CompoundPropertiesResource</a></span>
        
          
  <ul>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.__init__">__init__</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.alter_deserialized_detail_data">alter_deserialized_detail_data</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.alter_deserialized_list_data">alter_deserialized_list_data</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.alter_detail_data_to_serialize">alter_detail_data_to_serialize</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.alter_list_data_to_serialize">alter_list_data_to_serialize</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.api_field_from_django_field">api_field_from_django_field</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.apply_authorization_limits">apply_authorization_limits</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.apply_filters">apply_filters</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.apply_sorting">apply_sorting</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.authorized_create_detail">authorized_create_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.authorized_create_list">authorized_create_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.authorized_delete_detail">authorized_delete_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.authorized_delete_list">authorized_delete_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.authorized_read_detail">authorized_read_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.authorized_read_list">authorized_read_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.authorized_update_detail">authorized_update_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.authorized_update_list">authorized_update_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.base_urls">base_urls</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.build_bundle">build_bundle</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.build_filters">build_filters</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.build_schema">build_schema</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.cached_obj_get">cached_obj_get</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.cached_obj_get_list">cached_obj_get_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.can_create">can_create</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.can_delete">can_delete</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.can_update">can_update</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.check_filtering">check_filtering</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.create_identifier">create_identifier</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.create_response">create_response</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.dehydrate">dehydrate</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.dehydrate_resource_uri">dehydrate_resource_uri</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.delete_detail">delete_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.delete_list">delete_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.deserialize">deserialize</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.detail_uri_kwargs">detail_uri_kwargs</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.determine_format">determine_format</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.dispatch">dispatch</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.dispatch_detail">dispatch_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.dispatch_list">dispatch_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.error_response">error_response</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.filter_value_to_python">filter_value_to_python</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.full_dehydrate">full_dehydrate</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.full_hydrate">full_hydrate</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.generate_cache_key">generate_cache_key</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.get_bundle_detail_data">get_bundle_detail_data</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.get_detail">get_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.get_fields">get_fields</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.get_list">get_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.get_multiple">get_multiple</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.get_object_list">get_object_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.get_resource_uri">get_resource_uri</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.get_schema">get_schema</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.get_via_uri">get_via_uri</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.hydrate">hydrate</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.hydrate_m2m">hydrate_m2m</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.is_authenticated">is_authenticated</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.is_valid">is_valid</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.log_throttled_access">log_throttled_access</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.lookup_kwargs_with_identifiers">lookup_kwargs_with_identifiers</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.method_check">method_check</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.obj_create">obj_create</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.obj_delete">obj_delete</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.obj_delete_list">obj_delete_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.obj_delete_list_for_update">obj_delete_list_for_update</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.obj_get">obj_get</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.obj_get_list">obj_get_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.obj_update">obj_update</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.override_urls">override_urls</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.patch_detail">patch_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.patch_list">patch_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.post_detail">post_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.post_list">post_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.prepend_urls">prepend_urls</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.put_detail">put_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.put_list">put_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.remove_api_resource_names">remove_api_resource_names</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.resource_uri_kwargs">resource_uri_kwargs</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.rollback">rollback</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.save">save</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.save_m2m">save_m2m</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.save_related">save_related</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.serialize">serialize</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.should_skip_field">should_skip_field</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.throttle_check">throttle_check</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.unauthorized_result">unauthorized_result</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.update_in_place">update_in_place</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.CompoundPropertiesResource.wrap_view">wrap_view</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource">IndexingCBHCompoundBatchResource</a></span>
        
          
  <ul>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.__init__">__init__</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.alter_deserialized_detail_data">alter_deserialized_detail_data</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.alter_deserialized_list_data">alter_deserialized_list_data</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.alter_detail_data_to_serialize">alter_detail_data_to_serialize</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.alter_list_data_to_serialize">alter_list_data_to_serialize</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.api_field_from_django_field">api_field_from_django_field</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.apply_authorization_limits">apply_authorization_limits</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.apply_filters">apply_filters</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.apply_sorting">apply_sorting</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.authorized_create_detail">authorized_create_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.authorized_create_list">authorized_create_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.authorized_delete_detail">authorized_delete_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.authorized_delete_list">authorized_delete_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.authorized_read_detail">authorized_read_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.authorized_read_list">authorized_read_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.authorized_update_detail">authorized_update_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.authorized_update_list">authorized_update_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.base_urls">base_urls</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.build_bundle">build_bundle</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.build_filters">build_filters</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.build_schema">build_schema</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.cached_obj_get">cached_obj_get</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.cached_obj_get_list">cached_obj_get_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.can_create">can_create</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.can_delete">can_delete</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.can_update">can_update</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.check_filtering">check_filtering</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.create_identifier">create_identifier</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.create_response">create_response</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.dehydrate">dehydrate</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.dehydrate_properties">dehydrate_properties</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.dehydrate_resource_uri">dehydrate_resource_uri</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.dehydrate_timestamp">dehydrate_timestamp</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.dehydrate_uuid">dehydrate_uuid</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.delete_detail">delete_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.delete_list">delete_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.deserialize">deserialize</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.detail_uri_kwargs">detail_uri_kwargs</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.determine_format">determine_format</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.dispatch">dispatch</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.dispatch_detail">dispatch_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.dispatch_list">dispatch_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.error_response">error_response</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.filter_value_to_python">filter_value_to_python</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.full_dehydrate">full_dehydrate</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.full_hydrate">full_hydrate</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.generate_cache_key">generate_cache_key</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.get_bundle_detail_data">get_bundle_detail_data</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.get_detail">get_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.get_fields">get_fields</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.get_list">get_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.get_multiple">get_multiple</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.get_object_list">get_object_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.get_project_specific_data">get_project_specific_data</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.get_resource_uri">get_resource_uri</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.get_schema">get_schema</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.get_via_uri">get_via_uri</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.hydrate">hydrate</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.hydrate_blinded_batch_id">hydrate_blinded_batch_id</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.hydrate_m2m">hydrate_m2m</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.index_batch_list">index_batch_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.is_authenticated">is_authenticated</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.is_valid">is_valid</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.log_throttled_access">log_throttled_access</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.lookup_kwargs_with_identifiers">lookup_kwargs_with_identifiers</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.method_check">method_check</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.obj_create">obj_create</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.obj_delete">obj_delete</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.obj_delete_list">obj_delete_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.obj_delete_list_for_update">obj_delete_list_for_update</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.obj_get">obj_get</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.obj_get_list">obj_get_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.obj_update">obj_update</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.override_urls">override_urls</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.patch_detail">patch_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.patch_list">patch_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.post_detail">post_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.post_list">post_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.prepare_es_hits">prepare_es_hits</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.prepare_fields_for_index">prepare_fields_for_index</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.prepend_urls">prepend_urls</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.put_detail">put_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.put_list">put_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.reindex_elasticsearch">reindex_elasticsearch</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.remove_api_resource_names">remove_api_resource_names</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.resource_uri_kwargs">resource_uri_kwargs</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.rollback">rollback</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.save">save</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.save_m2m">save_m2m</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.save_related">save_related</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.serialize">serialize</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.should_skip_field">should_skip_field</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.throttle_check">throttle_check</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.unauthorized_result">unauthorized_result</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.update_in_place">update_in_place</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource.wrap_view">wrap_view</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource">MoleculeDictionaryResource</a></span>
        
          
  <ul>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.__init__">__init__</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.alter_deserialized_detail_data">alter_deserialized_detail_data</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.alter_deserialized_list_data">alter_deserialized_list_data</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.alter_detail_data_to_serialize">alter_detail_data_to_serialize</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.alter_list_data_to_serialize">alter_list_data_to_serialize</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.api_field_from_django_field">api_field_from_django_field</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.apply_authorization_limits">apply_authorization_limits</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.apply_filters">apply_filters</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.apply_sorting">apply_sorting</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.authorized_create_detail">authorized_create_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.authorized_create_list">authorized_create_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.authorized_delete_detail">authorized_delete_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.authorized_delete_list">authorized_delete_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.authorized_read_detail">authorized_read_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.authorized_read_list">authorized_read_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.authorized_update_detail">authorized_update_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.authorized_update_list">authorized_update_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.base_urls">base_urls</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.build_bundle">build_bundle</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.build_filters">build_filters</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.build_schema">build_schema</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.cached_obj_get">cached_obj_get</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.cached_obj_get_list">cached_obj_get_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.can_create">can_create</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.can_delete">can_delete</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.can_update">can_update</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.check_filtering">check_filtering</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.create_identifier">create_identifier</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.create_response">create_response</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.dehydrate">dehydrate</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.dehydrate_resource_uri">dehydrate_resource_uri</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.delete_detail">delete_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.delete_list">delete_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.deserialize">deserialize</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.detail_uri_kwargs">detail_uri_kwargs</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.determine_format">determine_format</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.dispatch">dispatch</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.dispatch_detail">dispatch_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.dispatch_list">dispatch_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.error_response">error_response</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.filter_value_to_python">filter_value_to_python</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.full_dehydrate">full_dehydrate</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.full_hydrate">full_hydrate</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.generate_cache_key">generate_cache_key</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.get_bundle_detail_data">get_bundle_detail_data</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.get_detail">get_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.get_fields">get_fields</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.get_list">get_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.get_multiple">get_multiple</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.get_object_list">get_object_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.get_resource_uri">get_resource_uri</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.get_schema">get_schema</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.get_via_uri">get_via_uri</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.hydrate">hydrate</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.hydrate_m2m">hydrate_m2m</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.is_authenticated">is_authenticated</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.is_valid">is_valid</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.log_throttled_access">log_throttled_access</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.lookup_kwargs_with_identifiers">lookup_kwargs_with_identifiers</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.method_check">method_check</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.obj_create">obj_create</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.obj_delete">obj_delete</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.obj_delete_list">obj_delete_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.obj_delete_list_for_update">obj_delete_list_for_update</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.obj_get">obj_get</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.obj_get_list">obj_get_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.obj_update">obj_update</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.override_urls">override_urls</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.patch_detail">patch_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.patch_list">patch_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.post_detail">post_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.post_list">post_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.prepend_urls">prepend_urls</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.put_detail">put_detail</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.put_list">put_list</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.remove_api_resource_names">remove_api_resource_names</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.resource_uri_kwargs">resource_uri_kwargs</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.rollback">rollback</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.save">save</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.save_m2m">save_m2m</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.save_related">save_related</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.serialize">serialize</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.should_skip_field">should_skip_field</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.throttle_check">throttle_check</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.unauthorized_result">unauthorized_result</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.update_in_place">update_in_place</a></li>
    <li class="mono"><a href="#cbh_chem_api.resources.MoleculeDictionaryResource.wrap_view">wrap_view</a></li>
  </ul>

        </li>
      </ul>
    </li>

    </ul>
  </div>

    <article id="content">
      
  

  


  <header id="section-intro">
  <h1 class="title"><span class="name">cbh_chem_api.resources</span> module</h1>
  <p>This is the main module of the new ChemiReg API
It provides the webservices to add, search for and index CBHCompoundBatch objects</p>
  
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources" class="source">
    <div class="codehilite"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This is the main module of the new ChemiReg API</span>
<span class="sd">It provides the webservices to add, search for and index CBHCompoundBatch objects</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">chembl_business_model.models.compounds</span> <span class="kn">import</span> <span class="n">CompoundProperties</span><span class="p">,</span> <span class="n">MoleculeDictionary</span>
<span class="kn">from</span> <span class="nn">cbh_chembl_model_extension.models</span> <span class="kn">import</span> <span class="n">CBHCompoundBatch</span><span class="p">,</span> <span class="n">generate_uox_id</span><span class="p">,</span> <span class="n">index_new_compounds</span>
<span class="kn">from</span> <span class="nn">tastypie.resources</span> <span class="kn">import</span> <span class="n">ALL</span>
<span class="kn">from</span> <span class="nn">tastypie.resources</span> <span class="kn">import</span> <span class="n">ALL_WITH_RELATIONS</span>
<span class="kn">from</span> <span class="nn">tastypie.resources</span> <span class="kn">import</span> <span class="n">ModelResource</span><span class="p">,</span> <span class="n">Resource</span>
<span class="kn">from</span> <span class="nn">tastypie.serializers</span> <span class="kn">import</span> <span class="n">Serializer</span>
<span class="kn">from</span> <span class="nn">django.conf</span> <span class="kn">import</span> <span class="n">settings</span>
<span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">django.core.exceptions</span> <span class="kn">import</span> <span class="n">ObjectDoesNotExist</span>
<span class="kn">from</span> <span class="nn">tastypie.authorization</span> <span class="kn">import</span> <span class="n">Authorization</span>
<span class="kn">from</span> <span class="nn">tastypie</span> <span class="kn">import</span> <span class="n">fields</span>
<span class="kn">from</span> <span class="nn">cbh_core_api.authorization</span> <span class="kn">import</span> <span class="n">ProjectAuthorization</span>
<span class="kn">from</span> <span class="nn">cbh_core_api.resources</span> <span class="kn">import</span> <span class="n">SimpleResourceURIField</span><span class="p">,</span> <span class="n">UserResource</span><span class="p">,</span> <span class="n">UserHydrate</span><span class="p">,</span> <span class="n">CBHNoSerializedDictField</span><span class="p">,</span>  <span class="n">ChemregProjectResource</span><span class="p">,</span> <span class="n">ChemRegCustomFieldConfigResource</span><span class="p">,</span> <span class="n">NoCustomFieldsChemregProjectResource</span>
<span class="kn">from</span> <span class="nn">cbh_core_model.models</span> <span class="kn">import</span> <span class="n">Project</span>
<span class="kn">from</span> <span class="nn">cbh_utils</span> <span class="kn">import</span> <span class="n">elasticsearch_client</span>
<span class="kn">import</span> <span class="nn">json</span> 
<span class="kn">from</span> <span class="nn">django.http</span> <span class="kn">import</span> <span class="n">HttpResponse</span><span class="p">,</span> <span class="n">HttpRequest</span>
<span class="kn">from</span> <span class="nn">tastypie</span> <span class="kn">import</span> <span class="n">http</span>
<span class="kn">from</span> <span class="nn">tastypie.exceptions</span> <span class="kn">import</span> <span class="n">Unauthorized</span><span class="p">,</span> <span class="n">BadRequest</span>
<span class="kn">from</span> <span class="nn">tastypie.utils.mime</span> <span class="kn">import</span> <span class="n">determine_format</span><span class="p">,</span> <span class="n">build_content_type</span>
<span class="kn">from</span> <span class="nn">base64</span> <span class="kn">import</span> <span class="n">b64decode</span><span class="p">,</span> <span class="n">b64encode</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">cbh_chem_api.new_serializers</span> <span class="kn">import</span> <span class="n">CBHCompoundBatchSerializer</span>
<span class="kn">from</span> <span class="nn">django_q.tasks</span> <span class="kn">import</span> <span class="n">async_iter</span><span class="p">,</span> <span class="n">result</span>
<span class="kn">from</span> <span class="nn">django.core.cache</span> <span class="kn">import</span> <span class="n">caches</span>
<span class="kn">from</span> <span class="nn">tastypie.utils</span> <span class="kn">import</span> <span class="n">dict_strip_unicode_keys</span>
<span class="kn">from</span> <span class="nn">rdkit</span> <span class="kn">import</span> <span class="n">Chem</span>
<span class="kn">from</span> <span class="nn">cbh_chembl_model_extension.models</span> <span class="kn">import</span> <span class="n">_ctab2image</span>
<span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">IntegrityError</span>
<span class="kn">from</span> <span class="nn">django.test</span> <span class="kn">import</span> <span class="n">RequestFactory</span>
<span class="kn">from</span> <span class="nn">django.contrib.auth</span> <span class="kn">import</span> <span class="n">login</span>
<span class="k">try</span><span class="p">:</span>
    <span class="c1"># django &gt;= 1.7</span>
    <span class="kn">from</span> <span class="nn">django.apps</span> <span class="kn">import</span> <span class="n">apps</span>
    <span class="n">get_model</span> <span class="o">=</span> <span class="n">apps</span><span class="o">.</span><span class="n">get_model</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="c1"># django &lt; 1.7</span>
    <span class="kn">from</span> <span class="nn">django.db.models</span> <span class="kn">import</span> <span class="n">get_model</span>

<span class="kn">from</span> <span class="nn">django.contrib.auth</span> <span class="kn">import</span> <span class="n">get_user_model</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>

<span class="n">EMPTY_ARRAY_B64</span> <span class="o">=</span> <span class="n">b64encode</span><span class="p">(</span><span class="s2">&quot;[]&quot;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">django_q.tasks</span> <span class="kn">import</span> <span class="n">async</span>





<span class="k">class</span> <span class="nc">CompoundPropertiesResource</span><span class="p">(</span><span class="n">ModelResource</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Resource to provide data about the compound properties </span>
<span class="sd">    as generated by the generateCompoundProperties task in </span>
<span class="sd">    ChEMBL business model</span>
<span class="sd">    Used only for a related resource, not declared globally as this would be a security risk</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">queryset</span> <span class="o">=</span> <span class="n">CompoundProperties</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;alogp&quot;</span><span class="p">,</span> <span class="s2">&quot;full_molformula&quot;</span><span class="p">,</span> <span class="s2">&quot;full_mwt&quot;</span><span class="p">]</span>

<span class="k">class</span> <span class="nc">MoleculeDictionaryResource</span><span class="p">(</span><span class="n">ModelResource</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Resource to provide data about the Molecule Dictionary</span>
<span class="sd">    Provides access to the compoundproperties model for a given CompoundBatch instance</span>
<span class="sd">    Used only for a related resource, not declared globally as this would be a security risk</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">compoundproperties</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">CompoundPropertiesResource</span><span class="p">,</span> <span class="s1">&#39;compoundproperties&#39;</span><span class="p">,</span>  <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">readonly</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">authorization</span> <span class="o">=</span> <span class="n">ProjectAuthorization</span><span class="p">()</span>
    <span class="n">project</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span>
        <span class="n">ChemregProjectResource</span><span class="p">,</span> <span class="s1">&#39;project&#39;</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>


    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">queryset</span> <span class="o">=</span> <span class="n">MoleculeDictionary</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;compoundproperties&quot;</span><span class="p">]</span>




<span class="k">class</span> <span class="nc">CBHChemicalSearchResource</span><span class="p">(</span><span class="n">Resource</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Provides a REST interface to POST a molfile for use with chemical search</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">help_text</span><span class="o">=</span><span class="s2">&quot;uuid generated on POST of data - comes from the task ID when molecule is searched for&quot;</span><span class="p">)</span>
    <span class="n">query_type</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">help_text</span><span class="o">=</span><span class="s2">&quot;Chemical query type - currently supports &#39;with_substructure&#39; or &#39;flexmatch&#39;&quot;</span><span class="p">)</span>
    <span class="n">molfile</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">help_text</span><span class="o">=</span><span class="s2">&quot;MDL molfile text for the molecule being searched for&quot;</span><span class="p">)</span>
    <span class="n">smiles</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">help_text</span><span class="o">=</span><span class="s2">&quot;Generated SMILES string for the molecule being searched for&quot;</span><span class="p">)</span>
    <span class="n">pids</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">ListField</span><span class="p">(</span><span class="n">help_text</span><span class="o">=</span><span class="s2">&quot;Project IDs over which this chemical search should be run&quot;</span><span class="p">)</span>
    <span class="n">filter_is_applied</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">help_text</span><span class="o">=</span><span class="s2">&quot;front end helper boolean&quot;</span><span class="p">)</span>
    <span class="n">inprogress</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>  <span class="n">help_text</span><span class="o">=</span><span class="s2">&quot;front end helper boolean&quot;</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        authorization is not used in the standard way as we just need to check the submitted project id list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">resource_name</span> <span class="o">=</span> <span class="s1">&#39;cbh_chemical_search&#39;</span>
        <span class="n">authorization</span> <span class="o">=</span> <span class="n">ProjectAuthorization</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">convert_mol_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">strn</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Take the mdl molfile string and convert it into a SMILES string</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromMolBlock</span><span class="p">(</span><span class="n">strn</span><span class="p">)</span>
            <span class="n">smiles</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolToSmiles</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">smiles</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        
        <span class="k">return</span> <span class="n">smiles</span>

    <span class="k">def</span> <span class="nf">get_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Used in the saved search method on the front end to return </span>
<span class="sd">        the molecule that should be structure searched</span>
<span class="sd">        This caching needs an upgrade to use the database instead as saved search </span>
<span class="sd">        could be retrieved in a different session</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>

        <span class="n">bundle</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">caches</span><span class="p">[</span><span class="n">settings</span><span class="o">.</span><span class="n">SESSION_CACHE_ALIAS</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;structure_search__</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pk&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">))</span>
        <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">alter_deserialized_detail_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">deserialized</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Standard tastypie hook to alter the input data from a post request after deserialization</span>
<span class="sd">        This function adds SMILES patterns and images to the input molfile</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">deserialized</span><span class="p">[</span><span class="s2">&quot;smiles&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_mol_string</span><span class="p">(</span><span class="n">deserialized</span><span class="p">[</span><span class="s2">&quot;molfile&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">deserialized</span><span class="p">[</span><span class="s2">&quot;smiles&quot;</span><span class="p">]:</span>
            <span class="n">deserialized</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">deserialized</span><span class="p">[</span><span class="s2">&quot;image&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">deserialized</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="n">deserialized</span><span class="p">[</span><span class="s2">&quot;image&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_ctab2image</span><span class="p">(</span><span class="n">deserialized</span><span class="p">[</span><span class="s2">&quot;molfile&quot;</span><span class="p">],</span><span class="mi">50</span><span class="p">,</span><span class="bp">False</span><span class="p">,</span> <span class="n">recalc</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>

        <span class="n">deserialized</span><span class="p">[</span><span class="s2">&quot;inprogress&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">deserialized</span><span class="p">[</span><span class="s2">&quot;filter_is_applied&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">return</span> <span class="n">deserialized</span>

    <span class="k">def</span> <span class="nf">post_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Takes an input molfile from a POST request and processes the structure search then</span>
<span class="sd">        saves it to the session cache </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">))</span>
        <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_deserialized_detail_data</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">deserialized</span><span class="p">)</span>
        <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">deserialized</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
        <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_create</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
        
        <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpCreated</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">obj_create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate a task id and send the relevant tasks to django q</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pids</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pids&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

        <span class="n">project_ids</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">pids</span><span class="p">:</span>

            <span class="n">project_ids</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">pid</span><span class="p">)</span> <span class="k">for</span> <span class="n">pid</span> <span class="ow">in</span> <span class="n">pids</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)]</span>
        
        <span class="n">allowed_pids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">project_ids</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">))</span>

        
        <span class="k">for</span> <span class="n">requested_pid</span> <span class="ow">in</span> <span class="n">project_ids</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">requested_pid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_pids</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">(</span><span class="s2">&quot;No permissions for requested project&quot;</span><span class="p">)</span> 

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">project_ids</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">project_ids</span> <span class="o">=</span> <span class="n">allowed_pids</span>

        <span class="n">allowed_pids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">allowed_pids</span><span class="p">)</span>
        <span class="n">one_eighth</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">allowed_pids</span><span class="p">)</span><span class="o">/</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="c1">#Split the projects into 8 equal parts</span>
        <span class="n">pid_chunks</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">chunks</span><span class="p">(</span><span class="n">allowed_pids</span><span class="p">,</span> <span class="n">one_eighth</span><span class="p">))</span>

        <span class="n">args</span> <span class="o">=</span> <span class="p">[(</span><span class="n">pid_list</span><span class="p">,</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;query_type&quot;</span><span class="p">],</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;smiles&quot;</span><span class="p">])</span> <span class="k">for</span> <span class="n">pid_list</span> <span class="ow">in</span> <span class="n">pid_chunks</span><span class="p">]</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_task_id</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">bundle</span>


        
    <span class="k">def</span> <span class="nf">add_task_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calls async_iter to generate a django_q task id and </span>
<span class="sd">        set the qcluster process to work processing the structure search. </span>
<span class="sd">        The user will then be able to search for it but </span>
<span class="sd">        this gives an extra second or so while the user considers pressing the apply key&quot;&quot;&quot;</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">async_iter</span><span class="p">(</span><span class="s1">&#39;cbh_chem_api.tasks.get_structure_search_for_projects&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
        <span class="n">caches</span><span class="p">[</span><span class="n">settings</span><span class="o">.</span><span class="n">SESSION_CACHE_ALIAS</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;structure_search__</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data</span>


<span class="k">def</span> <span class="nf">chunks</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Yield successive n-sized chunks from l.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="n">n</span><span class="p">):</span>
        <span class="k">yield</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">n</span><span class="p">]</span>

<span class="k">class</span> <span class="nc">BaseCBHCompoundBatchResource</span><span class="p">(</span><span class="n">ModelResource</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;New base resource for a compound batch, abstract implementation used</span>
<span class="sd">    in the indexing of compound batches as well as in the search API and the saved searches</span>
<span class="sd">    ModelResource - these fields are in addition to the fields already present in the CBHCompoundBatch model&quot;&quot;&quot;</span>
    <span class="n">uuid</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">timestamp</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">project</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span>
        <span class="n">ChemregProjectResource</span><span class="p">,</span> <span class="s1">&#39;project&#39;</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">creator</span> <span class="o">=</span> <span class="n">SimpleResourceURIField</span><span class="p">(</span><span class="n">UserResource</span><span class="p">,</span> <span class="s1">&#39;created_by_id&#39;</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">readonly</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">projectfull</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span>
         <span class="n">ChemregProjectResource</span><span class="p">,</span> <span class="s1">&#39;project&#39;</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">readonly</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">related_molregno</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">MoleculeDictionaryResource</span><span class="p">,</span> <span class="s1">&#39;related_molregno&#39;</span><span class="p">,</span>  <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">readonly</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">uncurated_fields</span> <span class="o">=</span> <span class="n">CBHNoSerializedDictField</span><span class="p">(</span><span class="s1">&#39;uncurated_fields&#39;</span><span class="p">)</span>
    <span class="n">warnings</span> <span class="o">=</span> <span class="n">CBHNoSerializedDictField</span><span class="p">(</span><span class="s1">&#39;warnings&#39;</span><span class="p">)</span>
    <span class="n">properties</span> <span class="o">=</span> <span class="n">CBHNoSerializedDictField</span><span class="p">(</span><span class="s1">&#39;properties&#39;</span><span class="p">)</span>
    <span class="n">custom_fields</span> <span class="o">=</span> <span class="n">CBHNoSerializedDictField</span><span class="p">(</span><span class="s1">&#39;custom_fields&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">dehydrate_timestamp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Provide a viewer-friendly timestamp&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">created</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">dehydrate_uuid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This is either a blinded batch uuid or a uuid for the compound structure based on the INCHI key&quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">related_molregno</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">related_molregno</span><span class="o">.</span><span class="n">chembl</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">related_molregno</span><span class="o">.</span><span class="n">chembl</span><span class="o">.</span><span class="n">chembl_id</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">related_molregno</span><span class="o">.</span><span class="n">chembl</span><span class="o">.</span><span class="n">chembl_id</span>
        <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">blinded_batch_id</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">blinded_batch_id</span>

    <span class="k">def</span> <span class="nf">create_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">HttpResponse</span><span class="p">,</span> <span class="o">**</span><span class="n">response_kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Ensure that data is returned in the right format as an attachment if returning SDF or XLSX data</span>
<span class="sd">        Should an object have been created or updated, now is the time to</span>
<span class="sd">        reindex it in the elasticsearch index</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">desired_format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">determine_format</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">response_class</span> <span class="o">==</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpCreated</span> <span class="ow">or</span> <span class="n">response_class</span> <span class="o">==</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpAccepted</span><span class="p">:</span>
            <span class="n">batches</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;objects&quot;</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;objects&quot;</span><span class="p">):</span>
                    <span class="n">batches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">batches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
            <span class="n">index_batches_in_new_index</span><span class="p">(</span><span class="n">batches</span><span class="p">)</span>

        <span class="n">serialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">desired_format</span><span class="p">)</span>
        <span class="n">rc</span> <span class="o">=</span> <span class="n">response_class</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">serialized</span><span class="p">,</span> <span class="n">content_type</span><span class="o">=</span><span class="n">build_content_type</span><span class="p">(</span>
            <span class="n">desired_format</span><span class="p">),</span> <span class="o">**</span><span class="n">response_kwargs</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="n">desired_format</span> <span class="o">==</span> <span class="s1">&#39;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&#39;</span><span class="p">):</span>
            <span class="n">rc</span><span class="p">[</span><span class="s1">&#39;Content-Disposition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;attachment; filename=export_from_chembiohub_chemreg</span><span class="si">%d</span><span class="s1">.xlsx&#39;</span> <span class="o">%</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">desired_format</span> <span class="o">==</span> <span class="s1">&#39;chemical/x-mdl-sdfile&#39;</span><span class="p">):</span>
            <span class="n">rc</span><span class="p">[</span><span class="s1">&#39;Content-Disposition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;attachment; filename=export_from_chembiohub_chemreg</span><span class="si">%d</span><span class="s1">.sdf&#39;</span> <span class="o">%</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">rc</span>


    <span class="k">def</span> <span class="nf">hydrate_blinded_batch_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Hydrate functions are run before save of a new or updated model instance</span>
<span class="sd">        This one ensures that the blinded batch id is filled in in cases where an inventory item </span>
<span class="sd">        with no ModelculeDictionary attribute (related_molregno)&quot;&quot;&quot;</span> 
        <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;blinded_batch_id&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">u&quot;EMPTY_ID&quot;</span><span class="p">:</span>
            <span class="n">uox_id</span> <span class="o">=</span> <span class="n">generate_uox_id</span><span class="p">()</span>
            <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;blinded_batch_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">uox_id</span>
            <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">blinded_batch_id</span> <span class="o">=</span> <span class="n">uox_id</span>
        <span class="k">return</span> <span class="n">bundle</span>


    <span class="k">def</span> <span class="nf">dehydrate_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Ensure that the archived property is always presented in a consistent way&quot;&quot;&quot;</span>
        <span class="n">archived</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;archived&quot;</span><span class="p">,</span> <span class="s2">&quot;false&quot;</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">properties</span>
        <span class="n">value</span><span class="p">[</span><span class="s2">&quot;archived&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">archived</span>
        <span class="k">return</span> <span class="n">value</span>


    <span class="k">def</span> <span class="nf">hydrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">created_by_id</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span>
        <span class="k">return</span> <span class="n">bundle</span>


    <span class="k">def</span> <span class="nf">get_project_specific_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">queries</span><span class="p">,</span> <span class="n">pids</span><span class="p">,</span> <span class="n">sorts</span><span class="p">,</span> <span class="n">textsearch</span><span class="p">,</span> <span class="n">batch_ids_by_project</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;When an Excel or SDF download is requested, </span>
<span class="sd">        present the data as a</span>
<span class="sd">        project by project summary so that </span>
<span class="sd">        one spreadsheet can be used per project&quot;&quot;&quot;</span>
        <span class="n">to_return</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">pids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pids</span><span class="p">)</span>
        <span class="n">table_schemata</span> <span class="o">=</span> <span class="n">get_schemata</span><span class="p">(</span><span class="n">pids</span><span class="p">,</span> <span class="s2">&quot;export&quot;</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
        <span class="c1">#We have removed the schema from the index for data efficiency so</span>
        <span class="c1">#We need to pull it out of the project resource</span>
            
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">proj_data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">table_schemata</span><span class="p">):</span>
            <span class="n">table_schema_for_project</span> <span class="o">=</span> <span class="n">proj_data</span><span class="p">[</span><span class="s2">&quot;tabular_data_schema&quot;</span><span class="p">][</span><span class="s2">&quot;for_export&quot;</span><span class="p">]</span>
            <span class="n">pid</span> <span class="o">=</span> <span class="n">pids</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
            <span class="n">proj_index</span> <span class="o">=</span> <span class="n">elasticsearch_client</span><span class="o">.</span><span class="n">get_project_index_name</span><span class="p">(</span><span class="n">pid</span><span class="p">)</span>
            <span class="n">es_data</span> <span class="o">=</span> <span class="n">elasticsearch_client</span><span class="o">.</span><span class="n">get_list_data_elasticsearch</span><span class="p">(</span><span class="n">queries</span><span class="p">,</span>
                    <span class="n">proj_index</span><span class="p">,</span>
                    <span class="n">sorts</span><span class="o">=</span><span class="n">sorts</span><span class="p">,</span> 
                    <span class="n">textsearch</span><span class="o">=</span><span class="n">textsearch</span><span class="p">,</span>
                    <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                    <span class="n">limit</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
                    <span class="n">batch_ids_by_project</span><span class="o">=</span><span class="n">batch_ids_by_project</span> <span class="p">)</span>
            <span class="n">standardised</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prepare_es_hits</span><span class="p">(</span><span class="n">es_data</span><span class="p">)</span>

            <span class="n">standardised</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">proj_data</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
            <span class="n">standardised</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pid</span>
            <span class="n">standardised</span><span class="p">[</span><span class="s2">&quot;schema&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">table_schema_for_project</span>
            <span class="n">base</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;wsgi.url_scheme&quot;</span><span class="p">,</span><span class="s2">&quot;http&quot;</span><span class="p">)</span> 
            <span class="n">base</span> <span class="o">+=</span> <span class="s2">&quot;://&quot;</span>
            <span class="n">base</span> <span class="o">+=</span> <span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;HTTP_HOST&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">standardised</span><span class="p">[</span><span class="s2">&quot;schema&quot;</span><span class="p">]:</span>
                <span class="n">field</span><span class="p">[</span><span class="s2">&quot;base_url&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">base</span>
            <span class="n">to_return</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">standardised</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;format&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;sdf&quot;</span><span class="p">:</span>
            <span class="c1">#For the Excel sheet print out the query used</span>
            <span class="n">query_reps</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;fieldn&quot;</span><span class="p">:</span> <span class="s2">&quot;Project&quot;</span><span class="p">,</span> <span class="s2">&quot;pick_from_list&quot;</span><span class="p">:</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">ret</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span> <span class="k">for</span> <span class="n">ret</span> <span class="ow">in</span> <span class="n">to_return</span><span class="p">])</span> <span class="p">}]</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">q</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">queries</span><span class="p">):</span>
                <span class="n">qrep</span> <span class="o">=</span> <span class="p">{</span><span class="n">qtype</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="p">:</span> <span class="s2">u&quot;&quot;</span> <span class="k">for</span> <span class="n">qtype</span> <span class="ow">in</span> <span class="n">settings</span><span class="o">.</span><span class="n">CBH_QUERY_TYPES</span><span class="p">}</span>
                <span class="n">qrep</span><span class="p">[</span><span class="s2">&quot;fieldn&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">q</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;pick_from_list&quot;</span><span class="p">:</span>
                        <span class="n">qrep</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;field_path&quot;</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
                            <span class="n">knownBy</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">TABULAR_DATA_SETTINGS</span><span class="p">[</span><span class="s2">&quot;schema&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">value</span><span class="p">,{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;knownBy&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="n">knownBy</span><span class="p">:</span>
                                <span class="n">knownBy</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                            <span class="n">qrep</span><span class="p">[</span><span class="s2">&quot;fieldn&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">l</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">knownBy</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">qrep</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

                <span class="n">qrep</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
                <span class="n">query_reps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">qrep</span><span class="p">)</span>

            <span class="n">schem</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;knownBy&quot;</span> <span class="p">:</span> <span class="s2">&quot;Row&quot;</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;fieldn&quot;</span><span class="p">,</span> <span class="s2">&quot;knownBy&quot;</span> <span class="p">:</span> <span class="s2">&quot;Col&quot;</span><span class="p">}]</span> <span class="o">+</span> <span class="p">[{</span><span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">qtype</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">],</span> <span class="s2">&quot;knownBy&quot;</span> <span class="p">:</span> <span class="n">qtype</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]}</span> <span class="k">for</span> <span class="n">qtype</span> <span class="ow">in</span> <span class="n">settings</span><span class="o">.</span><span class="n">CBH_QUERY_TYPES</span><span class="p">]</span>
            <span class="n">query_summary</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;_Query Used&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;objects&quot;</span> <span class="p">:</span> <span class="n">query_reps</span><span class="p">,</span>
                    <span class="s2">&quot;schema&quot;</span> <span class="p">:</span> <span class="n">schem</span>
                    <span class="p">}</span>
            <span class="n">to_return</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">query_summary</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">to_return</span>



    <span class="k">def</span> <span class="nf">get_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a single serialized resource.</span>
<span class="sd">        Calls ``cached_obj_get/obj_get`` to provide the data, then handles that result</span>
<span class="sd">        set and serializes it.</span>
<span class="sd">        Should return a HttpResponse (200 OK).</span>
<span class="sd">        Get a single CBHCompoundbatches from elasticsearch by running a query</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">basic_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>

        <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">allowed_pids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">project_ids</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
        <span class="n">concatenated_indices</span> <span class="o">=</span> <span class="n">elasticsearch_client</span><span class="o">.</span><span class="n">get_list_of_indicies</span><span class="p">(</span><span class="n">allowed_pids</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">elasticsearch_client</span><span class="o">.</span><span class="n">get_detail_data_elasticsearch</span><span class="p">(</span><span class="n">concatenated_indices</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;pk&quot;</span><span class="p">])</span>   
        

        <span class="n">requested_pid</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;projectfull&quot;</span><span class="p">][</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">requested_pid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_pids</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">(</span><span class="s2">&quot;No permissions for requested project&quot;</span><span class="p">)</span> 

        <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>





    <span class="k">def</span> <span class="nf">save_related</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handles the saving of related non-M2M data.</span>
<span class="sd">        Calling assigning ``child.parent = parent`` &amp; then calling</span>
<span class="sd">        ``Child.save`` isn&#39;t good enough to make sure the ``parent``</span>
<span class="sd">        is saved.</span>
<span class="sd">        To get around this, we go through all our related fields &amp;</span>
<span class="sd">        call ``save`` on them if they have related, non-M2M data.</span>
<span class="sd">        M2M data is handled by the ``ModelResource.save_m2m`` method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_related</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">readonly</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">blank</span> <span class="ow">and</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="c1"># Get the object.</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">related_obj</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">ObjectDoesNotExist</span><span class="p">:</span>
                <span class="c1"># Django 1.8: unset related objects default to None, no error</span>
                <span class="n">related_obj</span> <span class="o">=</span> <span class="bp">None</span>

            <span class="c1"># We didn&#39;t get it, so maybe we created it but haven&#39;t saved it</span>
            <span class="k">if</span> <span class="n">related_obj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">related_obj</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">related_objects_to_save</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">related_name</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bundle_detail_data</span><span class="p">(</span><span class="n">bundle</span><span class="p">):</span>
                    <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

                <span class="nb">setattr</span><span class="p">(</span><span class="n">related_obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">related_name</span><span class="p">,</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>

            <span class="n">related_resource</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">get_related_resource</span><span class="p">(</span><span class="n">related_obj</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_name</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">field_name</span><span class="p">],</span> <span class="s1">&#39;keys&#39;</span><span class="p">):</span>
                <span class="c1"># Only build &amp; save if there&#39;s data, not just a URI.</span>
                <span class="n">related_bundle</span> <span class="o">=</span> <span class="n">related_resource</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span>
                    <span class="n">obj</span><span class="o">=</span><span class="n">related_obj</span><span class="p">,</span>
                    <span class="n">data</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_name</span><span class="p">),</span>
                    <span class="n">request</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">,</span>
                    <span class="n">objects_saved</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">objects_saved</span>
                <span class="p">)</span>
                <span class="n">related_resource</span><span class="o">.</span><span class="n">full_hydrate</span><span class="p">(</span><span class="n">related_bundle</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">field_name</span> <span class="o">!=</span> <span class="s2">&quot;project&quot;</span><span class="p">:</span>
                    <span class="n">related_resource</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">related_bundle</span><span class="p">)</span>
                <span class="n">related_obj</span> <span class="o">=</span> <span class="n">related_bundle</span><span class="o">.</span><span class="n">obj</span>

            <span class="k">if</span> <span class="n">related_obj</span><span class="p">:</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="n">related_obj</span><span class="p">)</span>











    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">skip_errors</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">via_uri</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">bundle</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">errors</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">skip_errors</span><span class="p">:</span>

            <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">error_response</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="o">.</span><span class="n">errors</span><span class="p">))</span>

        <span class="c1"># Check if they&#39;re authorized.</span>
        <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">pk</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">authorized_update_detail</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">),</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">authorized_create_detail</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">),</span> <span class="n">bundle</span><span class="p">)</span>


        <span class="c1"># Save FKs just in case.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_related</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="k">print</span> <span class="s2">&quot;got&quot;</span>

        <span class="c1"># Save the main object.</span>
        <span class="n">obj_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_identifier</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">obj_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">bundle</span><span class="o">.</span><span class="n">objects_saved</span> <span class="ow">or</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_state</span><span class="o">.</span><span class="n">adding</span><span class="p">:</span>
            <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
            <span class="n">bundle</span><span class="o">.</span><span class="n">objects_saved</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">obj_id</span><span class="p">)</span>

        <span class="c1"># Now pick up the M2M bits.</span>
        <span class="n">m2m_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hydrate_m2m</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_m2m</span><span class="p">(</span><span class="n">m2m_bundle</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">bundle</span>

    <span class="k">def</span> <span class="nf">get_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a serialized list of resources.</span>
<span class="sd">        Calls ``obj_get_list`` to provide the data, then handles that result</span>
<span class="sd">        set and serializes it.</span>
<span class="sd">        Should return a HttpResponse (200 OK).</span>
<span class="sd">        Get a list of CBHCompoundbatches from elasticsearch by running a query</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">base_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
        <span class="n">pids</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pids&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">project_ids</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">pids</span><span class="p">:</span>

            <span class="n">project_ids</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">pid</span><span class="p">)</span> <span class="k">for</span> <span class="n">pid</span> <span class="ow">in</span> <span class="n">pids</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)]</span>
        
        <span class="n">allowed_pids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">project_ids</span><span class="p">(</span><span class="n">request</span><span class="p">))</span>
        
        <span class="k">for</span> <span class="n">requested_pid</span> <span class="ow">in</span> <span class="n">project_ids</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">requested_pid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_pids</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">(</span><span class="s2">&quot;No permissions for requested project&quot;</span><span class="p">)</span> 



        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">project_ids</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">project_ids</span> <span class="o">=</span> <span class="n">allowed_pids</span>

        <span class="n">queries</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">b64decode</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;encoded_query&quot;</span><span class="p">,</span> <span class="n">EMPTY_ARRAY_B64</span><span class="p">)))</span>

        <span class="n">extra_queries</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;extra_queries&quot;</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">extra_queries</span><span class="p">:</span>
            <span class="c1">#extra queries can be added via kwargs</span>
            <span class="n">queries</span> <span class="o">+=</span> <span class="n">extra_queries</span>

        <span class="c1">#Search for whether this item is archived or not (&quot;archived is indexed as a string&quot;)</span>
        <span class="n">archived</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;archived&quot;</span><span class="p">,</span> <span class="s2">&quot;false&quot;</span><span class="p">)</span>
        <span class="n">queries</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;query_type&quot;</span><span class="p">:</span> <span class="s2">&quot;phrase&quot;</span><span class="p">,</span> <span class="s2">&quot;field_path&quot;</span><span class="p">:</span> <span class="s2">&quot;properties.archived&quot;</span><span class="p">,</span> <span class="s2">&quot;phrase&quot;</span><span class="p">:</span> <span class="n">archived</span><span class="p">})</span>

       

        <span class="n">sorts</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">b64decode</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;encoded_sorts&quot;</span><span class="p">,</span> <span class="n">EMPTY_ARRAY_B64</span><span class="p">)))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sorts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">sorts</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;field_path&quot;</span><span class="p">:</span><span class="s2">&quot;id&quot;</span><span class="p">,</span><span class="s2">&quot;sort_direction&quot;</span><span class="p">:</span><span class="s2">&quot;desc&quot;</span><span class="p">}]</span>
        <span class="n">textsearch</span> <span class="o">=</span> <span class="n">b64decode</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;textsearch&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
        <span class="n">limit</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;limit&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;offset&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">autocomplete</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;autocomplete&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">autocomplete_field_path</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;autocomplete_field_path&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">autocomplete_size</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;autocomplete_size&quot;</span><span class="p">,</span> <span class="n">settings</span><span class="o">.</span><span class="n">MAX_AUTOCOMPLETE_SIZE</span><span class="p">)</span>

        <span class="n">pr</span> <span class="o">=</span> <span class="n">ChemregProjectResource</span><span class="p">()</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">get_list</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">do_cache</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">project_content</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">restricted_fieldnames</span> <span class="o">=</span> <span class="n">project_content</span><span class="p">[</span><span class="s2">&quot;user_restricted_fieldnames&quot;</span><span class="p">]</span>

        <span class="c1">#The project ids list needs to be reduced down</span>
        <span class="c1">#Because we dont support OR queries then every time you query a project for </span>
        <span class="c1">#a field then only the projects that have that field (and unrestricted) need to be shown</span>
        <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">queries</span><span class="p">:</span>
             <span class="n">project_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">check_if_field_restricted</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="s2">&quot;field_path&quot;</span><span class="p">],</span> <span class="n">project_ids</span><span class="p">,</span> <span class="n">restricted_fieldnames</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">autocomplete_field_path</span><span class="p">:</span>
            <span class="n">project_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">check_if_field_restricted</span><span class="p">(</span><span class="n">autocomplete_field_path</span><span class="p">,</span> <span class="n">project_ids</span><span class="p">,</span> <span class="n">restricted_fieldnames</span><span class="p">)</span>

        <span class="n">concatenated_indices</span> <span class="o">=</span> <span class="n">elasticsearch_client</span><span class="o">.</span><span class="n">get_list_of_indicies</span><span class="p">(</span><span class="n">project_ids</span><span class="p">)</span>

        <span class="n">chemical_search_id</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;chemical_search_id&quot;</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
        <span class="n">batch_ids_by_project</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="n">chemical_search_id</span><span class="p">:</span>
            <span class="n">batch_result</span> <span class="o">=</span> <span class="n">result</span><span class="p">(</span><span class="n">chemical_search_id</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="mi">20000</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">batch_result</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s1">&#39;{&quot;error&quot;: &quot;Unable to process structure search&quot;}&#39;</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="mi">503</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">print</span> <span class="n">batch_result</span>
                <span class="n">batch_ids_by_project</span> <span class="o">=</span> <span class="n">batch_result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;format&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;sdf&quot;</span> <span class="ow">and</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;format&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;xlsx&quot;</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">elasticsearch_client</span><span class="o">.</span><span class="n">get_list_data_elasticsearch</span><span class="p">(</span><span class="n">queries</span><span class="p">,</span>
                <span class="n">concatenated_indices</span><span class="p">,</span>
                <span class="n">sorts</span><span class="o">=</span><span class="n">sorts</span><span class="p">,</span> 
                <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">,</span> 
                <span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">,</span> 
                <span class="n">textsearch</span><span class="o">=</span><span class="n">textsearch</span><span class="p">,</span> 
                <span class="n">autocomplete</span><span class="o">=</span><span class="n">autocomplete</span><span class="p">,</span>
                <span class="n">autocomplete_field_path</span><span class="o">=</span><span class="n">autocomplete_field_path</span><span class="p">,</span>
                <span class="n">autocomplete_size</span><span class="o">=</span><span class="n">autocomplete_size</span><span class="p">,</span>
                <span class="n">batch_ids_by_project</span><span class="o">=</span><span class="n">batch_ids_by_project</span>
                 <span class="p">)</span>
            
            
            <span class="k">if</span> <span class="n">autocomplete_field_path</span><span class="p">:</span>
            
                <span class="n">bucks</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;aggregations&quot;</span><span class="p">][</span><span class="s2">&quot;filtered_field_path&quot;</span><span class="p">][</span><span class="s2">&quot;field_path_terms&quot;</span><span class="p">][</span><span class="s2">&quot;buckets&quot;</span><span class="p">]</span>

                <span class="n">bundledata</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;items&quot;</span> <span class="p">:</span> <span class="n">bucks</span><span class="p">,</span>
                            <span class="s2">&quot;autocomplete&quot;</span> <span class="p">:</span> <span class="n">autocomplete</span><span class="p">,</span>
                            <span class="s2">&quot;unique_count&quot;</span> <span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;aggregations&quot;</span><span class="p">][</span><span class="s2">&quot;filtered_field_path&quot;</span><span class="p">][</span><span class="s2">&quot;unique_count&quot;</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">]}</span>
        
            <span class="k">else</span><span class="p">:</span>

                <span class="n">bundledata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prepare_es_hits</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                <span class="n">bundledata</span><span class="p">[</span><span class="s2">&quot;objects&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">removed_restricted_fields_if_present</span><span class="p">(</span><span class="n">bundledata</span><span class="p">[</span><span class="s2">&quot;objects&quot;</span><span class="p">],</span> <span class="n">restricted_fieldnames</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1">#Limit , offset and autocomplete have no effect for a project export</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_project_specific_data</span><span class="p">(</span><span class="n">request</span><span class="p">,</span>  <span class="n">queries</span><span class="p">,</span> <span class="n">project_ids</span><span class="p">,</span> <span class="n">sorts</span><span class="p">,</span> <span class="n">textsearch</span><span class="p">,</span> <span class="n">batch_ids_by_project</span><span class="p">)</span>

            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span> 


        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundledata</span><span class="p">)</span> 

    <span class="k">def</span> <span class="nf">prepare_es_hits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hits</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;objects&quot;</span><span class="p">:</span> 
                            <span class="p">[</span><span class="n">hit</span><span class="p">[</span><span class="s2">&quot;_source&quot;</span><span class="p">][</span><span class="s2">&quot;dataset&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">hit</span> <span class="ow">in</span> <span class="n">hits</span><span class="p">[</span><span class="s2">&quot;hits&quot;</span><span class="p">][</span><span class="s2">&quot;hits&quot;</span><span class="p">]],</span>
                            <span class="s2">&quot;meta&quot;</span> <span class="p">:</span> <span class="p">{</span><span class="s2">&quot;total_count&quot;</span> <span class="p">:</span> <span class="n">hits</span><span class="p">[</span><span class="s2">&quot;hits&quot;</span><span class="p">][</span><span class="s2">&quot;total&quot;</span><span class="p">]}</span>
                            <span class="p">}</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">authorization</span> <span class="o">=</span> <span class="n">ProjectAuthorization</span><span class="p">()</span>
        <span class="n">queryset</span> <span class="o">=</span> <span class="n">CBHCompoundBatch</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        
        <span class="n">include_resource_uri</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">serializer</span> <span class="o">=</span> <span class="n">CBHCompoundBatchSerializer</span><span class="p">()</span>
        <span class="n">always_return_data</span> <span class="o">=</span> <span class="bp">True</span>







<span class="k">class</span> <span class="nc">CBHCompoundBatchResource</span><span class="p">(</span><span class="n">BaseCBHCompoundBatchResource</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Implementation of the compound batch API used for inventory and compound batch objects</span>
<span class="sd">    fiter out saved searches from this list&quot;&quot;&quot;</span>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">(</span><span class="n">BaseCBHCompoundBatchResource</span><span class="o">.</span><span class="n">Meta</span><span class="p">):</span>
        <span class="n">resource_name</span> <span class="o">=</span> <span class="s1">&#39;cbh_compound_batches_v2&#39;</span>


    
    <span class="k">def</span> <span class="nf">get_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Request data where the project is not of the saved search type&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">CBHCompoundBatchResource</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_list</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">extra_queries</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;query_type&quot;</span><span class="p">:</span> <span class="s2">&quot;pick_from_list&quot;</span><span class="p">,</span> <span class="s2">&quot;field_path&quot;</span> <span class="p">:</span> <span class="s2">&quot;projectfull.project_type.saved_search_project_type&quot;</span><span class="p">,</span> <span class="s2">&quot;pick_from_list&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;false&quot;</span><span class="p">]</span> <span class="p">}])</span>



<span class="k">class</span> <span class="nc">CBHSavedSearchResource</span><span class="p">(</span><span class="n">BaseCBHCompoundBatchResource</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Implementation of the compound batch API used for saved search objects,</span>
<span class="sd">    filter out non saved searches form this list&quot;&quot;&quot;</span>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">(</span><span class="n">BaseCBHCompoundBatchResource</span><span class="o">.</span><span class="n">Meta</span><span class="p">):</span>
        <span class="n">resource_name</span> <span class="o">=</span> <span class="s1">&#39;cbh_saved_search&#39;</span>


    <span class="k">def</span> <span class="nf">get_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Request data where the project is of the saved search type&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">CBHSavedSearchResource</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_list</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">extra_queries</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;query_type&quot;</span><span class="p">:</span> <span class="s2">&quot;pick_from_list&quot;</span><span class="p">,</span> <span class="s2">&quot;field_path&quot;</span> <span class="p">:</span> <span class="s2">&quot;projectfull.project_type.saved_search_project_type&quot;</span><span class="p">,</span> <span class="s2">&quot;pick_from_list&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;true&quot;</span><span class="p">]</span> <span class="p">}])</span>




<span class="k">class</span> <span class="nc">IndexingCBHCompoundBatchResource</span><span class="p">(</span><span class="n">BaseCBHCompoundBatchResource</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Implementation of the BaseCBHCompoundBatchResource used to generate JSON objects to be</span>
<span class="sd">    indexed in elasticsearch&quot;&quot;&quot;</span>
    <span class="n">project</span> <span class="o">=</span> <span class="n">SimpleResourceURIField</span><span class="p">(</span><span class="n">ChemregProjectResource</span><span class="p">,</span> <span class="s2">&quot;project_id&quot;</span><span class="p">)</span>
    <span class="n">projectfull</span> <span class="o">=</span> <span class="n">SimpleResourceURIField</span><span class="p">(</span><span class="n">ChemregProjectResource</span><span class="p">,</span> <span class="s2">&quot;project_id&quot;</span><span class="p">)</span>
    <span class="n">userfull</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">DictField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="p">{})</span>

    <span class="k">def</span> <span class="nf">prepare_fields_for_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch_dicts</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Fields are stored as strings in hstore so convert the list or object fields back from JSON&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">bd</span> <span class="ow">in</span> <span class="n">batch_dicts</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">bd</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;related_molregno&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">):</span>
                <span class="n">bd</span><span class="p">[</span><span class="s2">&quot;related_molregno&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;compoundproperties&quot;</span> <span class="p">:</span> <span class="p">{}}</span>
            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">bd</span><span class="p">[</span><span class="s2">&quot;projectfull&quot;</span><span class="p">][</span><span class="s2">&quot;custom_field_config&quot;</span><span class="p">][</span><span class="s2">&quot;project_data_fields&quot;</span><span class="p">]:</span>
                
                <span class="k">if</span> <span class="n">field</span><span class="p">[</span><span class="s2">&quot;edit_schema&quot;</span><span class="p">][</span><span class="s2">&quot;properties&quot;</span><span class="p">][</span><span class="n">field</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]][</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;object&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">bd</span><span class="p">[</span><span class="s2">&quot;custom_fields&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="bp">False</span><span class="p">):</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">bd</span><span class="p">[</span><span class="s2">&quot;custom_fields&quot;</span><span class="p">][</span><span class="n">field</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">bd</span><span class="p">[</span><span class="s2">&quot;custom_fields&quot;</span><span class="p">][</span><span class="n">field</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]])</span>
                            <span class="k">continue</span>
                        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                            <span class="k">pass</span>
                    <span class="n">bd</span><span class="p">[</span><span class="s2">&quot;custom_fields&quot;</span><span class="p">][</span><span class="n">field</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">[</span><span class="s2">&quot;edit_schema&quot;</span><span class="p">][</span><span class="s2">&quot;properties&quot;</span><span class="p">][</span><span class="n">field</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]][</span><span class="s2">&quot;default&quot;</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">field</span><span class="p">[</span><span class="s2">&quot;edit_schema&quot;</span><span class="p">][</span><span class="s2">&quot;properties&quot;</span><span class="p">][</span><span class="n">field</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]][</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;array&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">bd</span><span class="p">[</span><span class="s2">&quot;custom_fields&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="bp">False</span><span class="p">):</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">bd</span><span class="p">[</span><span class="s2">&quot;custom_fields&quot;</span><span class="p">][</span><span class="n">field</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">bd</span><span class="p">[</span><span class="s2">&quot;custom_fields&quot;</span><span class="p">][</span><span class="n">field</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]])</span>
                            <span class="k">continue</span>
                        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                            <span class="k">pass</span>
                    <span class="n">bd</span><span class="p">[</span><span class="s2">&quot;custom_fields&quot;</span><span class="p">][</span><span class="n">field</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">elif</span> <span class="ow">not</span> <span class="n">bd</span><span class="p">[</span><span class="s2">&quot;custom_fields&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="bp">False</span><span class="p">):</span>
                    <span class="c1">#Clean up existing fields to a blank string</span>
                    <span class="n">bd</span><span class="p">[</span><span class="s2">&quot;custom_fields&quot;</span><span class="p">][</span><span class="n">field</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">[</span><span class="s2">&quot;edit_schema&quot;</span><span class="p">][</span><span class="s2">&quot;properties&quot;</span><span class="p">][</span><span class="n">field</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">batch_dicts</span>


    <span class="k">def</span> <span class="nf">index_batch_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">batch_list</span><span class="p">,</span> <span class="n">project_and_indexing_schemata</span><span class="p">,</span> <span class="n">refresh</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Index a list or queryset of compound batches into the elasticsearch indices (one index per project)&quot;&quot;&quot;</span>
        
        <span class="n">request</span><span class="o">.</span><span class="n">GET</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="p">[</span><span class="s2">&quot;limit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;10000&quot;</span>
        <span class="n">ids</span> <span class="o">=</span> <span class="p">{</span><span class="n">b</span><span class="o">.</span><span class="n">created_by_id</span>  <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">batch_list</span><span class="p">}</span>
        <span class="n">no_none</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">uid</span> <span class="ow">in</span> <span class="n">ids</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">uid</span><span class="p">:</span>
                <span class="n">no_none</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">uid</span><span class="p">))</span>
        <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="p">[</span><span class="s2">&quot;id__in&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">no_none</span><span class="p">)</span>
        <span class="n">user_list</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">UserResource</span><span class="p">()</span><span class="o">.</span><span class="n">get_list</span><span class="p">(</span><span class="n">request</span><span class="p">)</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">user_lookup</span> <span class="o">=</span> <span class="p">{</span> <span class="n">u</span><span class="p">[</span><span class="s2">&quot;resource_uri&quot;</span><span class="p">]:</span> <span class="n">u</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">user_list</span><span class="p">[</span><span class="s2">&quot;objects&quot;</span><span class="p">]</span> <span class="p">}</span>
        <span class="n">bundles</span> <span class="o">=</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">),</span> <span class="n">for_list</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">batch_list</span>
        <span class="p">]</span>

        <span class="c1">#retrieve schemas which tell the elasticsearch request which fields to index for each object (we avoid deserializing a single custom field config more than once)</span>
        <span class="c1">#Now make the schema list parallel to the batches list</span>
        <span class="n">batch_dicts</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Meta</span><span class="o">.</span><span class="n">serializer</span><span class="o">.</span><span class="n">to_simple</span><span class="p">(</span><span class="n">bun</span><span class="p">,</span> <span class="p">{})</span> <span class="k">for</span> <span class="n">bun</span> <span class="ow">in</span> <span class="n">bundles</span><span class="p">]</span>
        <span class="n">batch_dicts</span><span class="p">,</span> <span class="n">indexing_schemata</span> <span class="o">=</span> <span class="n">add_cached_projects_to_batch_list</span><span class="p">(</span><span class="n">batch_dicts</span><span class="p">,</span> <span class="n">project_and_indexing_schemata</span><span class="p">)</span>
        <span class="n">batch_dicts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prepare_fields_for_index</span><span class="p">(</span><span class="n">batch_dicts</span><span class="p">)</span>

        <span class="n">project_data_field_sets</span> <span class="o">=</span> <span class="p">[</span><span class="n">batch_dict</span><span class="p">[</span><span class="s2">&quot;projectfull&quot;</span><span class="p">][</span><span class="s2">&quot;custom_field_config&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;project_data_fields&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">batch_dict</span> <span class="ow">in</span> <span class="n">batch_dicts</span><span class="p">]</span>
        <span class="n">tab_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">batch_dict</span><span class="p">[</span><span class="s2">&quot;projectfull&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;tabular_data_schema&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">batch_dict</span> <span class="ow">in</span> <span class="n">batch_dicts</span><span class="p">]</span>

        <span class="n">index_names</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">batch_dicts</span><span class="p">:</span>
            <span class="n">batch</span><span class="p">[</span><span class="s2">&quot;projectfull&quot;</span><span class="p">][</span><span class="s2">&quot;custom_field_config&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="s2">&quot;projectfull&quot;</span><span class="p">][</span><span class="s2">&quot;custom_field_config&quot;</span><span class="p">][</span><span class="s2">&quot;resource_uri&quot;</span><span class="p">]</span>
            <span class="n">index_name</span> <span class="o">=</span> <span class="n">elasticsearch_client</span><span class="o">.</span><span class="n">get_project_index_name</span><span class="p">(</span><span class="n">batch</span><span class="p">[</span><span class="s2">&quot;projectfull&quot;</span><span class="p">][</span><span class="s2">&quot;id&quot;</span><span class="p">])</span>
            <span class="n">index_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">index_name</span><span class="p">)</span>
            <span class="n">batch</span><span class="p">[</span><span class="s2">&quot;userfull&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">user_lookup</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">batch</span><span class="p">[</span><span class="s2">&quot;creator&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s2">&quot;display_name&quot;</span> <span class="p">:</span> <span class="s2">&quot;User Deleted&quot;</span><span class="p">})</span>
        
        <span class="n">batch_dicts</span> <span class="o">=</span> <span class="n">elasticsearch_client</span><span class="o">.</span><span class="n">index_dataset</span><span class="p">(</span><span class="n">batch_dicts</span><span class="p">,</span> <span class="n">indexing_schemata</span><span class="p">,</span> <span class="n">index_names</span><span class="p">,</span> <span class="n">refresh</span><span class="o">=</span><span class="n">refresh</span><span class="p">)</span>
            

    <span class="k">def</span> <span class="nf">reindex_elasticsearch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reindex all of the data into elasticsearch&quot;&quot;&quot;</span>
        <span class="n">desired_format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">determine_format</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
        <span class="n">projects</span> <span class="o">=</span> <span class="n">Project</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">values_list</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">flat</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">pid</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">projects</span><span class="p">):</span>
            <span class="n">batches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">request</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">project_id</span><span class="o">=</span><span class="n">pid</span><span class="p">)</span>
            <span class="c1"># we only want to store certain fields in the search index</span>
            <span class="kn">from</span> <span class="nn">django.core.paginator</span> <span class="kn">import</span> <span class="n">Paginator</span>
            <span class="n">paginator</span> <span class="o">=</span> <span class="n">Paginator</span><span class="p">(</span><span class="n">batches</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span> <span class="c1"># chunks of 1000</span>
            <span class="c1">#Get all schemata for all projects </span>
            <span class="n">indexing_schemata</span> <span class="o">=</span> <span class="n">get_indexing_schemata</span><span class="p">([</span><span class="n">pid</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">paginator</span><span class="o">.</span><span class="n">num_pages</span> <span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        
                <span class="n">result_list</span> <span class="o">=</span> <span class="n">index_batches_in_new_index</span><span class="p">(</span><span class="n">paginator</span><span class="o">.</span><span class="n">page</span><span class="p">(</span><span class="n">page</span><span class="p">)</span><span class="o">.</span><span class="n">object_list</span><span class="p">,</span> <span class="n">project_and_indexing_schemata</span><span class="o">=</span><span class="n">indexing_schemata</span><span class="p">)</span>
                <span class="k">print</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> of </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">page</span><span class="p">,</span> <span class="n">paginator</span><span class="o">.</span><span class="n">num_pages</span><span class="p">)</span>
            <span class="k">print</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> projects of </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">projects</span><span class="p">))</span> 
        <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="p">)</span>
        
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">(</span><span class="n">BaseCBHCompoundBatchResource</span><span class="o">.</span><span class="n">Meta</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="k">def</span> <span class="nf">add_cached_projects_to_batch_list</span><span class="p">(</span><span class="n">batch_dicts</span><span class="p">,</span> <span class="n">project_and_indexing_schemata</span><span class="p">):</span>
    <span class="n">schemata_for_indexing</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">batch_dict</span> <span class="ow">in</span> <span class="n">batch_dicts</span><span class="p">:</span>
        <span class="n">projdata</span> <span class="o">=</span> <span class="n">project_and_indexing_schemata</span><span class="p">[</span><span class="n">batch_dict</span><span class="p">[</span><span class="s2">&quot;project&quot;</span><span class="p">]]</span>
       
        <span class="n">schemata_for_indexing</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">projdata</span><span class="p">[</span><span class="s2">&quot;tabular_data_schema&quot;</span><span class="p">][</span><span class="s2">&quot;for_indexing&quot;</span><span class="p">])</span>
        <span class="n">batch_dict</span><span class="p">[</span><span class="s2">&quot;projectfull&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">projdata</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">batch_dicts</span><span class="p">,</span> <span class="n">schemata_for_indexing</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">get_schemata</span><span class="p">(</span><span class="n">project_ids</span><span class="p">,</span> <span class="n">fieldlist_name</span><span class="o">=</span><span class="s2">&quot;indexing&quot;</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">project_ids</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">project_ids</span> <span class="o">=</span> <span class="n">get_model</span><span class="p">(</span><span class="s2">&quot;cbh_core_model&quot;</span><span class="p">,</span><span class="s2">&quot;Project&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">()</span><span class="o">.</span><span class="n">values_list</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">flat</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">crp</span> <span class="o">=</span> <span class="n">ChemregProjectResource</span><span class="p">()</span>
    <span class="n">request_factory</span> <span class="o">=</span> <span class="n">RequestFactory</span><span class="p">()</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">get_user_model</span><span class="p">()</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">is_superuser</span><span class="o">=</span><span class="bp">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    
 
    <span class="k">for</span> <span class="n">pid</span> <span class="ow">in</span> <span class="n">project_ids</span><span class="p">:</span>
        <span class="n">req</span> <span class="o">=</span> <span class="n">request_factory</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">request</span><span class="p">:</span>

            <span class="c1">#Ensures that the restricted fields are obeyed if downloading data</span>
            <span class="c1">#Note that we cannot use the request raw because it will try to export XLSX because</span>
            <span class="c1">#of the way that tastypie works</span>
            <span class="n">req</span><span class="o">.</span><span class="n">user</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1">#If this request is coming from the reindex_all_compounds request then we need to</span>
            <span class="c1">#Ensure that a superuser is aganst the request so we have access to all fields</span>
            <span class="n">req</span><span class="o">.</span><span class="n">user</span> <span class="o">=</span> <span class="n">user</span>
        <span class="n">req</span><span class="o">.</span><span class="n">GET</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">req</span><span class="o">.</span><span class="n">GET</span><span class="p">[</span><span class="s2">&quot;tabular_data_schema&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">crp</span><span class="o">.</span><span class="n">get_detail</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">pk</span><span class="o">=</span><span class="n">pid</span><span class="p">)</span>

        <span class="n">projdata</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">projdata</span><span class="p">[</span><span class="s2">&quot;tabular_data_schema&quot;</span><span class="p">][</span><span class="s2">&quot;for_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">fieldlist_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span> <span class="n">projdata</span><span class="p">[</span><span class="s2">&quot;tabular_data_schema&quot;</span><span class="p">][</span><span class="s2">&quot;schema&quot;</span><span class="p">][</span><span class="n">field</span><span class="p">]</span> 
                                  <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">projdata</span><span class="p">[</span><span class="s2">&quot;tabular_data_schema&quot;</span><span class="p">][</span><span class="s2">&quot;included_in_tables&quot;</span><span class="p">][</span><span class="n">fieldlist_name</span><span class="p">][</span><span class="s2">&quot;default&quot;</span><span class="p">]]</span>
        <span class="k">yield</span> <span class="n">projdata</span>


<span class="k">def</span> <span class="nf">get_indexing_schemata</span><span class="p">(</span><span class="n">project_ids</span><span class="p">,</span> <span class="n">fieldlist_name</span><span class="o">=</span><span class="s2">&quot;indexing&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a cached version of the project schemata in the right format </span>
<span class="sd">    for elasticsearch indexing or for retrieving the Excel backup of the data&quot;&quot;&quot;</span>

    <span class="n">proj_datasets</span> <span class="o">=</span> <span class="n">get_schemata</span><span class="p">(</span><span class="n">project_ids</span><span class="p">,</span> <span class="n">fieldlist_name</span><span class="o">=</span><span class="s2">&quot;indexing&quot;</span><span class="p">)</span>
        <span class="c1">#Do the dict lookups now to avoid multiple times later</span>
    <span class="n">projdatadict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">projdata</span> <span class="ow">in</span> <span class="n">proj_datasets</span><span class="p">:</span>
        <span class="n">projdatadict</span><span class="p">[</span><span class="n">projdata</span><span class="p">[</span><span class="s2">&quot;resource_uri&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">projdata</span>

    <span class="k">return</span> <span class="n">projdatadict</span>

        


<span class="k">def</span> <span class="nf">index_batches_in_new_index</span><span class="p">(</span><span class="n">batches</span><span class="p">,</span> <span class="n">project_and_indexing_schemata</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;function to index all the data, creating a HTTPRequest programatically&quot;&quot;&quot;</span>
    <span class="n">request</span> <span class="o">=</span> <span class="n">HttpRequest</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">project_and_indexing_schemata</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">project_and_indexing_schemata</span> <span class="o">=</span> <span class="n">get_indexing_schemata</span><span class="p">({</span> <span class="n">batch</span><span class="o">.</span><span class="n">project_id</span>  <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">batches</span> <span class="p">})</span>
        <span class="c1">#This should be none for cases apart from the bulk index operation</span>
        <span class="c1">#Therefore we can run the structure indexing at this point too.</span>
        <span class="n">index_new_compounds</span><span class="p">()</span>
    <span class="n">IndexingCBHCompoundBatchResource</span><span class="p">()</span><span class="o">.</span><span class="n">index_batch_list</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">batches</span><span class="p">,</span> <span class="n">project_and_indexing_schemata</span><span class="p">)</span>




<span class="c1">##Multiple batch creation</span>


<span class="k">class</span> <span class="nc">CBHMultipleBatchUploadResource</span><span class="p">(</span><span class="n">ModelResource</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>

  </div>

  </header>

  <section id="section-items">
    <h2 class="section-title" id="header-variables">Module variables</h2>
      <div class="item">
      <p id="cbh_chem_api.resources.ALL" class="name">var <span class="ident">ALL</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="cbh_chem_api.resources.ALL_WITH_RELATIONS" class="name">var <span class="ident">ALL_WITH_RELATIONS</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="cbh_chem_api.resources.EMPTY_ARRAY_B64" class="name">var <span class="ident">EMPTY_ARRAY_B64</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="cbh_chem_api.resources.handler400" class="name">var <span class="ident">handler400</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="cbh_chem_api.resources.handler403" class="name">var <span class="ident">handler403</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="cbh_chem_api.resources.handler404" class="name">var <span class="ident">handler404</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="cbh_chem_api.resources.handler500" class="name">var <span class="ident">handler500</span></p>
      
  
  <div class="source_cont">
</div>

      </div>

    <h2 class="section-title" id="header-functions">Functions</h2>
      
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.add_cached_projects_to_batch_list">
    <p>def <span class="ident">add_cached_projects_to_batch_list</span>(</p><p>batch_dicts, project_and_indexing_schemata)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.add_cached_projects_to_batch_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.add_cached_projects_to_batch_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">add_cached_projects_to_batch_list</span><span class="p">(</span><span class="n">batch_dicts</span><span class="p">,</span> <span class="n">project_and_indexing_schemata</span><span class="p">):</span>
    <span class="n">schemata_for_indexing</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">batch_dict</span> <span class="ow">in</span> <span class="n">batch_dicts</span><span class="p">:</span>
        <span class="n">projdata</span> <span class="o">=</span> <span class="n">project_and_indexing_schemata</span><span class="p">[</span><span class="n">batch_dict</span><span class="p">[</span><span class="s2">&quot;project&quot;</span><span class="p">]]</span>
       
        <span class="n">schemata_for_indexing</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">projdata</span><span class="p">[</span><span class="s2">&quot;tabular_data_schema&quot;</span><span class="p">][</span><span class="s2">&quot;for_indexing&quot;</span><span class="p">])</span>
        <span class="n">batch_dict</span><span class="p">[</span><span class="s2">&quot;projectfull&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">projdata</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">batch_dicts</span><span class="p">,</span> <span class="n">schemata_for_indexing</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.chunks">
    <p>def <span class="ident">chunks</span>(</p><p>l, n)</p>
    </div>
    

    
  
    <div class="desc"><p>Yield successive n-sized chunks from l.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.chunks', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.chunks" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">chunks</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Yield successive n-sized chunks from l.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="n">n</span><span class="p">):</span>
        <span class="k">yield</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">n</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.get_indexing_schemata">
    <p>def <span class="ident">get_indexing_schemata</span>(</p><p>project_ids, fieldlist_name=&#39;indexing&#39;)</p>
    </div>
    

    
  
    <div class="desc"><p>Get a cached version of the project schemata in the right format 
for elasticsearch indexing or for retrieving the Excel backup of the data</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.get_indexing_schemata', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.get_indexing_schemata" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_indexing_schemata</span><span class="p">(</span><span class="n">project_ids</span><span class="p">,</span> <span class="n">fieldlist_name</span><span class="o">=</span><span class="s2">&quot;indexing&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a cached version of the project schemata in the right format </span>
<span class="sd">    for elasticsearch indexing or for retrieving the Excel backup of the data&quot;&quot;&quot;</span>

    <span class="n">proj_datasets</span> <span class="o">=</span> <span class="n">get_schemata</span><span class="p">(</span><span class="n">project_ids</span><span class="p">,</span> <span class="n">fieldlist_name</span><span class="o">=</span><span class="s2">&quot;indexing&quot;</span><span class="p">)</span>
        <span class="c1">#Do the dict lookups now to avoid multiple times later</span>
    <span class="n">projdatadict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">projdata</span> <span class="ow">in</span> <span class="n">proj_datasets</span><span class="p">:</span>
        <span class="n">projdatadict</span><span class="p">[</span><span class="n">projdata</span><span class="p">[</span><span class="s2">&quot;resource_uri&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">projdata</span>

    <span class="k">return</span> <span class="n">projdatadict</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.get_schemata">
    <p>def <span class="ident">get_schemata</span>(</p><p>project_ids, fieldlist_name=&#39;indexing&#39;, request=None)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.get_schemata', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.get_schemata" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_schemata</span><span class="p">(</span><span class="n">project_ids</span><span class="p">,</span> <span class="n">fieldlist_name</span><span class="o">=</span><span class="s2">&quot;indexing&quot;</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">project_ids</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">project_ids</span> <span class="o">=</span> <span class="n">get_model</span><span class="p">(</span><span class="s2">&quot;cbh_core_model&quot;</span><span class="p">,</span><span class="s2">&quot;Project&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">()</span><span class="o">.</span><span class="n">values_list</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">flat</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">crp</span> <span class="o">=</span> <span class="n">ChemregProjectResource</span><span class="p">()</span>
    <span class="n">request_factory</span> <span class="o">=</span> <span class="n">RequestFactory</span><span class="p">()</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">get_user_model</span><span class="p">()</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">is_superuser</span><span class="o">=</span><span class="bp">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    
 
    <span class="k">for</span> <span class="n">pid</span> <span class="ow">in</span> <span class="n">project_ids</span><span class="p">:</span>
        <span class="n">req</span> <span class="o">=</span> <span class="n">request_factory</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">request</span><span class="p">:</span>

            <span class="c1">#Ensures that the restricted fields are obeyed if downloading data</span>
            <span class="c1">#Note that we cannot use the request raw because it will try to export XLSX because</span>
            <span class="c1">#of the way that tastypie works</span>
            <span class="n">req</span><span class="o">.</span><span class="n">user</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1">#If this request is coming from the reindex_all_compounds request then we need to</span>
            <span class="c1">#Ensure that a superuser is aganst the request so we have access to all fields</span>
            <span class="n">req</span><span class="o">.</span><span class="n">user</span> <span class="o">=</span> <span class="n">user</span>
        <span class="n">req</span><span class="o">.</span><span class="n">GET</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">req</span><span class="o">.</span><span class="n">GET</span><span class="p">[</span><span class="s2">&quot;tabular_data_schema&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">crp</span><span class="o">.</span><span class="n">get_detail</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">pk</span><span class="o">=</span><span class="n">pid</span><span class="p">)</span>

        <span class="n">projdata</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">projdata</span><span class="p">[</span><span class="s2">&quot;tabular_data_schema&quot;</span><span class="p">][</span><span class="s2">&quot;for_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">fieldlist_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span> <span class="n">projdata</span><span class="p">[</span><span class="s2">&quot;tabular_data_schema&quot;</span><span class="p">][</span><span class="s2">&quot;schema&quot;</span><span class="p">][</span><span class="n">field</span><span class="p">]</span> 
                                  <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">projdata</span><span class="p">[</span><span class="s2">&quot;tabular_data_schema&quot;</span><span class="p">][</span><span class="s2">&quot;included_in_tables&quot;</span><span class="p">][</span><span class="n">fieldlist_name</span><span class="p">][</span><span class="s2">&quot;default&quot;</span><span class="p">]]</span>
        <span class="k">yield</span> <span class="n">projdata</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.index_batches_in_new_index">
    <p>def <span class="ident">index_batches_in_new_index</span>(</p><p>batches, project_and_indexing_schemata=None)</p>
    </div>
    

    
  
    <div class="desc"><p>function to index all the data, creating a HTTPRequest programatically</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.index_batches_in_new_index', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.index_batches_in_new_index" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">index_batches_in_new_index</span><span class="p">(</span><span class="n">batches</span><span class="p">,</span> <span class="n">project_and_indexing_schemata</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;function to index all the data, creating a HTTPRequest programatically&quot;&quot;&quot;</span>
    <span class="n">request</span> <span class="o">=</span> <span class="n">HttpRequest</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">project_and_indexing_schemata</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">project_and_indexing_schemata</span> <span class="o">=</span> <span class="n">get_indexing_schemata</span><span class="p">({</span> <span class="n">batch</span><span class="o">.</span><span class="n">project_id</span>  <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">batches</span> <span class="p">})</span>
        <span class="c1">#This should be none for cases apart from the bulk index operation</span>
        <span class="c1">#Therefore we can run the structure indexing at this point too.</span>
        <span class="n">index_new_compounds</span><span class="p">()</span>
    <span class="n">IndexingCBHCompoundBatchResource</span><span class="p">()</span><span class="o">.</span><span class="n">index_batch_list</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">batches</span><span class="p">,</span> <span class="n">project_and_indexing_schemata</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  

    <h2 class="section-title" id="header-classes">Classes</h2>
      
      <div class="item">
      <p id="cbh_chem_api.resources.BaseCBHCompoundBatchResource" class="name">class <span class="ident">BaseCBHCompoundBatchResource</span></p>
      
  
    <div class="desc"><p>New base resource for a compound batch, abstract implementation used
in the indexing of compound batches as well as in the search API and the saved searches
ModelResource - these fields are in addition to the fields already present in the CBHCompoundBatch model</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">BaseCBHCompoundBatchResource</span><span class="p">(</span><span class="n">ModelResource</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;New base resource for a compound batch, abstract implementation used</span>
<span class="sd">    in the indexing of compound batches as well as in the search API and the saved searches</span>
<span class="sd">    ModelResource - these fields are in addition to the fields already present in the CBHCompoundBatch model&quot;&quot;&quot;</span>
    <span class="n">uuid</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">timestamp</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">project</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span>
        <span class="n">ChemregProjectResource</span><span class="p">,</span> <span class="s1">&#39;project&#39;</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">creator</span> <span class="o">=</span> <span class="n">SimpleResourceURIField</span><span class="p">(</span><span class="n">UserResource</span><span class="p">,</span> <span class="s1">&#39;created_by_id&#39;</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">readonly</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">projectfull</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span>
         <span class="n">ChemregProjectResource</span><span class="p">,</span> <span class="s1">&#39;project&#39;</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">readonly</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">related_molregno</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">MoleculeDictionaryResource</span><span class="p">,</span> <span class="s1">&#39;related_molregno&#39;</span><span class="p">,</span>  <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">readonly</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">uncurated_fields</span> <span class="o">=</span> <span class="n">CBHNoSerializedDictField</span><span class="p">(</span><span class="s1">&#39;uncurated_fields&#39;</span><span class="p">)</span>
    <span class="n">warnings</span> <span class="o">=</span> <span class="n">CBHNoSerializedDictField</span><span class="p">(</span><span class="s1">&#39;warnings&#39;</span><span class="p">)</span>
    <span class="n">properties</span> <span class="o">=</span> <span class="n">CBHNoSerializedDictField</span><span class="p">(</span><span class="s1">&#39;properties&#39;</span><span class="p">)</span>
    <span class="n">custom_fields</span> <span class="o">=</span> <span class="n">CBHNoSerializedDictField</span><span class="p">(</span><span class="s1">&#39;custom_fields&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">dehydrate_timestamp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Provide a viewer-friendly timestamp&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">created</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">dehydrate_uuid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This is either a blinded batch uuid or a uuid for the compound structure based on the INCHI key&quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">related_molregno</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">related_molregno</span><span class="o">.</span><span class="n">chembl</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">related_molregno</span><span class="o">.</span><span class="n">chembl</span><span class="o">.</span><span class="n">chembl_id</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">related_molregno</span><span class="o">.</span><span class="n">chembl</span><span class="o">.</span><span class="n">chembl_id</span>
        <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">blinded_batch_id</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">blinded_batch_id</span>

    <span class="k">def</span> <span class="nf">create_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">HttpResponse</span><span class="p">,</span> <span class="o">**</span><span class="n">response_kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Ensure that data is returned in the right format as an attachment if returning SDF or XLSX data</span>
<span class="sd">        Should an object have been created or updated, now is the time to</span>
<span class="sd">        reindex it in the elasticsearch index</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">desired_format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">determine_format</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">response_class</span> <span class="o">==</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpCreated</span> <span class="ow">or</span> <span class="n">response_class</span> <span class="o">==</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpAccepted</span><span class="p">:</span>
            <span class="n">batches</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;objects&quot;</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;objects&quot;</span><span class="p">):</span>
                    <span class="n">batches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">batches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
            <span class="n">index_batches_in_new_index</span><span class="p">(</span><span class="n">batches</span><span class="p">)</span>

        <span class="n">serialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">desired_format</span><span class="p">)</span>
        <span class="n">rc</span> <span class="o">=</span> <span class="n">response_class</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">serialized</span><span class="p">,</span> <span class="n">content_type</span><span class="o">=</span><span class="n">build_content_type</span><span class="p">(</span>
            <span class="n">desired_format</span><span class="p">),</span> <span class="o">**</span><span class="n">response_kwargs</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="n">desired_format</span> <span class="o">==</span> <span class="s1">&#39;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&#39;</span><span class="p">):</span>
            <span class="n">rc</span><span class="p">[</span><span class="s1">&#39;Content-Disposition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;attachment; filename=export_from_chembiohub_chemreg</span><span class="si">%d</span><span class="s1">.xlsx&#39;</span> <span class="o">%</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">desired_format</span> <span class="o">==</span> <span class="s1">&#39;chemical/x-mdl-sdfile&#39;</span><span class="p">):</span>
            <span class="n">rc</span><span class="p">[</span><span class="s1">&#39;Content-Disposition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;attachment; filename=export_from_chembiohub_chemreg</span><span class="si">%d</span><span class="s1">.sdf&#39;</span> <span class="o">%</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">rc</span>


    <span class="k">def</span> <span class="nf">hydrate_blinded_batch_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Hydrate functions are run before save of a new or updated model instance</span>
<span class="sd">        This one ensures that the blinded batch id is filled in in cases where an inventory item </span>
<span class="sd">        with no ModelculeDictionary attribute (related_molregno)&quot;&quot;&quot;</span> 
        <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;blinded_batch_id&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">u&quot;EMPTY_ID&quot;</span><span class="p">:</span>
            <span class="n">uox_id</span> <span class="o">=</span> <span class="n">generate_uox_id</span><span class="p">()</span>
            <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;blinded_batch_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">uox_id</span>
            <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">blinded_batch_id</span> <span class="o">=</span> <span class="n">uox_id</span>
        <span class="k">return</span> <span class="n">bundle</span>


    <span class="k">def</span> <span class="nf">dehydrate_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Ensure that the archived property is always presented in a consistent way&quot;&quot;&quot;</span>
        <span class="n">archived</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;archived&quot;</span><span class="p">,</span> <span class="s2">&quot;false&quot;</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">properties</span>
        <span class="n">value</span><span class="p">[</span><span class="s2">&quot;archived&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">archived</span>
        <span class="k">return</span> <span class="n">value</span>


    <span class="k">def</span> <span class="nf">hydrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">created_by_id</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span>
        <span class="k">return</span> <span class="n">bundle</span>


    <span class="k">def</span> <span class="nf">get_project_specific_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">queries</span><span class="p">,</span> <span class="n">pids</span><span class="p">,</span> <span class="n">sorts</span><span class="p">,</span> <span class="n">textsearch</span><span class="p">,</span> <span class="n">batch_ids_by_project</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;When an Excel or SDF download is requested, </span>
<span class="sd">        present the data as a</span>
<span class="sd">        project by project summary so that </span>
<span class="sd">        one spreadsheet can be used per project&quot;&quot;&quot;</span>
        <span class="n">to_return</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">pids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pids</span><span class="p">)</span>
        <span class="n">table_schemata</span> <span class="o">=</span> <span class="n">get_schemata</span><span class="p">(</span><span class="n">pids</span><span class="p">,</span> <span class="s2">&quot;export&quot;</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
        <span class="c1">#We have removed the schema from the index for data efficiency so</span>
        <span class="c1">#We need to pull it out of the project resource</span>
            
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">proj_data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">table_schemata</span><span class="p">):</span>
            <span class="n">table_schema_for_project</span> <span class="o">=</span> <span class="n">proj_data</span><span class="p">[</span><span class="s2">&quot;tabular_data_schema&quot;</span><span class="p">][</span><span class="s2">&quot;for_export&quot;</span><span class="p">]</span>
            <span class="n">pid</span> <span class="o">=</span> <span class="n">pids</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
            <span class="n">proj_index</span> <span class="o">=</span> <span class="n">elasticsearch_client</span><span class="o">.</span><span class="n">get_project_index_name</span><span class="p">(</span><span class="n">pid</span><span class="p">)</span>
            <span class="n">es_data</span> <span class="o">=</span> <span class="n">elasticsearch_client</span><span class="o">.</span><span class="n">get_list_data_elasticsearch</span><span class="p">(</span><span class="n">queries</span><span class="p">,</span>
                    <span class="n">proj_index</span><span class="p">,</span>
                    <span class="n">sorts</span><span class="o">=</span><span class="n">sorts</span><span class="p">,</span> 
                    <span class="n">textsearch</span><span class="o">=</span><span class="n">textsearch</span><span class="p">,</span>
                    <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                    <span class="n">limit</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
                    <span class="n">batch_ids_by_project</span><span class="o">=</span><span class="n">batch_ids_by_project</span> <span class="p">)</span>
            <span class="n">standardised</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prepare_es_hits</span><span class="p">(</span><span class="n">es_data</span><span class="p">)</span>

            <span class="n">standardised</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">proj_data</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
            <span class="n">standardised</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pid</span>
            <span class="n">standardised</span><span class="p">[</span><span class="s2">&quot;schema&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">table_schema_for_project</span>
            <span class="n">base</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;wsgi.url_scheme&quot;</span><span class="p">,</span><span class="s2">&quot;http&quot;</span><span class="p">)</span> 
            <span class="n">base</span> <span class="o">+=</span> <span class="s2">&quot;://&quot;</span>
            <span class="n">base</span> <span class="o">+=</span> <span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;HTTP_HOST&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">standardised</span><span class="p">[</span><span class="s2">&quot;schema&quot;</span><span class="p">]:</span>
                <span class="n">field</span><span class="p">[</span><span class="s2">&quot;base_url&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">base</span>
            <span class="n">to_return</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">standardised</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;format&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;sdf&quot;</span><span class="p">:</span>
            <span class="c1">#For the Excel sheet print out the query used</span>
            <span class="n">query_reps</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;fieldn&quot;</span><span class="p">:</span> <span class="s2">&quot;Project&quot;</span><span class="p">,</span> <span class="s2">&quot;pick_from_list&quot;</span><span class="p">:</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">ret</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span> <span class="k">for</span> <span class="n">ret</span> <span class="ow">in</span> <span class="n">to_return</span><span class="p">])</span> <span class="p">}]</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">q</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">queries</span><span class="p">):</span>
                <span class="n">qrep</span> <span class="o">=</span> <span class="p">{</span><span class="n">qtype</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="p">:</span> <span class="s2">u&quot;&quot;</span> <span class="k">for</span> <span class="n">qtype</span> <span class="ow">in</span> <span class="n">settings</span><span class="o">.</span><span class="n">CBH_QUERY_TYPES</span><span class="p">}</span>
                <span class="n">qrep</span><span class="p">[</span><span class="s2">&quot;fieldn&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">q</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;pick_from_list&quot;</span><span class="p">:</span>
                        <span class="n">qrep</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;field_path&quot;</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
                            <span class="n">knownBy</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">TABULAR_DATA_SETTINGS</span><span class="p">[</span><span class="s2">&quot;schema&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">value</span><span class="p">,{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;knownBy&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="n">knownBy</span><span class="p">:</span>
                                <span class="n">knownBy</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                            <span class="n">qrep</span><span class="p">[</span><span class="s2">&quot;fieldn&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">l</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">knownBy</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">qrep</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

                <span class="n">qrep</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
                <span class="n">query_reps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">qrep</span><span class="p">)</span>

            <span class="n">schem</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;knownBy&quot;</span> <span class="p">:</span> <span class="s2">&quot;Row&quot;</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;fieldn&quot;</span><span class="p">,</span> <span class="s2">&quot;knownBy&quot;</span> <span class="p">:</span> <span class="s2">&quot;Col&quot;</span><span class="p">}]</span> <span class="o">+</span> <span class="p">[{</span><span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">qtype</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">],</span> <span class="s2">&quot;knownBy&quot;</span> <span class="p">:</span> <span class="n">qtype</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]}</span> <span class="k">for</span> <span class="n">qtype</span> <span class="ow">in</span> <span class="n">settings</span><span class="o">.</span><span class="n">CBH_QUERY_TYPES</span><span class="p">]</span>
            <span class="n">query_summary</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;_Query Used&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;objects&quot;</span> <span class="p">:</span> <span class="n">query_reps</span><span class="p">,</span>
                    <span class="s2">&quot;schema&quot;</span> <span class="p">:</span> <span class="n">schem</span>
                    <span class="p">}</span>
            <span class="n">to_return</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">query_summary</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">to_return</span>



    <span class="k">def</span> <span class="nf">get_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a single serialized resource.</span>
<span class="sd">        Calls ``cached_obj_get/obj_get`` to provide the data, then handles that result</span>
<span class="sd">        set and serializes it.</span>
<span class="sd">        Should return a HttpResponse (200 OK).</span>
<span class="sd">        Get a single CBHCompoundbatches from elasticsearch by running a query</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">basic_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>

        <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">allowed_pids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">project_ids</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
        <span class="n">concatenated_indices</span> <span class="o">=</span> <span class="n">elasticsearch_client</span><span class="o">.</span><span class="n">get_list_of_indicies</span><span class="p">(</span><span class="n">allowed_pids</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">elasticsearch_client</span><span class="o">.</span><span class="n">get_detail_data_elasticsearch</span><span class="p">(</span><span class="n">concatenated_indices</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;pk&quot;</span><span class="p">])</span>   
        

        <span class="n">requested_pid</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;projectfull&quot;</span><span class="p">][</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">requested_pid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_pids</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">(</span><span class="s2">&quot;No permissions for requested project&quot;</span><span class="p">)</span> 

        <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>





    <span class="k">def</span> <span class="nf">save_related</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handles the saving of related non-M2M data.</span>
<span class="sd">        Calling assigning ``child.parent = parent`` &amp; then calling</span>
<span class="sd">        ``Child.save`` isn&#39;t good enough to make sure the ``parent``</span>
<span class="sd">        is saved.</span>
<span class="sd">        To get around this, we go through all our related fields &amp;</span>
<span class="sd">        call ``save`` on them if they have related, non-M2M data.</span>
<span class="sd">        M2M data is handled by the ``ModelResource.save_m2m`` method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_related</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">readonly</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">blank</span> <span class="ow">and</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="c1"># Get the object.</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">related_obj</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">ObjectDoesNotExist</span><span class="p">:</span>
                <span class="c1"># Django 1.8: unset related objects default to None, no error</span>
                <span class="n">related_obj</span> <span class="o">=</span> <span class="bp">None</span>

            <span class="c1"># We didn&#39;t get it, so maybe we created it but haven&#39;t saved it</span>
            <span class="k">if</span> <span class="n">related_obj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">related_obj</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">related_objects_to_save</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">related_name</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bundle_detail_data</span><span class="p">(</span><span class="n">bundle</span><span class="p">):</span>
                    <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

                <span class="nb">setattr</span><span class="p">(</span><span class="n">related_obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">related_name</span><span class="p">,</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>

            <span class="n">related_resource</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">get_related_resource</span><span class="p">(</span><span class="n">related_obj</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_name</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">field_name</span><span class="p">],</span> <span class="s1">&#39;keys&#39;</span><span class="p">):</span>
                <span class="c1"># Only build &amp; save if there&#39;s data, not just a URI.</span>
                <span class="n">related_bundle</span> <span class="o">=</span> <span class="n">related_resource</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span>
                    <span class="n">obj</span><span class="o">=</span><span class="n">related_obj</span><span class="p">,</span>
                    <span class="n">data</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_name</span><span class="p">),</span>
                    <span class="n">request</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">,</span>
                    <span class="n">objects_saved</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">objects_saved</span>
                <span class="p">)</span>
                <span class="n">related_resource</span><span class="o">.</span><span class="n">full_hydrate</span><span class="p">(</span><span class="n">related_bundle</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">field_name</span> <span class="o">!=</span> <span class="s2">&quot;project&quot;</span><span class="p">:</span>
                    <span class="n">related_resource</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">related_bundle</span><span class="p">)</span>
                <span class="n">related_obj</span> <span class="o">=</span> <span class="n">related_bundle</span><span class="o">.</span><span class="n">obj</span>

            <span class="k">if</span> <span class="n">related_obj</span><span class="p">:</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="n">related_obj</span><span class="p">)</span>











    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">skip_errors</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">via_uri</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">bundle</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">errors</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">skip_errors</span><span class="p">:</span>

            <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">error_response</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="o">.</span><span class="n">errors</span><span class="p">))</span>

        <span class="c1"># Check if they&#39;re authorized.</span>
        <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">pk</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">authorized_update_detail</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">),</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">authorized_create_detail</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">),</span> <span class="n">bundle</span><span class="p">)</span>


        <span class="c1"># Save FKs just in case.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_related</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="k">print</span> <span class="s2">&quot;got&quot;</span>

        <span class="c1"># Save the main object.</span>
        <span class="n">obj_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_identifier</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">obj_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">bundle</span><span class="o">.</span><span class="n">objects_saved</span> <span class="ow">or</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_state</span><span class="o">.</span><span class="n">adding</span><span class="p">:</span>
            <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
            <span class="n">bundle</span><span class="o">.</span><span class="n">objects_saved</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">obj_id</span><span class="p">)</span>

        <span class="c1"># Now pick up the M2M bits.</span>
        <span class="n">m2m_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hydrate_m2m</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_m2m</span><span class="p">(</span><span class="n">m2m_bundle</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">bundle</span>

    <span class="k">def</span> <span class="nf">get_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a serialized list of resources.</span>
<span class="sd">        Calls ``obj_get_list`` to provide the data, then handles that result</span>
<span class="sd">        set and serializes it.</span>
<span class="sd">        Should return a HttpResponse (200 OK).</span>
<span class="sd">        Get a list of CBHCompoundbatches from elasticsearch by running a query</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">base_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
        <span class="n">pids</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pids&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">project_ids</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">pids</span><span class="p">:</span>

            <span class="n">project_ids</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">pid</span><span class="p">)</span> <span class="k">for</span> <span class="n">pid</span> <span class="ow">in</span> <span class="n">pids</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)]</span>
        
        <span class="n">allowed_pids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">project_ids</span><span class="p">(</span><span class="n">request</span><span class="p">))</span>
        
        <span class="k">for</span> <span class="n">requested_pid</span> <span class="ow">in</span> <span class="n">project_ids</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">requested_pid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_pids</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">(</span><span class="s2">&quot;No permissions for requested project&quot;</span><span class="p">)</span> 



        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">project_ids</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">project_ids</span> <span class="o">=</span> <span class="n">allowed_pids</span>

        <span class="n">queries</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">b64decode</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;encoded_query&quot;</span><span class="p">,</span> <span class="n">EMPTY_ARRAY_B64</span><span class="p">)))</span>

        <span class="n">extra_queries</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;extra_queries&quot;</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">extra_queries</span><span class="p">:</span>
            <span class="c1">#extra queries can be added via kwargs</span>
            <span class="n">queries</span> <span class="o">+=</span> <span class="n">extra_queries</span>

        <span class="c1">#Search for whether this item is archived or not (&quot;archived is indexed as a string&quot;)</span>
        <span class="n">archived</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;archived&quot;</span><span class="p">,</span> <span class="s2">&quot;false&quot;</span><span class="p">)</span>
        <span class="n">queries</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;query_type&quot;</span><span class="p">:</span> <span class="s2">&quot;phrase&quot;</span><span class="p">,</span> <span class="s2">&quot;field_path&quot;</span><span class="p">:</span> <span class="s2">&quot;properties.archived&quot;</span><span class="p">,</span> <span class="s2">&quot;phrase&quot;</span><span class="p">:</span> <span class="n">archived</span><span class="p">})</span>

       

        <span class="n">sorts</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">b64decode</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;encoded_sorts&quot;</span><span class="p">,</span> <span class="n">EMPTY_ARRAY_B64</span><span class="p">)))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sorts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">sorts</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;field_path&quot;</span><span class="p">:</span><span class="s2">&quot;id&quot;</span><span class="p">,</span><span class="s2">&quot;sort_direction&quot;</span><span class="p">:</span><span class="s2">&quot;desc&quot;</span><span class="p">}]</span>
        <span class="n">textsearch</span> <span class="o">=</span> <span class="n">b64decode</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;textsearch&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
        <span class="n">limit</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;limit&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;offset&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">autocomplete</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;autocomplete&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">autocomplete_field_path</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;autocomplete_field_path&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">autocomplete_size</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;autocomplete_size&quot;</span><span class="p">,</span> <span class="n">settings</span><span class="o">.</span><span class="n">MAX_AUTOCOMPLETE_SIZE</span><span class="p">)</span>

        <span class="n">pr</span> <span class="o">=</span> <span class="n">ChemregProjectResource</span><span class="p">()</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">get_list</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">do_cache</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">project_content</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">restricted_fieldnames</span> <span class="o">=</span> <span class="n">project_content</span><span class="p">[</span><span class="s2">&quot;user_restricted_fieldnames&quot;</span><span class="p">]</span>

        <span class="c1">#The project ids list needs to be reduced down</span>
        <span class="c1">#Because we dont support OR queries then every time you query a project for </span>
        <span class="c1">#a field then only the projects that have that field (and unrestricted) need to be shown</span>
        <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">queries</span><span class="p">:</span>
             <span class="n">project_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">check_if_field_restricted</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="s2">&quot;field_path&quot;</span><span class="p">],</span> <span class="n">project_ids</span><span class="p">,</span> <span class="n">restricted_fieldnames</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">autocomplete_field_path</span><span class="p">:</span>
            <span class="n">project_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">check_if_field_restricted</span><span class="p">(</span><span class="n">autocomplete_field_path</span><span class="p">,</span> <span class="n">project_ids</span><span class="p">,</span> <span class="n">restricted_fieldnames</span><span class="p">)</span>

        <span class="n">concatenated_indices</span> <span class="o">=</span> <span class="n">elasticsearch_client</span><span class="o">.</span><span class="n">get_list_of_indicies</span><span class="p">(</span><span class="n">project_ids</span><span class="p">)</span>

        <span class="n">chemical_search_id</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;chemical_search_id&quot;</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
        <span class="n">batch_ids_by_project</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="n">chemical_search_id</span><span class="p">:</span>
            <span class="n">batch_result</span> <span class="o">=</span> <span class="n">result</span><span class="p">(</span><span class="n">chemical_search_id</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="mi">20000</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">batch_result</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s1">&#39;{&quot;error&quot;: &quot;Unable to process structure search&quot;}&#39;</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="mi">503</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">print</span> <span class="n">batch_result</span>
                <span class="n">batch_ids_by_project</span> <span class="o">=</span> <span class="n">batch_result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;format&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;sdf&quot;</span> <span class="ow">and</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;format&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;xlsx&quot;</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">elasticsearch_client</span><span class="o">.</span><span class="n">get_list_data_elasticsearch</span><span class="p">(</span><span class="n">queries</span><span class="p">,</span>
                <span class="n">concatenated_indices</span><span class="p">,</span>
                <span class="n">sorts</span><span class="o">=</span><span class="n">sorts</span><span class="p">,</span> 
                <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">,</span> 
                <span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">,</span> 
                <span class="n">textsearch</span><span class="o">=</span><span class="n">textsearch</span><span class="p">,</span> 
                <span class="n">autocomplete</span><span class="o">=</span><span class="n">autocomplete</span><span class="p">,</span>
                <span class="n">autocomplete_field_path</span><span class="o">=</span><span class="n">autocomplete_field_path</span><span class="p">,</span>
                <span class="n">autocomplete_size</span><span class="o">=</span><span class="n">autocomplete_size</span><span class="p">,</span>
                <span class="n">batch_ids_by_project</span><span class="o">=</span><span class="n">batch_ids_by_project</span>
                 <span class="p">)</span>
            
            
            <span class="k">if</span> <span class="n">autocomplete_field_path</span><span class="p">:</span>
            
                <span class="n">bucks</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;aggregations&quot;</span><span class="p">][</span><span class="s2">&quot;filtered_field_path&quot;</span><span class="p">][</span><span class="s2">&quot;field_path_terms&quot;</span><span class="p">][</span><span class="s2">&quot;buckets&quot;</span><span class="p">]</span>

                <span class="n">bundledata</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;items&quot;</span> <span class="p">:</span> <span class="n">bucks</span><span class="p">,</span>
                            <span class="s2">&quot;autocomplete&quot;</span> <span class="p">:</span> <span class="n">autocomplete</span><span class="p">,</span>
                            <span class="s2">&quot;unique_count&quot;</span> <span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;aggregations&quot;</span><span class="p">][</span><span class="s2">&quot;filtered_field_path&quot;</span><span class="p">][</span><span class="s2">&quot;unique_count&quot;</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">]}</span>
        
            <span class="k">else</span><span class="p">:</span>

                <span class="n">bundledata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prepare_es_hits</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                <span class="n">bundledata</span><span class="p">[</span><span class="s2">&quot;objects&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">removed_restricted_fields_if_present</span><span class="p">(</span><span class="n">bundledata</span><span class="p">[</span><span class="s2">&quot;objects&quot;</span><span class="p">],</span> <span class="n">restricted_fieldnames</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1">#Limit , offset and autocomplete have no effect for a project export</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_project_specific_data</span><span class="p">(</span><span class="n">request</span><span class="p">,</span>  <span class="n">queries</span><span class="p">,</span> <span class="n">project_ids</span><span class="p">,</span> <span class="n">sorts</span><span class="p">,</span> <span class="n">textsearch</span><span class="p">,</span> <span class="n">batch_ids_by_project</span><span class="p">)</span>

            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span> 


        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundledata</span><span class="p">)</span> 

    <span class="k">def</span> <span class="nf">prepare_es_hits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hits</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;objects&quot;</span><span class="p">:</span> 
                            <span class="p">[</span><span class="n">hit</span><span class="p">[</span><span class="s2">&quot;_source&quot;</span><span class="p">][</span><span class="s2">&quot;dataset&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">hit</span> <span class="ow">in</span> <span class="n">hits</span><span class="p">[</span><span class="s2">&quot;hits&quot;</span><span class="p">][</span><span class="s2">&quot;hits&quot;</span><span class="p">]],</span>
                            <span class="s2">&quot;meta&quot;</span> <span class="p">:</span> <span class="p">{</span><span class="s2">&quot;total_count&quot;</span> <span class="p">:</span> <span class="n">hits</span><span class="p">[</span><span class="s2">&quot;hits&quot;</span><span class="p">][</span><span class="s2">&quot;total&quot;</span><span class="p">]}</span>
                            <span class="p">}</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">authorization</span> <span class="o">=</span> <span class="n">ProjectAuthorization</span><span class="p">()</span>
        <span class="n">queryset</span> <span class="o">=</span> <span class="n">CBHCompoundBatch</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        
        <span class="n">include_resource_uri</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">serializer</span> <span class="o">=</span> <span class="n">CBHCompoundBatchSerializer</span><span class="p">()</span>
        <span class="n">always_return_data</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></li>
          <li>tastypie.resources.ModelResource</li>
          <li>tastypie.resources.BaseModelResource</li>
          <li>tastypie.resources.Resource</li>
          <li>__builtin__.object</li>
          </ul>
          <h3>Class variables</h3>
            <div class="item">
            <p id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.Meta" class="name">var <span class="ident">Meta</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.base_fields" class="name">var <span class="ident">base_fields</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.creator" class="name">var <span class="ident">creator</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.custom_fields" class="name">var <span class="ident">custom_fields</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.declared_fields" class="name">var <span class="ident">declared_fields</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.project" class="name">var <span class="ident">project</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.projectfull" class="name">var <span class="ident">projectfull</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.properties" class="name">var <span class="ident">properties</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.related_molregno" class="name">var <span class="ident">related_molregno</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.timestamp" class="name">var <span class="ident">timestamp</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.uncurated_fields" class="name">var <span class="ident">uncurated_fields</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.uuid" class="name">var <span class="ident">uuid</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.warnings" class="name">var <span class="ident">warnings</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.urls" class="name">var <span class="ident">urls</span></p>
            

            
  
    <div class="desc"><p>The endpoints this <code>Resource</code> responds to.</p>
<p>Mostly a standard URLconf, this is suitable for either automatic use
when registered with an <code>Api</code> class or for including directly in
a URLconf should you choose to.</p></div>
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, api_name=None)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.__init__', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">api_name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="c1"># this can cause:</span>
    <span class="c1"># TypeError: object.__new__(method-wrapper) is not safe, use method-wrapper.__new__()</span>
    <span class="c1"># when trying to copy a generator used as a default. Wrap call to</span>
    <span class="c1"># generator in lambda to get around this error.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_fields</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">api_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span> <span class="o">=</span> <span class="n">api_name</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.alter_deserialized_detail_data">
    <p>def <span class="ident">alter_deserialized_detail_data</span>(</p><p>self, request, data)</p>
    </div>
    

    
  
    <div class="desc"><p>A hook to alter detail data just after it has been received from the user &amp;
gets deserialized.</p>
<p>Useful for altering the user data before any hydration is applied.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.alter_deserialized_detail_data', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.alter_deserialized_detail_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">alter_deserialized_detail_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to alter detail data just after it has been received from the user &amp;</span>
<span class="sd">    gets deserialized.</span>
<span class="sd">    Useful for altering the user data before any hydration is applied.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.alter_deserialized_list_data">
    <p>def <span class="ident">alter_deserialized_list_data</span>(</p><p>self, request, data)</p>
    </div>
    

    
  
    <div class="desc"><p>A hook to alter list data just after it has been received from the user &amp;
gets deserialized.</p>
<p>Useful for altering the user data before any hydration is applied.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.alter_deserialized_list_data', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.alter_deserialized_list_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">alter_deserialized_list_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to alter list data just after it has been received from the user &amp;</span>
<span class="sd">    gets deserialized.</span>
<span class="sd">    Useful for altering the user data before any hydration is applied.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.alter_detail_data_to_serialize">
    <p>def <span class="ident">alter_detail_data_to_serialize</span>(</p><p>self, request, data)</p>
    </div>
    

    
  
    <div class="desc"><p>A hook to alter detail data just before it gets serialized &amp; sent to the user.</p>
<p>Useful for restructuring/renaming aspects of the what's going to be
sent.</p>
<p>Should accommodate for receiving a single bundle of data.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.alter_detail_data_to_serialize', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.alter_detail_data_to_serialize" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">alter_detail_data_to_serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to alter detail data just before it gets serialized &amp; sent to the user.</span>
<span class="sd">    Useful for restructuring/renaming aspects of the what&#39;s going to be</span>
<span class="sd">    sent.</span>
<span class="sd">    Should accommodate for receiving a single bundle of data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.alter_list_data_to_serialize">
    <p>def <span class="ident">alter_list_data_to_serialize</span>(</p><p>self, request, data)</p>
    </div>
    

    
  
    <div class="desc"><p>A hook to alter list data just before it gets serialized &amp; sent to the user.</p>
<p>Useful for restructuring/renaming aspects of the what's going to be
sent.</p>
<p>Should accommodate for a list of objects, generally also including
meta data.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.alter_list_data_to_serialize', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.alter_list_data_to_serialize" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">alter_list_data_to_serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to alter list data just before it gets serialized &amp; sent to the user.</span>
<span class="sd">    Useful for restructuring/renaming aspects of the what&#39;s going to be</span>
<span class="sd">    sent.</span>
<span class="sd">    Should accommodate for a list of objects, generally also including</span>
<span class="sd">    meta data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.api_field_from_django_field">
    <p>def <span class="ident">api_field_from_django_field</span>(</p><p>cls, f, default=&lt;class &#39;tastypie.fields.CharField&#39;&gt;)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns the field type that would likely be associated with each
Django type.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.api_field_from_django_field', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.api_field_from_django_field" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">api_field_from_django_field</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">fields</span><span class="o">.</span><span class="n">CharField</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the field type that would likely be associated with each</span>
<span class="sd">    Django type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">default</span>
    <span class="n">internal_type</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">get_internal_type</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">internal_type</span> <span class="o">==</span> <span class="s1">&#39;DateField&#39;</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">DateField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="o">==</span> <span class="s1">&#39;DateTimeField&#39;</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">DateTimeField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;BooleanField&#39;</span><span class="p">,</span> <span class="s1">&#39;NullBooleanField&#39;</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">BooleanField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;FloatField&#39;</span><span class="p">,):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">FloatField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;DecimalField&#39;</span><span class="p">,):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">DecimalField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;IntegerField&#39;</span><span class="p">,</span> <span class="s1">&#39;PositiveIntegerField&#39;</span><span class="p">,</span> <span class="s1">&#39;PositiveSmallIntegerField&#39;</span><span class="p">,</span> <span class="s1">&#39;SmallIntegerField&#39;</span><span class="p">,</span> <span class="s1">&#39;AutoField&#39;</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">IntegerField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;FileField&#39;</span><span class="p">,</span> <span class="s1">&#39;ImageField&#39;</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">FileField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="o">==</span> <span class="s1">&#39;TimeField&#39;</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">TimeField</span>
    <span class="c1"># TODO: Perhaps enable these via introspection. The reason they&#39;re not enabled</span>
    <span class="c1">#       by default is the very different ``__init__`` they have over</span>
    <span class="c1">#       the other fields.</span>
    <span class="c1"># elif internal_type == &#39;ForeignKey&#39;:</span>
    <span class="c1">#     result = ForeignKey</span>
    <span class="c1"># elif internal_type == &#39;ManyToManyField&#39;:</span>
    <span class="c1">#     result = ManyToManyField</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.apply_authorization_limits">
    <p>def <span class="ident">apply_authorization_limits</span>(</p><p>self, request, object_list)</p>
    </div>
    

    
  
    <div class="desc"><p>Deprecated.</p>
<p>FIXME: REMOVE BEFORE 1.0</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.apply_authorization_limits', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.apply_authorization_limits" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">apply_authorization_limits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">object_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Deprecated.</span>
<span class="sd">    FIXME: REMOVE BEFORE 1.0</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">apply_limits</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">object_list</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.apply_filters">
    <p>def <span class="ident">apply_filters</span>(</p><p>self, request, applicable_filters)</p>
    </div>
    

    
  
    <div class="desc"><p>An ORM-specific implementation of <code>apply_filters</code>.</p>
<p>The default simply applies the <code>applicable_filters</code> as <code>**kwargs</code>,
but should make it possible to do more advanced things.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.apply_filters', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.apply_filters" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">apply_filters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">applicable_filters</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An ORM-specific implementation of ``apply_filters``.</span>
<span class="sd">    The default simply applies the ``applicable_filters`` as ``**kwargs``,</span>
<span class="sd">    but should make it possible to do more advanced things.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">request</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="o">**</span><span class="n">applicable_filters</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.apply_sorting">
    <p>def <span class="ident">apply_sorting</span>(</p><p>self, obj_list, options=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a dictionary of options, apply some ORM-level sorting to the
provided <code>QuerySet</code>.</p>
<p>Looks for the <code>order_by</code> key and handles either ascending (just the
field name) or descending (the field name with a <code>-</code> in front).</p>
<p>The field name should be the resource field, <strong>NOT</strong> model field.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.apply_sorting', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.apply_sorting" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">apply_sorting</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_list</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a dictionary of options, apply some ORM-level sorting to the</span>
<span class="sd">    provided ``QuerySet``.</span>
<span class="sd">    Looks for the ``order_by`` key and handles either ascending (just the</span>
<span class="sd">    field name) or descending (the field name with a ``-`` in front).</span>
<span class="sd">    The field name should be the resource field, **NOT** model field.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">parameter_name</span> <span class="o">=</span> <span class="s1">&#39;order_by&#39;</span>
    <span class="k">if</span> <span class="s1">&#39;order_by&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;sort_by&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
            <span class="c1"># Nothing to alter the order. Return what we&#39;ve got.</span>
            <span class="k">return</span> <span class="n">obj_list</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;&#39;sort_by&#39; is a deprecated parameter. Please use &#39;order_by&#39; instead.&quot;</span><span class="p">)</span>
            <span class="n">parameter_name</span> <span class="o">=</span> <span class="s1">&#39;sort_by&#39;</span>
    <span class="n">order_by_args</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="s1">&#39;getlist&#39;</span><span class="p">):</span>
        <span class="n">order_bits</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">getlist</span><span class="p">(</span><span class="n">parameter_name</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">order_bits</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">parameter_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">order_bits</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="n">order_bits</span> <span class="o">=</span> <span class="p">[</span><span class="n">order_bits</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">order_by</span> <span class="ow">in</span> <span class="n">order_bits</span><span class="p">:</span>
        <span class="n">order_by_bits</span> <span class="o">=</span> <span class="n">order_by</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">LOOKUP_SEP</span><span class="p">)</span>
        <span class="n">field_name</span> <span class="o">=</span> <span class="n">order_by_bits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">order</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">order_by_bits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">):</span>
            <span class="n">field_name</span> <span class="o">=</span> <span class="n">order_by_bits</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
            <span class="n">order</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span>
        <span class="k">if</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
            <span class="c1"># It&#39;s not a field we know about. Move along citizen.</span>
            <span class="k">raise</span> <span class="n">InvalidSortError</span><span class="p">(</span><span class="s2">&quot;No matching &#39;</span><span class="si">%s</span><span class="s2">&#39; field for ordering on.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">ordering</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidSortError</span><span class="p">(</span><span class="s2">&quot;The &#39;</span><span class="si">%s</span><span class="s2">&#39; field does not allow ordering.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">attribute</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidSortError</span><span class="p">(</span><span class="s2">&quot;The &#39;</span><span class="si">%s</span><span class="s2">&#39; field has no &#39;attribute&#39; for ordering with.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="n">order_by_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">LOOKUP_SEP</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">attribute</span><span class="p">]</span> <span class="o">+</span> <span class="n">order_by_bits</span><span class="p">[</span><span class="mi">1</span><span class="p">:])))</span>
    <span class="k">return</span> <span class="n">obj_list</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="o">*</span><span class="n">order_by_args</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_create_detail">
    <p>def <span class="ident">authorized_create_detail</span>(</p><p>self, object_list, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking of permissions to see if the user has authorization
to POST this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_create_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_create_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_create_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to POST this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">create_detail</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">auth_result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_create_list">
    <p>def <span class="ident">authorized_create_list</span>(</p><p>self, object_list, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking of permissions to see if the user has authorization
to POST this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_create_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_create_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_create_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to POST this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">create_list</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_delete_detail">
    <p>def <span class="ident">authorized_delete_detail</span>(</p><p>self, object_list, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking of permissions to see if the user has authorization
to DELETE this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_delete_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_delete_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_delete_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to DELETE this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">delete_detail</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">auth_result</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_delete_list">
    <p>def <span class="ident">authorized_delete_list</span>(</p><p>self, object_list, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking of permissions to see if the user has authorization
to DELETE this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_delete_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_delete_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_delete_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to DELETE this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">delete_list</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_read_detail">
    <p>def <span class="ident">authorized_read_detail</span>(</p><p>self, object_list, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking of permissions to see if the user has authorization
to GET this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_read_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_read_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_read_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to GET this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">read_detail</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">auth_result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_read_list">
    <p>def <span class="ident">authorized_read_list</span>(</p><p>self, object_list, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking of permissions to see if the user has authorization
to GET this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_read_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_read_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_read_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to GET this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">read_list</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_update_detail">
    <p>def <span class="ident">authorized_update_detail</span>(</p><p>self, object_list, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking of permissions to see if the user has authorization
to PUT this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_update_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_update_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_update_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to PUT this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">update_detail</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">auth_result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_update_list">
    <p>def <span class="ident">authorized_update_list</span>(</p><p>self, object_list, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking of permissions to see if the user has authorization
to PUT this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_update_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_update_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_update_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to PUT this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">update_list</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.base_urls">
    <p>def <span class="ident">base_urls</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>The standard URLs this <code>Resource</code> should respond to.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.base_urls', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.base_urls" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">base_urls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The standard URLs this ``Resource`` should respond to.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="n">url</span><span class="p">(</span><span class="s2">r&quot;^(?P&lt;resource_name&gt;</span><span class="si">%s</span><span class="s2">)</span><span class="si">%s</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span> <span class="n">trailing_slash</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrap_view</span><span class="p">(</span><span class="s1">&#39;dispatch_list&#39;</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;api_dispatch_list&quot;</span><span class="p">),</span>
        <span class="n">url</span><span class="p">(</span><span class="s2">r&quot;^(?P&lt;resource_name&gt;</span><span class="si">%s</span><span class="s2">)/schema</span><span class="si">%s</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span> <span class="n">trailing_slash</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrap_view</span><span class="p">(</span><span class="s1">&#39;get_schema&#39;</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;api_get_schema&quot;</span><span class="p">),</span>
        <span class="n">url</span><span class="p">(</span><span class="s2">r&quot;^(?P&lt;resource_name&gt;</span><span class="si">%s</span><span class="s2">)/set/(?P&lt;</span><span class="si">%s</span><span class="s2">_list&gt;.*?)</span><span class="si">%s</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">,</span> <span class="n">trailing_slash</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrap_view</span><span class="p">(</span><span class="s1">&#39;get_multiple&#39;</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;api_get_multiple&quot;</span><span class="p">),</span>
        <span class="n">url</span><span class="p">(</span><span class="s2">r&quot;^(?P&lt;resource_name&gt;</span><span class="si">%s</span><span class="s2">)/(?P&lt;</span><span class="si">%s</span><span class="s2">&gt;.*?)</span><span class="si">%s</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">,</span> <span class="n">trailing_slash</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrap_view</span><span class="p">(</span><span class="s1">&#39;dispatch_detail&#39;</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;api_dispatch_detail&quot;</span><span class="p">),</span>
    <span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.build_bundle">
    <p>def <span class="ident">build_bundle</span>(</p><p>self, obj=None, data=None, request=None, objects_saved=None, via_uri=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Given either an object, a data dictionary or both, builds a <code>Bundle</code>
for use throughout the <code>dehydrate/hydrate</code> cycle.</p>
<p>If no object is provided, an empty object from
<code>Resource._meta.object_class</code> is created so that attempts to access
<code>bundle.obj</code> do not fail.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.build_bundle', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.build_bundle" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">build_bundle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">objects_saved</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">via_uri</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given either an object, a data dictionary or both, builds a ``Bundle``</span>
<span class="sd">    for use throughout the ``dehydrate/hydrate`` cycle.</span>
<span class="sd">    If no object is provided, an empty object from</span>
<span class="sd">    ``Resource._meta.object_class`` is created so that attempts to access</span>
<span class="sd">    ``bundle.obj`` do not fail.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="p">:</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">Bundle</span><span class="p">(</span>
        <span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span>
        <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
        <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">,</span>
        <span class="n">objects_saved</span><span class="o">=</span><span class="n">objects_saved</span><span class="p">,</span>
        <span class="n">via_uri</span><span class="o">=</span><span class="n">via_uri</span>
    <span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.build_filters">
    <p>def <span class="ident">build_filters</span>(</p><p>self, filters=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a dictionary of filters, create the necessary ORM-level filters.</p>
<p>Keys should be resource fields, <strong>NOT</strong> model fields.</p>
<p>Valid values are either a list of Django filter types (i.e.
<code>['startswith', 'exact', 'lte']</code>), the <code>ALL</code> constant or the
<code>ALL_WITH_RELATIONS</code> constant.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.build_filters', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.build_filters" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">build_filters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a dictionary of filters, create the necessary ORM-level filters.</span>
<span class="sd">    Keys should be resource fields, **NOT** model fields.</span>
<span class="sd">    Valid values are either a list of Django filter types (i.e.</span>
<span class="sd">    ``[&#39;startswith&#39;, &#39;exact&#39;, &#39;lte&#39;]``), the ``ALL`` constant or the</span>
<span class="sd">    ``ALL_WITH_RELATIONS`` constant.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># At the declarative level:</span>
    <span class="c1">#     filtering = {</span>
    <span class="c1">#         &#39;resource_field_name&#39;: [&#39;exact&#39;, &#39;startswith&#39;, &#39;endswith&#39;, &#39;contains&#39;],</span>
    <span class="c1">#         &#39;resource_field_name_2&#39;: [&#39;exact&#39;, &#39;gt&#39;, &#39;gte&#39;, &#39;lt&#39;, &#39;lte&#39;, &#39;range&#39;],</span>
    <span class="c1">#         &#39;resource_field_name_3&#39;: ALL,</span>
    <span class="c1">#         &#39;resource_field_name_4&#39;: ALL_WITH_RELATIONS,</span>
    <span class="c1">#         ...</span>
    <span class="c1">#     }</span>
    <span class="c1"># Accepts the filters as a dict. None by default, meaning no filters.</span>
    <span class="k">if</span> <span class="n">filters</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">filters</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">qs_filters</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="p">,</span> <span class="s1">&#39;queryset&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="c1"># Get the possible query terms from the current QuerySet.</span>
        <span class="n">query_terms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">queryset</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">query_terms</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">query_terms</span> <span class="o">=</span> <span class="n">QUERY_TERMS</span>
    <span class="k">if</span> <span class="n">django</span><span class="o">.</span><span class="n">VERSION</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span> <span class="ow">and</span> <span class="n">GeometryField</span><span class="p">:</span>
        <span class="n">query_terms</span> <span class="o">=</span> <span class="n">query_terms</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="n">GeometryField</span><span class="o">.</span><span class="n">class_lookups</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="k">for</span> <span class="n">filter_expr</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">filters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">filter_bits</span> <span class="o">=</span> <span class="n">filter_expr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">LOOKUP_SEP</span><span class="p">)</span>
        <span class="n">field_name</span> <span class="o">=</span> <span class="n">filter_bits</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">filter_type</span> <span class="o">=</span> <span class="s1">&#39;exact&#39;</span>
        <span class="k">if</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
            <span class="c1"># It&#39;s not a field we know about. Move along citizen.</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filter_bits</span><span class="p">)</span> <span class="ow">and</span> <span class="n">filter_bits</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">query_terms</span><span class="p">:</span>
            <span class="n">filter_type</span> <span class="o">=</span> <span class="n">filter_bits</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="n">lookup_bits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_filtering</span><span class="p">(</span><span class="n">field_name</span><span class="p">,</span> <span class="n">filter_type</span><span class="p">,</span> <span class="n">filter_bits</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_value_to_python</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">filters</span><span class="p">,</span> <span class="n">filter_expr</span><span class="p">,</span> <span class="n">filter_type</span><span class="p">)</span>
        <span class="n">db_field_name</span> <span class="o">=</span> <span class="n">LOOKUP_SEP</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lookup_bits</span><span class="p">)</span>
        <span class="n">qs_filter</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">db_field_name</span><span class="p">,</span> <span class="n">LOOKUP_SEP</span><span class="p">,</span> <span class="n">filter_type</span><span class="p">)</span>
        <span class="n">qs_filters</span><span class="p">[</span><span class="n">qs_filter</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
    <span class="k">return</span> <span class="n">dict_strip_unicode_keys</span><span class="p">(</span><span class="n">qs_filters</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.build_schema">
    <p>def <span class="ident">build_schema</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns a dictionary of all the fields on the resource and some
properties about those fields.</p>
<p>Used by the <code>schema/</code> endpoint to describe what will be available.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.build_schema', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.build_schema" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">build_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a dictionary of all the fields on the resource and some</span>
<span class="sd">    properties about those fields.</span>
<span class="sd">    Used by the ``schema/`` endpoint to describe what will be available.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;fields&#39;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s1">&#39;default_format&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">default_format</span><span class="p">,</span>
        <span class="s1">&#39;allowed_list_http_methods&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">list_allowed_methods</span><span class="p">,</span>
        <span class="s1">&#39;allowed_detail_http_methods&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_allowed_methods</span><span class="p">,</span>
        <span class="s1">&#39;default_limit&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">limit</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">ordering</span><span class="p">:</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;ordering&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">ordering</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span><span class="p">:</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;filtering&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span>
    <span class="c1"># Skip assigning pk_field_name for non-model resources</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">pk_field_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">queryset</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">pk</span><span class="o">.</span><span class="n">name</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="n">pk_field_name</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;fields&#39;</span><span class="p">][</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">default</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">dehydrated_type</span><span class="p">,</span>
            <span class="s1">&#39;nullable&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">null</span><span class="p">,</span>
            <span class="s1">&#39;blank&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">blank</span><span class="p">,</span>
            <span class="s1">&#39;readonly&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">readonly</span><span class="p">,</span>
            <span class="s1">&#39;help_text&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">help_text</span><span class="p">,</span>
            <span class="s1">&#39;unique&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">unique</span><span class="p">,</span>
            <span class="s1">&#39;primary_key&#39;</span><span class="p">:</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">field_name</span> <span class="o">==</span> <span class="n">pk_field_name</span> <span class="k">else</span> <span class="bp">False</span><span class="p">,</span>
            <span class="s1">&#39;verbose_name&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">verbose_name</span> <span class="ow">or</span> <span class="n">field_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">),</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">dehydrated_type</span> <span class="o">==</span> <span class="s1">&#39;related&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
                <span class="n">related_type</span> <span class="o">=</span> <span class="s1">&#39;to_many&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">related_type</span> <span class="o">=</span> <span class="s1">&#39;to_one&#39;</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;fields&#39;</span><span class="p">][</span><span class="n">field_name</span><span class="p">][</span><span class="s1">&#39;related_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">related_type</span>
            <span class="n">uri</span> <span class="o">=</span> <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;api_get_schema&#39;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;api_name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span><span class="p">,</span> <span class="s1">&#39;resource_name&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">to_class</span><span class="p">()</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">})</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;fields&#39;</span><span class="p">][</span><span class="n">field_name</span><span class="p">][</span><span class="s1">&#39;related_schema&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">uri</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.cached_obj_get">
    <p>def <span class="ident">cached_obj_get</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A version of <code>obj_get</code> that uses the cache as a means to get
commonly-accessed data faster.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.cached_obj_get', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.cached_obj_get" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">cached_obj_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A version of ``obj_get`` that uses the cache as a means to get</span>
<span class="sd">    commonly-accessed data faster.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_cache_key</span><span class="p">(</span><span class="s1">&#39;detail&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">cached_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cache_key</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">cached_bundle</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">cached_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">cache_key</span><span class="p">,</span> <span class="n">cached_bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cached_bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.cached_obj_get_list">
    <p>def <span class="ident">cached_obj_get_list</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A version of <code>obj_get_list</code> that uses the cache as a means to get
commonly-accessed data faster.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.cached_obj_get_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.cached_obj_get_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">cached_obj_get_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A version of ``obj_get_list`` that uses the cache as a means to get</span>
<span class="sd">    commonly-accessed data faster.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_cache_key</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">obj_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cache_key</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">obj_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">obj_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">cache_key</span><span class="p">,</span> <span class="n">obj_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">obj_list</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.can_create">
    <p>def <span class="ident">can_create</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Checks to ensure <code>post</code> is within <code>allowed_methods</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.can_create', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.can_create" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">can_create</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks to ensure ``post`` is within ``allowed_methods``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">allowed</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">list_allowed_methods</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_allowed_methods</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">&#39;post&#39;</span> <span class="ow">in</span> <span class="n">allowed</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.can_delete">
    <p>def <span class="ident">can_delete</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Checks to ensure <code>delete</code> is within <code>allowed_methods</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.can_delete', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.can_delete" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">can_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks to ensure ``delete`` is within ``allowed_methods``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">allowed</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">list_allowed_methods</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_allowed_methods</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">&#39;delete&#39;</span> <span class="ow">in</span> <span class="n">allowed</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.can_update">
    <p>def <span class="ident">can_update</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Checks to ensure <code>put</code> is within <code>allowed_methods</code>.</p>
<p>Used when hydrating related data.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.can_update', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.can_update" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">can_update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks to ensure ``put`` is within ``allowed_methods``.</span>
<span class="sd">    Used when hydrating related data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">allowed</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">list_allowed_methods</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_allowed_methods</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">&#39;put&#39;</span> <span class="ow">in</span> <span class="n">allowed</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.check_filtering">
    <p>def <span class="ident">check_filtering</span>(</p><p>self, field_name, filter_type=u&#39;exact&#39;, filter_bits=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a field name, a optional filter type and an optional list of
additional relations, determine if a field can be filtered on.</p>
<p>If a filter does not meet the needed conditions, it should raise an
<code>InvalidFilterError</code>.</p>
<p>If the filter meets the conditions, a list of attribute names (not
field names) will be returned.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.check_filtering', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.check_filtering" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">check_filtering</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">filter_type</span><span class="o">=</span><span class="s1">&#39;exact&#39;</span><span class="p">,</span> <span class="n">filter_bits</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a field name, a optional filter type and an optional list of</span>
<span class="sd">    additional relations, determine if a field can be filtered on.</span>
<span class="sd">    If a filter does not meet the needed conditions, it should raise an</span>
<span class="sd">    ``InvalidFilterError``.</span>
<span class="sd">    If the filter meets the conditions, a list of attribute names (not</span>
<span class="sd">    field names) will be returned.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">filter_bits</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">filter_bits</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">InvalidFilterError</span><span class="p">(</span><span class="s2">&quot;The &#39;</span><span class="si">%s</span><span class="s2">&#39; field does not allow filtering.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
    <span class="c1"># Check to see if it&#39;s an allowed lookup type.</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">ALL</span><span class="p">,</span> <span class="n">ALL_WITH_RELATIONS</span><span class="p">):</span>
        <span class="c1"># Must be an explicit whitelist.</span>
        <span class="k">if</span> <span class="n">filter_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span><span class="p">[</span><span class="n">field_name</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">InvalidFilterError</span><span class="p">(</span><span class="s2">&quot;&#39;</span><span class="si">%s</span><span class="s2">&#39; is not an allowed filter on the &#39;</span><span class="si">%s</span><span class="s2">&#39; field.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">filter_type</span><span class="p">,</span> <span class="n">field_name</span><span class="p">))</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">attribute</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">InvalidFilterError</span><span class="p">(</span><span class="s2">&quot;The &#39;</span><span class="si">%s</span><span class="s2">&#39; field has no &#39;attribute&#39; for searching with.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
    <span class="c1"># Check to see if it&#39;s a relational lookup and if that&#39;s allowed.</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filter_bits</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">],</span> <span class="s1">&#39;is_related&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">InvalidFilterError</span><span class="p">(</span><span class="s2">&quot;The &#39;</span><span class="si">%s</span><span class="s2">&#39; field does not support relations.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">==</span> <span class="n">ALL_WITH_RELATIONS</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidFilterError</span><span class="p">(</span><span class="s2">&quot;Lookups are not allowed more than one level deep on the &#39;</span><span class="si">%s</span><span class="s2">&#39; field.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="c1"># Recursively descend through the remaining lookups in the filter,</span>
        <span class="c1"># if any. We should ensure that all along the way, we&#39;re allowed</span>
        <span class="c1"># to filter on that field by the related resource.</span>
        <span class="n">related_resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">get_related_resource</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">attribute</span><span class="p">]</span> <span class="o">+</span> <span class="n">related_resource</span><span class="o">.</span><span class="n">check_filtering</span><span class="p">(</span><span class="n">filter_bits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">filter_type</span><span class="p">,</span> <span class="n">filter_bits</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">attribute</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.create_identifier">
    <p>def <span class="ident">create_identifier</span>(</p><p>self, obj)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.create_identifier', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.create_identifier" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">create_identifier</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">u&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">app_label</span><span class="p">,</span> <span class="n">get_module_name</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">_meta</span><span class="p">),</span> <span class="n">obj</span><span class="o">.</span><span class="n">pk</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.create_response">
    <p>def <span class="ident">create_response</span>(</p><p>self, request, data, response_class=&lt;class &#39;django.http.response.HttpResponse&#39;&gt;, **response_kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Ensure that data is returned in the right format as an attachment if returning SDF or XLSX data
Should an object have been created or updated, now is the time to
reindex it in the elasticsearch index</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.create_response', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.create_response" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">create_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">HttpResponse</span><span class="p">,</span> <span class="o">**</span><span class="n">response_kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Ensure that data is returned in the right format as an attachment if returning SDF or XLSX data</span>
<span class="sd">    Should an object have been created or updated, now is the time to</span>
<span class="sd">    reindex it in the elasticsearch index</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">desired_format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">determine_format</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">response_class</span> <span class="o">==</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpCreated</span> <span class="ow">or</span> <span class="n">response_class</span> <span class="o">==</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpAccepted</span><span class="p">:</span>
        <span class="n">batches</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;objects&quot;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;objects&quot;</span><span class="p">):</span>
                <span class="n">batches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">batches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
        <span class="n">index_batches_in_new_index</span><span class="p">(</span><span class="n">batches</span><span class="p">)</span>
    <span class="n">serialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">desired_format</span><span class="p">)</span>
    <span class="n">rc</span> <span class="o">=</span> <span class="n">response_class</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">serialized</span><span class="p">,</span> <span class="n">content_type</span><span class="o">=</span><span class="n">build_content_type</span><span class="p">(</span>
        <span class="n">desired_format</span><span class="p">),</span> <span class="o">**</span><span class="n">response_kwargs</span><span class="p">)</span>
    <span class="k">if</span><span class="p">(</span><span class="n">desired_format</span> <span class="o">==</span> <span class="s1">&#39;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&#39;</span><span class="p">):</span>
        <span class="n">rc</span><span class="p">[</span><span class="s1">&#39;Content-Disposition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;attachment; filename=export_from_chembiohub_chemreg</span><span class="si">%d</span><span class="s1">.xlsx&#39;</span> <span class="o">%</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span>
    <span class="k">elif</span><span class="p">(</span><span class="n">desired_format</span> <span class="o">==</span> <span class="s1">&#39;chemical/x-mdl-sdfile&#39;</span><span class="p">):</span>
        <span class="n">rc</span><span class="p">[</span><span class="s1">&#39;Content-Disposition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;attachment; filename=export_from_chembiohub_chemreg</span><span class="si">%d</span><span class="s1">.sdf&#39;</span> <span class="o">%</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">rc</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.dehydrate">
    <p>def <span class="ident">dehydrate</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>A hook to allow a final manipulation of data once all fields/methods
have built out the dehydrated data.</p>
<p>Useful if you need to access more than one dehydrated field or want
to annotate on additional data.</p>
<p>Must return the modified bundle.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.dehydrate', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.dehydrate" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dehydrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to allow a final manipulation of data once all fields/methods</span>
<span class="sd">    have built out the dehydrated data.</span>
<span class="sd">    Useful if you need to access more than one dehydrated field or want</span>
<span class="sd">    to annotate on additional data.</span>
<span class="sd">    Must return the modified bundle.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.dehydrate_properties">
    <p>def <span class="ident">dehydrate_properties</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Ensure that the archived property is always presented in a consistent way</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.dehydrate_properties', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.dehydrate_properties" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dehydrate_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Ensure that the archived property is always presented in a consistent way&quot;&quot;&quot;</span>
    <span class="n">archived</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;archived&quot;</span><span class="p">,</span> <span class="s2">&quot;false&quot;</span><span class="p">)</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">properties</span>
    <span class="n">value</span><span class="p">[</span><span class="s2">&quot;archived&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">archived</span>
    <span class="k">return</span> <span class="n">value</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.dehydrate_resource_uri">
    <p>def <span class="ident">dehydrate_resource_uri</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>For the automatically included <code>resource_uri</code> field, dehydrate
the URI for the given bundle.</p>
<p>Returns empty string if no URI can be generated.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.dehydrate_resource_uri', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.dehydrate_resource_uri" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dehydrate_resource_uri</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    For the automatically included ``resource_uri`` field, dehydrate</span>
<span class="sd">    the URI for the given bundle.</span>
<span class="sd">    Returns empty string if no URI can be generated.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_uri</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="k">except</span> <span class="n">NoReverseMatch</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.dehydrate_timestamp">
    <p>def <span class="ident">dehydrate_timestamp</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Provide a viewer-friendly timestamp</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.dehydrate_timestamp', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.dehydrate_timestamp" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dehydrate_timestamp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Provide a viewer-friendly timestamp&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">created</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.dehydrate_uuid">
    <p>def <span class="ident">dehydrate_uuid</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>This is either a blinded batch uuid or a uuid for the compound structure based on the INCHI key</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.dehydrate_uuid', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.dehydrate_uuid" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dehydrate_uuid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This is either a blinded batch uuid or a uuid for the compound structure based on the INCHI key&quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">related_molregno</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">related_molregno</span><span class="o">.</span><span class="n">chembl</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">related_molregno</span><span class="o">.</span><span class="n">chembl</span><span class="o">.</span><span class="n">chembl_id</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">related_molregno</span><span class="o">.</span><span class="n">chembl</span><span class="o">.</span><span class="n">chembl_id</span>
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">blinded_batch_id</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">blinded_batch_id</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.delete_detail">
    <p>def <span class="ident">delete_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Destroys a single resource/object.</p>
<p>Calls <code>obj_delete</code>.</p>
<p>If the resource is deleted, return <code>HttpNoContent</code> (204 No Content).
If the resource did not exist, return <code>Http404</code> (404 Not Found).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.delete_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.delete_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">delete_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Destroys a single resource/object.</span>
<span class="sd">    Calls ``obj_delete``.</span>
<span class="sd">    If the resource is deleted, return ``HttpNoContent`` (204 No Content).</span>
<span class="sd">    If the resource did not exist, return ``Http404`` (404 Not Found).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Manually construct the bundle here, since we don&#39;t want to try to</span>
    <span class="c1"># delete an empty instance.</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="n">Bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">obj_delete</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNoContent</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">NotFound</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNotFound</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.delete_list">
    <p>def <span class="ident">delete_list</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Destroys a collection of resources/objects.</p>
<p>Calls <code>obj_delete_list</code>.</p>
<p>If the resources are deleted, return <code>HttpNoContent</code> (204 No Content).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.delete_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.delete_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">delete_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Destroys a collection of resources/objects.</span>
<span class="sd">    Calls ``obj_delete_list``.</span>
<span class="sd">    If the resources are deleted, return ``HttpNoContent`` (204 No Content).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">obj_delete_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNoContent</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.deserialize">
    <p>def <span class="ident">deserialize</span>(</p><p>self, request, data, format=u&#39;application/json&#39;)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a request, data and a format, deserializes the given data.</p>
<p>It relies on the request properly sending a <code>CONTENT_TYPE</code> header,
falling back to <code>application/json</code> if not provided.</p>
<p>Mostly a hook, this uses the <code>Serializer</code> from <code>Resource._meta</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.deserialize', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.deserialize" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">deserialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s1">&#39;application/json&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a request, data and a format, deserializes the given data.</span>
<span class="sd">    It relies on the request properly sending a ``CONTENT_TYPE`` header,</span>
<span class="sd">    falling back to ``application/json`` if not provided.</span>
<span class="sd">    Mostly a hook, this uses the ``Serializer`` from ``Resource._meta``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">serializer</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="n">format</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">deserialized</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.detail_uri_kwargs">
    <p>def <span class="ident">detail_uri_kwargs</span>(</p><p>self, bundle_or_obj)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a <code>Bundle</code> or an object (typically a <code>Model</code> instance),
it returns the extra kwargs needed to generate a detail URI.</p>
<p>By default, it uses the model's <code>pk</code> in order to create the URI.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.detail_uri_kwargs', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.detail_uri_kwargs" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">detail_uri_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle_or_obj</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a ``Bundle`` or an object (typically a ``Model`` instance),</span>
<span class="sd">    it returns the extra kwargs needed to generate a detail URI.</span>
<span class="sd">    By default, it uses the model&#39;s ``pk`` in order to create the URI.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bundle_or_obj</span><span class="p">,</span> <span class="n">Bundle</span><span class="p">):</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">bundle_or_obj</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">bundle_or_obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">kwargs</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.determine_format">
    <p>def <span class="ident">determine_format</span>(</p><p>self, request)</p>
    </div>
    

    
  
    <div class="desc"><p>Used to determine the desired format.</p>
<p>Largely relies on <code>tastypie.utils.mime.determine_format</code> but here
as a point of extension.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.determine_format', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.determine_format" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">determine_format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Used to determine the desired format.</span>
<span class="sd">    Largely relies on ``tastypie.utils.mime.determine_format`` but here</span>
<span class="sd">    as a point of extension.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">determine_format</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">serializer</span><span class="p">,</span> <span class="n">default_format</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">default_format</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.dispatch">
    <p>def <span class="ident">dispatch</span>(</p><p>self, request_type, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles the common operations (allowed HTTP method, authentication,
throttling, method lookup) surrounding most CRUD interactions.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.dispatch', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.dispatch" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dispatch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request_type</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles the common operations (allowed HTTP method, authentication,</span>
<span class="sd">    throttling, method lookup) surrounding most CRUD interactions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">allowed_methods</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_allowed_methods&quot;</span> <span class="o">%</span> <span class="n">request_type</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;HTTP_X_HTTP_METHOD_OVERRIDE&#39;</span> <span class="ow">in</span> <span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="p">:</span>
        <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="p">[</span><span class="s1">&#39;HTTP_X_HTTP_METHOD_OVERRIDE&#39;</span><span class="p">]</span>
    <span class="n">request_method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">method_check</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">allowed</span><span class="o">=</span><span class="n">allowed_methods</span><span class="p">)</span>
    <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">request_method</span><span class="p">,</span> <span class="n">request_type</span><span class="p">),</span> <span class="bp">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">method</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpNotImplemented</span><span class="p">())</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">throttle_check</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="c1"># All clear. Process the request.</span>
    <span class="n">request</span> <span class="o">=</span> <span class="n">convert_post_to_put</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="c1"># Add the throttled request.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_throttled_access</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="c1"># If what comes back isn&#39;t a ``HttpResponse``, assume that the</span>
    <span class="c1"># request was accepted and that some action occurred. This also</span>
    <span class="c1"># prevents Django from freaking out.</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">HttpResponse</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNoContent</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">response</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.dispatch_detail">
    <p>def <span class="ident">dispatch_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A view for handling the various HTTP methods (GET/POST/PUT/DELETE) on
a single resource.</p>
<p>Relies on <code>Resource.dispatch</code> for the heavy-lifting.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.dispatch_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.dispatch_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dispatch_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A view for handling the various HTTP methods (GET/POST/PUT/DELETE) on</span>
<span class="sd">    a single resource.</span>
<span class="sd">    Relies on ``Resource.dispatch`` for the heavy-lifting.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span><span class="s1">&#39;detail&#39;</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.dispatch_list">
    <p>def <span class="ident">dispatch_list</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A view for handling the various HTTP methods (GET/POST/PUT/DELETE) over
the entire list of resources.</p>
<p>Relies on <code>Resource.dispatch</code> for the heavy-lifting.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.dispatch_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.dispatch_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dispatch_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A view for handling the various HTTP methods (GET/POST/PUT/DELETE) over</span>
<span class="sd">    the entire list of resources.</span>
<span class="sd">    Relies on ``Resource.dispatch`` for the heavy-lifting.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.error_response">
    <p>def <span class="ident">error_response</span>(</p><p>self, request, errors, response_class=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Extracts the common "which-format/serialize/return-error-response"
cycle.</p>
<p>Should be used as much as possible to return errors.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.error_response', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.error_response" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">error_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extracts the common &quot;which-format/serialize/return-error-response&quot;</span>
<span class="sd">    cycle.</span>
<span class="sd">    Should be used as much as possible to return errors.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">response_class</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">response_class</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpBadRequest</span>
    <span class="n">desired_format</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">if</span> <span class="n">request</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;callback&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">desired_format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">determine_format</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">BadRequest</span><span class="p">:</span>
                <span class="k">pass</span>  <span class="c1"># Fall through to default handler below</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># JSONP can cause extra breakage.</span>
            <span class="n">desired_format</span> <span class="o">=</span> <span class="s1">&#39;application/json&#39;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">desired_format</span><span class="p">:</span>
        <span class="n">desired_format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">default_format</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">serialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">desired_format</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">BadRequest</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">error</span> <span class="o">=</span> <span class="s2">&quot;Additional errors occurred, but serialization of those errors failed.&quot;</span>
        <span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">:</span>
            <span class="n">error</span> <span class="o">+=</span> <span class="s2">&quot; </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">e</span>
        <span class="k">return</span> <span class="n">response_class</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">error</span><span class="p">,</span> <span class="n">content_type</span><span class="o">=</span><span class="s1">&#39;text/plain&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response_class</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">serialized</span><span class="p">,</span> <span class="n">content_type</span><span class="o">=</span><span class="n">build_content_type</span><span class="p">(</span><span class="n">desired_format</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.filter_value_to_python">
    <p>def <span class="ident">filter_value_to_python</span>(</p><p>self, value, field_name, filters, filter_expr, filter_type)</p>
    </div>
    

    
  
    <div class="desc"><p>Turn the string <code>value</code> into a python object.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.filter_value_to_python', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.filter_value_to_python" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">filter_value_to_python</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">filters</span><span class="p">,</span> <span class="n">filter_expr</span><span class="p">,</span>
        <span class="n">filter_type</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Turn the string ``value`` into a python object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Simple values</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">string_to_python</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="c1"># Split on &#39;,&#39; if not empty string and either an in or range filter.</span>
    <span class="k">if</span> <span class="n">filter_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="s1">&#39;range&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">filters</span><span class="p">,</span> <span class="s1">&#39;getlist&#39;</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">filters</span><span class="o">.</span><span class="n">getlist</span><span class="p">(</span><span class="n">filter_expr</span><span class="p">):</span>
                <span class="n">value</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">part</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">value</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.full_dehydrate">
    <p>def <span class="ident">full_dehydrate</span>(</p><p>self, bundle, for_list=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a bundle with an object instance, extract the information from it
to populate the resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.full_dehydrate', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.full_dehydrate" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">full_dehydrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">for_list</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a bundle with an object instance, extract the information from it</span>
<span class="sd">    to populate the resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span>
    <span class="n">api_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span>
    <span class="n">resource_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span>
    <span class="c1"># Dehydrate each field.</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># If it&#39;s not for use in this mode, skip</span>
        <span class="n">field_use_in</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">use_in</span>
        <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_use_in</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">field_use_in</span><span class="p">(</span><span class="n">bundle</span><span class="p">):</span>
                <span class="k">continue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">field_use_in</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;list&#39;</span> <span class="k">if</span> <span class="n">for_list</span> <span class="k">else</span> <span class="s1">&#39;detail&#39;</span><span class="p">]:</span>
                <span class="k">continue</span>
        <span class="c1"># A touch leaky but it makes URI resolution work.</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">dehydrated_type</span> <span class="o">==</span> <span class="s1">&#39;related&#39;</span><span class="p">:</span>
            <span class="n">field_object</span><span class="o">.</span><span class="n">api_name</span> <span class="o">=</span> <span class="n">api_name</span>
            <span class="n">field_object</span><span class="o">.</span><span class="n">resource_name</span> <span class="o">=</span> <span class="n">resource_name</span>
        <span class="n">data</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="n">for_list</span><span class="o">=</span><span class="n">for_list</span><span class="p">)</span>
        <span class="c1"># Check for an optional method to do further dehydration.</span>
        <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;dehydrate_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.full_hydrate">
    <p>def <span class="ident">full_hydrate</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a populated bundle, distill it and turn it back into
a full-fledged object instance.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.full_hydrate', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.full_hydrate" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">full_hydrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a populated bundle, distill it and turn it back into</span>
<span class="sd">    a full-fledged object instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="p">()</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">readonly</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># Check for an optional method to do further hydration.</span>
        <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;hydrate_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
            <span class="n">bundle</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
            <span class="c1"># NOTE: We only get back a bundle when it is related field.</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Bundle</span><span class="p">)</span> <span class="ow">and</span> <span class="n">value</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_name</span><span class="p">):</span>
                <span class="n">bundle</span><span class="o">.</span><span class="n">errors</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">errors</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">field_object</span><span class="o">.</span><span class="n">null</span><span class="p">:</span>
                <span class="c1"># We need to avoid populating M2M data here as that will</span>
                <span class="c1"># cause things to blow up.</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_related</span><span class="p">:</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="k">elif</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                        <span class="c1"># NOTE: A bug fix in Django (ticket #18153) fixes incorrect behavior</span>
                        <span class="c1"># which Tastypie was relying on.  To fix this, we store value.obj to</span>
                        <span class="c1"># be saved later in save_related.</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="nb">setattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
                        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">ObjectDoesNotExist</span><span class="p">):</span>
                            <span class="n">bundle</span><span class="o">.</span><span class="n">related_objects_to_save</span><span class="p">[</span><span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">obj</span>
                    <span class="k">elif</span> <span class="n">field_object</span><span class="o">.</span><span class="n">blank</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="k">elif</span> <span class="n">field_object</span><span class="o">.</span><span class="n">null</span><span class="p">:</span>
                        <span class="nb">setattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.generate_cache_key">
    <p>def <span class="ident">generate_cache_key</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Creates a unique-enough cache key.</p>
<p>This is based off the current api_name/resource_name/args/kwargs.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.generate_cache_key', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.generate_cache_key" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">generate_cache_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a unique-enough cache key.</span>
<span class="sd">    This is based off the current api_name/resource_name/args/kwargs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">smooshed</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">=</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
    <span class="c1"># Use a list plus a ``.join()`` because it&#39;s faster than concatenation.</span>
    <span class="k">return</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">args</span><span class="p">),</span> <span class="s1">&#39;:&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">smooshed</span><span class="p">)))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_bundle_detail_data">
    <p>def <span class="ident">get_bundle_detail_data</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Convenience method to return the <code>detail_uri_name</code> attribute off
<code>bundle.obj</code>.</p>
<p>Usually just accesses <code>bundle.obj.pk</code> by default.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_bundle_detail_data', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_bundle_detail_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_bundle_detail_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convenience method to return the ``detail_uri_name`` attribute off</span>
<span class="sd">    ``bundle.obj``.</span>
<span class="sd">    Usually just accesses ``bundle.obj.pk`` by default.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_detail">
    <p>def <span class="ident">get_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns a single serialized resource.
Calls <code>cached_obj_get/obj_get</code> to provide the data, then handles that result
set and serializes it.
Should return a HttpResponse (200 OK).
Get a single CBHCompoundbatches from elasticsearch by running a query</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a single serialized resource.</span>
<span class="sd">    Calls ``cached_obj_get/obj_get`` to provide the data, then handles that result</span>
<span class="sd">    set and serializes it.</span>
<span class="sd">    Should return a HttpResponse (200 OK).</span>
<span class="sd">    Get a single CBHCompoundbatches from elasticsearch by running a query</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">basic_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">allowed_pids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">project_ids</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="n">concatenated_indices</span> <span class="o">=</span> <span class="n">elasticsearch_client</span><span class="o">.</span><span class="n">get_list_of_indicies</span><span class="p">(</span><span class="n">allowed_pids</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">elasticsearch_client</span><span class="o">.</span><span class="n">get_detail_data_elasticsearch</span><span class="p">(</span><span class="n">concatenated_indices</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;pk&quot;</span><span class="p">])</span>   
    
    <span class="n">requested_pid</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;projectfull&quot;</span><span class="p">][</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">requested_pid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_pids</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">(</span><span class="s2">&quot;No permissions for requested project&quot;</span><span class="p">)</span> 
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_fields">
    <p>def <span class="ident">get_fields</span>(</p><p>cls, fields=None, excludes=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Given any explicit fields to include and fields to exclude, add
additional fields based on the associated model.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_fields', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_fields" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">get_fields</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">excludes</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given any explicit fields to include and fields to exclude, add</span>
<span class="sd">    additional fields based on the associated model.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">final_fields</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">fields</span> <span class="o">=</span> <span class="n">fields</span> <span class="ow">or</span> <span class="p">[]</span>
    <span class="n">excludes</span> <span class="o">=</span> <span class="n">excludes</span> <span class="ow">or</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">cls</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">final_fields</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">cls</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
        <span class="c1"># If the field name is already present, skip</span>
        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">cls</span><span class="o">.</span><span class="n">base_fields</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># If field is not present in explicit field listing, skip</span>
        <span class="k">if</span> <span class="n">fields</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># If field is in exclude list, skip</span>
        <span class="k">if</span> <span class="n">excludes</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">excludes</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">cls</span><span class="o">.</span><span class="n">should_skip_field</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="n">api_field_class</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">api_field_from_django_field</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;attribute&#39;</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s1">&#39;help_text&#39;</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">help_text</span><span class="p">,</span>
            <span class="s1">&#39;verbose_name&#39;</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">verbose_name</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">null</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;null&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;unique&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">unique</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">f</span><span class="o">.</span><span class="n">null</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">blank</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;blank&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">get_internal_type</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;TextField&#39;</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">has_default</span><span class="p">():</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">default</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;auto_now&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">auto_now</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;auto_now_add&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">auto_now_add</span>
        <span class="n">final_fields</span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">api_field_class</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">final_fields</span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">instance_name</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span>
    <span class="k">return</span> <span class="n">final_fields</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_list">
    <p>def <span class="ident">get_list</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns a serialized list of resources.
Calls <code>obj_get_list</code> to provide the data, then handles that result
set and serializes it.
Should return a HttpResponse (200 OK).
Get a list of CBHCompoundbatches from elasticsearch by running a query</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a serialized list of resources.</span>
<span class="sd">    Calls ``obj_get_list`` to provide the data, then handles that result</span>
<span class="sd">    set and serializes it.</span>
<span class="sd">    Should return a HttpResponse (200 OK).</span>
<span class="sd">    Get a list of CBHCompoundbatches from elasticsearch by running a query</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">base_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="n">pids</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pids&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">project_ids</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">pids</span><span class="p">:</span>
        <span class="n">project_ids</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">pid</span><span class="p">)</span> <span class="k">for</span> <span class="n">pid</span> <span class="ow">in</span> <span class="n">pids</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)]</span>
    
    <span class="n">allowed_pids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">project_ids</span><span class="p">(</span><span class="n">request</span><span class="p">))</span>
    
    <span class="k">for</span> <span class="n">requested_pid</span> <span class="ow">in</span> <span class="n">project_ids</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">requested_pid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_pids</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">(</span><span class="s2">&quot;No permissions for requested project&quot;</span><span class="p">)</span> 
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">project_ids</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">project_ids</span> <span class="o">=</span> <span class="n">allowed_pids</span>
    <span class="n">queries</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">b64decode</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;encoded_query&quot;</span><span class="p">,</span> <span class="n">EMPTY_ARRAY_B64</span><span class="p">)))</span>
    <span class="n">extra_queries</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;extra_queries&quot;</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">extra_queries</span><span class="p">:</span>
        <span class="c1">#extra queries can be added via kwargs</span>
        <span class="n">queries</span> <span class="o">+=</span> <span class="n">extra_queries</span>
    <span class="c1">#Search for whether this item is archived or not (&quot;archived is indexed as a string&quot;)</span>
    <span class="n">archived</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;archived&quot;</span><span class="p">,</span> <span class="s2">&quot;false&quot;</span><span class="p">)</span>
    <span class="n">queries</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;query_type&quot;</span><span class="p">:</span> <span class="s2">&quot;phrase&quot;</span><span class="p">,</span> <span class="s2">&quot;field_path&quot;</span><span class="p">:</span> <span class="s2">&quot;properties.archived&quot;</span><span class="p">,</span> <span class="s2">&quot;phrase&quot;</span><span class="p">:</span> <span class="n">archived</span><span class="p">})</span>
   
    <span class="n">sorts</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">b64decode</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;encoded_sorts&quot;</span><span class="p">,</span> <span class="n">EMPTY_ARRAY_B64</span><span class="p">)))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sorts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">sorts</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;field_path&quot;</span><span class="p">:</span><span class="s2">&quot;id&quot;</span><span class="p">,</span><span class="s2">&quot;sort_direction&quot;</span><span class="p">:</span><span class="s2">&quot;desc&quot;</span><span class="p">}]</span>
    <span class="n">textsearch</span> <span class="o">=</span> <span class="n">b64decode</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;textsearch&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
    <span class="n">limit</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;limit&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">offset</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;offset&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">autocomplete</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;autocomplete&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">autocomplete_field_path</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;autocomplete_field_path&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">autocomplete_size</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;autocomplete_size&quot;</span><span class="p">,</span> <span class="n">settings</span><span class="o">.</span><span class="n">MAX_AUTOCOMPLETE_SIZE</span><span class="p">)</span>
    <span class="n">pr</span> <span class="o">=</span> <span class="n">ChemregProjectResource</span><span class="p">()</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">get_list</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">do_cache</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">project_content</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
    <span class="n">restricted_fieldnames</span> <span class="o">=</span> <span class="n">project_content</span><span class="p">[</span><span class="s2">&quot;user_restricted_fieldnames&quot;</span><span class="p">]</span>
    <span class="c1">#The project ids list needs to be reduced down</span>
    <span class="c1">#Because we dont support OR queries then every time you query a project for </span>
    <span class="c1">#a field then only the projects that have that field (and unrestricted) need to be shown</span>
    <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">queries</span><span class="p">:</span>
         <span class="n">project_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">check_if_field_restricted</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="s2">&quot;field_path&quot;</span><span class="p">],</span> <span class="n">project_ids</span><span class="p">,</span> <span class="n">restricted_fieldnames</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">autocomplete_field_path</span><span class="p">:</span>
        <span class="n">project_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">check_if_field_restricted</span><span class="p">(</span><span class="n">autocomplete_field_path</span><span class="p">,</span> <span class="n">project_ids</span><span class="p">,</span> <span class="n">restricted_fieldnames</span><span class="p">)</span>
    <span class="n">concatenated_indices</span> <span class="o">=</span> <span class="n">elasticsearch_client</span><span class="o">.</span><span class="n">get_list_of_indicies</span><span class="p">(</span><span class="n">project_ids</span><span class="p">)</span>
    <span class="n">chemical_search_id</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;chemical_search_id&quot;</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
    <span class="n">batch_ids_by_project</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">if</span> <span class="n">chemical_search_id</span><span class="p">:</span>
        <span class="n">batch_result</span> <span class="o">=</span> <span class="n">result</span><span class="p">(</span><span class="n">chemical_search_id</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="mi">20000</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">batch_result</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s1">&#39;{&quot;error&quot;: &quot;Unable to process structure search&quot;}&#39;</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="mi">503</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span> <span class="n">batch_result</span>
            <span class="n">batch_ids_by_project</span> <span class="o">=</span> <span class="n">batch_result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;format&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;sdf&quot;</span> <span class="ow">and</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;format&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;xlsx&quot;</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">elasticsearch_client</span><span class="o">.</span><span class="n">get_list_data_elasticsearch</span><span class="p">(</span><span class="n">queries</span><span class="p">,</span>
            <span class="n">concatenated_indices</span><span class="p">,</span>
            <span class="n">sorts</span><span class="o">=</span><span class="n">sorts</span><span class="p">,</span> 
            <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">,</span> 
            <span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">,</span> 
            <span class="n">textsearch</span><span class="o">=</span><span class="n">textsearch</span><span class="p">,</span> 
            <span class="n">autocomplete</span><span class="o">=</span><span class="n">autocomplete</span><span class="p">,</span>
            <span class="n">autocomplete_field_path</span><span class="o">=</span><span class="n">autocomplete_field_path</span><span class="p">,</span>
            <span class="n">autocomplete_size</span><span class="o">=</span><span class="n">autocomplete_size</span><span class="p">,</span>
            <span class="n">batch_ids_by_project</span><span class="o">=</span><span class="n">batch_ids_by_project</span>
             <span class="p">)</span>
        
        
        <span class="k">if</span> <span class="n">autocomplete_field_path</span><span class="p">:</span>
        
            <span class="n">bucks</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;aggregations&quot;</span><span class="p">][</span><span class="s2">&quot;filtered_field_path&quot;</span><span class="p">][</span><span class="s2">&quot;field_path_terms&quot;</span><span class="p">][</span><span class="s2">&quot;buckets&quot;</span><span class="p">]</span>
            <span class="n">bundledata</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;items&quot;</span> <span class="p">:</span> <span class="n">bucks</span><span class="p">,</span>
                        <span class="s2">&quot;autocomplete&quot;</span> <span class="p">:</span> <span class="n">autocomplete</span><span class="p">,</span>
                        <span class="s2">&quot;unique_count&quot;</span> <span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;aggregations&quot;</span><span class="p">][</span><span class="s2">&quot;filtered_field_path&quot;</span><span class="p">][</span><span class="s2">&quot;unique_count&quot;</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">]}</span>
    
        <span class="k">else</span><span class="p">:</span>
            <span class="n">bundledata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prepare_es_hits</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">bundledata</span><span class="p">[</span><span class="s2">&quot;objects&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">removed_restricted_fields_if_present</span><span class="p">(</span><span class="n">bundledata</span><span class="p">[</span><span class="s2">&quot;objects&quot;</span><span class="p">],</span> <span class="n">restricted_fieldnames</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#Limit , offset and autocomplete have no effect for a project export</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_project_specific_data</span><span class="p">(</span><span class="n">request</span><span class="p">,</span>  <span class="n">queries</span><span class="p">,</span> <span class="n">project_ids</span><span class="p">,</span> <span class="n">sorts</span><span class="p">,</span> <span class="n">textsearch</span><span class="p">,</span> <span class="n">batch_ids_by_project</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span> 
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundledata</span><span class="p">)</span> 
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_multiple">
    <p>def <span class="ident">get_multiple</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns a serialized list of resources based on the identifiers
from the URL.</p>
<p>Calls <code>obj_get</code> to fetch only the objects requested. This method
only responds to HTTP GET.</p>
<p>Should return a HttpResponse (200 OK).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_multiple', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_multiple" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_multiple</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a serialized list of resources based on the identifiers</span>
<span class="sd">    from the URL.</span>
<span class="sd">    Calls ``obj_get`` to fetch only the objects requested. This method</span>
<span class="sd">    only responds to HTTP GET.</span>
<span class="sd">    Should return a HttpResponse (200 OK).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">method_check</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">allowed</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;get&#39;</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">throttle_check</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="c1"># Rip apart the list then iterate.</span>
    <span class="n">kwarg_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_list&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span>
    <span class="n">obj_identifiers</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">kwarg_name</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
    <span class="n">objects</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">not_found</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">base_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">identifier</span> <span class="ow">in</span> <span class="n">obj_identifiers</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">base_bundle</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">:</span> <span class="n">identifier</span><span class="p">})</span>
            <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
            <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="n">for_list</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="n">objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">ObjectDoesNotExist</span><span class="p">,</span> <span class="n">Unauthorized</span><span class="p">):</span>
            <span class="n">not_found</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">identifier</span><span class="p">)</span>
    <span class="n">object_list</span> <span class="o">=</span> <span class="p">{</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">:</span> <span class="n">objects</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">not_found</span><span class="p">):</span>
        <span class="n">object_list</span><span class="p">[</span><span class="s1">&#39;not_found&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">not_found</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_throttled_access</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">object_list</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_object_list">
    <p>def <span class="ident">get_object_list</span>(</p><p>self, request)</p>
    </div>
    

    
  
    <div class="desc"><p>An ORM-specific implementation of <code>get_object_list</code>.</p>
<p>Returns a queryset that may have been limited by other overrides.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_object_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_object_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_object_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An ORM-specific implementation of ``get_object_list``.</span>
<span class="sd">    Returns a queryset that may have been limited by other overrides.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">queryset</span><span class="o">.</span><span class="n">_clone</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_project_specific_data">
    <p>def <span class="ident">get_project_specific_data</span>(</p><p>self, request, queries, pids, sorts, textsearch, batch_ids_by_project)</p>
    </div>
    

    
  
    <div class="desc"><p>When an Excel or SDF download is requested, 
present the data as a
project by project summary so that 
one spreadsheet can be used per project</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_project_specific_data', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_project_specific_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_project_specific_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">queries</span><span class="p">,</span> <span class="n">pids</span><span class="p">,</span> <span class="n">sorts</span><span class="p">,</span> <span class="n">textsearch</span><span class="p">,</span> <span class="n">batch_ids_by_project</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;When an Excel or SDF download is requested, </span>
<span class="sd">    present the data as a</span>
<span class="sd">    project by project summary so that </span>
<span class="sd">    one spreadsheet can be used per project&quot;&quot;&quot;</span>
    <span class="n">to_return</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">pids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pids</span><span class="p">)</span>
    <span class="n">table_schemata</span> <span class="o">=</span> <span class="n">get_schemata</span><span class="p">(</span><span class="n">pids</span><span class="p">,</span> <span class="s2">&quot;export&quot;</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="c1">#We have removed the schema from the index for data efficiency so</span>
    <span class="c1">#We need to pull it out of the project resource</span>
        
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">proj_data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">table_schemata</span><span class="p">):</span>
        <span class="n">table_schema_for_project</span> <span class="o">=</span> <span class="n">proj_data</span><span class="p">[</span><span class="s2">&quot;tabular_data_schema&quot;</span><span class="p">][</span><span class="s2">&quot;for_export&quot;</span><span class="p">]</span>
        <span class="n">pid</span> <span class="o">=</span> <span class="n">pids</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="n">proj_index</span> <span class="o">=</span> <span class="n">elasticsearch_client</span><span class="o">.</span><span class="n">get_project_index_name</span><span class="p">(</span><span class="n">pid</span><span class="p">)</span>
        <span class="n">es_data</span> <span class="o">=</span> <span class="n">elasticsearch_client</span><span class="o">.</span><span class="n">get_list_data_elasticsearch</span><span class="p">(</span><span class="n">queries</span><span class="p">,</span>
                <span class="n">proj_index</span><span class="p">,</span>
                <span class="n">sorts</span><span class="o">=</span><span class="n">sorts</span><span class="p">,</span> 
                <span class="n">textsearch</span><span class="o">=</span><span class="n">textsearch</span><span class="p">,</span>
                <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">limit</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
                <span class="n">batch_ids_by_project</span><span class="o">=</span><span class="n">batch_ids_by_project</span> <span class="p">)</span>
        <span class="n">standardised</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prepare_es_hits</span><span class="p">(</span><span class="n">es_data</span><span class="p">)</span>
        <span class="n">standardised</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">proj_data</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
        <span class="n">standardised</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pid</span>
        <span class="n">standardised</span><span class="p">[</span><span class="s2">&quot;schema&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">table_schema_for_project</span>
        <span class="n">base</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;wsgi.url_scheme&quot;</span><span class="p">,</span><span class="s2">&quot;http&quot;</span><span class="p">)</span> 
        <span class="n">base</span> <span class="o">+=</span> <span class="s2">&quot;://&quot;</span>
        <span class="n">base</span> <span class="o">+=</span> <span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;HTTP_HOST&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">standardised</span><span class="p">[</span><span class="s2">&quot;schema&quot;</span><span class="p">]:</span>
            <span class="n">field</span><span class="p">[</span><span class="s2">&quot;base_url&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">base</span>
        <span class="n">to_return</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">standardised</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;format&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;sdf&quot;</span><span class="p">:</span>
        <span class="c1">#For the Excel sheet print out the query used</span>
        <span class="n">query_reps</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;fieldn&quot;</span><span class="p">:</span> <span class="s2">&quot;Project&quot;</span><span class="p">,</span> <span class="s2">&quot;pick_from_list&quot;</span><span class="p">:</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">ret</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span> <span class="k">for</span> <span class="n">ret</span> <span class="ow">in</span> <span class="n">to_return</span><span class="p">])</span> <span class="p">}]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">q</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">queries</span><span class="p">):</span>
            <span class="n">qrep</span> <span class="o">=</span> <span class="p">{</span><span class="n">qtype</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="p">:</span> <span class="s2">u&quot;&quot;</span> <span class="k">for</span> <span class="n">qtype</span> <span class="ow">in</span> <span class="n">settings</span><span class="o">.</span><span class="n">CBH_QUERY_TYPES</span><span class="p">}</span>
            <span class="n">qrep</span><span class="p">[</span><span class="s2">&quot;fieldn&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">q</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;pick_from_list&quot;</span><span class="p">:</span>
                    <span class="n">qrep</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;field_path&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
                        <span class="n">knownBy</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">TABULAR_DATA_SETTINGS</span><span class="p">[</span><span class="s2">&quot;schema&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">value</span><span class="p">,{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;knownBy&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">knownBy</span><span class="p">:</span>
                            <span class="n">knownBy</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                        <span class="n">qrep</span><span class="p">[</span><span class="s2">&quot;fieldn&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">l</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">knownBy</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">qrep</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="n">qrep</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
            <span class="n">query_reps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">qrep</span><span class="p">)</span>
        <span class="n">schem</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;knownBy&quot;</span> <span class="p">:</span> <span class="s2">&quot;Row&quot;</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;fieldn&quot;</span><span class="p">,</span> <span class="s2">&quot;knownBy&quot;</span> <span class="p">:</span> <span class="s2">&quot;Col&quot;</span><span class="p">}]</span> <span class="o">+</span> <span class="p">[{</span><span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">qtype</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">],</span> <span class="s2">&quot;knownBy&quot;</span> <span class="p">:</span> <span class="n">qtype</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]}</span> <span class="k">for</span> <span class="n">qtype</span> <span class="ow">in</span> <span class="n">settings</span><span class="o">.</span><span class="n">CBH_QUERY_TYPES</span><span class="p">]</span>
        <span class="n">query_summary</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;_Query Used&quot;</span><span class="p">,</span>
                <span class="s2">&quot;objects&quot;</span> <span class="p">:</span> <span class="n">query_reps</span><span class="p">,</span>
                <span class="s2">&quot;schema&quot;</span> <span class="p">:</span> <span class="n">schem</span>
                <span class="p">}</span>
        <span class="n">to_return</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">query_summary</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">to_return</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_resource_uri">
    <p>def <span class="ident">get_resource_uri</span>(</p><p>self, bundle_or_obj=None, url_name=u&#39;api_dispatch_list&#39;)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles generating a resource URI.</p>
<p>If the <code>bundle_or_obj</code> argument is not provided, it builds the URI
for the list endpoint.</p>
<p>If the <code>bundle_or_obj</code> argument is provided, it builds the URI for
the detail endpoint.</p>
<p>Return the generated URI. If that URI can not be reversed (not found
in the URLconf), it will return an empty string.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_resource_uri', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_resource_uri" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_resource_uri</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle_or_obj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">url_name</span><span class="o">=</span><span class="s1">&#39;api_dispatch_list&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles generating a resource URI.</span>
<span class="sd">    If the ``bundle_or_obj`` argument is not provided, it builds the URI</span>
<span class="sd">    for the list endpoint.</span>
<span class="sd">    If the ``bundle_or_obj`` argument is provided, it builds the URI for</span>
<span class="sd">    the detail endpoint.</span>
<span class="sd">    Return the generated URI. If that URI can not be reversed (not found</span>
<span class="sd">    in the URLconf), it will return an empty string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">bundle_or_obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">url_name</span> <span class="o">=</span> <span class="s1">&#39;api_dispatch_detail&#39;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_reverse_url</span><span class="p">(</span><span class="n">url_name</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resource_uri_kwargs</span><span class="p">(</span><span class="n">bundle_or_obj</span><span class="p">))</span>
    <span class="k">except</span> <span class="n">NoReverseMatch</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_schema">
    <p>def <span class="ident">get_schema</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns a serialized form of the schema of the resource.</p>
<p>Calls <code>build_schema</code> to generate the data. This method only responds
to HTTP GET.</p>
<p>Should return a HttpResponse (200 OK).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_schema', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_schema" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a serialized form of the schema of the resource.</span>
<span class="sd">    Calls ``build_schema`` to generate the data. This method only responds</span>
<span class="sd">    to HTTP GET.</span>
<span class="sd">    Should return a HttpResponse (200 OK).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">method_check</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">allowed</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;get&#39;</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">throttle_check</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_throttled_access</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">authorized_read_detail</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">),</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_schema</span><span class="p">())</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_via_uri">
    <p>def <span class="ident">get_via_uri</span>(</p><p>self, uri, request=None)</p>
    </div>
    

    
  
    <div class="desc"><p>This pulls apart the salient bits of the URI and populates the
resource via a <code>obj_get</code>.</p>
<p>Optionally accepts a <code>request</code>.</p>
<p>If you need custom behavior based on other portions of the URI,
simply override this method.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_via_uri', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_via_uri" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_via_uri</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uri</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This pulls apart the salient bits of the URI and populates the</span>
<span class="sd">    resource via a ``obj_get``.</span>
<span class="sd">    Optionally accepts a ``request``.</span>
<span class="sd">    If you need custom behavior based on other portions of the URI,</span>
<span class="sd">    simply override this method.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="n">get_script_prefix</span><span class="p">()</span>
    <span class="n">chomped_uri</span> <span class="o">=</span> <span class="n">uri</span>
    <span class="k">if</span> <span class="n">prefix</span> <span class="ow">and</span> <span class="n">chomped_uri</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">prefix</span><span class="p">):</span>
        <span class="n">chomped_uri</span> <span class="o">=</span> <span class="n">chomped_uri</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:]</span>
    <span class="c1"># We mangle the path a bit further &amp; run URL resolution against *only*</span>
    <span class="c1"># the current class. This ought to prevent bad URLs from resolving to</span>
    <span class="c1"># incorrect data.</span>
    <span class="n">found_at</span> <span class="o">=</span> <span class="n">chomped_uri</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">found_at</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">NotFound</span><span class="p">(</span><span class="s2">&quot;An incorrect URL was provided &#39;</span><span class="si">%s</span><span class="s2">&#39; for the &#39;</span><span class="si">%s</span><span class="s2">&#39; resource.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">))</span>
    <span class="n">chomped_uri</span> <span class="o">=</span> <span class="n">chomped_uri</span><span class="p">[</span><span class="n">found_at</span><span class="p">:]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">url_resolver</span> <span class="ow">in</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;urls&#39;</span><span class="p">,</span> <span class="p">[]):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">url_resolver</span><span class="o">.</span><span class="n">resolve</span><span class="p">(</span><span class="n">chomped_uri</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">view</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span> <span class="o">=</span> <span class="n">result</span>
                <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Resolver404</span><span class="p">(</span><span class="s2">&quot;URI not found in &#39;self.urls&#39;.&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">Resolver404</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">NotFound</span><span class="p">(</span><span class="s2">&quot;The URL provided &#39;</span><span class="si">%s</span><span class="s2">&#39; was not a link to a valid resource.&quot;</span> <span class="o">%</span> <span class="n">uri</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.hydrate">
    <p>def <span class="ident">hydrate</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.hydrate', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.hydrate" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">hydrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">created_by_id</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.hydrate_blinded_batch_id">
    <p>def <span class="ident">hydrate_blinded_batch_id</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Hydrate functions are run before save of a new or updated model instance
This one ensures that the blinded batch id is filled in in cases where an inventory item 
with no ModelculeDictionary attribute (related_molregno)</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.hydrate_blinded_batch_id', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.hydrate_blinded_batch_id" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">hydrate_blinded_batch_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Hydrate functions are run before save of a new or updated model instance</span>
<span class="sd">    This one ensures that the blinded batch id is filled in in cases where an inventory item </span>
<span class="sd">    with no ModelculeDictionary attribute (related_molregno)&quot;&quot;&quot;</span> 
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;blinded_batch_id&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">u&quot;EMPTY_ID&quot;</span><span class="p">:</span>
        <span class="n">uox_id</span> <span class="o">=</span> <span class="n">generate_uox_id</span><span class="p">()</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;blinded_batch_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">uox_id</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">blinded_batch_id</span> <span class="o">=</span> <span class="n">uox_id</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.hydrate_m2m">
    <p>def <span class="ident">hydrate_m2m</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Populate the ManyToMany data on the instance.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.hydrate_m2m', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.hydrate_m2m" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">hydrate_m2m</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Populate the ManyToMany data on the instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrationError</span><span class="p">(</span><span class="s2">&quot;You must call &#39;full_hydrate&#39; before attempting to run &#39;hydrate_m2m&#39; on </span><span class="si">%r</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span>
            <span class="c1"># Note that we only hydrate the data, leaving the instance</span>
            <span class="c1"># unmodified. It&#39;s up to the user&#39;s code to handle this.</span>
            <span class="c1"># The ``ModelResource`` provides a working baseline</span>
            <span class="c1"># in this regard.</span>
            <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">hydrate_m2m</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;hydrate_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
            <span class="n">method</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.is_authenticated">
    <p>def <span class="ident">is_authenticated</span>(</p><p>self, request)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking if the user is authenticated and dealing with
unauthenticated users.</p>
<p>Mostly a hook, this uses class assigned to <code>authentication</code> from
<code>Resource._meta</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.is_authenticated', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.is_authenticated" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">is_authenticated</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking if the user is authenticated and dealing with</span>
<span class="sd">    unauthenticated users.</span>
<span class="sd">    Mostly a hook, this uses class assigned to ``authentication`` from</span>
<span class="sd">    ``Resource._meta``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Authenticate the request as needed.</span>
    <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authentication</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">auth_result</span><span class="p">,</span> <span class="n">HttpResponse</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">auth_result</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">auth_result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpUnauthorized</span><span class="p">())</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.is_valid">
    <p>def <span class="ident">is_valid</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking if the data provided by the user is valid.</p>
<p>Mostly a hook, this uses class assigned to <code>validation</code> from
<code>Resource._meta</code>.</p>
<p>If validation fails, an error is raised with the error messages
serialized inside it.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.is_valid', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.is_valid" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking if the data provided by the user is valid.</span>
<span class="sd">    Mostly a hook, this uses class assigned to ``validation`` from</span>
<span class="sd">    ``Resource._meta``.</span>
<span class="sd">    If validation fails, an error is raised with the error messages</span>
<span class="sd">    serialized inside it.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">validation</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">errors</span><span class="p">:</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">errors</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">errors</span>
        <span class="k">return</span> <span class="bp">False</span>
    <span class="k">return</span> <span class="bp">True</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.log_throttled_access">
    <p>def <span class="ident">log_throttled_access</span>(</p><p>self, request)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles the recording of the user's access for throttling purposes.</p>
<p>Mostly a hook, this uses class assigned to <code>throttle</code> from
<code>Resource._meta</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.log_throttled_access', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.log_throttled_access" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">log_throttled_access</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles the recording of the user&#39;s access for throttling purposes.</span>
<span class="sd">    Mostly a hook, this uses class assigned to ``throttle`` from</span>
<span class="sd">    ``Resource._meta``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">request_method</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">throttle</span><span class="o">.</span><span class="n">accessed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authentication</span><span class="o">.</span><span class="n">get_identifier</span><span class="p">(</span><span class="n">request</span><span class="p">),</span> <span class="n">url</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">get_full_path</span><span class="p">(),</span> <span class="n">request_method</span><span class="o">=</span><span class="n">request_method</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.lookup_kwargs_with_identifiers">
    <p>def <span class="ident">lookup_kwargs_with_identifiers</span>(</p><p>self, bundle, kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Kwargs here represent uri identifiers Ex: /repos/<user_id>/<repo_name>/
We need to turn those identifiers into Python objects for generating
lookup parameters that can find them in the DB</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.lookup_kwargs_with_identifiers', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.lookup_kwargs_with_identifiers" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">lookup_kwargs_with_identifiers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Kwargs here represent uri identifiers Ex: /repos/&lt;user_id&gt;/&lt;repo_name&gt;/</span>
<span class="sd">    We need to turn those identifiers into Python objects for generating</span>
<span class="sd">    lookup parameters that can find them in the DB</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lookup_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">)</span><span class="o">.</span><span class="n">model</span><span class="p">()</span>
    <span class="c1"># Override data values, we rely on uri identifiers</span>
    <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="c1"># We&#39;re going to manually hydrate, as opposed to calling</span>
    <span class="c1"># ``full_hydrate``, to ensure we don&#39;t try to flesh out related</span>
    <span class="c1"># resources &amp; keep things speedy.</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">identifier</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">identifier</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">:</span>
            <span class="n">lookup_kwargs</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span>
            <span class="k">continue</span>
        <span class="n">field_object</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span>
        <span class="c1"># Skip readonly or related fields.</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">readonly</span> <span class="ow">is</span> <span class="bp">True</span> <span class="ow">or</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_related</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># Check for an optional method to do further hydration.</span>
        <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;hydrate_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">identifier</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
            <span class="n">bundle</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="n">lookup_kwargs</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
    <span class="k">return</span> <span class="n">lookup_kwargs</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.method_check">
    <p>def <span class="ident">method_check</span>(</p><p>self, request, allowed=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Ensures that the HTTP method used on the request is allowed to be
handled by the resource.</p>
<p>Takes an <code>allowed</code> parameter, which should be a list of lowercase
HTTP methods to check against. Usually, this looks like::</p>
<div class="codehilite"><pre><span></span># The most generic lookup.
self.method_check(request, self._meta.allowed_methods)

# A lookup against what&#39;s allowed for list-type methods.
self.method_check(request, self._meta.list_allowed_methods)

# A useful check when creating a new endpoint that only handles
# GET.
self.method_check(request, [&#39;get&#39;])
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.method_check', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.method_check" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">method_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">allowed</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Ensures that the HTTP method used on the request is allowed to be</span>
<span class="sd">    handled by the resource.</span>
<span class="sd">    Takes an ``allowed`` parameter, which should be a list of lowercase</span>
<span class="sd">    HTTP methods to check against. Usually, this looks like::</span>
<span class="sd">        # The most generic lookup.</span>
<span class="sd">        self.method_check(request, self._meta.allowed_methods)</span>
<span class="sd">        # A lookup against what&#39;s allowed for list-type methods.</span>
<span class="sd">        self.method_check(request, self._meta.list_allowed_methods)</span>
<span class="sd">        # A useful check when creating a new endpoint that only handles</span>
<span class="sd">        # GET.</span>
<span class="sd">        self.method_check(request, [&#39;get&#39;])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">allowed</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">allowed</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">request_method</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">allows</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">meth</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">allowed</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">request_method</span> <span class="o">==</span> <span class="s2">&quot;options&quot;</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="n">allows</span><span class="p">)</span>
        <span class="n">response</span><span class="p">[</span><span class="s1">&#39;Allow&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">allows</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">request_method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpMethodNotAllowed</span><span class="p">(</span><span class="n">allows</span><span class="p">)</span>
        <span class="n">response</span><span class="p">[</span><span class="s1">&#39;Allow&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">allows</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">request_method</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_create">
    <p>def <span class="ident">obj_create</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A ORM-specific implementation of <code>obj_create</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_create', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_create" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_create``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_delete">
    <p>def <span class="ident">obj_delete</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A ORM-specific implementation of <code>obj_delete</code>.</p>
<p>Takes optional <code>kwargs</code>, which are used to narrow the query to find
the instance.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_delete', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_delete" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_delete``.</span>
<span class="sd">    Takes optional ``kwargs``, which are used to narrow the query to find</span>
<span class="sd">    the instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="s1">&#39;delete&#39;</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ObjectDoesNotExist</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NotFound</span><span class="p">(</span><span class="s2">&quot;A model instance matching the provided arguments could not be found.&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">authorized_delete_detail</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">),</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_delete_list">
    <p>def <span class="ident">obj_delete_list</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A ORM-specific implementation of <code>obj_delete_list</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_delete_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_delete_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_delete_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_delete_list``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">objects_to_delete</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">deletable_objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">authorized_delete_list</span><span class="p">(</span><span class="n">objects_to_delete</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">deletable_objects</span><span class="p">,</span> <span class="s1">&#39;delete&#39;</span><span class="p">):</span>
        <span class="c1"># It&#39;s likely a ``QuerySet``. Call ``.delete()`` for efficiency.</span>
        <span class="n">deletable_objects</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">authed_obj</span> <span class="ow">in</span> <span class="n">deletable_objects</span><span class="p">:</span>
            <span class="n">authed_obj</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_delete_list_for_update">
    <p>def <span class="ident">obj_delete_list_for_update</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A ORM-specific implementation of <code>obj_delete_list_for_update</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_delete_list_for_update', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_delete_list_for_update" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_delete_list_for_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_delete_list_for_update``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">objects_to_delete</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">deletable_objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">authorized_update_list</span><span class="p">(</span><span class="n">objects_to_delete</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">deletable_objects</span><span class="p">,</span> <span class="s1">&#39;delete&#39;</span><span class="p">):</span>
        <span class="c1"># It&#39;s likely a ``QuerySet``. Call ``.delete()`` for efficiency.</span>
        <span class="n">deletable_objects</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">authed_obj</span> <span class="ow">in</span> <span class="n">deletable_objects</span><span class="p">:</span>
            <span class="n">authed_obj</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_get">
    <p>def <span class="ident">obj_get</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A ORM-specific implementation of <code>obj_get</code>.</p>
<p>Takes optional <code>kwargs</code>, which are used to narrow the query to find
the instance.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_get', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_get" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_get``.</span>
<span class="sd">    Takes optional ``kwargs``, which are used to narrow the query to find</span>
<span class="sd">    the instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># prevents FieldError when looking up nested resources containing extra data</span>
    <span class="n">field_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">get_all_field_names</span><span class="p">()</span>
    <span class="n">field_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;pk&#39;</span><span class="p">)</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">field_names</span><span class="p">}</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">object_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">stringified_kwargs</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">=</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">object_list</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="o">.</span><span class="n">DoesNotExist</span><span class="p">(</span><span class="s2">&quot;Couldn&#39;t find an instance of &#39;</span><span class="si">%s</span><span class="s2">&#39; which matched &#39;</span><span class="si">%s</span><span class="s2">&#39;.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">stringified_kwargs</span><span class="p">))</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">object_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MultipleObjectsReturned</span><span class="p">(</span><span class="s2">&quot;More than &#39;</span><span class="si">%s</span><span class="s2">&#39; matched &#39;</span><span class="si">%s</span><span class="s2">&#39;.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">stringified_kwargs</span><span class="p">))</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">object_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">authorized_read_detail</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">NotFound</span><span class="p">(</span><span class="s2">&quot;Invalid resource lookup data provided (mismatched type).&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_get_list">
    <p>def <span class="ident">obj_get_list</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A ORM-specific implementation of <code>obj_get_list</code>.</p>
<p>Takes an optional <code>request</code> object, whose <code>GET</code> dictionary can be
used to narrow the query.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_get_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_get_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_get_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_get_list``.</span>
<span class="sd">    Takes an optional ``request`` object, whose ``GET`` dictionary can be</span>
<span class="sd">    used to narrow the query.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">filters</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;GET&#39;</span><span class="p">):</span>
        <span class="c1"># Grab a mutable copy.</span>
        <span class="n">filters</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="c1"># Update with the provided kwargs.</span>
    <span class="n">filters</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">applicable_filters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_filters</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_filters</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">,</span> <span class="n">applicable_filters</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">authorized_read_list</span><span class="p">(</span><span class="n">objects</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">BadRequest</span><span class="p">(</span><span class="s2">&quot;Invalid resource lookup data provided (mismatched type).&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_update">
    <p>def <span class="ident">obj_update</span>(</p><p>self, bundle, skip_errors=False, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A ORM-specific implementation of <code>obj_update</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_update', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_update" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">skip_errors</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_update``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bundle_detail_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bundle_detail_data</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="n">arg_detail_data</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">bundle_detail_data</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">arg_detail_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="nb">str</span><span class="p">(</span><span class="n">bundle_detail_data</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">str</span><span class="p">(</span><span class="n">arg_detail_data</span><span class="p">)):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">lookup_kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lookup_kwargs_with_identifiers</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="c1"># if there is trouble hydrating the data, fall back to just</span>
            <span class="c1"># using kwargs by itself (usually it only contains a &quot;pk&quot; key</span>
            <span class="c1"># and this will work fine.</span>
            <span class="n">lookup_kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">lookup_kwargs</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ObjectDoesNotExist</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NotFound</span><span class="p">(</span><span class="s2">&quot;A model instance matching the provided arguments could not be found.&quot;</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="n">skip_errors</span><span class="o">=</span><span class="n">skip_errors</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.override_urls">
    <p>def <span class="ident">override_urls</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Deprecated. Will be removed by v1.0.0. Please use <code>prepend_urls</code> instead.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.override_urls', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.override_urls" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">override_urls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Deprecated. Will be removed by v1.0.0. Please use ``prepend_urls`` instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.patch_detail">
    <p>def <span class="ident">patch_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Updates a resource in-place.</p>
<p>Calls <code>obj_update</code>.</p>
<p>If the resource is updated, return <code>HttpAccepted</code> (202 Accepted).
If the resource did not exist, return <code>HttpNotFound</code> (404 Not Found).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.patch_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.patch_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">patch_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates a resource in-place.</span>
<span class="sd">    Calls ``obj_update``.</span>
<span class="sd">    If the resource is updated, return ``HttpAccepted`` (202 Accepted).</span>
<span class="sd">    If the resource did not exist, return ``HttpNotFound`` (404 Not Found).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">request</span> <span class="o">=</span> <span class="n">convert_post_to_patch</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="n">basic_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="c1"># We want to be able to validate the update, but we can&#39;t just pass</span>
    <span class="c1"># the partial data into the validator since all data needs to be</span>
    <span class="c1"># present. Instead, we basically simulate a PUT by pulling out the</span>
    <span class="c1"># original data and updating it in-place.</span>
    <span class="c1"># So first pull out the original object. This is essentially</span>
    <span class="c1"># ``get_detail``.</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cached_obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">basic_bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="k">except</span> <span class="n">ObjectDoesNotExist</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNotFound</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">MultipleObjectsReturned</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpMultipleChoices</span><span class="p">(</span><span class="s2">&quot;More than one resource is found at this URI.&quot;</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="c1"># Now update the bundle in-place.</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">update_in_place</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">deserialized</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">always_return_data</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpAccepted</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Invalidate prefetched_objects_cache for bundled object</span>
        <span class="c1"># because we might have changed a prefetched field</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_prefetched_objects_cache</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpAccepted</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.patch_list">
    <p>def <span class="ident">patch_list</span>(</p><p>*args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>An ORM-specific implementation of <code>patch_list</code>.</p>
<p>Necessary because PATCH should be atomic (all-success or all-fail)
and the only way to do this neatly is at the database level.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.patch_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.patch_list" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@wraps</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">assigned</span><span class="o">=</span><span class="n">available_attrs</span><span class="p">(</span><span class="n">func</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">with</span> <span class="bp">self</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.post_detail">
    <p>def <span class="ident">post_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Creates a new subcollection of the resource under a resource.</p>
<p>This is not implemented by default because most people's data models
aren't self-referential.</p>
<p>If a new resource is created, return <code>HttpCreated</code> (201 Created).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.post_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.post_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">post_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a new subcollection of the resource under a resource.</span>
<span class="sd">    This is not implemented by default because most people&#39;s data models</span>
<span class="sd">    aren&#39;t self-referential.</span>
<span class="sd">    If a new resource is created, return ``HttpCreated`` (201 Created).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNotImplemented</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.post_list">
    <p>def <span class="ident">post_list</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Creates a new resource/object with the provided data.</p>
<p>Calls <code>obj_create</code> with the provided data and returns a response
with the new resource's location.</p>
<p>If a new resource is created, return <code>HttpCreated</code> (201 Created).
If <code>Meta.always_return_data = True</code>, there will be a populated body
of serialized data.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.post_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.post_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">post_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a new resource/object with the provided data.</span>
<span class="sd">    Calls ``obj_create`` with the provided data and returns a response</span>
<span class="sd">    with the new resource&#39;s location.</span>
<span class="sd">    If a new resource is created, return ``HttpCreated`` (201 Created).</span>
<span class="sd">    If ``Meta.always_return_data = True``, there will be a populated body</span>
<span class="sd">    of serialized data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">))</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_deserialized_detail_data</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">deserialized</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dict_strip_unicode_keys</span><span class="p">(</span><span class="n">deserialized</span><span class="p">),</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_create</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="n">location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_uri</span><span class="p">(</span><span class="n">updated_bundle</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">always_return_data</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpCreated</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">updated_bundle</span><span class="p">)</span>
        <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpCreated</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.prepare_es_hits">
    <p>def <span class="ident">prepare_es_hits</span>(</p><p>self, hits)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.prepare_es_hits', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.prepare_es_hits" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">prepare_es_hits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hits</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;objects&quot;</span><span class="p">:</span> 
                        <span class="p">[</span><span class="n">hit</span><span class="p">[</span><span class="s2">&quot;_source&quot;</span><span class="p">][</span><span class="s2">&quot;dataset&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">hit</span> <span class="ow">in</span> <span class="n">hits</span><span class="p">[</span><span class="s2">&quot;hits&quot;</span><span class="p">][</span><span class="s2">&quot;hits&quot;</span><span class="p">]],</span>
                        <span class="s2">&quot;meta&quot;</span> <span class="p">:</span> <span class="p">{</span><span class="s2">&quot;total_count&quot;</span> <span class="p">:</span> <span class="n">hits</span><span class="p">[</span><span class="s2">&quot;hits&quot;</span><span class="p">][</span><span class="s2">&quot;total&quot;</span><span class="p">]}</span>
                        <span class="p">}</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.prepend_urls">
    <p>def <span class="ident">prepend_urls</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>A hook for adding your own URLs or matching before the default URLs.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.prepend_urls', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.prepend_urls" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">prepend_urls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook for adding your own URLs or matching before the default URLs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.put_detail">
    <p>def <span class="ident">put_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Either updates an existing resource or creates a new one with the
provided data.</p>
<p>Calls <code>obj_update</code> with the provided data first, but falls back to
<code>obj_create</code> if the object does not already exist.</p>
<p>If a new resource is created, return <code>HttpCreated</code> (201 Created).
If <code>Meta.always_return_data = True</code>, there will be a populated body
of serialized data.</p>
<p>If an existing resource is modified and
<code>Meta.always_return_data = False</code> (default), return <code>HttpNoContent</code>
(204 No Content).
If an existing resource is modified and
<code>Meta.always_return_data = True</code>, return <code>HttpAccepted</code> (200
OK).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.put_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.put_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">put_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Either updates an existing resource or creates a new one with the</span>
<span class="sd">    provided data.</span>
<span class="sd">    Calls ``obj_update`` with the provided data first, but falls back to</span>
<span class="sd">    ``obj_create`` if the object does not already exist.</span>
<span class="sd">    If a new resource is created, return ``HttpCreated`` (201 Created).</span>
<span class="sd">    If ``Meta.always_return_data = True``, there will be a populated body</span>
<span class="sd">    of serialized data.</span>
<span class="sd">    If an existing resource is modified and</span>
<span class="sd">    ``Meta.always_return_data = False`` (default), return ``HttpNoContent``</span>
<span class="sd">    (204 No Content).</span>
<span class="sd">    If an existing resource is modified and</span>
<span class="sd">    ``Meta.always_return_data = True``, return ``HttpAccepted`` (200</span>
<span class="sd">    OK).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">))</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_deserialized_detail_data</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">deserialized</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dict_strip_unicode_keys</span><span class="p">(</span><span class="n">deserialized</span><span class="p">),</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_update</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">always_return_data</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNoContent</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Invalidate prefetched_objects_cache for bundled object</span>
            <span class="c1"># because we might have changed a prefetched field</span>
            <span class="n">updated_bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_prefetched_objects_cache</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">updated_bundle</span><span class="p">)</span>
            <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="p">(</span><span class="n">NotFound</span><span class="p">,</span> <span class="n">MultipleObjectsReturned</span><span class="p">):</span>
        <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_create</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="n">location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_uri</span><span class="p">(</span><span class="n">updated_bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">always_return_data</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpCreated</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">updated_bundle</span><span class="p">)</span>
            <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpCreated</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.put_list">
    <p>def <span class="ident">put_list</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Replaces a collection of resources with another collection.</p>
<p>Calls <code>delete_list</code> to clear out the collection then <code>obj_create</code>
with the provided the data to create the new collection.</p>
<p>Return <code>HttpNoContent</code> (204 No Content) if
<code>Meta.always_return_data = False</code> (default).</p>
<p>Return <code>HttpAccepted</code> (200 OK) if
<code>Meta.always_return_data = True</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.put_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.put_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">put_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Replaces a collection of resources with another collection.</span>
<span class="sd">    Calls ``delete_list`` to clear out the collection then ``obj_create``</span>
<span class="sd">    with the provided the data to create the new collection.</span>
<span class="sd">    Return ``HttpNoContent`` (204 No Content) if</span>
<span class="sd">    ``Meta.always_return_data = False`` (default).</span>
<span class="sd">    Return ``HttpAccepted`` (200 OK) if</span>
<span class="sd">    ``Meta.always_return_data = True``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">))</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_deserialized_list_data</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">deserialized</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">deserialized</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">BadRequest</span><span class="p">(</span><span class="s2">&quot;Invalid data sent: missing &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">)</span>
    <span class="n">basic_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">obj_delete_list_for_update</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">basic_bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="n">bundles_seen</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">object_data</span> <span class="ow">in</span> <span class="n">deserialized</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">]:</span>
        <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dict_strip_unicode_keys</span><span class="p">(</span><span class="n">object_data</span><span class="p">),</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
        <span class="c1"># Attempt to be transactional, deleting any previously created</span>
        <span class="c1"># objects if validation fails.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">obj_create</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
            <span class="n">bundles_seen</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ImmediateHttpResponse</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rollback</span><span class="p">(</span><span class="n">bundles_seen</span><span class="p">)</span>
            <span class="k">raise</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">always_return_data</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNoContent</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">to_be_serialized</span> <span class="o">=</span> <span class="p">{</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">:</span> <span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">for_list</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">bundles_seen</span>
            <span class="p">]</span>
        <span class="p">}</span>
        <span class="n">to_be_serialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_list_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">to_be_serialized</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">to_be_serialized</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.remove_api_resource_names">
    <p>def <span class="ident">remove_api_resource_names</span>(</p><p>self, url_dict)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a dictionary of regex matches from a URLconf, removes
<code>api_name</code> and/or <code>resource_name</code> if found.</p>
<p>This is useful for converting URLconf matches into something suitable
for data lookup. For example::</p>
<div class="codehilite"><pre><span></span>Model.objects.filter(**self.remove_api_resource_names(matches))
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.remove_api_resource_names', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.remove_api_resource_names" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">remove_api_resource_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url_dict</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a dictionary of regex matches from a URLconf, removes</span>
<span class="sd">    ``api_name`` and/or ``resource_name`` if found.</span>
<span class="sd">    This is useful for converting URLconf matches into something suitable</span>
<span class="sd">    for data lookup. For example::</span>
<span class="sd">        Model.objects.filter(**self.remove_api_resource_names(matches))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kwargs_subset</span> <span class="o">=</span> <span class="n">url_dict</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;api_name&#39;</span><span class="p">,</span> <span class="s1">&#39;resource_name&#39;</span><span class="p">]:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">del</span><span class="p">(</span><span class="n">kwargs_subset</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">pass</span>
    <span class="k">return</span> <span class="n">kwargs_subset</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.resource_uri_kwargs">
    <p>def <span class="ident">resource_uri_kwargs</span>(</p><p>self, bundle_or_obj=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Builds a dictionary of kwargs to help generate URIs.</p>
<p>Automatically provides the <code>Resource.Meta.resource_name</code> (and
optionally the <code>Resource.Meta.api_name</code> if populated by an <code>Api</code>
object).</p>
<p>If the <code>bundle_or_obj</code> argument is provided, it calls
<code>Resource.detail_uri_kwargs</code> for additional bits to create</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.resource_uri_kwargs', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.resource_uri_kwargs" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">resource_uri_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle_or_obj</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Builds a dictionary of kwargs to help generate URIs.</span>
<span class="sd">    Automatically provides the ``Resource.Meta.resource_name`` (and</span>
<span class="sd">    optionally the ``Resource.Meta.api_name`` if populated by an ``Api``</span>
<span class="sd">    object).</span>
<span class="sd">    If the ``bundle_or_obj`` argument is provided, it calls</span>
<span class="sd">    ``Resource.detail_uri_kwargs`` for additional bits to create</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;resource_name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;api_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span>
    <span class="k">if</span> <span class="n">bundle_or_obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">detail_uri_kwargs</span><span class="p">(</span><span class="n">bundle_or_obj</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">kwargs</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.rollback">
    <p>def <span class="ident">rollback</span>(</p><p>self, bundles)</p>
    </div>
    

    
  
    <div class="desc"><p>A ORM-specific implementation of <code>rollback</code>.</p>
<p>Given the list of bundles, delete all models pertaining to those
bundles.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.rollback', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.rollback" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">rollback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundles</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``rollback``.</span>
<span class="sd">    Given the list of bundles, delete all models pertaining to those</span>
<span class="sd">    bundles.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">bundle</span> <span class="ow">in</span> <span class="n">bundles</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bundle_detail_data</span><span class="p">(</span><span class="n">bundle</span><span class="p">):</span>
            <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.save">
    <p>def <span class="ident">save</span>(</p><p>self, bundle, skip_errors=False)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.save', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.save" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">skip_errors</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">via_uri</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">bundle</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">errors</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">skip_errors</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">error_response</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="o">.</span><span class="n">errors</span><span class="p">))</span>
    <span class="c1"># Check if they&#39;re authorized.</span>
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">pk</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">authorized_update_detail</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">),</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">authorized_create_detail</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">),</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="c1"># Save FKs just in case.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">save_related</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">print</span> <span class="s2">&quot;got&quot;</span>
    <span class="c1"># Save the main object.</span>
    <span class="n">obj_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_identifier</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">obj_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">bundle</span><span class="o">.</span><span class="n">objects_saved</span> <span class="ow">or</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_state</span><span class="o">.</span><span class="n">adding</span><span class="p">:</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">objects_saved</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">obj_id</span><span class="p">)</span>
    <span class="c1"># Now pick up the M2M bits.</span>
    <span class="n">m2m_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hydrate_m2m</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">save_m2m</span><span class="p">(</span><span class="n">m2m_bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.save_m2m">
    <p>def <span class="ident">save_m2m</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles the saving of related M2M data.</p>
<p>Due to the way Django works, the M2M data must be handled after the
main instance, which is why this isn't a part of the main <code>save</code> bits.</p>
<p>Currently slightly inefficient in that it will clear out the whole
relation and recreate the related data as needed.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.save_m2m', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.save_m2m" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">save_m2m</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles the saving of related M2M data.</span>
<span class="sd">    Due to the way Django works, the M2M data must be handled after the</span>
<span class="sd">    main instance, which is why this isn&#39;t a part of the main ``save`` bits.</span>
<span class="sd">    Currently slightly inefficient in that it will clear out the whole</span>
<span class="sd">    relation and recreate the related data as needed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">readonly</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># Get the manager.</span>
        <span class="n">related_mngr</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
            <span class="n">related_mngr</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">):</span>
            <span class="n">related_mngr</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">related_mngr</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">related_mngr</span><span class="p">,</span> <span class="s1">&#39;clear&#39;</span><span class="p">):</span>
            <span class="c1"># FIXME: Dupe the original bundle, copy in the new object &amp;</span>
            <span class="c1">#        check the perms on that (using the related resource)?</span>
            <span class="c1"># Clear it out, just to be safe.</span>
            <span class="n">related_mngr</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">related_objs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">related_bundle</span> <span class="ow">in</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">field_name</span><span class="p">]:</span>
            <span class="n">related_resource</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">get_related_resource</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
            <span class="c1"># Only build &amp; save if there&#39;s data, not just a URI.</span>
            <span class="n">updated_related_bundle</span> <span class="o">=</span> <span class="n">related_resource</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span>
                <span class="n">obj</span><span class="o">=</span><span class="n">related_bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="n">related_bundle</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                <span class="n">request</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">,</span>
                <span class="n">objects_saved</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">objects_saved</span><span class="p">,</span>
                <span class="n">via_uri</span><span class="o">=</span><span class="n">related_bundle</span><span class="o">.</span><span class="n">via_uri</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">related_resource</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">updated_related_bundle</span><span class="p">)</span>
            <span class="n">related_objs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">updated_related_bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
        <span class="n">related_mngr</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="o">*</span><span class="n">related_objs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.save_related">
    <p>def <span class="ident">save_related</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles the saving of related non-M2M data.
Calling assigning <code>child.parent = parent</code> &amp; then calling
<code>Child.save</code> isn't good enough to make sure the <code>parent</code>
is saved.
To get around this, we go through all our related fields &amp;
call <code>save</code> on them if they have related, non-M2M data.
M2M data is handled by the <code>ModelResource.save_m2m</code> method.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.save_related', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.save_related" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">save_related</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles the saving of related non-M2M data.</span>
<span class="sd">    Calling assigning ``child.parent = parent`` &amp; then calling</span>
<span class="sd">    ``Child.save`` isn&#39;t good enough to make sure the ``parent``</span>
<span class="sd">    is saved.</span>
<span class="sd">    To get around this, we go through all our related fields &amp;</span>
<span class="sd">    call ``save`` on them if they have related, non-M2M data.</span>
<span class="sd">    M2M data is handled by the ``ModelResource.save_m2m`` method.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_related</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">readonly</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">blank</span> <span class="ow">and</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># Get the object.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">related_obj</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ObjectDoesNotExist</span><span class="p">:</span>
            <span class="c1"># Django 1.8: unset related objects default to None, no error</span>
            <span class="n">related_obj</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="c1"># We didn&#39;t get it, so maybe we created it but haven&#39;t saved it</span>
        <span class="k">if</span> <span class="n">related_obj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">related_obj</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">related_objects_to_save</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">related_name</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bundle_detail_data</span><span class="p">(</span><span class="n">bundle</span><span class="p">):</span>
                <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">related_obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">related_name</span><span class="p">,</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
        <span class="n">related_resource</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">get_related_resource</span><span class="p">(</span><span class="n">related_obj</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_name</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">field_name</span><span class="p">],</span> <span class="s1">&#39;keys&#39;</span><span class="p">):</span>
            <span class="c1"># Only build &amp; save if there&#39;s data, not just a URI.</span>
            <span class="n">related_bundle</span> <span class="o">=</span> <span class="n">related_resource</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span>
                <span class="n">obj</span><span class="o">=</span><span class="n">related_obj</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_name</span><span class="p">),</span>
                <span class="n">request</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">,</span>
                <span class="n">objects_saved</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">objects_saved</span>
            <span class="p">)</span>
            <span class="n">related_resource</span><span class="o">.</span><span class="n">full_hydrate</span><span class="p">(</span><span class="n">related_bundle</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">field_name</span> <span class="o">!=</span> <span class="s2">&quot;project&quot;</span><span class="p">:</span>
                <span class="n">related_resource</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">related_bundle</span><span class="p">)</span>
            <span class="n">related_obj</span> <span class="o">=</span> <span class="n">related_bundle</span><span class="o">.</span><span class="n">obj</span>
        <span class="k">if</span> <span class="n">related_obj</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="n">related_obj</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.serialize">
    <p>def <span class="ident">serialize</span>(</p><p>self, request, data, format, options=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a request, data and a desired format, produces a serialized
version suitable for transfer over the wire.</p>
<p>Mostly a hook, this uses the <code>Serializer</code> from <code>Resource._meta</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.serialize', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.serialize" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">format</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a request, data and a desired format, produces a serialized</span>
<span class="sd">    version suitable for transfer over the wire.</span>
<span class="sd">    Mostly a hook, this uses the ``Serializer`` from ``Resource._meta``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span> <span class="o">=</span> <span class="n">options</span> <span class="ow">or</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="s1">&#39;text/javascript&#39;</span> <span class="ow">in</span> <span class="n">format</span><span class="p">:</span>
        <span class="c1"># get JSONP callback name. default to &quot;callback&quot;</span>
        <span class="n">callback</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;callback&#39;</span><span class="p">,</span> <span class="s1">&#39;callback&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_valid_jsonp_callback_value</span><span class="p">(</span><span class="n">callback</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">BadRequest</span><span class="p">(</span><span class="s1">&#39;JSONP callback name is invalid.&#39;</span><span class="p">)</span>
        <span class="n">options</span><span class="p">[</span><span class="s1">&#39;callback&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">callback</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">serializer</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">format</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.should_skip_field">
    <p>def <span class="ident">should_skip_field</span>(</p><p>cls, field)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a Django model field, return if it should be included in the
contributed ApiFields.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.should_skip_field', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.should_skip_field" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">should_skip_field</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">field</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a Django model field, return if it should be included in the</span>
<span class="sd">    contributed ApiFields.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Ignore certain fields (related fields).</span>
    <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="s1">&#39;rel&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">return</span> <span class="bp">False</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.throttle_check">
    <p>def <span class="ident">throttle_check</span>(</p><p>self, request)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking if the user should be throttled.</p>
<p>Mostly a hook, this uses class assigned to <code>throttle</code> from
<code>Resource._meta</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.throttle_check', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.throttle_check" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">throttle_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking if the user should be throttled.</span>
<span class="sd">    Mostly a hook, this uses class assigned to ``throttle`` from</span>
<span class="sd">    ``Resource._meta``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">identifier</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authentication</span><span class="o">.</span><span class="n">get_identifier</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="c1"># Check to see if they should be throttled.</span>
    <span class="n">throttle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">throttle</span><span class="o">.</span><span class="n">should_be_throttled</span><span class="p">(</span><span class="n">identifier</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">throttle</span><span class="p">:</span>
        <span class="c1"># Throttle limit exceeded.</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpTooManyRequests</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">throttle</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">throttle</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="n">response</span><span class="p">[</span><span class="s1">&#39;Retry-After&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">throttle</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">throttle</span><span class="p">,</span> <span class="n">datetime</span><span class="p">):</span>
            <span class="n">response</span><span class="p">[</span><span class="s1">&#39;Retry-After&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">format_date_time</span><span class="p">(</span><span class="n">mktime</span><span class="p">(</span><span class="n">throttle</span><span class="o">.</span><span class="n">timetuple</span><span class="p">()))</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.unauthorized_result">
    <p>def <span class="ident">unauthorized_result</span>(</p><p>self, exception)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.unauthorized_result', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.unauthorized_result" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">unauthorized_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exception</span><span class="p">):</span>
    <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpUnauthorized</span><span class="p">())</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.update_in_place">
    <p>def <span class="ident">update_in_place</span>(</p><p>self, request, original_bundle, new_data)</p>
    </div>
    

    
  
    <div class="desc"><p>Update the object in original_bundle in-place using new_data.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.update_in_place', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.update_in_place" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">update_in_place</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">original_bundle</span><span class="p">,</span> <span class="n">new_data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Update the object in original_bundle in-place using new_data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">original_bundle</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">dict_strip_unicode_keys</span><span class="p">(</span><span class="n">new_data</span><span class="p">))</span>
    <span class="c1"># Now we&#39;ve got a bundle with the new data sitting in it and we&#39;re</span>
    <span class="c1"># we&#39;re basically in the same spot as a PUT request. SO the rest of this</span>
    <span class="c1"># function is cribbed from put_detail.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">alter_deserialized_detail_data</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">original_bundle</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bundle_detail_data</span><span class="p">(</span><span class="n">original_bundle</span><span class="p">),</span>
        <span class="s1">&#39;request&#39;</span><span class="p">:</span> <span class="n">request</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_update</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">original_bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.BaseCBHCompoundBatchResource.wrap_view">
    <p>def <span class="ident">wrap_view</span>(</p><p>self, view)</p>
    </div>
    

    
  
    <div class="desc"><p>Wraps methods so they can be called in a more functional way as well
as handling exceptions better.</p>
<p>Note that if <code>BadRequest</code> or an exception with a <code>response</code> attr
are seen, there is special handling to either present a message back
to the user or return the response traveling with the exception.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.wrap_view', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.BaseCBHCompoundBatchResource.wrap_view" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">wrap_view</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">view</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wraps methods so they can be called in a more functional way as well</span>
<span class="sd">    as handling exceptions better.</span>
<span class="sd">    Note that if ``BadRequest`` or an exception with a ``response`` attr</span>
<span class="sd">    are seen, there is special handling to either present a message back</span>
<span class="sd">    to the user or return the response traveling with the exception.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nd">@csrf_exempt</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">callback</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">view</span><span class="p">)</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">callback</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="c1"># Our response can vary based on a number of factors, use</span>
            <span class="c1"># the cache class to determine what we should ``Vary`` on so</span>
            <span class="c1"># caches won&#39;t return the wrong (cached) version.</span>
            <span class="n">varies</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="p">,</span> <span class="s2">&quot;varies&quot;</span><span class="p">,</span> <span class="p">[])</span>
            <span class="k">if</span> <span class="n">varies</span><span class="p">:</span>
                <span class="n">patch_vary_headers</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">varies</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">cacheable</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">response</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">cache_control</span><span class="p">():</span>
                    <span class="c1"># If the request is cacheable and we have a</span>
                    <span class="c1"># ``Cache-Control`` available then patch the header.</span>
                    <span class="n">patch_cache_control</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">cache_control</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">is_ajax</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">response</span><span class="o">.</span><span class="n">has_header</span><span class="p">(</span><span class="s2">&quot;Cache-Control&quot;</span><span class="p">):</span>
                <span class="c1"># IE excessively caches XMLHttpRequests, so we&#39;re disabling</span>
                <span class="c1"># the browser cache here.</span>
                <span class="c1"># See http://www.enhanceie.com/ie/bugs.asp for details.</span>
                <span class="n">patch_cache_control</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">no_cache</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">response</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">BadRequest</span><span class="p">,</span> <span class="n">fields</span><span class="o">.</span><span class="n">ApiFieldError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="n">sanitize</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s1">&#39;args&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">}</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpBadRequest</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="n">sanitize</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">messages</span><span class="p">)}</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpBadRequest</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1"># Prevent muting non-django&#39;s exceptions</span>
            <span class="c1"># i.e. RequestException from &#39;requests&#39; library</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s1">&#39;response&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">response</span><span class="p">,</span> <span class="n">HttpResponse</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">e</span><span class="o">.</span><span class="n">response</span>
            <span class="c1"># A real, non-expected exception.</span>
            <span class="c1"># Handle the case where the full traceback is more helpful</span>
            <span class="c1"># than the serialized error.</span>
            <span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">DEBUG</span> <span class="ow">and</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">settings</span><span class="p">,</span> <span class="s1">&#39;TASTYPIE_FULL_DEBUG&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
                <span class="k">raise</span>
            <span class="c1"># Re-raise the error to get a proper traceback when the error</span>
            <span class="c1"># happend during a test case</span>
            <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SERVER_NAME&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;testserver&#39;</span><span class="p">:</span>
                <span class="k">raise</span>
            <span class="c1"># Rather than re-raising, we&#39;re going to things similar to</span>
            <span class="c1"># what Django does. The difference is returning a serialized</span>
            <span class="c1"># error message.</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_500</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wrapper</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="cbh_chem_api.resources.CBHChemicalSearchResource" class="name">class <span class="ident">CBHChemicalSearchResource</span></p>
      
  
    <div class="desc"><p>Provides a REST interface to POST a molfile for use with chemical search</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">CBHChemicalSearchResource</span><span class="p">(</span><span class="n">Resource</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Provides a REST interface to POST a molfile for use with chemical search</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">help_text</span><span class="o">=</span><span class="s2">&quot;uuid generated on POST of data - comes from the task ID when molecule is searched for&quot;</span><span class="p">)</span>
    <span class="n">query_type</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">help_text</span><span class="o">=</span><span class="s2">&quot;Chemical query type - currently supports &#39;with_substructure&#39; or &#39;flexmatch&#39;&quot;</span><span class="p">)</span>
    <span class="n">molfile</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">help_text</span><span class="o">=</span><span class="s2">&quot;MDL molfile text for the molecule being searched for&quot;</span><span class="p">)</span>
    <span class="n">smiles</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">help_text</span><span class="o">=</span><span class="s2">&quot;Generated SMILES string for the molecule being searched for&quot;</span><span class="p">)</span>
    <span class="n">pids</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">ListField</span><span class="p">(</span><span class="n">help_text</span><span class="o">=</span><span class="s2">&quot;Project IDs over which this chemical search should be run&quot;</span><span class="p">)</span>
    <span class="n">filter_is_applied</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">help_text</span><span class="o">=</span><span class="s2">&quot;front end helper boolean&quot;</span><span class="p">)</span>
    <span class="n">inprogress</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>  <span class="n">help_text</span><span class="o">=</span><span class="s2">&quot;front end helper boolean&quot;</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        authorization is not used in the standard way as we just need to check the submitted project id list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">resource_name</span> <span class="o">=</span> <span class="s1">&#39;cbh_chemical_search&#39;</span>
        <span class="n">authorization</span> <span class="o">=</span> <span class="n">ProjectAuthorization</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">convert_mol_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">strn</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Take the mdl molfile string and convert it into a SMILES string</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromMolBlock</span><span class="p">(</span><span class="n">strn</span><span class="p">)</span>
            <span class="n">smiles</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolToSmiles</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">smiles</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        
        <span class="k">return</span> <span class="n">smiles</span>

    <span class="k">def</span> <span class="nf">get_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Used in the saved search method on the front end to return </span>
<span class="sd">        the molecule that should be structure searched</span>
<span class="sd">        This caching needs an upgrade to use the database instead as saved search </span>
<span class="sd">        could be retrieved in a different session</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>

        <span class="n">bundle</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">caches</span><span class="p">[</span><span class="n">settings</span><span class="o">.</span><span class="n">SESSION_CACHE_ALIAS</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;structure_search__</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pk&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">))</span>
        <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">alter_deserialized_detail_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">deserialized</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Standard tastypie hook to alter the input data from a post request after deserialization</span>
<span class="sd">        This function adds SMILES patterns and images to the input molfile</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">deserialized</span><span class="p">[</span><span class="s2">&quot;smiles&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_mol_string</span><span class="p">(</span><span class="n">deserialized</span><span class="p">[</span><span class="s2">&quot;molfile&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">deserialized</span><span class="p">[</span><span class="s2">&quot;smiles&quot;</span><span class="p">]:</span>
            <span class="n">deserialized</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">deserialized</span><span class="p">[</span><span class="s2">&quot;image&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">deserialized</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="n">deserialized</span><span class="p">[</span><span class="s2">&quot;image&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_ctab2image</span><span class="p">(</span><span class="n">deserialized</span><span class="p">[</span><span class="s2">&quot;molfile&quot;</span><span class="p">],</span><span class="mi">50</span><span class="p">,</span><span class="bp">False</span><span class="p">,</span> <span class="n">recalc</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>

        <span class="n">deserialized</span><span class="p">[</span><span class="s2">&quot;inprogress&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">deserialized</span><span class="p">[</span><span class="s2">&quot;filter_is_applied&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">return</span> <span class="n">deserialized</span>

    <span class="k">def</span> <span class="nf">post_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Takes an input molfile from a POST request and processes the structure search then</span>
<span class="sd">        saves it to the session cache </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">))</span>
        <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_deserialized_detail_data</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">deserialized</span><span class="p">)</span>
        <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">deserialized</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
        <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_create</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
        
        <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpCreated</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">obj_create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate a task id and send the relevant tasks to django q</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pids</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pids&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

        <span class="n">project_ids</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">pids</span><span class="p">:</span>

            <span class="n">project_ids</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">pid</span><span class="p">)</span> <span class="k">for</span> <span class="n">pid</span> <span class="ow">in</span> <span class="n">pids</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)]</span>
        
        <span class="n">allowed_pids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">project_ids</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">))</span>

        
        <span class="k">for</span> <span class="n">requested_pid</span> <span class="ow">in</span> <span class="n">project_ids</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">requested_pid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_pids</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">(</span><span class="s2">&quot;No permissions for requested project&quot;</span><span class="p">)</span> 

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">project_ids</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">project_ids</span> <span class="o">=</span> <span class="n">allowed_pids</span>

        <span class="n">allowed_pids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">allowed_pids</span><span class="p">)</span>
        <span class="n">one_eighth</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">allowed_pids</span><span class="p">)</span><span class="o">/</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="c1">#Split the projects into 8 equal parts</span>
        <span class="n">pid_chunks</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">chunks</span><span class="p">(</span><span class="n">allowed_pids</span><span class="p">,</span> <span class="n">one_eighth</span><span class="p">))</span>

        <span class="n">args</span> <span class="o">=</span> <span class="p">[(</span><span class="n">pid_list</span><span class="p">,</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;query_type&quot;</span><span class="p">],</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;smiles&quot;</span><span class="p">])</span> <span class="k">for</span> <span class="n">pid_list</span> <span class="ow">in</span> <span class="n">pid_chunks</span><span class="p">]</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_task_id</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">bundle</span>


        
    <span class="k">def</span> <span class="nf">add_task_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calls async_iter to generate a django_q task id and </span>
<span class="sd">        set the qcluster process to work processing the structure search. </span>
<span class="sd">        The user will then be able to search for it but </span>
<span class="sd">        this gives an extra second or so while the user considers pressing the apply key&quot;&quot;&quot;</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">async_iter</span><span class="p">(</span><span class="s1">&#39;cbh_chem_api.tasks.get_structure_search_for_projects&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
        <span class="n">caches</span><span class="p">[</span><span class="n">settings</span><span class="o">.</span><span class="n">SESSION_CACHE_ALIAS</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;structure_search__</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#cbh_chem_api.resources.CBHChemicalSearchResource">CBHChemicalSearchResource</a></li>
          <li>tastypie.resources.Resource</li>
          <li>__builtin__.object</li>
          </ul>
          <h3>Class variables</h3>
            <div class="item">
            <p id="cbh_chem_api.resources.CBHChemicalSearchResource.Meta" class="name">var <span class="ident">Meta</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="cbh_chem_api.resources.CBHChemicalSearchResource.base_fields" class="name">var <span class="ident">base_fields</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="cbh_chem_api.resources.CBHChemicalSearchResource.declared_fields" class="name">var <span class="ident">declared_fields</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="cbh_chem_api.resources.CBHChemicalSearchResource.filter_is_applied" class="name">var <span class="ident">filter_is_applied</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="cbh_chem_api.resources.CBHChemicalSearchResource.id" class="name">var <span class="ident">id</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="cbh_chem_api.resources.CBHChemicalSearchResource.inprogress" class="name">var <span class="ident">inprogress</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="cbh_chem_api.resources.CBHChemicalSearchResource.molfile" class="name">var <span class="ident">molfile</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="cbh_chem_api.resources.CBHChemicalSearchResource.pids" class="name">var <span class="ident">pids</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="cbh_chem_api.resources.CBHChemicalSearchResource.query_type" class="name">var <span class="ident">query_type</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="cbh_chem_api.resources.CBHChemicalSearchResource.smiles" class="name">var <span class="ident">smiles</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="cbh_chem_api.resources.CBHChemicalSearchResource.urls" class="name">var <span class="ident">urls</span></p>
            

            
  
    <div class="desc"><p>The endpoints this <code>Resource</code> responds to.</p>
<p>Mostly a standard URLconf, this is suitable for either automatic use
when registered with an <code>Api</code> class or for including directly in
a URLconf should you choose to.</p></div>
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, api_name=None)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.__init__', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">api_name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="c1"># this can cause:</span>
    <span class="c1"># TypeError: object.__new__(method-wrapper) is not safe, use method-wrapper.__new__()</span>
    <span class="c1"># when trying to copy a generator used as a default. Wrap call to</span>
    <span class="c1"># generator in lambda to get around this error.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_fields</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">api_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span> <span class="o">=</span> <span class="n">api_name</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.add_task_id">
    <p>def <span class="ident">add_task_id</span>(</p><p>self, data, args)</p>
    </div>
    

    
  
    <div class="desc"><p>Calls async_iter to generate a django_q task id and 
set the qcluster process to work processing the structure search. 
The user will then be able to search for it but 
this gives an extra second or so while the user considers pressing the apply key</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.add_task_id', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.add_task_id" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">add_task_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calls async_iter to generate a django_q task id and </span>
<span class="sd">    set the qcluster process to work processing the structure search. </span>
<span class="sd">    The user will then be able to search for it but </span>
<span class="sd">    this gives an extra second or so while the user considers pressing the apply key&quot;&quot;&quot;</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">async_iter</span><span class="p">(</span><span class="s1">&#39;cbh_chem_api.tasks.get_structure_search_for_projects&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
    <span class="n">caches</span><span class="p">[</span><span class="n">settings</span><span class="o">.</span><span class="n">SESSION_CACHE_ALIAS</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;structure_search__</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.alter_deserialized_detail_data">
    <p>def <span class="ident">alter_deserialized_detail_data</span>(</p><p>self, request, deserialized)</p>
    </div>
    

    
  
    <div class="desc"><p>Standard tastypie hook to alter the input data from a post request after deserialization
This function adds SMILES patterns and images to the input molfile</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.alter_deserialized_detail_data', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.alter_deserialized_detail_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">alter_deserialized_detail_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">deserialized</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Standard tastypie hook to alter the input data from a post request after deserialization</span>
<span class="sd">    This function adds SMILES patterns and images to the input molfile</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">deserialized</span><span class="p">[</span><span class="s2">&quot;smiles&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_mol_string</span><span class="p">(</span><span class="n">deserialized</span><span class="p">[</span><span class="s2">&quot;molfile&quot;</span><span class="p">])</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">deserialized</span><span class="p">[</span><span class="s2">&quot;smiles&quot;</span><span class="p">]:</span>
        <span class="n">deserialized</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">deserialized</span><span class="p">[</span><span class="s2">&quot;image&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">deserialized</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">deserialized</span><span class="p">[</span><span class="s2">&quot;image&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_ctab2image</span><span class="p">(</span><span class="n">deserialized</span><span class="p">[</span><span class="s2">&quot;molfile&quot;</span><span class="p">],</span><span class="mi">50</span><span class="p">,</span><span class="bp">False</span><span class="p">,</span> <span class="n">recalc</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
    <span class="n">deserialized</span><span class="p">[</span><span class="s2">&quot;inprogress&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="n">deserialized</span><span class="p">[</span><span class="s2">&quot;filter_is_applied&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">return</span> <span class="n">deserialized</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.alter_deserialized_list_data">
    <p>def <span class="ident">alter_deserialized_list_data</span>(</p><p>self, request, data)</p>
    </div>
    

    
  
    <div class="desc"><p>A hook to alter list data just after it has been received from the user &amp;
gets deserialized.</p>
<p>Useful for altering the user data before any hydration is applied.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.alter_deserialized_list_data', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.alter_deserialized_list_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">alter_deserialized_list_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to alter list data just after it has been received from the user &amp;</span>
<span class="sd">    gets deserialized.</span>
<span class="sd">    Useful for altering the user data before any hydration is applied.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.alter_detail_data_to_serialize">
    <p>def <span class="ident">alter_detail_data_to_serialize</span>(</p><p>self, request, data)</p>
    </div>
    

    
  
    <div class="desc"><p>A hook to alter detail data just before it gets serialized &amp; sent to the user.</p>
<p>Useful for restructuring/renaming aspects of the what's going to be
sent.</p>
<p>Should accommodate for receiving a single bundle of data.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.alter_detail_data_to_serialize', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.alter_detail_data_to_serialize" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">alter_detail_data_to_serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to alter detail data just before it gets serialized &amp; sent to the user.</span>
<span class="sd">    Useful for restructuring/renaming aspects of the what&#39;s going to be</span>
<span class="sd">    sent.</span>
<span class="sd">    Should accommodate for receiving a single bundle of data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.alter_list_data_to_serialize">
    <p>def <span class="ident">alter_list_data_to_serialize</span>(</p><p>self, request, data)</p>
    </div>
    

    
  
    <div class="desc"><p>A hook to alter list data just before it gets serialized &amp; sent to the user.</p>
<p>Useful for restructuring/renaming aspects of the what's going to be
sent.</p>
<p>Should accommodate for a list of objects, generally also including
meta data.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.alter_list_data_to_serialize', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.alter_list_data_to_serialize" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">alter_list_data_to_serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to alter list data just before it gets serialized &amp; sent to the user.</span>
<span class="sd">    Useful for restructuring/renaming aspects of the what&#39;s going to be</span>
<span class="sd">    sent.</span>
<span class="sd">    Should accommodate for a list of objects, generally also including</span>
<span class="sd">    meta data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.apply_authorization_limits">
    <p>def <span class="ident">apply_authorization_limits</span>(</p><p>self, request, object_list)</p>
    </div>
    

    
  
    <div class="desc"><p>Deprecated.</p>
<p>FIXME: REMOVE BEFORE 1.0</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.apply_authorization_limits', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.apply_authorization_limits" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">apply_authorization_limits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">object_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Deprecated.</span>
<span class="sd">    FIXME: REMOVE BEFORE 1.0</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">apply_limits</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">object_list</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.apply_filters">
    <p>def <span class="ident">apply_filters</span>(</p><p>self, request, applicable_filters)</p>
    </div>
    

    
  
    <div class="desc"><p>A hook to alter how the filters are applied to the object list.</p>
<p>This needs to be implemented at the user level.</p>
<p><code>ModelResource</code> includes a full working version specific to Django's
<code>Models</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.apply_filters', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.apply_filters" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">apply_filters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">applicable_filters</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to alter how the filters are applied to the object list.</span>
<span class="sd">    This needs to be implemented at the user level.</span>
<span class="sd">    ``ModelResource`` includes a full working version specific to Django&#39;s</span>
<span class="sd">    ``Models``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.apply_sorting">
    <p>def <span class="ident">apply_sorting</span>(</p><p>self, obj_list, options=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Allows for the sorting of objects being returned.</p>
<p>This needs to be implemented at the user level.</p>
<p><code>ModelResource</code> includes a full working version specific to Django's
<code>Models</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.apply_sorting', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.apply_sorting" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">apply_sorting</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_list</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Allows for the sorting of objects being returned.</span>
<span class="sd">    This needs to be implemented at the user level.</span>
<span class="sd">    ``ModelResource`` includes a full working version specific to Django&#39;s</span>
<span class="sd">    ``Models``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">obj_list</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.authorized_create_detail">
    <p>def <span class="ident">authorized_create_detail</span>(</p><p>self, object_list, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking of permissions to see if the user has authorization
to POST this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.authorized_create_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.authorized_create_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_create_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to POST this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">create_detail</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">auth_result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.authorized_create_list">
    <p>def <span class="ident">authorized_create_list</span>(</p><p>self, object_list, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking of permissions to see if the user has authorization
to POST this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.authorized_create_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.authorized_create_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_create_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to POST this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">create_list</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.authorized_delete_detail">
    <p>def <span class="ident">authorized_delete_detail</span>(</p><p>self, object_list, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking of permissions to see if the user has authorization
to DELETE this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.authorized_delete_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.authorized_delete_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_delete_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to DELETE this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">delete_detail</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">auth_result</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.authorized_delete_list">
    <p>def <span class="ident">authorized_delete_list</span>(</p><p>self, object_list, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking of permissions to see if the user has authorization
to DELETE this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.authorized_delete_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.authorized_delete_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_delete_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to DELETE this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">delete_list</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.authorized_read_detail">
    <p>def <span class="ident">authorized_read_detail</span>(</p><p>self, object_list, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking of permissions to see if the user has authorization
to GET this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.authorized_read_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.authorized_read_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_read_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to GET this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">read_detail</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">auth_result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.authorized_read_list">
    <p>def <span class="ident">authorized_read_list</span>(</p><p>self, object_list, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking of permissions to see if the user has authorization
to GET this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.authorized_read_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.authorized_read_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_read_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to GET this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">read_list</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.authorized_update_detail">
    <p>def <span class="ident">authorized_update_detail</span>(</p><p>self, object_list, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking of permissions to see if the user has authorization
to PUT this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.authorized_update_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.authorized_update_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_update_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to PUT this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">update_detail</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">auth_result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.authorized_update_list">
    <p>def <span class="ident">authorized_update_list</span>(</p><p>self, object_list, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking of permissions to see if the user has authorization
to PUT this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.authorized_update_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.authorized_update_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_update_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to PUT this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">update_list</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.base_urls">
    <p>def <span class="ident">base_urls</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>The standard URLs this <code>Resource</code> should respond to.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.base_urls', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.base_urls" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">base_urls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The standard URLs this ``Resource`` should respond to.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="n">url</span><span class="p">(</span><span class="s2">r&quot;^(?P&lt;resource_name&gt;</span><span class="si">%s</span><span class="s2">)</span><span class="si">%s</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span> <span class="n">trailing_slash</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrap_view</span><span class="p">(</span><span class="s1">&#39;dispatch_list&#39;</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;api_dispatch_list&quot;</span><span class="p">),</span>
        <span class="n">url</span><span class="p">(</span><span class="s2">r&quot;^(?P&lt;resource_name&gt;</span><span class="si">%s</span><span class="s2">)/schema</span><span class="si">%s</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span> <span class="n">trailing_slash</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrap_view</span><span class="p">(</span><span class="s1">&#39;get_schema&#39;</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;api_get_schema&quot;</span><span class="p">),</span>
        <span class="n">url</span><span class="p">(</span><span class="s2">r&quot;^(?P&lt;resource_name&gt;</span><span class="si">%s</span><span class="s2">)/set/(?P&lt;</span><span class="si">%s</span><span class="s2">_list&gt;.*?)</span><span class="si">%s</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">,</span> <span class="n">trailing_slash</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrap_view</span><span class="p">(</span><span class="s1">&#39;get_multiple&#39;</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;api_get_multiple&quot;</span><span class="p">),</span>
        <span class="n">url</span><span class="p">(</span><span class="s2">r&quot;^(?P&lt;resource_name&gt;</span><span class="si">%s</span><span class="s2">)/(?P&lt;</span><span class="si">%s</span><span class="s2">&gt;.*?)</span><span class="si">%s</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">,</span> <span class="n">trailing_slash</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrap_view</span><span class="p">(</span><span class="s1">&#39;dispatch_detail&#39;</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;api_dispatch_detail&quot;</span><span class="p">),</span>
    <span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.build_bundle">
    <p>def <span class="ident">build_bundle</span>(</p><p>self, obj=None, data=None, request=None, objects_saved=None, via_uri=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Given either an object, a data dictionary or both, builds a <code>Bundle</code>
for use throughout the <code>dehydrate/hydrate</code> cycle.</p>
<p>If no object is provided, an empty object from
<code>Resource._meta.object_class</code> is created so that attempts to access
<code>bundle.obj</code> do not fail.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.build_bundle', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.build_bundle" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">build_bundle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">objects_saved</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">via_uri</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given either an object, a data dictionary or both, builds a ``Bundle``</span>
<span class="sd">    for use throughout the ``dehydrate/hydrate`` cycle.</span>
<span class="sd">    If no object is provided, an empty object from</span>
<span class="sd">    ``Resource._meta.object_class`` is created so that attempts to access</span>
<span class="sd">    ``bundle.obj`` do not fail.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="p">:</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">Bundle</span><span class="p">(</span>
        <span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span>
        <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
        <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">,</span>
        <span class="n">objects_saved</span><span class="o">=</span><span class="n">objects_saved</span><span class="p">,</span>
        <span class="n">via_uri</span><span class="o">=</span><span class="n">via_uri</span>
    <span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.build_filters">
    <p>def <span class="ident">build_filters</span>(</p><p>self, filters=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Allows for the filtering of applicable objects.</p>
<p>This needs to be implemented at the user level.'</p>
<p><code>ModelResource</code> includes a full working version specific to Django's
<code>Models</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.build_filters', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.build_filters" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">build_filters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Allows for the filtering of applicable objects.</span>
<span class="sd">    This needs to be implemented at the user level.&#39;</span>
<span class="sd">    ``ModelResource`` includes a full working version specific to Django&#39;s</span>
<span class="sd">    ``Models``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">filters</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.build_schema">
    <p>def <span class="ident">build_schema</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns a dictionary of all the fields on the resource and some
properties about those fields.</p>
<p>Used by the <code>schema/</code> endpoint to describe what will be available.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.build_schema', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.build_schema" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">build_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a dictionary of all the fields on the resource and some</span>
<span class="sd">    properties about those fields.</span>
<span class="sd">    Used by the ``schema/`` endpoint to describe what will be available.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;fields&#39;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s1">&#39;default_format&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">default_format</span><span class="p">,</span>
        <span class="s1">&#39;allowed_list_http_methods&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">list_allowed_methods</span><span class="p">,</span>
        <span class="s1">&#39;allowed_detail_http_methods&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_allowed_methods</span><span class="p">,</span>
        <span class="s1">&#39;default_limit&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">limit</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">ordering</span><span class="p">:</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;ordering&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">ordering</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span><span class="p">:</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;filtering&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span>
    <span class="c1"># Skip assigning pk_field_name for non-model resources</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">pk_field_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">queryset</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">pk</span><span class="o">.</span><span class="n">name</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="n">pk_field_name</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;fields&#39;</span><span class="p">][</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">default</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">dehydrated_type</span><span class="p">,</span>
            <span class="s1">&#39;nullable&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">null</span><span class="p">,</span>
            <span class="s1">&#39;blank&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">blank</span><span class="p">,</span>
            <span class="s1">&#39;readonly&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">readonly</span><span class="p">,</span>
            <span class="s1">&#39;help_text&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">help_text</span><span class="p">,</span>
            <span class="s1">&#39;unique&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">unique</span><span class="p">,</span>
            <span class="s1">&#39;primary_key&#39;</span><span class="p">:</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">field_name</span> <span class="o">==</span> <span class="n">pk_field_name</span> <span class="k">else</span> <span class="bp">False</span><span class="p">,</span>
            <span class="s1">&#39;verbose_name&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">verbose_name</span> <span class="ow">or</span> <span class="n">field_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">),</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">dehydrated_type</span> <span class="o">==</span> <span class="s1">&#39;related&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
                <span class="n">related_type</span> <span class="o">=</span> <span class="s1">&#39;to_many&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">related_type</span> <span class="o">=</span> <span class="s1">&#39;to_one&#39;</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;fields&#39;</span><span class="p">][</span><span class="n">field_name</span><span class="p">][</span><span class="s1">&#39;related_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">related_type</span>
            <span class="n">uri</span> <span class="o">=</span> <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;api_get_schema&#39;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;api_name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span><span class="p">,</span> <span class="s1">&#39;resource_name&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">to_class</span><span class="p">()</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">})</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;fields&#39;</span><span class="p">][</span><span class="n">field_name</span><span class="p">][</span><span class="s1">&#39;related_schema&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">uri</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.cached_obj_get">
    <p>def <span class="ident">cached_obj_get</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A version of <code>obj_get</code> that uses the cache as a means to get
commonly-accessed data faster.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.cached_obj_get', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.cached_obj_get" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">cached_obj_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A version of ``obj_get`` that uses the cache as a means to get</span>
<span class="sd">    commonly-accessed data faster.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_cache_key</span><span class="p">(</span><span class="s1">&#39;detail&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">cached_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cache_key</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">cached_bundle</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">cached_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">cache_key</span><span class="p">,</span> <span class="n">cached_bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cached_bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.cached_obj_get_list">
    <p>def <span class="ident">cached_obj_get_list</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A version of <code>obj_get_list</code> that uses the cache as a means to get
commonly-accessed data faster.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.cached_obj_get_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.cached_obj_get_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">cached_obj_get_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A version of ``obj_get_list`` that uses the cache as a means to get</span>
<span class="sd">    commonly-accessed data faster.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_cache_key</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">obj_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cache_key</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">obj_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">obj_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">cache_key</span><span class="p">,</span> <span class="n">obj_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">obj_list</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.can_create">
    <p>def <span class="ident">can_create</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Checks to ensure <code>post</code> is within <code>allowed_methods</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.can_create', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.can_create" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">can_create</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks to ensure ``post`` is within ``allowed_methods``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">allowed</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">list_allowed_methods</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_allowed_methods</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">&#39;post&#39;</span> <span class="ow">in</span> <span class="n">allowed</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.can_delete">
    <p>def <span class="ident">can_delete</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Checks to ensure <code>delete</code> is within <code>allowed_methods</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.can_delete', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.can_delete" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">can_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks to ensure ``delete`` is within ``allowed_methods``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">allowed</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">list_allowed_methods</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_allowed_methods</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">&#39;delete&#39;</span> <span class="ow">in</span> <span class="n">allowed</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.can_update">
    <p>def <span class="ident">can_update</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Checks to ensure <code>put</code> is within <code>allowed_methods</code>.</p>
<p>Used when hydrating related data.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.can_update', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.can_update" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">can_update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks to ensure ``put`` is within ``allowed_methods``.</span>
<span class="sd">    Used when hydrating related data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">allowed</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">list_allowed_methods</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_allowed_methods</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">&#39;put&#39;</span> <span class="ow">in</span> <span class="n">allowed</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.convert_mol_string">
    <p>def <span class="ident">convert_mol_string</span>(</p><p>self, strn)</p>
    </div>
    

    
  
    <div class="desc"><p>Take the mdl molfile string and convert it into a SMILES string</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.convert_mol_string', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.convert_mol_string" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">convert_mol_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">strn</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Take the mdl molfile string and convert it into a SMILES string</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromMolBlock</span><span class="p">(</span><span class="n">strn</span><span class="p">)</span>
        <span class="n">smiles</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolToSmiles</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">smiles</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    
    <span class="k">return</span> <span class="n">smiles</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.create_response">
    <p>def <span class="ident">create_response</span>(</p><p>self, request, data, response_class=&lt;class &#39;django.http.response.HttpResponse&#39;&gt;, **response_kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Extracts the common "which-format/serialize/return-response" cycle.</p>
<p>Mostly a useful shortcut/hook.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.create_response', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.create_response" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">create_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">HttpResponse</span><span class="p">,</span> <span class="o">**</span><span class="n">response_kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extracts the common &quot;which-format/serialize/return-response&quot; cycle.</span>
<span class="sd">    Mostly a useful shortcut/hook.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">desired_format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">determine_format</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="n">serialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">desired_format</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response_class</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">serialized</span><span class="p">,</span> <span class="n">content_type</span><span class="o">=</span><span class="n">build_content_type</span><span class="p">(</span><span class="n">desired_format</span><span class="p">),</span> <span class="o">**</span><span class="n">response_kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.dehydrate">
    <p>def <span class="ident">dehydrate</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>A hook to allow a final manipulation of data once all fields/methods
have built out the dehydrated data.</p>
<p>Useful if you need to access more than one dehydrated field or want
to annotate on additional data.</p>
<p>Must return the modified bundle.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.dehydrate', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.dehydrate" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dehydrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to allow a final manipulation of data once all fields/methods</span>
<span class="sd">    have built out the dehydrated data.</span>
<span class="sd">    Useful if you need to access more than one dehydrated field or want</span>
<span class="sd">    to annotate on additional data.</span>
<span class="sd">    Must return the modified bundle.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.dehydrate_resource_uri">
    <p>def <span class="ident">dehydrate_resource_uri</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>For the automatically included <code>resource_uri</code> field, dehydrate
the URI for the given bundle.</p>
<p>Returns empty string if no URI can be generated.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.dehydrate_resource_uri', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.dehydrate_resource_uri" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dehydrate_resource_uri</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    For the automatically included ``resource_uri`` field, dehydrate</span>
<span class="sd">    the URI for the given bundle.</span>
<span class="sd">    Returns empty string if no URI can be generated.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_uri</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="k">except</span> <span class="n">NoReverseMatch</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.delete_detail">
    <p>def <span class="ident">delete_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Destroys a single resource/object.</p>
<p>Calls <code>obj_delete</code>.</p>
<p>If the resource is deleted, return <code>HttpNoContent</code> (204 No Content).
If the resource did not exist, return <code>Http404</code> (404 Not Found).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.delete_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.delete_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">delete_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Destroys a single resource/object.</span>
<span class="sd">    Calls ``obj_delete``.</span>
<span class="sd">    If the resource is deleted, return ``HttpNoContent`` (204 No Content).</span>
<span class="sd">    If the resource did not exist, return ``Http404`` (404 Not Found).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Manually construct the bundle here, since we don&#39;t want to try to</span>
    <span class="c1"># delete an empty instance.</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="n">Bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">obj_delete</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNoContent</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">NotFound</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNotFound</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.delete_list">
    <p>def <span class="ident">delete_list</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Destroys a collection of resources/objects.</p>
<p>Calls <code>obj_delete_list</code>.</p>
<p>If the resources are deleted, return <code>HttpNoContent</code> (204 No Content).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.delete_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.delete_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">delete_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Destroys a collection of resources/objects.</span>
<span class="sd">    Calls ``obj_delete_list``.</span>
<span class="sd">    If the resources are deleted, return ``HttpNoContent`` (204 No Content).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">obj_delete_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNoContent</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.deserialize">
    <p>def <span class="ident">deserialize</span>(</p><p>self, request, data, format=u&#39;application/json&#39;)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a request, data and a format, deserializes the given data.</p>
<p>It relies on the request properly sending a <code>CONTENT_TYPE</code> header,
falling back to <code>application/json</code> if not provided.</p>
<p>Mostly a hook, this uses the <code>Serializer</code> from <code>Resource._meta</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.deserialize', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.deserialize" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">deserialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s1">&#39;application/json&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a request, data and a format, deserializes the given data.</span>
<span class="sd">    It relies on the request properly sending a ``CONTENT_TYPE`` header,</span>
<span class="sd">    falling back to ``application/json`` if not provided.</span>
<span class="sd">    Mostly a hook, this uses the ``Serializer`` from ``Resource._meta``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">serializer</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="n">format</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">deserialized</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.detail_uri_kwargs">
    <p>def <span class="ident">detail_uri_kwargs</span>(</p><p>self, bundle_or_obj)</p>
    </div>
    

    
  
    <div class="desc"><p>This needs to be implemented at the user level.</p>
<p>Given a <code>Bundle</code> or an object, it returns the extra kwargs needed to
generate a detail URI.</p>
<p><code>ModelResource</code> includes a full working version specific to Django's
<code>Models</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.detail_uri_kwargs', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.detail_uri_kwargs" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">detail_uri_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle_or_obj</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This needs to be implemented at the user level.</span>
<span class="sd">    Given a ``Bundle`` or an object, it returns the extra kwargs needed to</span>
<span class="sd">    generate a detail URI.</span>
<span class="sd">    ``ModelResource`` includes a full working version specific to Django&#39;s</span>
<span class="sd">    ``Models``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.determine_format">
    <p>def <span class="ident">determine_format</span>(</p><p>self, request)</p>
    </div>
    

    
  
    <div class="desc"><p>Used to determine the desired format.</p>
<p>Largely relies on <code>tastypie.utils.mime.determine_format</code> but here
as a point of extension.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.determine_format', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.determine_format" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">determine_format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Used to determine the desired format.</span>
<span class="sd">    Largely relies on ``tastypie.utils.mime.determine_format`` but here</span>
<span class="sd">    as a point of extension.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">determine_format</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">serializer</span><span class="p">,</span> <span class="n">default_format</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">default_format</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.dispatch">
    <p>def <span class="ident">dispatch</span>(</p><p>self, request_type, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles the common operations (allowed HTTP method, authentication,
throttling, method lookup) surrounding most CRUD interactions.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.dispatch', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.dispatch" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dispatch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request_type</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles the common operations (allowed HTTP method, authentication,</span>
<span class="sd">    throttling, method lookup) surrounding most CRUD interactions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">allowed_methods</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_allowed_methods&quot;</span> <span class="o">%</span> <span class="n">request_type</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;HTTP_X_HTTP_METHOD_OVERRIDE&#39;</span> <span class="ow">in</span> <span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="p">:</span>
        <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="p">[</span><span class="s1">&#39;HTTP_X_HTTP_METHOD_OVERRIDE&#39;</span><span class="p">]</span>
    <span class="n">request_method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">method_check</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">allowed</span><span class="o">=</span><span class="n">allowed_methods</span><span class="p">)</span>
    <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">request_method</span><span class="p">,</span> <span class="n">request_type</span><span class="p">),</span> <span class="bp">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">method</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpNotImplemented</span><span class="p">())</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">throttle_check</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="c1"># All clear. Process the request.</span>
    <span class="n">request</span> <span class="o">=</span> <span class="n">convert_post_to_put</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="c1"># Add the throttled request.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_throttled_access</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="c1"># If what comes back isn&#39;t a ``HttpResponse``, assume that the</span>
    <span class="c1"># request was accepted and that some action occurred. This also</span>
    <span class="c1"># prevents Django from freaking out.</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">HttpResponse</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNoContent</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">response</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.dispatch_detail">
    <p>def <span class="ident">dispatch_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A view for handling the various HTTP methods (GET/POST/PUT/DELETE) on
a single resource.</p>
<p>Relies on <code>Resource.dispatch</code> for the heavy-lifting.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.dispatch_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.dispatch_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dispatch_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A view for handling the various HTTP methods (GET/POST/PUT/DELETE) on</span>
<span class="sd">    a single resource.</span>
<span class="sd">    Relies on ``Resource.dispatch`` for the heavy-lifting.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span><span class="s1">&#39;detail&#39;</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.dispatch_list">
    <p>def <span class="ident">dispatch_list</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A view for handling the various HTTP methods (GET/POST/PUT/DELETE) over
the entire list of resources.</p>
<p>Relies on <code>Resource.dispatch</code> for the heavy-lifting.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.dispatch_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.dispatch_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dispatch_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A view for handling the various HTTP methods (GET/POST/PUT/DELETE) over</span>
<span class="sd">    the entire list of resources.</span>
<span class="sd">    Relies on ``Resource.dispatch`` for the heavy-lifting.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.error_response">
    <p>def <span class="ident">error_response</span>(</p><p>self, request, errors, response_class=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Extracts the common "which-format/serialize/return-error-response"
cycle.</p>
<p>Should be used as much as possible to return errors.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.error_response', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.error_response" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">error_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extracts the common &quot;which-format/serialize/return-error-response&quot;</span>
<span class="sd">    cycle.</span>
<span class="sd">    Should be used as much as possible to return errors.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">response_class</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">response_class</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpBadRequest</span>
    <span class="n">desired_format</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">if</span> <span class="n">request</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;callback&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">desired_format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">determine_format</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">BadRequest</span><span class="p">:</span>
                <span class="k">pass</span>  <span class="c1"># Fall through to default handler below</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># JSONP can cause extra breakage.</span>
            <span class="n">desired_format</span> <span class="o">=</span> <span class="s1">&#39;application/json&#39;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">desired_format</span><span class="p">:</span>
        <span class="n">desired_format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">default_format</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">serialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">desired_format</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">BadRequest</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">error</span> <span class="o">=</span> <span class="s2">&quot;Additional errors occurred, but serialization of those errors failed.&quot;</span>
        <span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">:</span>
            <span class="n">error</span> <span class="o">+=</span> <span class="s2">&quot; </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">e</span>
        <span class="k">return</span> <span class="n">response_class</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">error</span><span class="p">,</span> <span class="n">content_type</span><span class="o">=</span><span class="s1">&#39;text/plain&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response_class</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">serialized</span><span class="p">,</span> <span class="n">content_type</span><span class="o">=</span><span class="n">build_content_type</span><span class="p">(</span><span class="n">desired_format</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.full_dehydrate">
    <p>def <span class="ident">full_dehydrate</span>(</p><p>self, bundle, for_list=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a bundle with an object instance, extract the information from it
to populate the resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.full_dehydrate', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.full_dehydrate" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">full_dehydrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">for_list</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a bundle with an object instance, extract the information from it</span>
<span class="sd">    to populate the resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span>
    <span class="n">api_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span>
    <span class="n">resource_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span>
    <span class="c1"># Dehydrate each field.</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># If it&#39;s not for use in this mode, skip</span>
        <span class="n">field_use_in</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">use_in</span>
        <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_use_in</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">field_use_in</span><span class="p">(</span><span class="n">bundle</span><span class="p">):</span>
                <span class="k">continue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">field_use_in</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;list&#39;</span> <span class="k">if</span> <span class="n">for_list</span> <span class="k">else</span> <span class="s1">&#39;detail&#39;</span><span class="p">]:</span>
                <span class="k">continue</span>
        <span class="c1"># A touch leaky but it makes URI resolution work.</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">dehydrated_type</span> <span class="o">==</span> <span class="s1">&#39;related&#39;</span><span class="p">:</span>
            <span class="n">field_object</span><span class="o">.</span><span class="n">api_name</span> <span class="o">=</span> <span class="n">api_name</span>
            <span class="n">field_object</span><span class="o">.</span><span class="n">resource_name</span> <span class="o">=</span> <span class="n">resource_name</span>
        <span class="n">data</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="n">for_list</span><span class="o">=</span><span class="n">for_list</span><span class="p">)</span>
        <span class="c1"># Check for an optional method to do further dehydration.</span>
        <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;dehydrate_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.full_hydrate">
    <p>def <span class="ident">full_hydrate</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a populated bundle, distill it and turn it back into
a full-fledged object instance.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.full_hydrate', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.full_hydrate" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">full_hydrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a populated bundle, distill it and turn it back into</span>
<span class="sd">    a full-fledged object instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="p">()</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">readonly</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># Check for an optional method to do further hydration.</span>
        <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;hydrate_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
            <span class="n">bundle</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
            <span class="c1"># NOTE: We only get back a bundle when it is related field.</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Bundle</span><span class="p">)</span> <span class="ow">and</span> <span class="n">value</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_name</span><span class="p">):</span>
                <span class="n">bundle</span><span class="o">.</span><span class="n">errors</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">errors</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">field_object</span><span class="o">.</span><span class="n">null</span><span class="p">:</span>
                <span class="c1"># We need to avoid populating M2M data here as that will</span>
                <span class="c1"># cause things to blow up.</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_related</span><span class="p">:</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="k">elif</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                        <span class="c1"># NOTE: A bug fix in Django (ticket #18153) fixes incorrect behavior</span>
                        <span class="c1"># which Tastypie was relying on.  To fix this, we store value.obj to</span>
                        <span class="c1"># be saved later in save_related.</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="nb">setattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
                        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">ObjectDoesNotExist</span><span class="p">):</span>
                            <span class="n">bundle</span><span class="o">.</span><span class="n">related_objects_to_save</span><span class="p">[</span><span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">obj</span>
                    <span class="k">elif</span> <span class="n">field_object</span><span class="o">.</span><span class="n">blank</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="k">elif</span> <span class="n">field_object</span><span class="o">.</span><span class="n">null</span><span class="p">:</span>
                        <span class="nb">setattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.generate_cache_key">
    <p>def <span class="ident">generate_cache_key</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Creates a unique-enough cache key.</p>
<p>This is based off the current api_name/resource_name/args/kwargs.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.generate_cache_key', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.generate_cache_key" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">generate_cache_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a unique-enough cache key.</span>
<span class="sd">    This is based off the current api_name/resource_name/args/kwargs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">smooshed</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">=</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
    <span class="c1"># Use a list plus a ``.join()`` because it&#39;s faster than concatenation.</span>
    <span class="k">return</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">args</span><span class="p">),</span> <span class="s1">&#39;:&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">smooshed</span><span class="p">)))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.get_bundle_detail_data">
    <p>def <span class="ident">get_bundle_detail_data</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Convenience method to return the <code>detail_uri_name</code> attribute off
<code>bundle.obj</code>.</p>
<p>Usually just accesses <code>bundle.obj.pk</code> by default.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.get_bundle_detail_data', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.get_bundle_detail_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_bundle_detail_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convenience method to return the ``detail_uri_name`` attribute off</span>
<span class="sd">    ``bundle.obj``.</span>
<span class="sd">    Usually just accesses ``bundle.obj.pk`` by default.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.get_detail">
    <p>def <span class="ident">get_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Used in the saved search method on the front end to return 
the molecule that should be structure searched
This caching needs an upgrade to use the database instead as saved search 
could be retrieved in a different session</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.get_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.get_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Used in the saved search method on the front end to return </span>
<span class="sd">    the molecule that should be structure searched</span>
<span class="sd">    This caching needs an upgrade to use the database instead as saved search </span>
<span class="sd">    could be retrieved in a different session</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="n">bundle</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">caches</span><span class="p">[</span><span class="n">settings</span><span class="o">.</span><span class="n">SESSION_CACHE_ALIAS</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;structure_search__</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pk&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">))</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.get_list">
    <p>def <span class="ident">get_list</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns a serialized list of resources.</p>
<p>Calls <code>obj_get_list</code> to provide the data, then handles that result
set and serializes it.</p>
<p>Should return a HttpResponse (200 OK).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.get_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.get_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a serialized list of resources.</span>
<span class="sd">    Calls ``obj_get_list`` to provide the data, then handles that result</span>
<span class="sd">    set and serializes it.</span>
<span class="sd">    Should return a HttpResponse (200 OK).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO: Uncached for now. Invalidation that works for everyone may be</span>
    <span class="c1">#       impossible.</span>
    <span class="n">base_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="n">objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">base_bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="n">sorted_objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_sorting</span><span class="p">(</span><span class="n">objects</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="p">)</span>
    <span class="n">paginator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">paginator_class</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="p">,</span> <span class="n">sorted_objects</span><span class="p">,</span> <span class="n">resource_uri</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_resource_uri</span><span class="p">(),</span> <span class="n">limit</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">limit</span><span class="p">,</span> <span class="n">max_limit</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">max_limit</span><span class="p">,</span> <span class="n">collection_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">)</span>
    <span class="n">to_be_serialized</span> <span class="o">=</span> <span class="n">paginator</span><span class="o">.</span><span class="n">page</span><span class="p">()</span>
    <span class="c1"># Dehydrate the bundles in preparation for serialization.</span>
    <span class="n">bundles</span> <span class="o">=</span> <span class="p">[</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">),</span> <span class="n">for_list</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">to_be_serialized</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">]</span>
    <span class="p">]</span>
    <span class="n">to_be_serialized</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">bundles</span>
    <span class="n">to_be_serialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_list_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">to_be_serialized</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">to_be_serialized</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.get_multiple">
    <p>def <span class="ident">get_multiple</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns a serialized list of resources based on the identifiers
from the URL.</p>
<p>Calls <code>obj_get</code> to fetch only the objects requested. This method
only responds to HTTP GET.</p>
<p>Should return a HttpResponse (200 OK).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.get_multiple', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.get_multiple" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_multiple</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a serialized list of resources based on the identifiers</span>
<span class="sd">    from the URL.</span>
<span class="sd">    Calls ``obj_get`` to fetch only the objects requested. This method</span>
<span class="sd">    only responds to HTTP GET.</span>
<span class="sd">    Should return a HttpResponse (200 OK).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">method_check</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">allowed</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;get&#39;</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">throttle_check</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="c1"># Rip apart the list then iterate.</span>
    <span class="n">kwarg_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_list&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span>
    <span class="n">obj_identifiers</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">kwarg_name</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
    <span class="n">objects</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">not_found</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">base_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">identifier</span> <span class="ow">in</span> <span class="n">obj_identifiers</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">base_bundle</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">:</span> <span class="n">identifier</span><span class="p">})</span>
            <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
            <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="n">for_list</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="n">objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">ObjectDoesNotExist</span><span class="p">,</span> <span class="n">Unauthorized</span><span class="p">):</span>
            <span class="n">not_found</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">identifier</span><span class="p">)</span>
    <span class="n">object_list</span> <span class="o">=</span> <span class="p">{</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">:</span> <span class="n">objects</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">not_found</span><span class="p">):</span>
        <span class="n">object_list</span><span class="p">[</span><span class="s1">&#39;not_found&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">not_found</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_throttled_access</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">object_list</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.get_object_list">
    <p>def <span class="ident">get_object_list</span>(</p><p>self, request)</p>
    </div>
    

    
  
    <div class="desc"><p>A hook to allow making returning the list of available objects.</p>
<p>This needs to be implemented at the user level.</p>
<p><code>ModelResource</code> includes a full working version specific to Django's
<code>Models</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.get_object_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.get_object_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_object_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to allow making returning the list of available objects.</span>
<span class="sd">    This needs to be implemented at the user level.</span>
<span class="sd">    ``ModelResource`` includes a full working version specific to Django&#39;s</span>
<span class="sd">    ``Models``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.get_resource_uri">
    <p>def <span class="ident">get_resource_uri</span>(</p><p>self, bundle_or_obj=None, url_name=u&#39;api_dispatch_list&#39;)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles generating a resource URI.</p>
<p>If the <code>bundle_or_obj</code> argument is not provided, it builds the URI
for the list endpoint.</p>
<p>If the <code>bundle_or_obj</code> argument is provided, it builds the URI for
the detail endpoint.</p>
<p>Return the generated URI. If that URI can not be reversed (not found
in the URLconf), it will return an empty string.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.get_resource_uri', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.get_resource_uri" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_resource_uri</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle_or_obj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">url_name</span><span class="o">=</span><span class="s1">&#39;api_dispatch_list&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles generating a resource URI.</span>
<span class="sd">    If the ``bundle_or_obj`` argument is not provided, it builds the URI</span>
<span class="sd">    for the list endpoint.</span>
<span class="sd">    If the ``bundle_or_obj`` argument is provided, it builds the URI for</span>
<span class="sd">    the detail endpoint.</span>
<span class="sd">    Return the generated URI. If that URI can not be reversed (not found</span>
<span class="sd">    in the URLconf), it will return an empty string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">bundle_or_obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">url_name</span> <span class="o">=</span> <span class="s1">&#39;api_dispatch_detail&#39;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_reverse_url</span><span class="p">(</span><span class="n">url_name</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resource_uri_kwargs</span><span class="p">(</span><span class="n">bundle_or_obj</span><span class="p">))</span>
    <span class="k">except</span> <span class="n">NoReverseMatch</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.get_schema">
    <p>def <span class="ident">get_schema</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns a serialized form of the schema of the resource.</p>
<p>Calls <code>build_schema</code> to generate the data. This method only responds
to HTTP GET.</p>
<p>Should return a HttpResponse (200 OK).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.get_schema', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.get_schema" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a serialized form of the schema of the resource.</span>
<span class="sd">    Calls ``build_schema`` to generate the data. This method only responds</span>
<span class="sd">    to HTTP GET.</span>
<span class="sd">    Should return a HttpResponse (200 OK).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">method_check</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">allowed</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;get&#39;</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">throttle_check</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_throttled_access</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">authorized_read_detail</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">),</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_schema</span><span class="p">())</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.get_via_uri">
    <p>def <span class="ident">get_via_uri</span>(</p><p>self, uri, request=None)</p>
    </div>
    

    
  
    <div class="desc"><p>This pulls apart the salient bits of the URI and populates the
resource via a <code>obj_get</code>.</p>
<p>Optionally accepts a <code>request</code>.</p>
<p>If you need custom behavior based on other portions of the URI,
simply override this method.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.get_via_uri', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.get_via_uri" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_via_uri</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uri</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This pulls apart the salient bits of the URI and populates the</span>
<span class="sd">    resource via a ``obj_get``.</span>
<span class="sd">    Optionally accepts a ``request``.</span>
<span class="sd">    If you need custom behavior based on other portions of the URI,</span>
<span class="sd">    simply override this method.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="n">get_script_prefix</span><span class="p">()</span>
    <span class="n">chomped_uri</span> <span class="o">=</span> <span class="n">uri</span>
    <span class="k">if</span> <span class="n">prefix</span> <span class="ow">and</span> <span class="n">chomped_uri</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">prefix</span><span class="p">):</span>
        <span class="n">chomped_uri</span> <span class="o">=</span> <span class="n">chomped_uri</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:]</span>
    <span class="c1"># We mangle the path a bit further &amp; run URL resolution against *only*</span>
    <span class="c1"># the current class. This ought to prevent bad URLs from resolving to</span>
    <span class="c1"># incorrect data.</span>
    <span class="n">found_at</span> <span class="o">=</span> <span class="n">chomped_uri</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">found_at</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">NotFound</span><span class="p">(</span><span class="s2">&quot;An incorrect URL was provided &#39;</span><span class="si">%s</span><span class="s2">&#39; for the &#39;</span><span class="si">%s</span><span class="s2">&#39; resource.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">))</span>
    <span class="n">chomped_uri</span> <span class="o">=</span> <span class="n">chomped_uri</span><span class="p">[</span><span class="n">found_at</span><span class="p">:]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">url_resolver</span> <span class="ow">in</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;urls&#39;</span><span class="p">,</span> <span class="p">[]):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">url_resolver</span><span class="o">.</span><span class="n">resolve</span><span class="p">(</span><span class="n">chomped_uri</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">view</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span> <span class="o">=</span> <span class="n">result</span>
                <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Resolver404</span><span class="p">(</span><span class="s2">&quot;URI not found in &#39;self.urls&#39;.&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">Resolver404</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">NotFound</span><span class="p">(</span><span class="s2">&quot;The URL provided &#39;</span><span class="si">%s</span><span class="s2">&#39; was not a link to a valid resource.&quot;</span> <span class="o">%</span> <span class="n">uri</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.hydrate">
    <p>def <span class="ident">hydrate</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>A hook to allow an initial manipulation of data before all methods/fields
have built out the hydrated data.</p>
<p>Useful if you need to access more than one hydrated field or want
to annotate on additional data.</p>
<p>Must return the modified bundle.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.hydrate', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.hydrate" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">hydrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to allow an initial manipulation of data before all methods/fields</span>
<span class="sd">    have built out the hydrated data.</span>
<span class="sd">    Useful if you need to access more than one hydrated field or want</span>
<span class="sd">    to annotate on additional data.</span>
<span class="sd">    Must return the modified bundle.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.hydrate_m2m">
    <p>def <span class="ident">hydrate_m2m</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Populate the ManyToMany data on the instance.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.hydrate_m2m', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.hydrate_m2m" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">hydrate_m2m</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Populate the ManyToMany data on the instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrationError</span><span class="p">(</span><span class="s2">&quot;You must call &#39;full_hydrate&#39; before attempting to run &#39;hydrate_m2m&#39; on </span><span class="si">%r</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span>
            <span class="c1"># Note that we only hydrate the data, leaving the instance</span>
            <span class="c1"># unmodified. It&#39;s up to the user&#39;s code to handle this.</span>
            <span class="c1"># The ``ModelResource`` provides a working baseline</span>
            <span class="c1"># in this regard.</span>
            <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">hydrate_m2m</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;hydrate_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
            <span class="n">method</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.is_authenticated">
    <p>def <span class="ident">is_authenticated</span>(</p><p>self, request)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking if the user is authenticated and dealing with
unauthenticated users.</p>
<p>Mostly a hook, this uses class assigned to <code>authentication</code> from
<code>Resource._meta</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.is_authenticated', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.is_authenticated" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">is_authenticated</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking if the user is authenticated and dealing with</span>
<span class="sd">    unauthenticated users.</span>
<span class="sd">    Mostly a hook, this uses class assigned to ``authentication`` from</span>
<span class="sd">    ``Resource._meta``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Authenticate the request as needed.</span>
    <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authentication</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">auth_result</span><span class="p">,</span> <span class="n">HttpResponse</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">auth_result</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">auth_result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpUnauthorized</span><span class="p">())</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.is_valid">
    <p>def <span class="ident">is_valid</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking if the data provided by the user is valid.</p>
<p>Mostly a hook, this uses class assigned to <code>validation</code> from
<code>Resource._meta</code>.</p>
<p>If validation fails, an error is raised with the error messages
serialized inside it.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.is_valid', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.is_valid" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking if the data provided by the user is valid.</span>
<span class="sd">    Mostly a hook, this uses class assigned to ``validation`` from</span>
<span class="sd">    ``Resource._meta``.</span>
<span class="sd">    If validation fails, an error is raised with the error messages</span>
<span class="sd">    serialized inside it.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">validation</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">errors</span><span class="p">:</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">errors</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">errors</span>
        <span class="k">return</span> <span class="bp">False</span>
    <span class="k">return</span> <span class="bp">True</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.log_throttled_access">
    <p>def <span class="ident">log_throttled_access</span>(</p><p>self, request)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles the recording of the user's access for throttling purposes.</p>
<p>Mostly a hook, this uses class assigned to <code>throttle</code> from
<code>Resource._meta</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.log_throttled_access', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.log_throttled_access" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">log_throttled_access</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles the recording of the user&#39;s access for throttling purposes.</span>
<span class="sd">    Mostly a hook, this uses class assigned to ``throttle`` from</span>
<span class="sd">    ``Resource._meta``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">request_method</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">throttle</span><span class="o">.</span><span class="n">accessed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authentication</span><span class="o">.</span><span class="n">get_identifier</span><span class="p">(</span><span class="n">request</span><span class="p">),</span> <span class="n">url</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">get_full_path</span><span class="p">(),</span> <span class="n">request_method</span><span class="o">=</span><span class="n">request_method</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.method_check">
    <p>def <span class="ident">method_check</span>(</p><p>self, request, allowed=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Ensures that the HTTP method used on the request is allowed to be
handled by the resource.</p>
<p>Takes an <code>allowed</code> parameter, which should be a list of lowercase
HTTP methods to check against. Usually, this looks like::</p>
<div class="codehilite"><pre><span></span># The most generic lookup.
self.method_check(request, self._meta.allowed_methods)

# A lookup against what&#39;s allowed for list-type methods.
self.method_check(request, self._meta.list_allowed_methods)

# A useful check when creating a new endpoint that only handles
# GET.
self.method_check(request, [&#39;get&#39;])
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.method_check', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.method_check" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">method_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">allowed</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Ensures that the HTTP method used on the request is allowed to be</span>
<span class="sd">    handled by the resource.</span>
<span class="sd">    Takes an ``allowed`` parameter, which should be a list of lowercase</span>
<span class="sd">    HTTP methods to check against. Usually, this looks like::</span>
<span class="sd">        # The most generic lookup.</span>
<span class="sd">        self.method_check(request, self._meta.allowed_methods)</span>
<span class="sd">        # A lookup against what&#39;s allowed for list-type methods.</span>
<span class="sd">        self.method_check(request, self._meta.list_allowed_methods)</span>
<span class="sd">        # A useful check when creating a new endpoint that only handles</span>
<span class="sd">        # GET.</span>
<span class="sd">        self.method_check(request, [&#39;get&#39;])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">allowed</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">allowed</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">request_method</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">allows</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">meth</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">allowed</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">request_method</span> <span class="o">==</span> <span class="s2">&quot;options&quot;</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="n">allows</span><span class="p">)</span>
        <span class="n">response</span><span class="p">[</span><span class="s1">&#39;Allow&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">allows</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">request_method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpMethodNotAllowed</span><span class="p">(</span><span class="n">allows</span><span class="p">)</span>
        <span class="n">response</span><span class="p">[</span><span class="s1">&#39;Allow&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">allows</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">request_method</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.obj_create">
    <p>def <span class="ident">obj_create</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Generate a task id and send the relevant tasks to django q</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.obj_create', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.obj_create" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate a task id and send the relevant tasks to django q</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pids</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pids&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="n">project_ids</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">pids</span><span class="p">:</span>
        <span class="n">project_ids</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">pid</span><span class="p">)</span> <span class="k">for</span> <span class="n">pid</span> <span class="ow">in</span> <span class="n">pids</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)]</span>
    
    <span class="n">allowed_pids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">project_ids</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">))</span>
    
    <span class="k">for</span> <span class="n">requested_pid</span> <span class="ow">in</span> <span class="n">project_ids</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">requested_pid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_pids</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">(</span><span class="s2">&quot;No permissions for requested project&quot;</span><span class="p">)</span> 
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">project_ids</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">project_ids</span> <span class="o">=</span> <span class="n">allowed_pids</span>
    <span class="n">allowed_pids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">allowed_pids</span><span class="p">)</span>
    <span class="n">one_eighth</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">allowed_pids</span><span class="p">)</span><span class="o">/</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="c1">#Split the projects into 8 equal parts</span>
    <span class="n">pid_chunks</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">chunks</span><span class="p">(</span><span class="n">allowed_pids</span><span class="p">,</span> <span class="n">one_eighth</span><span class="p">))</span>
    <span class="n">args</span> <span class="o">=</span> <span class="p">[(</span><span class="n">pid_list</span><span class="p">,</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;query_type&quot;</span><span class="p">],</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;smiles&quot;</span><span class="p">])</span> <span class="k">for</span> <span class="n">pid_list</span> <span class="ow">in</span> <span class="n">pid_chunks</span><span class="p">]</span>
    <span class="n">bundle</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_task_id</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.obj_delete">
    <p>def <span class="ident">obj_delete</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Deletes a single object.</p>
<p>This needs to be implemented at the user level.</p>
<p><code>ModelResource</code> includes a full working version specific to Django's
<code>Models</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.obj_delete', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.obj_delete" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Deletes a single object.</span>
<span class="sd">    This needs to be implemented at the user level.</span>
<span class="sd">    ``ModelResource`` includes a full working version specific to Django&#39;s</span>
<span class="sd">    ``Models``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.obj_delete_list">
    <p>def <span class="ident">obj_delete_list</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Deletes an entire list of objects.</p>
<p>This needs to be implemented at the user level.</p>
<p><code>ModelResource</code> includes a full working version specific to Django's
<code>Models</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.obj_delete_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.obj_delete_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_delete_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Deletes an entire list of objects.</span>
<span class="sd">    This needs to be implemented at the user level.</span>
<span class="sd">    ``ModelResource`` includes a full working version specific to Django&#39;s</span>
<span class="sd">    ``Models``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.obj_delete_list_for_update">
    <p>def <span class="ident">obj_delete_list_for_update</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Deletes an entire list of objects, specific to PUT list.</p>
<p>This needs to be implemented at the user level.</p>
<p><code>ModelResource</code> includes a full working version specific to Django's
<code>Models</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.obj_delete_list_for_update', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.obj_delete_list_for_update" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_delete_list_for_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Deletes an entire list of objects, specific to PUT list.</span>
<span class="sd">    This needs to be implemented at the user level.</span>
<span class="sd">    ``ModelResource`` includes a full working version specific to Django&#39;s</span>
<span class="sd">    ``Models``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.obj_get">
    <p>def <span class="ident">obj_get</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Fetches an individual object on the resource.</p>
<p>This needs to be implemented at the user level. If the object can not
be found, this should raise a <code>NotFound</code> exception.</p>
<p><code>ModelResource</code> includes a full working version specific to Django's
<code>Models</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.obj_get', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.obj_get" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fetches an individual object on the resource.</span>
<span class="sd">    This needs to be implemented at the user level. If the object can not</span>
<span class="sd">    be found, this should raise a ``NotFound`` exception.</span>
<span class="sd">    ``ModelResource`` includes a full working version specific to Django&#39;s</span>
<span class="sd">    ``Models``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.obj_get_list">
    <p>def <span class="ident">obj_get_list</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Fetches the list of objects available on the resource.</p>
<p>This needs to be implemented at the user level.</p>
<p><code>ModelResource</code> includes a full working version specific to Django's
<code>Models</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.obj_get_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.obj_get_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_get_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fetches the list of objects available on the resource.</span>
<span class="sd">    This needs to be implemented at the user level.</span>
<span class="sd">    ``ModelResource`` includes a full working version specific to Django&#39;s</span>
<span class="sd">    ``Models``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.obj_update">
    <p>def <span class="ident">obj_update</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Updates an existing object (or creates a new object) based on the
provided data.</p>
<p>This needs to be implemented at the user level.</p>
<p><code>ModelResource</code> includes a full working version specific to Django's
<code>Models</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.obj_update', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.obj_update" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates an existing object (or creates a new object) based on the</span>
<span class="sd">    provided data.</span>
<span class="sd">    This needs to be implemented at the user level.</span>
<span class="sd">    ``ModelResource`` includes a full working version specific to Django&#39;s</span>
<span class="sd">    ``Models``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.override_urls">
    <p>def <span class="ident">override_urls</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Deprecated. Will be removed by v1.0.0. Please use <code>prepend_urls</code> instead.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.override_urls', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.override_urls" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">override_urls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Deprecated. Will be removed by v1.0.0. Please use ``prepend_urls`` instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.patch_detail">
    <p>def <span class="ident">patch_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Updates a resource in-place.</p>
<p>Calls <code>obj_update</code>.</p>
<p>If the resource is updated, return <code>HttpAccepted</code> (202 Accepted).
If the resource did not exist, return <code>HttpNotFound</code> (404 Not Found).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.patch_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.patch_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">patch_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates a resource in-place.</span>
<span class="sd">    Calls ``obj_update``.</span>
<span class="sd">    If the resource is updated, return ``HttpAccepted`` (202 Accepted).</span>
<span class="sd">    If the resource did not exist, return ``HttpNotFound`` (404 Not Found).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">request</span> <span class="o">=</span> <span class="n">convert_post_to_patch</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="n">basic_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="c1"># We want to be able to validate the update, but we can&#39;t just pass</span>
    <span class="c1"># the partial data into the validator since all data needs to be</span>
    <span class="c1"># present. Instead, we basically simulate a PUT by pulling out the</span>
    <span class="c1"># original data and updating it in-place.</span>
    <span class="c1"># So first pull out the original object. This is essentially</span>
    <span class="c1"># ``get_detail``.</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cached_obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">basic_bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="k">except</span> <span class="n">ObjectDoesNotExist</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNotFound</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">MultipleObjectsReturned</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpMultipleChoices</span><span class="p">(</span><span class="s2">&quot;More than one resource is found at this URI.&quot;</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="c1"># Now update the bundle in-place.</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">update_in_place</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">deserialized</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">always_return_data</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpAccepted</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Invalidate prefetched_objects_cache for bundled object</span>
        <span class="c1"># because we might have changed a prefetched field</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_prefetched_objects_cache</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpAccepted</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.patch_list">
    <p>def <span class="ident">patch_list</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Updates a collection in-place.</p>
<p>The exact behavior of <code>PATCH</code> to a list resource is still the matter of
some debate in REST circles, and the <code>PATCH</code> RFC isn't standard. So the
behavior this method implements (described below) is something of a
stab in the dark. It's mostly cribbed from GData, with a smattering
of ActiveResource-isms and maybe even an original idea or two.</p>
<p>The <code>PATCH</code> format is one that's similar to the response returned from
a <code>GET</code> on a list resource::</p>
<div class="codehilite"><pre><span></span>{
  &quot;objects&quot;: [{object}, {object}, ...],
  &quot;deleted_objects&quot;: [&quot;URI&quot;, &quot;URI&quot;, &quot;URI&quot;, ...],
}
</pre></div>


<p>For each object in <code>objects</code>:</p>
<div class="codehilite"><pre><span></span>* If the dict does not have a ``resource_uri`` key then the item is
  considered &quot;new&quot; and is handled like a ``POST`` to the resource list.

* If the dict has a ``resource_uri`` key and the ``resource_uri`` refers
  to an existing resource then the item is a update; it&#39;s treated
  like a ``PATCH`` to the corresponding resource detail.

* If the dict has a ``resource_uri`` but the resource *doesn&#39;t* exist,
  then this is considered to be a create-via-``PUT``.
</pre></div>


<p>Each entry in <code>deleted_objects</code> referes to a resource URI of an existing
resource to be deleted; each is handled like a <code>DELETE</code> to the relevent
resource.</p>
<p>In any case:</p>
<div class="codehilite"><pre><span></span>* If there&#39;s a resource URI it *must* refer to a resource of this
  type. It&#39;s an error to include a URI of a different resource.

* ``PATCH`` is all or nothing. If a single sub-operation fails, the
  entire request will fail and all resources will be rolled back.
</pre></div>


<ul>
<li>
<p>For <code>PATCH</code> to work, you <strong>must</strong> have <code>put</code> in your
    :ref:<code>detail-allowed-methods</code> setting.</p>
</li>
<li>
<p>To delete objects via <code>deleted_objects</code> in a <code>PATCH</code> request you
    <strong>must</strong> have <code>delete</code> in your :ref:<code>detail-allowed-methods</code>
    setting.</p>
</li>
</ul>
<p>Substitute appropriate names for <code>objects</code> and
<code>deleted_objects</code> if <code>Meta.collection_name</code> is set to something
other than <code>objects</code> (default).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.patch_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.patch_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">patch_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates a collection in-place.</span>
<span class="sd">    The exact behavior of ``PATCH`` to a list resource is still the matter of</span>
<span class="sd">    some debate in REST circles, and the ``PATCH`` RFC isn&#39;t standard. So the</span>
<span class="sd">    behavior this method implements (described below) is something of a</span>
<span class="sd">    stab in the dark. It&#39;s mostly cribbed from GData, with a smattering</span>
<span class="sd">    of ActiveResource-isms and maybe even an original idea or two.</span>
<span class="sd">    The ``PATCH`` format is one that&#39;s similar to the response returned from</span>
<span class="sd">    a ``GET`` on a list resource::</span>
<span class="sd">        {</span>
<span class="sd">          &quot;objects&quot;: [{object}, {object}, ...],</span>
<span class="sd">          &quot;deleted_objects&quot;: [&quot;URI&quot;, &quot;URI&quot;, &quot;URI&quot;, ...],</span>
<span class="sd">        }</span>
<span class="sd">    For each object in ``objects``:</span>
<span class="sd">        * If the dict does not have a ``resource_uri`` key then the item is</span>
<span class="sd">          considered &quot;new&quot; and is handled like a ``POST`` to the resource list.</span>
<span class="sd">        * If the dict has a ``resource_uri`` key and the ``resource_uri`` refers</span>
<span class="sd">          to an existing resource then the item is a update; it&#39;s treated</span>
<span class="sd">          like a ``PATCH`` to the corresponding resource detail.</span>
<span class="sd">        * If the dict has a ``resource_uri`` but the resource *doesn&#39;t* exist,</span>
<span class="sd">          then this is considered to be a create-via-``PUT``.</span>
<span class="sd">    Each entry in ``deleted_objects`` referes to a resource URI of an existing</span>
<span class="sd">    resource to be deleted; each is handled like a ``DELETE`` to the relevent</span>
<span class="sd">    resource.</span>
<span class="sd">    In any case:</span>
<span class="sd">        * If there&#39;s a resource URI it *must* refer to a resource of this</span>
<span class="sd">          type. It&#39;s an error to include a URI of a different resource.</span>
<span class="sd">        * ``PATCH`` is all or nothing. If a single sub-operation fails, the</span>
<span class="sd">          entire request will fail and all resources will be rolled back.</span>
<span class="sd">      * For ``PATCH`` to work, you **must** have ``put`` in your</span>
<span class="sd">        :ref:`detail-allowed-methods` setting.</span>
<span class="sd">      * To delete objects via ``deleted_objects`` in a ``PATCH`` request you</span>
<span class="sd">        **must** have ``delete`` in your :ref:`detail-allowed-methods`</span>
<span class="sd">        setting.</span>
<span class="sd">    Substitute appropriate names for ``objects`` and</span>
<span class="sd">    ``deleted_objects`` if ``Meta.collection_name`` is set to something</span>
<span class="sd">    other than ``objects`` (default).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">request</span> <span class="o">=</span> <span class="n">convert_post_to_patch</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">))</span>
    <span class="n">collection_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span>
    <span class="n">deleted_collection_name</span> <span class="o">=</span> <span class="s1">&#39;deleted_</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">collection_name</span>
    <span class="k">if</span> <span class="n">collection_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">deserialized</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">BadRequest</span><span class="p">(</span><span class="s2">&quot;Invalid data sent: missing &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="n">collection_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">deserialized</span><span class="p">[</span><span class="n">collection_name</span><span class="p">])</span> <span class="ow">and</span> <span class="s1">&#39;put&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_allowed_methods</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpMethodNotAllowed</span><span class="p">())</span>
    <span class="n">bundles_seen</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">deserialized</span><span class="p">[</span><span class="n">collection_name</span><span class="p">]:</span>
        <span class="c1"># If there&#39;s a resource_uri then this is either an</span>
        <span class="c1"># update-in-place or a create-via-PUT.</span>
        <span class="k">if</span> <span class="s2">&quot;resource_uri&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">uri</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;resource_uri&#39;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_via_uri</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
                <span class="c1"># The object does exist, so this is an update-in-place.</span>
                <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
                <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="n">for_list</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
                <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_in_place</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">(</span><span class="n">ObjectDoesNotExist</span><span class="p">,</span> <span class="n">MultipleObjectsReturned</span><span class="p">):</span>
                <span class="c1"># The object referenced by resource_uri doesn&#39;t exist,</span>
                <span class="c1"># so this is a create-by-PUT equivalent.</span>
                <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_deserialized_detail_data</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
                <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dict_strip_unicode_keys</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">obj_create</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># There&#39;s no resource URI, so this is a create call just</span>
            <span class="c1"># like a POST to the list resource.</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_deserialized_detail_data</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
            <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dict_strip_unicode_keys</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">obj_create</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">)</span>
        <span class="n">bundles_seen</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="n">deleted_collection</span> <span class="o">=</span> <span class="n">deserialized</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">deleted_collection_name</span><span class="p">,</span> <span class="p">[])</span>
    <span class="k">if</span> <span class="n">deleted_collection</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;delete&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_allowed_methods</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpMethodNotAllowed</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">uri</span> <span class="ow">in</span> <span class="n">deleted_collection</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_via_uri</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
            <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">obj_delete</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">always_return_data</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpAccepted</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">to_be_serialized</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;objects&#39;</span><span class="p">:</span> <span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">for_list</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">bundles_seen</span>
            <span class="p">]</span>
        <span class="p">}</span>
        <span class="n">to_be_serialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_list_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">to_be_serialized</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">to_be_serialized</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpAccepted</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.post_detail">
    <p>def <span class="ident">post_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Creates a new subcollection of the resource under a resource.</p>
<p>This is not implemented by default because most people's data models
aren't self-referential.</p>
<p>If a new resource is created, return <code>HttpCreated</code> (201 Created).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.post_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.post_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">post_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a new subcollection of the resource under a resource.</span>
<span class="sd">    This is not implemented by default because most people&#39;s data models</span>
<span class="sd">    aren&#39;t self-referential.</span>
<span class="sd">    If a new resource is created, return ``HttpCreated`` (201 Created).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNotImplemented</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.post_list">
    <p>def <span class="ident">post_list</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Takes an input molfile from a POST request and processes the structure search then
saves it to the session cache</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.post_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.post_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">post_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Takes an input molfile from a POST request and processes the structure search then</span>
<span class="sd">    saves it to the session cache </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">))</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_deserialized_detail_data</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">deserialized</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">deserialized</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_create</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    
    <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpCreated</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.prepend_urls">
    <p>def <span class="ident">prepend_urls</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>A hook for adding your own URLs or matching before the default URLs.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.prepend_urls', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.prepend_urls" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">prepend_urls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook for adding your own URLs or matching before the default URLs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.put_detail">
    <p>def <span class="ident">put_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Either updates an existing resource or creates a new one with the
provided data.</p>
<p>Calls <code>obj_update</code> with the provided data first, but falls back to
<code>obj_create</code> if the object does not already exist.</p>
<p>If a new resource is created, return <code>HttpCreated</code> (201 Created).
If <code>Meta.always_return_data = True</code>, there will be a populated body
of serialized data.</p>
<p>If an existing resource is modified and
<code>Meta.always_return_data = False</code> (default), return <code>HttpNoContent</code>
(204 No Content).
If an existing resource is modified and
<code>Meta.always_return_data = True</code>, return <code>HttpAccepted</code> (200
OK).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.put_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.put_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">put_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Either updates an existing resource or creates a new one with the</span>
<span class="sd">    provided data.</span>
<span class="sd">    Calls ``obj_update`` with the provided data first, but falls back to</span>
<span class="sd">    ``obj_create`` if the object does not already exist.</span>
<span class="sd">    If a new resource is created, return ``HttpCreated`` (201 Created).</span>
<span class="sd">    If ``Meta.always_return_data = True``, there will be a populated body</span>
<span class="sd">    of serialized data.</span>
<span class="sd">    If an existing resource is modified and</span>
<span class="sd">    ``Meta.always_return_data = False`` (default), return ``HttpNoContent``</span>
<span class="sd">    (204 No Content).</span>
<span class="sd">    If an existing resource is modified and</span>
<span class="sd">    ``Meta.always_return_data = True``, return ``HttpAccepted`` (200</span>
<span class="sd">    OK).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">))</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_deserialized_detail_data</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">deserialized</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dict_strip_unicode_keys</span><span class="p">(</span><span class="n">deserialized</span><span class="p">),</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_update</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">always_return_data</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNoContent</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Invalidate prefetched_objects_cache for bundled object</span>
            <span class="c1"># because we might have changed a prefetched field</span>
            <span class="n">updated_bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_prefetched_objects_cache</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">updated_bundle</span><span class="p">)</span>
            <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="p">(</span><span class="n">NotFound</span><span class="p">,</span> <span class="n">MultipleObjectsReturned</span><span class="p">):</span>
        <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_create</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="n">location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_uri</span><span class="p">(</span><span class="n">updated_bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">always_return_data</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpCreated</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">updated_bundle</span><span class="p">)</span>
            <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpCreated</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.put_list">
    <p>def <span class="ident">put_list</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Replaces a collection of resources with another collection.</p>
<p>Calls <code>delete_list</code> to clear out the collection then <code>obj_create</code>
with the provided the data to create the new collection.</p>
<p>Return <code>HttpNoContent</code> (204 No Content) if
<code>Meta.always_return_data = False</code> (default).</p>
<p>Return <code>HttpAccepted</code> (200 OK) if
<code>Meta.always_return_data = True</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.put_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.put_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">put_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Replaces a collection of resources with another collection.</span>
<span class="sd">    Calls ``delete_list`` to clear out the collection then ``obj_create``</span>
<span class="sd">    with the provided the data to create the new collection.</span>
<span class="sd">    Return ``HttpNoContent`` (204 No Content) if</span>
<span class="sd">    ``Meta.always_return_data = False`` (default).</span>
<span class="sd">    Return ``HttpAccepted`` (200 OK) if</span>
<span class="sd">    ``Meta.always_return_data = True``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">))</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_deserialized_list_data</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">deserialized</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">deserialized</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">BadRequest</span><span class="p">(</span><span class="s2">&quot;Invalid data sent: missing &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">)</span>
    <span class="n">basic_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">obj_delete_list_for_update</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">basic_bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="n">bundles_seen</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">object_data</span> <span class="ow">in</span> <span class="n">deserialized</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">]:</span>
        <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dict_strip_unicode_keys</span><span class="p">(</span><span class="n">object_data</span><span class="p">),</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
        <span class="c1"># Attempt to be transactional, deleting any previously created</span>
        <span class="c1"># objects if validation fails.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">obj_create</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
            <span class="n">bundles_seen</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ImmediateHttpResponse</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rollback</span><span class="p">(</span><span class="n">bundles_seen</span><span class="p">)</span>
            <span class="k">raise</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">always_return_data</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNoContent</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">to_be_serialized</span> <span class="o">=</span> <span class="p">{</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">:</span> <span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">for_list</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">bundles_seen</span>
            <span class="p">]</span>
        <span class="p">}</span>
        <span class="n">to_be_serialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_list_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">to_be_serialized</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">to_be_serialized</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.remove_api_resource_names">
    <p>def <span class="ident">remove_api_resource_names</span>(</p><p>self, url_dict)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a dictionary of regex matches from a URLconf, removes
<code>api_name</code> and/or <code>resource_name</code> if found.</p>
<p>This is useful for converting URLconf matches into something suitable
for data lookup. For example::</p>
<div class="codehilite"><pre><span></span>Model.objects.filter(**self.remove_api_resource_names(matches))
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.remove_api_resource_names', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.remove_api_resource_names" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">remove_api_resource_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url_dict</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a dictionary of regex matches from a URLconf, removes</span>
<span class="sd">    ``api_name`` and/or ``resource_name`` if found.</span>
<span class="sd">    This is useful for converting URLconf matches into something suitable</span>
<span class="sd">    for data lookup. For example::</span>
<span class="sd">        Model.objects.filter(**self.remove_api_resource_names(matches))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kwargs_subset</span> <span class="o">=</span> <span class="n">url_dict</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;api_name&#39;</span><span class="p">,</span> <span class="s1">&#39;resource_name&#39;</span><span class="p">]:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">del</span><span class="p">(</span><span class="n">kwargs_subset</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">pass</span>
    <span class="k">return</span> <span class="n">kwargs_subset</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.resource_uri_kwargs">
    <p>def <span class="ident">resource_uri_kwargs</span>(</p><p>self, bundle_or_obj=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Builds a dictionary of kwargs to help generate URIs.</p>
<p>Automatically provides the <code>Resource.Meta.resource_name</code> (and
optionally the <code>Resource.Meta.api_name</code> if populated by an <code>Api</code>
object).</p>
<p>If the <code>bundle_or_obj</code> argument is provided, it calls
<code>Resource.detail_uri_kwargs</code> for additional bits to create</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.resource_uri_kwargs', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.resource_uri_kwargs" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">resource_uri_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle_or_obj</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Builds a dictionary of kwargs to help generate URIs.</span>
<span class="sd">    Automatically provides the ``Resource.Meta.resource_name`` (and</span>
<span class="sd">    optionally the ``Resource.Meta.api_name`` if populated by an ``Api``</span>
<span class="sd">    object).</span>
<span class="sd">    If the ``bundle_or_obj`` argument is provided, it calls</span>
<span class="sd">    ``Resource.detail_uri_kwargs`` for additional bits to create</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;resource_name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;api_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span>
    <span class="k">if</span> <span class="n">bundle_or_obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">detail_uri_kwargs</span><span class="p">(</span><span class="n">bundle_or_obj</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">kwargs</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.rollback">
    <p>def <span class="ident">rollback</span>(</p><p>self, bundles)</p>
    </div>
    

    
  
    <div class="desc"><p>Given the list of bundles, delete all objects pertaining to those
bundles.</p>
<p>This needs to be implemented at the user level. No exceptions should
be raised if possible.</p>
<p><code>ModelResource</code> includes a full working version specific to Django's
<code>Models</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.rollback', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.rollback" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">rollback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundles</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given the list of bundles, delete all objects pertaining to those</span>
<span class="sd">    bundles.</span>
<span class="sd">    This needs to be implemented at the user level. No exceptions should</span>
<span class="sd">    be raised if possible.</span>
<span class="sd">    ``ModelResource`` includes a full working version specific to Django&#39;s</span>
<span class="sd">    ``Models``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.serialize">
    <p>def <span class="ident">serialize</span>(</p><p>self, request, data, format, options=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a request, data and a desired format, produces a serialized
version suitable for transfer over the wire.</p>
<p>Mostly a hook, this uses the <code>Serializer</code> from <code>Resource._meta</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.serialize', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.serialize" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">format</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a request, data and a desired format, produces a serialized</span>
<span class="sd">    version suitable for transfer over the wire.</span>
<span class="sd">    Mostly a hook, this uses the ``Serializer`` from ``Resource._meta``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span> <span class="o">=</span> <span class="n">options</span> <span class="ow">or</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="s1">&#39;text/javascript&#39;</span> <span class="ow">in</span> <span class="n">format</span><span class="p">:</span>
        <span class="c1"># get JSONP callback name. default to &quot;callback&quot;</span>
        <span class="n">callback</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;callback&#39;</span><span class="p">,</span> <span class="s1">&#39;callback&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_valid_jsonp_callback_value</span><span class="p">(</span><span class="n">callback</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">BadRequest</span><span class="p">(</span><span class="s1">&#39;JSONP callback name is invalid.&#39;</span><span class="p">)</span>
        <span class="n">options</span><span class="p">[</span><span class="s1">&#39;callback&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">callback</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">serializer</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">format</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.throttle_check">
    <p>def <span class="ident">throttle_check</span>(</p><p>self, request)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking if the user should be throttled.</p>
<p>Mostly a hook, this uses class assigned to <code>throttle</code> from
<code>Resource._meta</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.throttle_check', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.throttle_check" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">throttle_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking if the user should be throttled.</span>
<span class="sd">    Mostly a hook, this uses class assigned to ``throttle`` from</span>
<span class="sd">    ``Resource._meta``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">identifier</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authentication</span><span class="o">.</span><span class="n">get_identifier</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="c1"># Check to see if they should be throttled.</span>
    <span class="n">throttle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">throttle</span><span class="o">.</span><span class="n">should_be_throttled</span><span class="p">(</span><span class="n">identifier</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">throttle</span><span class="p">:</span>
        <span class="c1"># Throttle limit exceeded.</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpTooManyRequests</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">throttle</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">throttle</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="n">response</span><span class="p">[</span><span class="s1">&#39;Retry-After&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">throttle</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">throttle</span><span class="p">,</span> <span class="n">datetime</span><span class="p">):</span>
            <span class="n">response</span><span class="p">[</span><span class="s1">&#39;Retry-After&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">format_date_time</span><span class="p">(</span><span class="n">mktime</span><span class="p">(</span><span class="n">throttle</span><span class="o">.</span><span class="n">timetuple</span><span class="p">()))</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.unauthorized_result">
    <p>def <span class="ident">unauthorized_result</span>(</p><p>self, exception)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.unauthorized_result', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.unauthorized_result" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">unauthorized_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exception</span><span class="p">):</span>
    <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpUnauthorized</span><span class="p">())</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.update_in_place">
    <p>def <span class="ident">update_in_place</span>(</p><p>self, request, original_bundle, new_data)</p>
    </div>
    

    
  
    <div class="desc"><p>Update the object in original_bundle in-place using new_data.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.update_in_place', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.update_in_place" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">update_in_place</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">original_bundle</span><span class="p">,</span> <span class="n">new_data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Update the object in original_bundle in-place using new_data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">original_bundle</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">dict_strip_unicode_keys</span><span class="p">(</span><span class="n">new_data</span><span class="p">))</span>
    <span class="c1"># Now we&#39;ve got a bundle with the new data sitting in it and we&#39;re</span>
    <span class="c1"># we&#39;re basically in the same spot as a PUT request. SO the rest of this</span>
    <span class="c1"># function is cribbed from put_detail.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">alter_deserialized_detail_data</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">original_bundle</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bundle_detail_data</span><span class="p">(</span><span class="n">original_bundle</span><span class="p">),</span>
        <span class="s1">&#39;request&#39;</span><span class="p">:</span> <span class="n">request</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_update</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">original_bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHChemicalSearchResource.wrap_view">
    <p>def <span class="ident">wrap_view</span>(</p><p>self, view)</p>
    </div>
    

    
  
    <div class="desc"><p>Wraps methods so they can be called in a more functional way as well
as handling exceptions better.</p>
<p>Note that if <code>BadRequest</code> or an exception with a <code>response</code> attr
are seen, there is special handling to either present a message back
to the user or return the response traveling with the exception.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHChemicalSearchResource.wrap_view', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHChemicalSearchResource.wrap_view" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">wrap_view</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">view</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wraps methods so they can be called in a more functional way as well</span>
<span class="sd">    as handling exceptions better.</span>
<span class="sd">    Note that if ``BadRequest`` or an exception with a ``response`` attr</span>
<span class="sd">    are seen, there is special handling to either present a message back</span>
<span class="sd">    to the user or return the response traveling with the exception.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nd">@csrf_exempt</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">callback</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">view</span><span class="p">)</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">callback</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="c1"># Our response can vary based on a number of factors, use</span>
            <span class="c1"># the cache class to determine what we should ``Vary`` on so</span>
            <span class="c1"># caches won&#39;t return the wrong (cached) version.</span>
            <span class="n">varies</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="p">,</span> <span class="s2">&quot;varies&quot;</span><span class="p">,</span> <span class="p">[])</span>
            <span class="k">if</span> <span class="n">varies</span><span class="p">:</span>
                <span class="n">patch_vary_headers</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">varies</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">cacheable</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">response</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">cache_control</span><span class="p">():</span>
                    <span class="c1"># If the request is cacheable and we have a</span>
                    <span class="c1"># ``Cache-Control`` available then patch the header.</span>
                    <span class="n">patch_cache_control</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">cache_control</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">is_ajax</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">response</span><span class="o">.</span><span class="n">has_header</span><span class="p">(</span><span class="s2">&quot;Cache-Control&quot;</span><span class="p">):</span>
                <span class="c1"># IE excessively caches XMLHttpRequests, so we&#39;re disabling</span>
                <span class="c1"># the browser cache here.</span>
                <span class="c1"># See http://www.enhanceie.com/ie/bugs.asp for details.</span>
                <span class="n">patch_cache_control</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">no_cache</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">response</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">BadRequest</span><span class="p">,</span> <span class="n">fields</span><span class="o">.</span><span class="n">ApiFieldError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="n">sanitize</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s1">&#39;args&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">}</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpBadRequest</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="n">sanitize</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">messages</span><span class="p">)}</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpBadRequest</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1"># Prevent muting non-django&#39;s exceptions</span>
            <span class="c1"># i.e. RequestException from &#39;requests&#39; library</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s1">&#39;response&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">response</span><span class="p">,</span> <span class="n">HttpResponse</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">e</span><span class="o">.</span><span class="n">response</span>
            <span class="c1"># A real, non-expected exception.</span>
            <span class="c1"># Handle the case where the full traceback is more helpful</span>
            <span class="c1"># than the serialized error.</span>
            <span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">DEBUG</span> <span class="ow">and</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">settings</span><span class="p">,</span> <span class="s1">&#39;TASTYPIE_FULL_DEBUG&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
                <span class="k">raise</span>
            <span class="c1"># Re-raise the error to get a proper traceback when the error</span>
            <span class="c1"># happend during a test case</span>
            <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SERVER_NAME&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;testserver&#39;</span><span class="p">:</span>
                <span class="k">raise</span>
            <span class="c1"># Rather than re-raising, we&#39;re going to things similar to</span>
            <span class="c1"># what Django does. The difference is returning a serialized</span>
            <span class="c1"># error message.</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_500</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wrapper</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="cbh_chem_api.resources.CBHCompoundBatchResource" class="name">class <span class="ident">CBHCompoundBatchResource</span></p>
      
  
    <div class="desc"><p>Implementation of the compound batch API used for inventory and compound batch objects
fiter out saved searches from this list</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">CBHCompoundBatchResource</span><span class="p">(</span><span class="n">BaseCBHCompoundBatchResource</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Implementation of the compound batch API used for inventory and compound batch objects</span>
<span class="sd">    fiter out saved searches from this list&quot;&quot;&quot;</span>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">(</span><span class="n">BaseCBHCompoundBatchResource</span><span class="o">.</span><span class="n">Meta</span><span class="p">):</span>
        <span class="n">resource_name</span> <span class="o">=</span> <span class="s1">&#39;cbh_compound_batches_v2&#39;</span>


    
    <span class="k">def</span> <span class="nf">get_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Request data where the project is not of the saved search type&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">CBHCompoundBatchResource</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_list</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">extra_queries</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;query_type&quot;</span><span class="p">:</span> <span class="s2">&quot;pick_from_list&quot;</span><span class="p">,</span> <span class="s2">&quot;field_path&quot;</span> <span class="p">:</span> <span class="s2">&quot;projectfull.project_type.saved_search_project_type&quot;</span><span class="p">,</span> <span class="s2">&quot;pick_from_list&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;false&quot;</span><span class="p">]</span> <span class="p">}])</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#cbh_chem_api.resources.CBHCompoundBatchResource">CBHCompoundBatchResource</a></li>
          <li><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></li>
          <li>tastypie.resources.ModelResource</li>
          <li>tastypie.resources.BaseModelResource</li>
          <li>tastypie.resources.Resource</li>
          <li>__builtin__.object</li>
          </ul>
          <h3>Class variables</h3>
            <div class="item">
            <p id="cbh_chem_api.resources.CBHCompoundBatchResource.Meta" class="name">var <span class="ident">Meta</span></p>
            
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.Meta">Meta</a></code>
    </p>

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="cbh_chem_api.resources.CBHCompoundBatchResource.base_fields" class="name">var <span class="ident">base_fields</span></p>
            
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.base_fields">base_fields</a></code>
    </p>

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="cbh_chem_api.resources.CBHCompoundBatchResource.declared_fields" class="name">var <span class="ident">declared_fields</span></p>
            
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.declared_fields">declared_fields</a></code>
    </p>

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="cbh_chem_api.resources.CBHCompoundBatchResource.urls" class="name">var <span class="ident">urls</span></p>
            
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.urls">urls</a></code>
    </p>

            
  
    <div class="desc inherited"><p>The endpoints this <code>Resource</code> responds to.</p>
<p>Mostly a standard URLconf, this is suitable for either automatic use
when registered with an <code>Api</code> class or for including directly in
a URLconf should you choose to.</p></div>
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, api_name=None)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.__init__">__init__</a></code>
    </p>

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.__init__', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">api_name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="c1"># this can cause:</span>
    <span class="c1"># TypeError: object.__new__(method-wrapper) is not safe, use method-wrapper.__new__()</span>
    <span class="c1"># when trying to copy a generator used as a default. Wrap call to</span>
    <span class="c1"># generator in lambda to get around this error.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_fields</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">api_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span> <span class="o">=</span> <span class="n">api_name</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.alter_deserialized_detail_data">
    <p>def <span class="ident">alter_deserialized_detail_data</span>(</p><p>self, request, data)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.alter_deserialized_detail_data">alter_deserialized_detail_data</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A hook to alter detail data just after it has been received from the user &amp;
gets deserialized.</p>
<p>Useful for altering the user data before any hydration is applied.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.alter_deserialized_detail_data', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.alter_deserialized_detail_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">alter_deserialized_detail_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to alter detail data just after it has been received from the user &amp;</span>
<span class="sd">    gets deserialized.</span>
<span class="sd">    Useful for altering the user data before any hydration is applied.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.alter_deserialized_list_data">
    <p>def <span class="ident">alter_deserialized_list_data</span>(</p><p>self, request, data)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.alter_deserialized_list_data">alter_deserialized_list_data</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A hook to alter list data just after it has been received from the user &amp;
gets deserialized.</p>
<p>Useful for altering the user data before any hydration is applied.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.alter_deserialized_list_data', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.alter_deserialized_list_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">alter_deserialized_list_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to alter list data just after it has been received from the user &amp;</span>
<span class="sd">    gets deserialized.</span>
<span class="sd">    Useful for altering the user data before any hydration is applied.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.alter_detail_data_to_serialize">
    <p>def <span class="ident">alter_detail_data_to_serialize</span>(</p><p>self, request, data)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.alter_detail_data_to_serialize">alter_detail_data_to_serialize</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A hook to alter detail data just before it gets serialized &amp; sent to the user.</p>
<p>Useful for restructuring/renaming aspects of the what's going to be
sent.</p>
<p>Should accommodate for receiving a single bundle of data.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.alter_detail_data_to_serialize', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.alter_detail_data_to_serialize" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">alter_detail_data_to_serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to alter detail data just before it gets serialized &amp; sent to the user.</span>
<span class="sd">    Useful for restructuring/renaming aspects of the what&#39;s going to be</span>
<span class="sd">    sent.</span>
<span class="sd">    Should accommodate for receiving a single bundle of data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.alter_list_data_to_serialize">
    <p>def <span class="ident">alter_list_data_to_serialize</span>(</p><p>self, request, data)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.alter_list_data_to_serialize">alter_list_data_to_serialize</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A hook to alter list data just before it gets serialized &amp; sent to the user.</p>
<p>Useful for restructuring/renaming aspects of the what's going to be
sent.</p>
<p>Should accommodate for a list of objects, generally also including
meta data.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.alter_list_data_to_serialize', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.alter_list_data_to_serialize" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">alter_list_data_to_serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to alter list data just before it gets serialized &amp; sent to the user.</span>
<span class="sd">    Useful for restructuring/renaming aspects of the what&#39;s going to be</span>
<span class="sd">    sent.</span>
<span class="sd">    Should accommodate for a list of objects, generally also including</span>
<span class="sd">    meta data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.api_field_from_django_field">
    <p>def <span class="ident">api_field_from_django_field</span>(</p><p>cls, f, default=&lt;class &#39;tastypie.fields.CharField&#39;&gt;)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.api_field_from_django_field">api_field_from_django_field</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Returns the field type that would likely be associated with each
Django type.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.api_field_from_django_field', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.api_field_from_django_field" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">api_field_from_django_field</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">fields</span><span class="o">.</span><span class="n">CharField</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the field type that would likely be associated with each</span>
<span class="sd">    Django type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">default</span>
    <span class="n">internal_type</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">get_internal_type</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">internal_type</span> <span class="o">==</span> <span class="s1">&#39;DateField&#39;</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">DateField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="o">==</span> <span class="s1">&#39;DateTimeField&#39;</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">DateTimeField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;BooleanField&#39;</span><span class="p">,</span> <span class="s1">&#39;NullBooleanField&#39;</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">BooleanField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;FloatField&#39;</span><span class="p">,):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">FloatField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;DecimalField&#39;</span><span class="p">,):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">DecimalField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;IntegerField&#39;</span><span class="p">,</span> <span class="s1">&#39;PositiveIntegerField&#39;</span><span class="p">,</span> <span class="s1">&#39;PositiveSmallIntegerField&#39;</span><span class="p">,</span> <span class="s1">&#39;SmallIntegerField&#39;</span><span class="p">,</span> <span class="s1">&#39;AutoField&#39;</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">IntegerField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;FileField&#39;</span><span class="p">,</span> <span class="s1">&#39;ImageField&#39;</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">FileField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="o">==</span> <span class="s1">&#39;TimeField&#39;</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">TimeField</span>
    <span class="c1"># TODO: Perhaps enable these via introspection. The reason they&#39;re not enabled</span>
    <span class="c1">#       by default is the very different ``__init__`` they have over</span>
    <span class="c1">#       the other fields.</span>
    <span class="c1"># elif internal_type == &#39;ForeignKey&#39;:</span>
    <span class="c1">#     result = ForeignKey</span>
    <span class="c1"># elif internal_type == &#39;ManyToManyField&#39;:</span>
    <span class="c1">#     result = ManyToManyField</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.apply_authorization_limits">
    <p>def <span class="ident">apply_authorization_limits</span>(</p><p>self, request, object_list)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.apply_authorization_limits">apply_authorization_limits</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Deprecated.</p>
<p>FIXME: REMOVE BEFORE 1.0</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.apply_authorization_limits', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.apply_authorization_limits" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">apply_authorization_limits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">object_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Deprecated.</span>
<span class="sd">    FIXME: REMOVE BEFORE 1.0</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">apply_limits</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">object_list</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.apply_filters">
    <p>def <span class="ident">apply_filters</span>(</p><p>self, request, applicable_filters)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.apply_filters">apply_filters</a></code>
    </p>

    
  
    <div class="desc inherited"><p>An ORM-specific implementation of <code>apply_filters</code>.</p>
<p>The default simply applies the <code>applicable_filters</code> as <code>**kwargs</code>,
but should make it possible to do more advanced things.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.apply_filters', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.apply_filters" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">apply_filters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">applicable_filters</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An ORM-specific implementation of ``apply_filters``.</span>
<span class="sd">    The default simply applies the ``applicable_filters`` as ``**kwargs``,</span>
<span class="sd">    but should make it possible to do more advanced things.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">request</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="o">**</span><span class="n">applicable_filters</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.apply_sorting">
    <p>def <span class="ident">apply_sorting</span>(</p><p>self, obj_list, options=None)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.apply_sorting">apply_sorting</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Given a dictionary of options, apply some ORM-level sorting to the
provided <code>QuerySet</code>.</p>
<p>Looks for the <code>order_by</code> key and handles either ascending (just the
field name) or descending (the field name with a <code>-</code> in front).</p>
<p>The field name should be the resource field, <strong>NOT</strong> model field.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.apply_sorting', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.apply_sorting" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">apply_sorting</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_list</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a dictionary of options, apply some ORM-level sorting to the</span>
<span class="sd">    provided ``QuerySet``.</span>
<span class="sd">    Looks for the ``order_by`` key and handles either ascending (just the</span>
<span class="sd">    field name) or descending (the field name with a ``-`` in front).</span>
<span class="sd">    The field name should be the resource field, **NOT** model field.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">parameter_name</span> <span class="o">=</span> <span class="s1">&#39;order_by&#39;</span>
    <span class="k">if</span> <span class="s1">&#39;order_by&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;sort_by&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
            <span class="c1"># Nothing to alter the order. Return what we&#39;ve got.</span>
            <span class="k">return</span> <span class="n">obj_list</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;&#39;sort_by&#39; is a deprecated parameter. Please use &#39;order_by&#39; instead.&quot;</span><span class="p">)</span>
            <span class="n">parameter_name</span> <span class="o">=</span> <span class="s1">&#39;sort_by&#39;</span>
    <span class="n">order_by_args</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="s1">&#39;getlist&#39;</span><span class="p">):</span>
        <span class="n">order_bits</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">getlist</span><span class="p">(</span><span class="n">parameter_name</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">order_bits</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">parameter_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">order_bits</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="n">order_bits</span> <span class="o">=</span> <span class="p">[</span><span class="n">order_bits</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">order_by</span> <span class="ow">in</span> <span class="n">order_bits</span><span class="p">:</span>
        <span class="n">order_by_bits</span> <span class="o">=</span> <span class="n">order_by</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">LOOKUP_SEP</span><span class="p">)</span>
        <span class="n">field_name</span> <span class="o">=</span> <span class="n">order_by_bits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">order</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">order_by_bits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">):</span>
            <span class="n">field_name</span> <span class="o">=</span> <span class="n">order_by_bits</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
            <span class="n">order</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span>
        <span class="k">if</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
            <span class="c1"># It&#39;s not a field we know about. Move along citizen.</span>
            <span class="k">raise</span> <span class="n">InvalidSortError</span><span class="p">(</span><span class="s2">&quot;No matching &#39;</span><span class="si">%s</span><span class="s2">&#39; field for ordering on.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">ordering</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidSortError</span><span class="p">(</span><span class="s2">&quot;The &#39;</span><span class="si">%s</span><span class="s2">&#39; field does not allow ordering.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">attribute</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidSortError</span><span class="p">(</span><span class="s2">&quot;The &#39;</span><span class="si">%s</span><span class="s2">&#39; field has no &#39;attribute&#39; for ordering with.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="n">order_by_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">LOOKUP_SEP</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">attribute</span><span class="p">]</span> <span class="o">+</span> <span class="n">order_by_bits</span><span class="p">[</span><span class="mi">1</span><span class="p">:])))</span>
    <span class="k">return</span> <span class="n">obj_list</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="o">*</span><span class="n">order_by_args</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.authorized_create_detail">
    <p>def <span class="ident">authorized_create_detail</span>(</p><p>self, object_list, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_create_detail">authorized_create_detail</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles checking of permissions to see if the user has authorization
to POST this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.authorized_create_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.authorized_create_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_create_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to POST this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">create_detail</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">auth_result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.authorized_create_list">
    <p>def <span class="ident">authorized_create_list</span>(</p><p>self, object_list, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_create_list">authorized_create_list</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles checking of permissions to see if the user has authorization
to POST this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.authorized_create_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.authorized_create_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_create_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to POST this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">create_list</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.authorized_delete_detail">
    <p>def <span class="ident">authorized_delete_detail</span>(</p><p>self, object_list, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_delete_detail">authorized_delete_detail</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles checking of permissions to see if the user has authorization
to DELETE this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.authorized_delete_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.authorized_delete_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_delete_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to DELETE this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">delete_detail</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">auth_result</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.authorized_delete_list">
    <p>def <span class="ident">authorized_delete_list</span>(</p><p>self, object_list, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_delete_list">authorized_delete_list</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles checking of permissions to see if the user has authorization
to DELETE this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.authorized_delete_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.authorized_delete_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_delete_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to DELETE this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">delete_list</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.authorized_read_detail">
    <p>def <span class="ident">authorized_read_detail</span>(</p><p>self, object_list, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_read_detail">authorized_read_detail</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles checking of permissions to see if the user has authorization
to GET this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.authorized_read_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.authorized_read_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_read_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to GET this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">read_detail</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">auth_result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.authorized_read_list">
    <p>def <span class="ident">authorized_read_list</span>(</p><p>self, object_list, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_read_list">authorized_read_list</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles checking of permissions to see if the user has authorization
to GET this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.authorized_read_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.authorized_read_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_read_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to GET this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">read_list</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.authorized_update_detail">
    <p>def <span class="ident">authorized_update_detail</span>(</p><p>self, object_list, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_update_detail">authorized_update_detail</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles checking of permissions to see if the user has authorization
to PUT this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.authorized_update_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.authorized_update_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_update_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to PUT this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">update_detail</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">auth_result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.authorized_update_list">
    <p>def <span class="ident">authorized_update_list</span>(</p><p>self, object_list, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_update_list">authorized_update_list</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles checking of permissions to see if the user has authorization
to PUT this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.authorized_update_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.authorized_update_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_update_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to PUT this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">update_list</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.base_urls">
    <p>def <span class="ident">base_urls</span>(</p><p>self)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.base_urls">base_urls</a></code>
    </p>

    
  
    <div class="desc inherited"><p>The standard URLs this <code>Resource</code> should respond to.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.base_urls', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.base_urls" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">base_urls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The standard URLs this ``Resource`` should respond to.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="n">url</span><span class="p">(</span><span class="s2">r&quot;^(?P&lt;resource_name&gt;</span><span class="si">%s</span><span class="s2">)</span><span class="si">%s</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span> <span class="n">trailing_slash</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrap_view</span><span class="p">(</span><span class="s1">&#39;dispatch_list&#39;</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;api_dispatch_list&quot;</span><span class="p">),</span>
        <span class="n">url</span><span class="p">(</span><span class="s2">r&quot;^(?P&lt;resource_name&gt;</span><span class="si">%s</span><span class="s2">)/schema</span><span class="si">%s</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span> <span class="n">trailing_slash</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrap_view</span><span class="p">(</span><span class="s1">&#39;get_schema&#39;</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;api_get_schema&quot;</span><span class="p">),</span>
        <span class="n">url</span><span class="p">(</span><span class="s2">r&quot;^(?P&lt;resource_name&gt;</span><span class="si">%s</span><span class="s2">)/set/(?P&lt;</span><span class="si">%s</span><span class="s2">_list&gt;.*?)</span><span class="si">%s</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">,</span> <span class="n">trailing_slash</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrap_view</span><span class="p">(</span><span class="s1">&#39;get_multiple&#39;</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;api_get_multiple&quot;</span><span class="p">),</span>
        <span class="n">url</span><span class="p">(</span><span class="s2">r&quot;^(?P&lt;resource_name&gt;</span><span class="si">%s</span><span class="s2">)/(?P&lt;</span><span class="si">%s</span><span class="s2">&gt;.*?)</span><span class="si">%s</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">,</span> <span class="n">trailing_slash</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrap_view</span><span class="p">(</span><span class="s1">&#39;dispatch_detail&#39;</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;api_dispatch_detail&quot;</span><span class="p">),</span>
    <span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.build_bundle">
    <p>def <span class="ident">build_bundle</span>(</p><p>self, obj=None, data=None, request=None, objects_saved=None, via_uri=None)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.build_bundle">build_bundle</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Given either an object, a data dictionary or both, builds a <code>Bundle</code>
for use throughout the <code>dehydrate/hydrate</code> cycle.</p>
<p>If no object is provided, an empty object from
<code>Resource._meta.object_class</code> is created so that attempts to access
<code>bundle.obj</code> do not fail.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.build_bundle', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.build_bundle" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">build_bundle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">objects_saved</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">via_uri</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given either an object, a data dictionary or both, builds a ``Bundle``</span>
<span class="sd">    for use throughout the ``dehydrate/hydrate`` cycle.</span>
<span class="sd">    If no object is provided, an empty object from</span>
<span class="sd">    ``Resource._meta.object_class`` is created so that attempts to access</span>
<span class="sd">    ``bundle.obj`` do not fail.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="p">:</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">Bundle</span><span class="p">(</span>
        <span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span>
        <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
        <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">,</span>
        <span class="n">objects_saved</span><span class="o">=</span><span class="n">objects_saved</span><span class="p">,</span>
        <span class="n">via_uri</span><span class="o">=</span><span class="n">via_uri</span>
    <span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.build_filters">
    <p>def <span class="ident">build_filters</span>(</p><p>self, filters=None)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.build_filters">build_filters</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Given a dictionary of filters, create the necessary ORM-level filters.</p>
<p>Keys should be resource fields, <strong>NOT</strong> model fields.</p>
<p>Valid values are either a list of Django filter types (i.e.
<code>['startswith', 'exact', 'lte']</code>), the <code>ALL</code> constant or the
<code>ALL_WITH_RELATIONS</code> constant.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.build_filters', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.build_filters" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">build_filters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a dictionary of filters, create the necessary ORM-level filters.</span>
<span class="sd">    Keys should be resource fields, **NOT** model fields.</span>
<span class="sd">    Valid values are either a list of Django filter types (i.e.</span>
<span class="sd">    ``[&#39;startswith&#39;, &#39;exact&#39;, &#39;lte&#39;]``), the ``ALL`` constant or the</span>
<span class="sd">    ``ALL_WITH_RELATIONS`` constant.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># At the declarative level:</span>
    <span class="c1">#     filtering = {</span>
    <span class="c1">#         &#39;resource_field_name&#39;: [&#39;exact&#39;, &#39;startswith&#39;, &#39;endswith&#39;, &#39;contains&#39;],</span>
    <span class="c1">#         &#39;resource_field_name_2&#39;: [&#39;exact&#39;, &#39;gt&#39;, &#39;gte&#39;, &#39;lt&#39;, &#39;lte&#39;, &#39;range&#39;],</span>
    <span class="c1">#         &#39;resource_field_name_3&#39;: ALL,</span>
    <span class="c1">#         &#39;resource_field_name_4&#39;: ALL_WITH_RELATIONS,</span>
    <span class="c1">#         ...</span>
    <span class="c1">#     }</span>
    <span class="c1"># Accepts the filters as a dict. None by default, meaning no filters.</span>
    <span class="k">if</span> <span class="n">filters</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">filters</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">qs_filters</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="p">,</span> <span class="s1">&#39;queryset&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="c1"># Get the possible query terms from the current QuerySet.</span>
        <span class="n">query_terms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">queryset</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">query_terms</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">query_terms</span> <span class="o">=</span> <span class="n">QUERY_TERMS</span>
    <span class="k">if</span> <span class="n">django</span><span class="o">.</span><span class="n">VERSION</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span> <span class="ow">and</span> <span class="n">GeometryField</span><span class="p">:</span>
        <span class="n">query_terms</span> <span class="o">=</span> <span class="n">query_terms</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="n">GeometryField</span><span class="o">.</span><span class="n">class_lookups</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="k">for</span> <span class="n">filter_expr</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">filters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">filter_bits</span> <span class="o">=</span> <span class="n">filter_expr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">LOOKUP_SEP</span><span class="p">)</span>
        <span class="n">field_name</span> <span class="o">=</span> <span class="n">filter_bits</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">filter_type</span> <span class="o">=</span> <span class="s1">&#39;exact&#39;</span>
        <span class="k">if</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
            <span class="c1"># It&#39;s not a field we know about. Move along citizen.</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filter_bits</span><span class="p">)</span> <span class="ow">and</span> <span class="n">filter_bits</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">query_terms</span><span class="p">:</span>
            <span class="n">filter_type</span> <span class="o">=</span> <span class="n">filter_bits</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="n">lookup_bits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_filtering</span><span class="p">(</span><span class="n">field_name</span><span class="p">,</span> <span class="n">filter_type</span><span class="p">,</span> <span class="n">filter_bits</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_value_to_python</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">filters</span><span class="p">,</span> <span class="n">filter_expr</span><span class="p">,</span> <span class="n">filter_type</span><span class="p">)</span>
        <span class="n">db_field_name</span> <span class="o">=</span> <span class="n">LOOKUP_SEP</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lookup_bits</span><span class="p">)</span>
        <span class="n">qs_filter</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">db_field_name</span><span class="p">,</span> <span class="n">LOOKUP_SEP</span><span class="p">,</span> <span class="n">filter_type</span><span class="p">)</span>
        <span class="n">qs_filters</span><span class="p">[</span><span class="n">qs_filter</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
    <span class="k">return</span> <span class="n">dict_strip_unicode_keys</span><span class="p">(</span><span class="n">qs_filters</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.build_schema">
    <p>def <span class="ident">build_schema</span>(</p><p>self)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.build_schema">build_schema</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Returns a dictionary of all the fields on the resource and some
properties about those fields.</p>
<p>Used by the <code>schema/</code> endpoint to describe what will be available.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.build_schema', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.build_schema" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">build_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a dictionary of all the fields on the resource and some</span>
<span class="sd">    properties about those fields.</span>
<span class="sd">    Used by the ``schema/`` endpoint to describe what will be available.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;fields&#39;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s1">&#39;default_format&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">default_format</span><span class="p">,</span>
        <span class="s1">&#39;allowed_list_http_methods&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">list_allowed_methods</span><span class="p">,</span>
        <span class="s1">&#39;allowed_detail_http_methods&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_allowed_methods</span><span class="p">,</span>
        <span class="s1">&#39;default_limit&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">limit</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">ordering</span><span class="p">:</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;ordering&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">ordering</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span><span class="p">:</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;filtering&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span>
    <span class="c1"># Skip assigning pk_field_name for non-model resources</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">pk_field_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">queryset</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">pk</span><span class="o">.</span><span class="n">name</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="n">pk_field_name</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;fields&#39;</span><span class="p">][</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">default</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">dehydrated_type</span><span class="p">,</span>
            <span class="s1">&#39;nullable&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">null</span><span class="p">,</span>
            <span class="s1">&#39;blank&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">blank</span><span class="p">,</span>
            <span class="s1">&#39;readonly&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">readonly</span><span class="p">,</span>
            <span class="s1">&#39;help_text&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">help_text</span><span class="p">,</span>
            <span class="s1">&#39;unique&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">unique</span><span class="p">,</span>
            <span class="s1">&#39;primary_key&#39;</span><span class="p">:</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">field_name</span> <span class="o">==</span> <span class="n">pk_field_name</span> <span class="k">else</span> <span class="bp">False</span><span class="p">,</span>
            <span class="s1">&#39;verbose_name&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">verbose_name</span> <span class="ow">or</span> <span class="n">field_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">),</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">dehydrated_type</span> <span class="o">==</span> <span class="s1">&#39;related&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
                <span class="n">related_type</span> <span class="o">=</span> <span class="s1">&#39;to_many&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">related_type</span> <span class="o">=</span> <span class="s1">&#39;to_one&#39;</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;fields&#39;</span><span class="p">][</span><span class="n">field_name</span><span class="p">][</span><span class="s1">&#39;related_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">related_type</span>
            <span class="n">uri</span> <span class="o">=</span> <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;api_get_schema&#39;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;api_name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span><span class="p">,</span> <span class="s1">&#39;resource_name&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">to_class</span><span class="p">()</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">})</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;fields&#39;</span><span class="p">][</span><span class="n">field_name</span><span class="p">][</span><span class="s1">&#39;related_schema&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">uri</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.cached_obj_get">
    <p>def <span class="ident">cached_obj_get</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.cached_obj_get">cached_obj_get</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A version of <code>obj_get</code> that uses the cache as a means to get
commonly-accessed data faster.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.cached_obj_get', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.cached_obj_get" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">cached_obj_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A version of ``obj_get`` that uses the cache as a means to get</span>
<span class="sd">    commonly-accessed data faster.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_cache_key</span><span class="p">(</span><span class="s1">&#39;detail&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">cached_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cache_key</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">cached_bundle</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">cached_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">cache_key</span><span class="p">,</span> <span class="n">cached_bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cached_bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.cached_obj_get_list">
    <p>def <span class="ident">cached_obj_get_list</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.cached_obj_get_list">cached_obj_get_list</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A version of <code>obj_get_list</code> that uses the cache as a means to get
commonly-accessed data faster.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.cached_obj_get_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.cached_obj_get_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">cached_obj_get_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A version of ``obj_get_list`` that uses the cache as a means to get</span>
<span class="sd">    commonly-accessed data faster.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_cache_key</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">obj_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cache_key</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">obj_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">obj_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">cache_key</span><span class="p">,</span> <span class="n">obj_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">obj_list</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.can_create">
    <p>def <span class="ident">can_create</span>(</p><p>self)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.can_create">can_create</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Checks to ensure <code>post</code> is within <code>allowed_methods</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.can_create', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.can_create" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">can_create</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks to ensure ``post`` is within ``allowed_methods``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">allowed</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">list_allowed_methods</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_allowed_methods</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">&#39;post&#39;</span> <span class="ow">in</span> <span class="n">allowed</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.can_delete">
    <p>def <span class="ident">can_delete</span>(</p><p>self)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.can_delete">can_delete</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Checks to ensure <code>delete</code> is within <code>allowed_methods</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.can_delete', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.can_delete" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">can_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks to ensure ``delete`` is within ``allowed_methods``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">allowed</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">list_allowed_methods</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_allowed_methods</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">&#39;delete&#39;</span> <span class="ow">in</span> <span class="n">allowed</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.can_update">
    <p>def <span class="ident">can_update</span>(</p><p>self)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.can_update">can_update</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Checks to ensure <code>put</code> is within <code>allowed_methods</code>.</p>
<p>Used when hydrating related data.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.can_update', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.can_update" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">can_update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks to ensure ``put`` is within ``allowed_methods``.</span>
<span class="sd">    Used when hydrating related data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">allowed</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">list_allowed_methods</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_allowed_methods</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">&#39;put&#39;</span> <span class="ow">in</span> <span class="n">allowed</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.check_filtering">
    <p>def <span class="ident">check_filtering</span>(</p><p>self, field_name, filter_type=u&#39;exact&#39;, filter_bits=None)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.check_filtering">check_filtering</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Given a field name, a optional filter type and an optional list of
additional relations, determine if a field can be filtered on.</p>
<p>If a filter does not meet the needed conditions, it should raise an
<code>InvalidFilterError</code>.</p>
<p>If the filter meets the conditions, a list of attribute names (not
field names) will be returned.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.check_filtering', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.check_filtering" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">check_filtering</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">filter_type</span><span class="o">=</span><span class="s1">&#39;exact&#39;</span><span class="p">,</span> <span class="n">filter_bits</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a field name, a optional filter type and an optional list of</span>
<span class="sd">    additional relations, determine if a field can be filtered on.</span>
<span class="sd">    If a filter does not meet the needed conditions, it should raise an</span>
<span class="sd">    ``InvalidFilterError``.</span>
<span class="sd">    If the filter meets the conditions, a list of attribute names (not</span>
<span class="sd">    field names) will be returned.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">filter_bits</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">filter_bits</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">InvalidFilterError</span><span class="p">(</span><span class="s2">&quot;The &#39;</span><span class="si">%s</span><span class="s2">&#39; field does not allow filtering.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
    <span class="c1"># Check to see if it&#39;s an allowed lookup type.</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">ALL</span><span class="p">,</span> <span class="n">ALL_WITH_RELATIONS</span><span class="p">):</span>
        <span class="c1"># Must be an explicit whitelist.</span>
        <span class="k">if</span> <span class="n">filter_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span><span class="p">[</span><span class="n">field_name</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">InvalidFilterError</span><span class="p">(</span><span class="s2">&quot;&#39;</span><span class="si">%s</span><span class="s2">&#39; is not an allowed filter on the &#39;</span><span class="si">%s</span><span class="s2">&#39; field.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">filter_type</span><span class="p">,</span> <span class="n">field_name</span><span class="p">))</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">attribute</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">InvalidFilterError</span><span class="p">(</span><span class="s2">&quot;The &#39;</span><span class="si">%s</span><span class="s2">&#39; field has no &#39;attribute&#39; for searching with.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
    <span class="c1"># Check to see if it&#39;s a relational lookup and if that&#39;s allowed.</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filter_bits</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">],</span> <span class="s1">&#39;is_related&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">InvalidFilterError</span><span class="p">(</span><span class="s2">&quot;The &#39;</span><span class="si">%s</span><span class="s2">&#39; field does not support relations.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">==</span> <span class="n">ALL_WITH_RELATIONS</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidFilterError</span><span class="p">(</span><span class="s2">&quot;Lookups are not allowed more than one level deep on the &#39;</span><span class="si">%s</span><span class="s2">&#39; field.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="c1"># Recursively descend through the remaining lookups in the filter,</span>
        <span class="c1"># if any. We should ensure that all along the way, we&#39;re allowed</span>
        <span class="c1"># to filter on that field by the related resource.</span>
        <span class="n">related_resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">get_related_resource</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">attribute</span><span class="p">]</span> <span class="o">+</span> <span class="n">related_resource</span><span class="o">.</span><span class="n">check_filtering</span><span class="p">(</span><span class="n">filter_bits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">filter_type</span><span class="p">,</span> <span class="n">filter_bits</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">attribute</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.create_identifier">
    <p>def <span class="ident">create_identifier</span>(</p><p>self, obj)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.create_identifier">create_identifier</a></code>
    </p>

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.create_identifier', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.create_identifier" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">create_identifier</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">u&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">app_label</span><span class="p">,</span> <span class="n">get_module_name</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">_meta</span><span class="p">),</span> <span class="n">obj</span><span class="o">.</span><span class="n">pk</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.create_response">
    <p>def <span class="ident">create_response</span>(</p><p>self, request, data, response_class=&lt;class &#39;django.http.response.HttpResponse&#39;&gt;, **response_kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.create_response">create_response</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Ensure that data is returned in the right format as an attachment if returning SDF or XLSX data
Should an object have been created or updated, now is the time to
reindex it in the elasticsearch index</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.create_response', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.create_response" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">create_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">HttpResponse</span><span class="p">,</span> <span class="o">**</span><span class="n">response_kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Ensure that data is returned in the right format as an attachment if returning SDF or XLSX data</span>
<span class="sd">    Should an object have been created or updated, now is the time to</span>
<span class="sd">    reindex it in the elasticsearch index</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">desired_format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">determine_format</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">response_class</span> <span class="o">==</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpCreated</span> <span class="ow">or</span> <span class="n">response_class</span> <span class="o">==</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpAccepted</span><span class="p">:</span>
        <span class="n">batches</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;objects&quot;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;objects&quot;</span><span class="p">):</span>
                <span class="n">batches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">batches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
        <span class="n">index_batches_in_new_index</span><span class="p">(</span><span class="n">batches</span><span class="p">)</span>
    <span class="n">serialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">desired_format</span><span class="p">)</span>
    <span class="n">rc</span> <span class="o">=</span> <span class="n">response_class</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">serialized</span><span class="p">,</span> <span class="n">content_type</span><span class="o">=</span><span class="n">build_content_type</span><span class="p">(</span>
        <span class="n">desired_format</span><span class="p">),</span> <span class="o">**</span><span class="n">response_kwargs</span><span class="p">)</span>
    <span class="k">if</span><span class="p">(</span><span class="n">desired_format</span> <span class="o">==</span> <span class="s1">&#39;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&#39;</span><span class="p">):</span>
        <span class="n">rc</span><span class="p">[</span><span class="s1">&#39;Content-Disposition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;attachment; filename=export_from_chembiohub_chemreg</span><span class="si">%d</span><span class="s1">.xlsx&#39;</span> <span class="o">%</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span>
    <span class="k">elif</span><span class="p">(</span><span class="n">desired_format</span> <span class="o">==</span> <span class="s1">&#39;chemical/x-mdl-sdfile&#39;</span><span class="p">):</span>
        <span class="n">rc</span><span class="p">[</span><span class="s1">&#39;Content-Disposition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;attachment; filename=export_from_chembiohub_chemreg</span><span class="si">%d</span><span class="s1">.sdf&#39;</span> <span class="o">%</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">rc</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.dehydrate">
    <p>def <span class="ident">dehydrate</span>(</p><p>self, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.dehydrate">dehydrate</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A hook to allow a final manipulation of data once all fields/methods
have built out the dehydrated data.</p>
<p>Useful if you need to access more than one dehydrated field or want
to annotate on additional data.</p>
<p>Must return the modified bundle.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.dehydrate', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.dehydrate" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dehydrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to allow a final manipulation of data once all fields/methods</span>
<span class="sd">    have built out the dehydrated data.</span>
<span class="sd">    Useful if you need to access more than one dehydrated field or want</span>
<span class="sd">    to annotate on additional data.</span>
<span class="sd">    Must return the modified bundle.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.dehydrate_properties">
    <p>def <span class="ident">dehydrate_properties</span>(</p><p>self, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.dehydrate_properties">dehydrate_properties</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Ensure that the archived property is always presented in a consistent way</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.dehydrate_properties', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.dehydrate_properties" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dehydrate_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Ensure that the archived property is always presented in a consistent way&quot;&quot;&quot;</span>
    <span class="n">archived</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;archived&quot;</span><span class="p">,</span> <span class="s2">&quot;false&quot;</span><span class="p">)</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">properties</span>
    <span class="n">value</span><span class="p">[</span><span class="s2">&quot;archived&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">archived</span>
    <span class="k">return</span> <span class="n">value</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.dehydrate_resource_uri">
    <p>def <span class="ident">dehydrate_resource_uri</span>(</p><p>self, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.dehydrate_resource_uri">dehydrate_resource_uri</a></code>
    </p>

    
  
    <div class="desc inherited"><p>For the automatically included <code>resource_uri</code> field, dehydrate
the URI for the given bundle.</p>
<p>Returns empty string if no URI can be generated.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.dehydrate_resource_uri', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.dehydrate_resource_uri" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dehydrate_resource_uri</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    For the automatically included ``resource_uri`` field, dehydrate</span>
<span class="sd">    the URI for the given bundle.</span>
<span class="sd">    Returns empty string if no URI can be generated.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_uri</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="k">except</span> <span class="n">NoReverseMatch</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.dehydrate_timestamp">
    <p>def <span class="ident">dehydrate_timestamp</span>(</p><p>self, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.dehydrate_timestamp">dehydrate_timestamp</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Provide a viewer-friendly timestamp</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.dehydrate_timestamp', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.dehydrate_timestamp" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dehydrate_timestamp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Provide a viewer-friendly timestamp&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">created</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.dehydrate_uuid">
    <p>def <span class="ident">dehydrate_uuid</span>(</p><p>self, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.dehydrate_uuid">dehydrate_uuid</a></code>
    </p>

    
  
    <div class="desc inherited"><p>This is either a blinded batch uuid or a uuid for the compound structure based on the INCHI key</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.dehydrate_uuid', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.dehydrate_uuid" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dehydrate_uuid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This is either a blinded batch uuid or a uuid for the compound structure based on the INCHI key&quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">related_molregno</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">related_molregno</span><span class="o">.</span><span class="n">chembl</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">related_molregno</span><span class="o">.</span><span class="n">chembl</span><span class="o">.</span><span class="n">chembl_id</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">related_molregno</span><span class="o">.</span><span class="n">chembl</span><span class="o">.</span><span class="n">chembl_id</span>
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">blinded_batch_id</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">blinded_batch_id</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.delete_detail">
    <p>def <span class="ident">delete_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.delete_detail">delete_detail</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Destroys a single resource/object.</p>
<p>Calls <code>obj_delete</code>.</p>
<p>If the resource is deleted, return <code>HttpNoContent</code> (204 No Content).
If the resource did not exist, return <code>Http404</code> (404 Not Found).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.delete_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.delete_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">delete_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Destroys a single resource/object.</span>
<span class="sd">    Calls ``obj_delete``.</span>
<span class="sd">    If the resource is deleted, return ``HttpNoContent`` (204 No Content).</span>
<span class="sd">    If the resource did not exist, return ``Http404`` (404 Not Found).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Manually construct the bundle here, since we don&#39;t want to try to</span>
    <span class="c1"># delete an empty instance.</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="n">Bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">obj_delete</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNoContent</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">NotFound</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNotFound</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.delete_list">
    <p>def <span class="ident">delete_list</span>(</p><p>self, request, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.delete_list">delete_list</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Destroys a collection of resources/objects.</p>
<p>Calls <code>obj_delete_list</code>.</p>
<p>If the resources are deleted, return <code>HttpNoContent</code> (204 No Content).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.delete_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.delete_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">delete_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Destroys a collection of resources/objects.</span>
<span class="sd">    Calls ``obj_delete_list``.</span>
<span class="sd">    If the resources are deleted, return ``HttpNoContent`` (204 No Content).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">obj_delete_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNoContent</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.deserialize">
    <p>def <span class="ident">deserialize</span>(</p><p>self, request, data, format=u&#39;application/json&#39;)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.deserialize">deserialize</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Given a request, data and a format, deserializes the given data.</p>
<p>It relies on the request properly sending a <code>CONTENT_TYPE</code> header,
falling back to <code>application/json</code> if not provided.</p>
<p>Mostly a hook, this uses the <code>Serializer</code> from <code>Resource._meta</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.deserialize', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.deserialize" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">deserialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s1">&#39;application/json&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a request, data and a format, deserializes the given data.</span>
<span class="sd">    It relies on the request properly sending a ``CONTENT_TYPE`` header,</span>
<span class="sd">    falling back to ``application/json`` if not provided.</span>
<span class="sd">    Mostly a hook, this uses the ``Serializer`` from ``Resource._meta``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">serializer</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="n">format</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">deserialized</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.detail_uri_kwargs">
    <p>def <span class="ident">detail_uri_kwargs</span>(</p><p>self, bundle_or_obj)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.detail_uri_kwargs">detail_uri_kwargs</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Given a <code>Bundle</code> or an object (typically a <code>Model</code> instance),
it returns the extra kwargs needed to generate a detail URI.</p>
<p>By default, it uses the model's <code>pk</code> in order to create the URI.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.detail_uri_kwargs', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.detail_uri_kwargs" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">detail_uri_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle_or_obj</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a ``Bundle`` or an object (typically a ``Model`` instance),</span>
<span class="sd">    it returns the extra kwargs needed to generate a detail URI.</span>
<span class="sd">    By default, it uses the model&#39;s ``pk`` in order to create the URI.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bundle_or_obj</span><span class="p">,</span> <span class="n">Bundle</span><span class="p">):</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">bundle_or_obj</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">bundle_or_obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">kwargs</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.determine_format">
    <p>def <span class="ident">determine_format</span>(</p><p>self, request)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.determine_format">determine_format</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Used to determine the desired format.</p>
<p>Largely relies on <code>tastypie.utils.mime.determine_format</code> but here
as a point of extension.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.determine_format', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.determine_format" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">determine_format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Used to determine the desired format.</span>
<span class="sd">    Largely relies on ``tastypie.utils.mime.determine_format`` but here</span>
<span class="sd">    as a point of extension.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">determine_format</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">serializer</span><span class="p">,</span> <span class="n">default_format</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">default_format</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.dispatch">
    <p>def <span class="ident">dispatch</span>(</p><p>self, request_type, request, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.dispatch">dispatch</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles the common operations (allowed HTTP method, authentication,
throttling, method lookup) surrounding most CRUD interactions.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.dispatch', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.dispatch" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dispatch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request_type</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles the common operations (allowed HTTP method, authentication,</span>
<span class="sd">    throttling, method lookup) surrounding most CRUD interactions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">allowed_methods</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_allowed_methods&quot;</span> <span class="o">%</span> <span class="n">request_type</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;HTTP_X_HTTP_METHOD_OVERRIDE&#39;</span> <span class="ow">in</span> <span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="p">:</span>
        <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="p">[</span><span class="s1">&#39;HTTP_X_HTTP_METHOD_OVERRIDE&#39;</span><span class="p">]</span>
    <span class="n">request_method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">method_check</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">allowed</span><span class="o">=</span><span class="n">allowed_methods</span><span class="p">)</span>
    <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">request_method</span><span class="p">,</span> <span class="n">request_type</span><span class="p">),</span> <span class="bp">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">method</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpNotImplemented</span><span class="p">())</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">throttle_check</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="c1"># All clear. Process the request.</span>
    <span class="n">request</span> <span class="o">=</span> <span class="n">convert_post_to_put</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="c1"># Add the throttled request.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_throttled_access</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="c1"># If what comes back isn&#39;t a ``HttpResponse``, assume that the</span>
    <span class="c1"># request was accepted and that some action occurred. This also</span>
    <span class="c1"># prevents Django from freaking out.</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">HttpResponse</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNoContent</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">response</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.dispatch_detail">
    <p>def <span class="ident">dispatch_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.dispatch_detail">dispatch_detail</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A view for handling the various HTTP methods (GET/POST/PUT/DELETE) on
a single resource.</p>
<p>Relies on <code>Resource.dispatch</code> for the heavy-lifting.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.dispatch_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.dispatch_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dispatch_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A view for handling the various HTTP methods (GET/POST/PUT/DELETE) on</span>
<span class="sd">    a single resource.</span>
<span class="sd">    Relies on ``Resource.dispatch`` for the heavy-lifting.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span><span class="s1">&#39;detail&#39;</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.dispatch_list">
    <p>def <span class="ident">dispatch_list</span>(</p><p>self, request, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.dispatch_list">dispatch_list</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A view for handling the various HTTP methods (GET/POST/PUT/DELETE) over
the entire list of resources.</p>
<p>Relies on <code>Resource.dispatch</code> for the heavy-lifting.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.dispatch_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.dispatch_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dispatch_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A view for handling the various HTTP methods (GET/POST/PUT/DELETE) over</span>
<span class="sd">    the entire list of resources.</span>
<span class="sd">    Relies on ``Resource.dispatch`` for the heavy-lifting.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.error_response">
    <p>def <span class="ident">error_response</span>(</p><p>self, request, errors, response_class=None)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.error_response">error_response</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Extracts the common "which-format/serialize/return-error-response"
cycle.</p>
<p>Should be used as much as possible to return errors.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.error_response', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.error_response" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">error_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extracts the common &quot;which-format/serialize/return-error-response&quot;</span>
<span class="sd">    cycle.</span>
<span class="sd">    Should be used as much as possible to return errors.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">response_class</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">response_class</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpBadRequest</span>
    <span class="n">desired_format</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">if</span> <span class="n">request</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;callback&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">desired_format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">determine_format</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">BadRequest</span><span class="p">:</span>
                <span class="k">pass</span>  <span class="c1"># Fall through to default handler below</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># JSONP can cause extra breakage.</span>
            <span class="n">desired_format</span> <span class="o">=</span> <span class="s1">&#39;application/json&#39;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">desired_format</span><span class="p">:</span>
        <span class="n">desired_format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">default_format</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">serialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">desired_format</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">BadRequest</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">error</span> <span class="o">=</span> <span class="s2">&quot;Additional errors occurred, but serialization of those errors failed.&quot;</span>
        <span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">:</span>
            <span class="n">error</span> <span class="o">+=</span> <span class="s2">&quot; </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">e</span>
        <span class="k">return</span> <span class="n">response_class</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">error</span><span class="p">,</span> <span class="n">content_type</span><span class="o">=</span><span class="s1">&#39;text/plain&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response_class</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">serialized</span><span class="p">,</span> <span class="n">content_type</span><span class="o">=</span><span class="n">build_content_type</span><span class="p">(</span><span class="n">desired_format</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.filter_value_to_python">
    <p>def <span class="ident">filter_value_to_python</span>(</p><p>self, value, field_name, filters, filter_expr, filter_type)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.filter_value_to_python">filter_value_to_python</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Turn the string <code>value</code> into a python object.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.filter_value_to_python', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.filter_value_to_python" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">filter_value_to_python</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">filters</span><span class="p">,</span> <span class="n">filter_expr</span><span class="p">,</span>
        <span class="n">filter_type</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Turn the string ``value`` into a python object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Simple values</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">string_to_python</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="c1"># Split on &#39;,&#39; if not empty string and either an in or range filter.</span>
    <span class="k">if</span> <span class="n">filter_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="s1">&#39;range&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">filters</span><span class="p">,</span> <span class="s1">&#39;getlist&#39;</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">filters</span><span class="o">.</span><span class="n">getlist</span><span class="p">(</span><span class="n">filter_expr</span><span class="p">):</span>
                <span class="n">value</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">part</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">value</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.full_dehydrate">
    <p>def <span class="ident">full_dehydrate</span>(</p><p>self, bundle, for_list=False)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.full_dehydrate">full_dehydrate</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Given a bundle with an object instance, extract the information from it
to populate the resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.full_dehydrate', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.full_dehydrate" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">full_dehydrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">for_list</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a bundle with an object instance, extract the information from it</span>
<span class="sd">    to populate the resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span>
    <span class="n">api_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span>
    <span class="n">resource_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span>
    <span class="c1"># Dehydrate each field.</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># If it&#39;s not for use in this mode, skip</span>
        <span class="n">field_use_in</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">use_in</span>
        <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_use_in</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">field_use_in</span><span class="p">(</span><span class="n">bundle</span><span class="p">):</span>
                <span class="k">continue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">field_use_in</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;list&#39;</span> <span class="k">if</span> <span class="n">for_list</span> <span class="k">else</span> <span class="s1">&#39;detail&#39;</span><span class="p">]:</span>
                <span class="k">continue</span>
        <span class="c1"># A touch leaky but it makes URI resolution work.</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">dehydrated_type</span> <span class="o">==</span> <span class="s1">&#39;related&#39;</span><span class="p">:</span>
            <span class="n">field_object</span><span class="o">.</span><span class="n">api_name</span> <span class="o">=</span> <span class="n">api_name</span>
            <span class="n">field_object</span><span class="o">.</span><span class="n">resource_name</span> <span class="o">=</span> <span class="n">resource_name</span>
        <span class="n">data</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="n">for_list</span><span class="o">=</span><span class="n">for_list</span><span class="p">)</span>
        <span class="c1"># Check for an optional method to do further dehydration.</span>
        <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;dehydrate_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.full_hydrate">
    <p>def <span class="ident">full_hydrate</span>(</p><p>self, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.full_hydrate">full_hydrate</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Given a populated bundle, distill it and turn it back into
a full-fledged object instance.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.full_hydrate', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.full_hydrate" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">full_hydrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a populated bundle, distill it and turn it back into</span>
<span class="sd">    a full-fledged object instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="p">()</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">readonly</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># Check for an optional method to do further hydration.</span>
        <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;hydrate_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
            <span class="n">bundle</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
            <span class="c1"># NOTE: We only get back a bundle when it is related field.</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Bundle</span><span class="p">)</span> <span class="ow">and</span> <span class="n">value</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_name</span><span class="p">):</span>
                <span class="n">bundle</span><span class="o">.</span><span class="n">errors</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">errors</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">field_object</span><span class="o">.</span><span class="n">null</span><span class="p">:</span>
                <span class="c1"># We need to avoid populating M2M data here as that will</span>
                <span class="c1"># cause things to blow up.</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_related</span><span class="p">:</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="k">elif</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                        <span class="c1"># NOTE: A bug fix in Django (ticket #18153) fixes incorrect behavior</span>
                        <span class="c1"># which Tastypie was relying on.  To fix this, we store value.obj to</span>
                        <span class="c1"># be saved later in save_related.</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="nb">setattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
                        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">ObjectDoesNotExist</span><span class="p">):</span>
                            <span class="n">bundle</span><span class="o">.</span><span class="n">related_objects_to_save</span><span class="p">[</span><span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">obj</span>
                    <span class="k">elif</span> <span class="n">field_object</span><span class="o">.</span><span class="n">blank</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="k">elif</span> <span class="n">field_object</span><span class="o">.</span><span class="n">null</span><span class="p">:</span>
                        <span class="nb">setattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.generate_cache_key">
    <p>def <span class="ident">generate_cache_key</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.generate_cache_key">generate_cache_key</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Creates a unique-enough cache key.</p>
<p>This is based off the current api_name/resource_name/args/kwargs.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.generate_cache_key', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.generate_cache_key" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">generate_cache_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a unique-enough cache key.</span>
<span class="sd">    This is based off the current api_name/resource_name/args/kwargs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">smooshed</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">=</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
    <span class="c1"># Use a list plus a ``.join()`` because it&#39;s faster than concatenation.</span>
    <span class="k">return</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">args</span><span class="p">),</span> <span class="s1">&#39;:&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">smooshed</span><span class="p">)))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.get_bundle_detail_data">
    <p>def <span class="ident">get_bundle_detail_data</span>(</p><p>self, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_bundle_detail_data">get_bundle_detail_data</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Convenience method to return the <code>detail_uri_name</code> attribute off
<code>bundle.obj</code>.</p>
<p>Usually just accesses <code>bundle.obj.pk</code> by default.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.get_bundle_detail_data', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.get_bundle_detail_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_bundle_detail_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convenience method to return the ``detail_uri_name`` attribute off</span>
<span class="sd">    ``bundle.obj``.</span>
<span class="sd">    Usually just accesses ``bundle.obj.pk`` by default.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.get_detail">
    <p>def <span class="ident">get_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_detail">get_detail</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Returns a single serialized resource.
Calls <code>cached_obj_get/obj_get</code> to provide the data, then handles that result
set and serializes it.
Should return a HttpResponse (200 OK).
Get a single CBHCompoundbatches from elasticsearch by running a query</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.get_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.get_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a single serialized resource.</span>
<span class="sd">    Calls ``cached_obj_get/obj_get`` to provide the data, then handles that result</span>
<span class="sd">    set and serializes it.</span>
<span class="sd">    Should return a HttpResponse (200 OK).</span>
<span class="sd">    Get a single CBHCompoundbatches from elasticsearch by running a query</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">basic_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">allowed_pids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">project_ids</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="n">concatenated_indices</span> <span class="o">=</span> <span class="n">elasticsearch_client</span><span class="o">.</span><span class="n">get_list_of_indicies</span><span class="p">(</span><span class="n">allowed_pids</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">elasticsearch_client</span><span class="o">.</span><span class="n">get_detail_data_elasticsearch</span><span class="p">(</span><span class="n">concatenated_indices</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;pk&quot;</span><span class="p">])</span>   
    
    <span class="n">requested_pid</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;projectfull&quot;</span><span class="p">][</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">requested_pid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_pids</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">(</span><span class="s2">&quot;No permissions for requested project&quot;</span><span class="p">)</span> 
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.get_fields">
    <p>def <span class="ident">get_fields</span>(</p><p>cls, fields=None, excludes=None)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_fields">get_fields</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Given any explicit fields to include and fields to exclude, add
additional fields based on the associated model.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.get_fields', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.get_fields" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">get_fields</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">excludes</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given any explicit fields to include and fields to exclude, add</span>
<span class="sd">    additional fields based on the associated model.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">final_fields</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">fields</span> <span class="o">=</span> <span class="n">fields</span> <span class="ow">or</span> <span class="p">[]</span>
    <span class="n">excludes</span> <span class="o">=</span> <span class="n">excludes</span> <span class="ow">or</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">cls</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">final_fields</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">cls</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
        <span class="c1"># If the field name is already present, skip</span>
        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">cls</span><span class="o">.</span><span class="n">base_fields</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># If field is not present in explicit field listing, skip</span>
        <span class="k">if</span> <span class="n">fields</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># If field is in exclude list, skip</span>
        <span class="k">if</span> <span class="n">excludes</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">excludes</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">cls</span><span class="o">.</span><span class="n">should_skip_field</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="n">api_field_class</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">api_field_from_django_field</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;attribute&#39;</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s1">&#39;help_text&#39;</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">help_text</span><span class="p">,</span>
            <span class="s1">&#39;verbose_name&#39;</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">verbose_name</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">null</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;null&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;unique&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">unique</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">f</span><span class="o">.</span><span class="n">null</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">blank</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;blank&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">get_internal_type</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;TextField&#39;</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">has_default</span><span class="p">():</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">default</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;auto_now&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">auto_now</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;auto_now_add&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">auto_now_add</span>
        <span class="n">final_fields</span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">api_field_class</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">final_fields</span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">instance_name</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span>
    <span class="k">return</span> <span class="n">final_fields</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.get_list">
    <p>def <span class="ident">get_list</span>(</p><p>self, request, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_list">get_list</a></code>
    </p>

    
  
    <div class="desc"><p>Request data where the project is not of the saved search type</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.get_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.get_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Request data where the project is not of the saved search type&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">CBHCompoundBatchResource</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_list</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">extra_queries</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;query_type&quot;</span><span class="p">:</span> <span class="s2">&quot;pick_from_list&quot;</span><span class="p">,</span> <span class="s2">&quot;field_path&quot;</span> <span class="p">:</span> <span class="s2">&quot;projectfull.project_type.saved_search_project_type&quot;</span><span class="p">,</span> <span class="s2">&quot;pick_from_list&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;false&quot;</span><span class="p">]</span> <span class="p">}])</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.get_multiple">
    <p>def <span class="ident">get_multiple</span>(</p><p>self, request, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_multiple">get_multiple</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Returns a serialized list of resources based on the identifiers
from the URL.</p>
<p>Calls <code>obj_get</code> to fetch only the objects requested. This method
only responds to HTTP GET.</p>
<p>Should return a HttpResponse (200 OK).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.get_multiple', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.get_multiple" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_multiple</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a serialized list of resources based on the identifiers</span>
<span class="sd">    from the URL.</span>
<span class="sd">    Calls ``obj_get`` to fetch only the objects requested. This method</span>
<span class="sd">    only responds to HTTP GET.</span>
<span class="sd">    Should return a HttpResponse (200 OK).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">method_check</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">allowed</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;get&#39;</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">throttle_check</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="c1"># Rip apart the list then iterate.</span>
    <span class="n">kwarg_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_list&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span>
    <span class="n">obj_identifiers</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">kwarg_name</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
    <span class="n">objects</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">not_found</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">base_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">identifier</span> <span class="ow">in</span> <span class="n">obj_identifiers</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">base_bundle</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">:</span> <span class="n">identifier</span><span class="p">})</span>
            <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
            <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="n">for_list</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="n">objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">ObjectDoesNotExist</span><span class="p">,</span> <span class="n">Unauthorized</span><span class="p">):</span>
            <span class="n">not_found</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">identifier</span><span class="p">)</span>
    <span class="n">object_list</span> <span class="o">=</span> <span class="p">{</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">:</span> <span class="n">objects</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">not_found</span><span class="p">):</span>
        <span class="n">object_list</span><span class="p">[</span><span class="s1">&#39;not_found&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">not_found</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_throttled_access</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">object_list</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.get_object_list">
    <p>def <span class="ident">get_object_list</span>(</p><p>self, request)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_object_list">get_object_list</a></code>
    </p>

    
  
    <div class="desc inherited"><p>An ORM-specific implementation of <code>get_object_list</code>.</p>
<p>Returns a queryset that may have been limited by other overrides.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.get_object_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.get_object_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_object_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An ORM-specific implementation of ``get_object_list``.</span>
<span class="sd">    Returns a queryset that may have been limited by other overrides.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">queryset</span><span class="o">.</span><span class="n">_clone</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.get_project_specific_data">
    <p>def <span class="ident">get_project_specific_data</span>(</p><p>self, request, queries, pids, sorts, textsearch, batch_ids_by_project)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_project_specific_data">get_project_specific_data</a></code>
    </p>

    
  
    <div class="desc inherited"><p>When an Excel or SDF download is requested, 
present the data as a
project by project summary so that 
one spreadsheet can be used per project</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.get_project_specific_data', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.get_project_specific_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_project_specific_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">queries</span><span class="p">,</span> <span class="n">pids</span><span class="p">,</span> <span class="n">sorts</span><span class="p">,</span> <span class="n">textsearch</span><span class="p">,</span> <span class="n">batch_ids_by_project</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;When an Excel or SDF download is requested, </span>
<span class="sd">    present the data as a</span>
<span class="sd">    project by project summary so that </span>
<span class="sd">    one spreadsheet can be used per project&quot;&quot;&quot;</span>
    <span class="n">to_return</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">pids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pids</span><span class="p">)</span>
    <span class="n">table_schemata</span> <span class="o">=</span> <span class="n">get_schemata</span><span class="p">(</span><span class="n">pids</span><span class="p">,</span> <span class="s2">&quot;export&quot;</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="c1">#We have removed the schema from the index for data efficiency so</span>
    <span class="c1">#We need to pull it out of the project resource</span>
        
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">proj_data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">table_schemata</span><span class="p">):</span>
        <span class="n">table_schema_for_project</span> <span class="o">=</span> <span class="n">proj_data</span><span class="p">[</span><span class="s2">&quot;tabular_data_schema&quot;</span><span class="p">][</span><span class="s2">&quot;for_export&quot;</span><span class="p">]</span>
        <span class="n">pid</span> <span class="o">=</span> <span class="n">pids</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="n">proj_index</span> <span class="o">=</span> <span class="n">elasticsearch_client</span><span class="o">.</span><span class="n">get_project_index_name</span><span class="p">(</span><span class="n">pid</span><span class="p">)</span>
        <span class="n">es_data</span> <span class="o">=</span> <span class="n">elasticsearch_client</span><span class="o">.</span><span class="n">get_list_data_elasticsearch</span><span class="p">(</span><span class="n">queries</span><span class="p">,</span>
                <span class="n">proj_index</span><span class="p">,</span>
                <span class="n">sorts</span><span class="o">=</span><span class="n">sorts</span><span class="p">,</span> 
                <span class="n">textsearch</span><span class="o">=</span><span class="n">textsearch</span><span class="p">,</span>
                <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">limit</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
                <span class="n">batch_ids_by_project</span><span class="o">=</span><span class="n">batch_ids_by_project</span> <span class="p">)</span>
        <span class="n">standardised</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prepare_es_hits</span><span class="p">(</span><span class="n">es_data</span><span class="p">)</span>
        <span class="n">standardised</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">proj_data</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
        <span class="n">standardised</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pid</span>
        <span class="n">standardised</span><span class="p">[</span><span class="s2">&quot;schema&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">table_schema_for_project</span>
        <span class="n">base</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;wsgi.url_scheme&quot;</span><span class="p">,</span><span class="s2">&quot;http&quot;</span><span class="p">)</span> 
        <span class="n">base</span> <span class="o">+=</span> <span class="s2">&quot;://&quot;</span>
        <span class="n">base</span> <span class="o">+=</span> <span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;HTTP_HOST&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">standardised</span><span class="p">[</span><span class="s2">&quot;schema&quot;</span><span class="p">]:</span>
            <span class="n">field</span><span class="p">[</span><span class="s2">&quot;base_url&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">base</span>
        <span class="n">to_return</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">standardised</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;format&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;sdf&quot;</span><span class="p">:</span>
        <span class="c1">#For the Excel sheet print out the query used</span>
        <span class="n">query_reps</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;fieldn&quot;</span><span class="p">:</span> <span class="s2">&quot;Project&quot;</span><span class="p">,</span> <span class="s2">&quot;pick_from_list&quot;</span><span class="p">:</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">ret</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span> <span class="k">for</span> <span class="n">ret</span> <span class="ow">in</span> <span class="n">to_return</span><span class="p">])</span> <span class="p">}]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">q</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">queries</span><span class="p">):</span>
            <span class="n">qrep</span> <span class="o">=</span> <span class="p">{</span><span class="n">qtype</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="p">:</span> <span class="s2">u&quot;&quot;</span> <span class="k">for</span> <span class="n">qtype</span> <span class="ow">in</span> <span class="n">settings</span><span class="o">.</span><span class="n">CBH_QUERY_TYPES</span><span class="p">}</span>
            <span class="n">qrep</span><span class="p">[</span><span class="s2">&quot;fieldn&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">q</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;pick_from_list&quot;</span><span class="p">:</span>
                    <span class="n">qrep</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;field_path&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
                        <span class="n">knownBy</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">TABULAR_DATA_SETTINGS</span><span class="p">[</span><span class="s2">&quot;schema&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">value</span><span class="p">,{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;knownBy&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">knownBy</span><span class="p">:</span>
                            <span class="n">knownBy</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                        <span class="n">qrep</span><span class="p">[</span><span class="s2">&quot;fieldn&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">l</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">knownBy</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">qrep</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="n">qrep</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
            <span class="n">query_reps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">qrep</span><span class="p">)</span>
        <span class="n">schem</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;knownBy&quot;</span> <span class="p">:</span> <span class="s2">&quot;Row&quot;</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;fieldn&quot;</span><span class="p">,</span> <span class="s2">&quot;knownBy&quot;</span> <span class="p">:</span> <span class="s2">&quot;Col&quot;</span><span class="p">}]</span> <span class="o">+</span> <span class="p">[{</span><span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">qtype</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">],</span> <span class="s2">&quot;knownBy&quot;</span> <span class="p">:</span> <span class="n">qtype</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]}</span> <span class="k">for</span> <span class="n">qtype</span> <span class="ow">in</span> <span class="n">settings</span><span class="o">.</span><span class="n">CBH_QUERY_TYPES</span><span class="p">]</span>
        <span class="n">query_summary</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;_Query Used&quot;</span><span class="p">,</span>
                <span class="s2">&quot;objects&quot;</span> <span class="p">:</span> <span class="n">query_reps</span><span class="p">,</span>
                <span class="s2">&quot;schema&quot;</span> <span class="p">:</span> <span class="n">schem</span>
                <span class="p">}</span>
        <span class="n">to_return</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">query_summary</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">to_return</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.get_resource_uri">
    <p>def <span class="ident">get_resource_uri</span>(</p><p>self, bundle_or_obj=None, url_name=u&#39;api_dispatch_list&#39;)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_resource_uri">get_resource_uri</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles generating a resource URI.</p>
<p>If the <code>bundle_or_obj</code> argument is not provided, it builds the URI
for the list endpoint.</p>
<p>If the <code>bundle_or_obj</code> argument is provided, it builds the URI for
the detail endpoint.</p>
<p>Return the generated URI. If that URI can not be reversed (not found
in the URLconf), it will return an empty string.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.get_resource_uri', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.get_resource_uri" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_resource_uri</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle_or_obj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">url_name</span><span class="o">=</span><span class="s1">&#39;api_dispatch_list&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles generating a resource URI.</span>
<span class="sd">    If the ``bundle_or_obj`` argument is not provided, it builds the URI</span>
<span class="sd">    for the list endpoint.</span>
<span class="sd">    If the ``bundle_or_obj`` argument is provided, it builds the URI for</span>
<span class="sd">    the detail endpoint.</span>
<span class="sd">    Return the generated URI. If that URI can not be reversed (not found</span>
<span class="sd">    in the URLconf), it will return an empty string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">bundle_or_obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">url_name</span> <span class="o">=</span> <span class="s1">&#39;api_dispatch_detail&#39;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_reverse_url</span><span class="p">(</span><span class="n">url_name</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resource_uri_kwargs</span><span class="p">(</span><span class="n">bundle_or_obj</span><span class="p">))</span>
    <span class="k">except</span> <span class="n">NoReverseMatch</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.get_schema">
    <p>def <span class="ident">get_schema</span>(</p><p>self, request, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_schema">get_schema</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Returns a serialized form of the schema of the resource.</p>
<p>Calls <code>build_schema</code> to generate the data. This method only responds
to HTTP GET.</p>
<p>Should return a HttpResponse (200 OK).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.get_schema', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.get_schema" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a serialized form of the schema of the resource.</span>
<span class="sd">    Calls ``build_schema`` to generate the data. This method only responds</span>
<span class="sd">    to HTTP GET.</span>
<span class="sd">    Should return a HttpResponse (200 OK).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">method_check</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">allowed</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;get&#39;</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">throttle_check</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_throttled_access</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">authorized_read_detail</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">),</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_schema</span><span class="p">())</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.get_via_uri">
    <p>def <span class="ident">get_via_uri</span>(</p><p>self, uri, request=None)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_via_uri">get_via_uri</a></code>
    </p>

    
  
    <div class="desc inherited"><p>This pulls apart the salient bits of the URI and populates the
resource via a <code>obj_get</code>.</p>
<p>Optionally accepts a <code>request</code>.</p>
<p>If you need custom behavior based on other portions of the URI,
simply override this method.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.get_via_uri', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.get_via_uri" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_via_uri</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uri</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This pulls apart the salient bits of the URI and populates the</span>
<span class="sd">    resource via a ``obj_get``.</span>
<span class="sd">    Optionally accepts a ``request``.</span>
<span class="sd">    If you need custom behavior based on other portions of the URI,</span>
<span class="sd">    simply override this method.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="n">get_script_prefix</span><span class="p">()</span>
    <span class="n">chomped_uri</span> <span class="o">=</span> <span class="n">uri</span>
    <span class="k">if</span> <span class="n">prefix</span> <span class="ow">and</span> <span class="n">chomped_uri</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">prefix</span><span class="p">):</span>
        <span class="n">chomped_uri</span> <span class="o">=</span> <span class="n">chomped_uri</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:]</span>
    <span class="c1"># We mangle the path a bit further &amp; run URL resolution against *only*</span>
    <span class="c1"># the current class. This ought to prevent bad URLs from resolving to</span>
    <span class="c1"># incorrect data.</span>
    <span class="n">found_at</span> <span class="o">=</span> <span class="n">chomped_uri</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">found_at</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">NotFound</span><span class="p">(</span><span class="s2">&quot;An incorrect URL was provided &#39;</span><span class="si">%s</span><span class="s2">&#39; for the &#39;</span><span class="si">%s</span><span class="s2">&#39; resource.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">))</span>
    <span class="n">chomped_uri</span> <span class="o">=</span> <span class="n">chomped_uri</span><span class="p">[</span><span class="n">found_at</span><span class="p">:]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">url_resolver</span> <span class="ow">in</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;urls&#39;</span><span class="p">,</span> <span class="p">[]):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">url_resolver</span><span class="o">.</span><span class="n">resolve</span><span class="p">(</span><span class="n">chomped_uri</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">view</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span> <span class="o">=</span> <span class="n">result</span>
                <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Resolver404</span><span class="p">(</span><span class="s2">&quot;URI not found in &#39;self.urls&#39;.&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">Resolver404</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">NotFound</span><span class="p">(</span><span class="s2">&quot;The URL provided &#39;</span><span class="si">%s</span><span class="s2">&#39; was not a link to a valid resource.&quot;</span> <span class="o">%</span> <span class="n">uri</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.hydrate">
    <p>def <span class="ident">hydrate</span>(</p><p>self, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.hydrate">hydrate</a></code>
    </p>

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.hydrate', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.hydrate" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">hydrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">created_by_id</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.hydrate_blinded_batch_id">
    <p>def <span class="ident">hydrate_blinded_batch_id</span>(</p><p>self, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.hydrate_blinded_batch_id">hydrate_blinded_batch_id</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Hydrate functions are run before save of a new or updated model instance
This one ensures that the blinded batch id is filled in in cases where an inventory item 
with no ModelculeDictionary attribute (related_molregno)</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.hydrate_blinded_batch_id', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.hydrate_blinded_batch_id" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">hydrate_blinded_batch_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Hydrate functions are run before save of a new or updated model instance</span>
<span class="sd">    This one ensures that the blinded batch id is filled in in cases where an inventory item </span>
<span class="sd">    with no ModelculeDictionary attribute (related_molregno)&quot;&quot;&quot;</span> 
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;blinded_batch_id&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">u&quot;EMPTY_ID&quot;</span><span class="p">:</span>
        <span class="n">uox_id</span> <span class="o">=</span> <span class="n">generate_uox_id</span><span class="p">()</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;blinded_batch_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">uox_id</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">blinded_batch_id</span> <span class="o">=</span> <span class="n">uox_id</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.hydrate_m2m">
    <p>def <span class="ident">hydrate_m2m</span>(</p><p>self, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.hydrate_m2m">hydrate_m2m</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Populate the ManyToMany data on the instance.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.hydrate_m2m', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.hydrate_m2m" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">hydrate_m2m</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Populate the ManyToMany data on the instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrationError</span><span class="p">(</span><span class="s2">&quot;You must call &#39;full_hydrate&#39; before attempting to run &#39;hydrate_m2m&#39; on </span><span class="si">%r</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span>
            <span class="c1"># Note that we only hydrate the data, leaving the instance</span>
            <span class="c1"># unmodified. It&#39;s up to the user&#39;s code to handle this.</span>
            <span class="c1"># The ``ModelResource`` provides a working baseline</span>
            <span class="c1"># in this regard.</span>
            <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">hydrate_m2m</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;hydrate_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
            <span class="n">method</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.is_authenticated">
    <p>def <span class="ident">is_authenticated</span>(</p><p>self, request)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.is_authenticated">is_authenticated</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles checking if the user is authenticated and dealing with
unauthenticated users.</p>
<p>Mostly a hook, this uses class assigned to <code>authentication</code> from
<code>Resource._meta</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.is_authenticated', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.is_authenticated" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">is_authenticated</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking if the user is authenticated and dealing with</span>
<span class="sd">    unauthenticated users.</span>
<span class="sd">    Mostly a hook, this uses class assigned to ``authentication`` from</span>
<span class="sd">    ``Resource._meta``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Authenticate the request as needed.</span>
    <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authentication</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">auth_result</span><span class="p">,</span> <span class="n">HttpResponse</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">auth_result</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">auth_result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpUnauthorized</span><span class="p">())</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.is_valid">
    <p>def <span class="ident">is_valid</span>(</p><p>self, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.is_valid">is_valid</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles checking if the data provided by the user is valid.</p>
<p>Mostly a hook, this uses class assigned to <code>validation</code> from
<code>Resource._meta</code>.</p>
<p>If validation fails, an error is raised with the error messages
serialized inside it.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.is_valid', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.is_valid" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking if the data provided by the user is valid.</span>
<span class="sd">    Mostly a hook, this uses class assigned to ``validation`` from</span>
<span class="sd">    ``Resource._meta``.</span>
<span class="sd">    If validation fails, an error is raised with the error messages</span>
<span class="sd">    serialized inside it.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">validation</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">errors</span><span class="p">:</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">errors</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">errors</span>
        <span class="k">return</span> <span class="bp">False</span>
    <span class="k">return</span> <span class="bp">True</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.log_throttled_access">
    <p>def <span class="ident">log_throttled_access</span>(</p><p>self, request)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.log_throttled_access">log_throttled_access</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles the recording of the user's access for throttling purposes.</p>
<p>Mostly a hook, this uses class assigned to <code>throttle</code> from
<code>Resource._meta</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.log_throttled_access', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.log_throttled_access" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">log_throttled_access</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles the recording of the user&#39;s access for throttling purposes.</span>
<span class="sd">    Mostly a hook, this uses class assigned to ``throttle`` from</span>
<span class="sd">    ``Resource._meta``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">request_method</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">throttle</span><span class="o">.</span><span class="n">accessed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authentication</span><span class="o">.</span><span class="n">get_identifier</span><span class="p">(</span><span class="n">request</span><span class="p">),</span> <span class="n">url</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">get_full_path</span><span class="p">(),</span> <span class="n">request_method</span><span class="o">=</span><span class="n">request_method</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.lookup_kwargs_with_identifiers">
    <p>def <span class="ident">lookup_kwargs_with_identifiers</span>(</p><p>self, bundle, kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.lookup_kwargs_with_identifiers">lookup_kwargs_with_identifiers</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Kwargs here represent uri identifiers Ex: /repos/<user_id>/<repo_name>/
We need to turn those identifiers into Python objects for generating
lookup parameters that can find them in the DB</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.lookup_kwargs_with_identifiers', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.lookup_kwargs_with_identifiers" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">lookup_kwargs_with_identifiers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Kwargs here represent uri identifiers Ex: /repos/&lt;user_id&gt;/&lt;repo_name&gt;/</span>
<span class="sd">    We need to turn those identifiers into Python objects for generating</span>
<span class="sd">    lookup parameters that can find them in the DB</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lookup_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">)</span><span class="o">.</span><span class="n">model</span><span class="p">()</span>
    <span class="c1"># Override data values, we rely on uri identifiers</span>
    <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="c1"># We&#39;re going to manually hydrate, as opposed to calling</span>
    <span class="c1"># ``full_hydrate``, to ensure we don&#39;t try to flesh out related</span>
    <span class="c1"># resources &amp; keep things speedy.</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">identifier</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">identifier</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">:</span>
            <span class="n">lookup_kwargs</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span>
            <span class="k">continue</span>
        <span class="n">field_object</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span>
        <span class="c1"># Skip readonly or related fields.</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">readonly</span> <span class="ow">is</span> <span class="bp">True</span> <span class="ow">or</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_related</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># Check for an optional method to do further hydration.</span>
        <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;hydrate_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">identifier</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
            <span class="n">bundle</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="n">lookup_kwargs</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
    <span class="k">return</span> <span class="n">lookup_kwargs</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.method_check">
    <p>def <span class="ident">method_check</span>(</p><p>self, request, allowed=None)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.method_check">method_check</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Ensures that the HTTP method used on the request is allowed to be
handled by the resource.</p>
<p>Takes an <code>allowed</code> parameter, which should be a list of lowercase
HTTP methods to check against. Usually, this looks like::</p>
<div class="codehilite"><pre><span></span># The most generic lookup.
self.method_check(request, self._meta.allowed_methods)

# A lookup against what&#39;s allowed for list-type methods.
self.method_check(request, self._meta.list_allowed_methods)

# A useful check when creating a new endpoint that only handles
# GET.
self.method_check(request, [&#39;get&#39;])
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.method_check', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.method_check" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">method_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">allowed</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Ensures that the HTTP method used on the request is allowed to be</span>
<span class="sd">    handled by the resource.</span>
<span class="sd">    Takes an ``allowed`` parameter, which should be a list of lowercase</span>
<span class="sd">    HTTP methods to check against. Usually, this looks like::</span>
<span class="sd">        # The most generic lookup.</span>
<span class="sd">        self.method_check(request, self._meta.allowed_methods)</span>
<span class="sd">        # A lookup against what&#39;s allowed for list-type methods.</span>
<span class="sd">        self.method_check(request, self._meta.list_allowed_methods)</span>
<span class="sd">        # A useful check when creating a new endpoint that only handles</span>
<span class="sd">        # GET.</span>
<span class="sd">        self.method_check(request, [&#39;get&#39;])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">allowed</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">allowed</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">request_method</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">allows</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">meth</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">allowed</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">request_method</span> <span class="o">==</span> <span class="s2">&quot;options&quot;</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="n">allows</span><span class="p">)</span>
        <span class="n">response</span><span class="p">[</span><span class="s1">&#39;Allow&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">allows</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">request_method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpMethodNotAllowed</span><span class="p">(</span><span class="n">allows</span><span class="p">)</span>
        <span class="n">response</span><span class="p">[</span><span class="s1">&#39;Allow&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">allows</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">request_method</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.obj_create">
    <p>def <span class="ident">obj_create</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_create">obj_create</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A ORM-specific implementation of <code>obj_create</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.obj_create', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.obj_create" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_create``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.obj_delete">
    <p>def <span class="ident">obj_delete</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_delete">obj_delete</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A ORM-specific implementation of <code>obj_delete</code>.</p>
<p>Takes optional <code>kwargs</code>, which are used to narrow the query to find
the instance.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.obj_delete', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.obj_delete" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_delete``.</span>
<span class="sd">    Takes optional ``kwargs``, which are used to narrow the query to find</span>
<span class="sd">    the instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="s1">&#39;delete&#39;</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ObjectDoesNotExist</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NotFound</span><span class="p">(</span><span class="s2">&quot;A model instance matching the provided arguments could not be found.&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">authorized_delete_detail</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">),</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.obj_delete_list">
    <p>def <span class="ident">obj_delete_list</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_delete_list">obj_delete_list</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A ORM-specific implementation of <code>obj_delete_list</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.obj_delete_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.obj_delete_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_delete_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_delete_list``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">objects_to_delete</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">deletable_objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">authorized_delete_list</span><span class="p">(</span><span class="n">objects_to_delete</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">deletable_objects</span><span class="p">,</span> <span class="s1">&#39;delete&#39;</span><span class="p">):</span>
        <span class="c1"># It&#39;s likely a ``QuerySet``. Call ``.delete()`` for efficiency.</span>
        <span class="n">deletable_objects</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">authed_obj</span> <span class="ow">in</span> <span class="n">deletable_objects</span><span class="p">:</span>
            <span class="n">authed_obj</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.obj_delete_list_for_update">
    <p>def <span class="ident">obj_delete_list_for_update</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_delete_list_for_update">obj_delete_list_for_update</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A ORM-specific implementation of <code>obj_delete_list_for_update</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.obj_delete_list_for_update', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.obj_delete_list_for_update" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_delete_list_for_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_delete_list_for_update``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">objects_to_delete</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">deletable_objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">authorized_update_list</span><span class="p">(</span><span class="n">objects_to_delete</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">deletable_objects</span><span class="p">,</span> <span class="s1">&#39;delete&#39;</span><span class="p">):</span>
        <span class="c1"># It&#39;s likely a ``QuerySet``. Call ``.delete()`` for efficiency.</span>
        <span class="n">deletable_objects</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">authed_obj</span> <span class="ow">in</span> <span class="n">deletable_objects</span><span class="p">:</span>
            <span class="n">authed_obj</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.obj_get">
    <p>def <span class="ident">obj_get</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_get">obj_get</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A ORM-specific implementation of <code>obj_get</code>.</p>
<p>Takes optional <code>kwargs</code>, which are used to narrow the query to find
the instance.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.obj_get', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.obj_get" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_get``.</span>
<span class="sd">    Takes optional ``kwargs``, which are used to narrow the query to find</span>
<span class="sd">    the instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># prevents FieldError when looking up nested resources containing extra data</span>
    <span class="n">field_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">get_all_field_names</span><span class="p">()</span>
    <span class="n">field_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;pk&#39;</span><span class="p">)</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">field_names</span><span class="p">}</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">object_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">stringified_kwargs</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">=</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">object_list</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="o">.</span><span class="n">DoesNotExist</span><span class="p">(</span><span class="s2">&quot;Couldn&#39;t find an instance of &#39;</span><span class="si">%s</span><span class="s2">&#39; which matched &#39;</span><span class="si">%s</span><span class="s2">&#39;.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">stringified_kwargs</span><span class="p">))</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">object_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MultipleObjectsReturned</span><span class="p">(</span><span class="s2">&quot;More than &#39;</span><span class="si">%s</span><span class="s2">&#39; matched &#39;</span><span class="si">%s</span><span class="s2">&#39;.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">stringified_kwargs</span><span class="p">))</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">object_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">authorized_read_detail</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">NotFound</span><span class="p">(</span><span class="s2">&quot;Invalid resource lookup data provided (mismatched type).&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.obj_get_list">
    <p>def <span class="ident">obj_get_list</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_get_list">obj_get_list</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A ORM-specific implementation of <code>obj_get_list</code>.</p>
<p>Takes an optional <code>request</code> object, whose <code>GET</code> dictionary can be
used to narrow the query.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.obj_get_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.obj_get_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_get_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_get_list``.</span>
<span class="sd">    Takes an optional ``request`` object, whose ``GET`` dictionary can be</span>
<span class="sd">    used to narrow the query.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">filters</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;GET&#39;</span><span class="p">):</span>
        <span class="c1"># Grab a mutable copy.</span>
        <span class="n">filters</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="c1"># Update with the provided kwargs.</span>
    <span class="n">filters</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">applicable_filters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_filters</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_filters</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">,</span> <span class="n">applicable_filters</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">authorized_read_list</span><span class="p">(</span><span class="n">objects</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">BadRequest</span><span class="p">(</span><span class="s2">&quot;Invalid resource lookup data provided (mismatched type).&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.obj_update">
    <p>def <span class="ident">obj_update</span>(</p><p>self, bundle, skip_errors=False, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_update">obj_update</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A ORM-specific implementation of <code>obj_update</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.obj_update', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.obj_update" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">skip_errors</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_update``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bundle_detail_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bundle_detail_data</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="n">arg_detail_data</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">bundle_detail_data</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">arg_detail_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="nb">str</span><span class="p">(</span><span class="n">bundle_detail_data</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">str</span><span class="p">(</span><span class="n">arg_detail_data</span><span class="p">)):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">lookup_kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lookup_kwargs_with_identifiers</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="c1"># if there is trouble hydrating the data, fall back to just</span>
            <span class="c1"># using kwargs by itself (usually it only contains a &quot;pk&quot; key</span>
            <span class="c1"># and this will work fine.</span>
            <span class="n">lookup_kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">lookup_kwargs</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ObjectDoesNotExist</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NotFound</span><span class="p">(</span><span class="s2">&quot;A model instance matching the provided arguments could not be found.&quot;</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="n">skip_errors</span><span class="o">=</span><span class="n">skip_errors</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.override_urls">
    <p>def <span class="ident">override_urls</span>(</p><p>self)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.override_urls">override_urls</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Deprecated. Will be removed by v1.0.0. Please use <code>prepend_urls</code> instead.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.override_urls', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.override_urls" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">override_urls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Deprecated. Will be removed by v1.0.0. Please use ``prepend_urls`` instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.patch_detail">
    <p>def <span class="ident">patch_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.patch_detail">patch_detail</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Updates a resource in-place.</p>
<p>Calls <code>obj_update</code>.</p>
<p>If the resource is updated, return <code>HttpAccepted</code> (202 Accepted).
If the resource did not exist, return <code>HttpNotFound</code> (404 Not Found).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.patch_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.patch_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">patch_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates a resource in-place.</span>
<span class="sd">    Calls ``obj_update``.</span>
<span class="sd">    If the resource is updated, return ``HttpAccepted`` (202 Accepted).</span>
<span class="sd">    If the resource did not exist, return ``HttpNotFound`` (404 Not Found).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">request</span> <span class="o">=</span> <span class="n">convert_post_to_patch</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="n">basic_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="c1"># We want to be able to validate the update, but we can&#39;t just pass</span>
    <span class="c1"># the partial data into the validator since all data needs to be</span>
    <span class="c1"># present. Instead, we basically simulate a PUT by pulling out the</span>
    <span class="c1"># original data and updating it in-place.</span>
    <span class="c1"># So first pull out the original object. This is essentially</span>
    <span class="c1"># ``get_detail``.</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cached_obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">basic_bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="k">except</span> <span class="n">ObjectDoesNotExist</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNotFound</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">MultipleObjectsReturned</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpMultipleChoices</span><span class="p">(</span><span class="s2">&quot;More than one resource is found at this URI.&quot;</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="c1"># Now update the bundle in-place.</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">update_in_place</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">deserialized</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">always_return_data</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpAccepted</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Invalidate prefetched_objects_cache for bundled object</span>
        <span class="c1"># because we might have changed a prefetched field</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_prefetched_objects_cache</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpAccepted</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.patch_list">
    <p>def <span class="ident">patch_list</span>(</p><p>*args, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.patch_list">patch_list</a></code>
    </p>

    
  
    <div class="desc inherited"><p>An ORM-specific implementation of <code>patch_list</code>.</p>
<p>Necessary because PATCH should be atomic (all-success or all-fail)
and the only way to do this neatly is at the database level.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.patch_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.patch_list" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@wraps</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">assigned</span><span class="o">=</span><span class="n">available_attrs</span><span class="p">(</span><span class="n">func</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">with</span> <span class="bp">self</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.post_detail">
    <p>def <span class="ident">post_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.post_detail">post_detail</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Creates a new subcollection of the resource under a resource.</p>
<p>This is not implemented by default because most people's data models
aren't self-referential.</p>
<p>If a new resource is created, return <code>HttpCreated</code> (201 Created).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.post_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.post_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">post_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a new subcollection of the resource under a resource.</span>
<span class="sd">    This is not implemented by default because most people&#39;s data models</span>
<span class="sd">    aren&#39;t self-referential.</span>
<span class="sd">    If a new resource is created, return ``HttpCreated`` (201 Created).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNotImplemented</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.post_list">
    <p>def <span class="ident">post_list</span>(</p><p>self, request, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.post_list">post_list</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Creates a new resource/object with the provided data.</p>
<p>Calls <code>obj_create</code> with the provided data and returns a response
with the new resource's location.</p>
<p>If a new resource is created, return <code>HttpCreated</code> (201 Created).
If <code>Meta.always_return_data = True</code>, there will be a populated body
of serialized data.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.post_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.post_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">post_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a new resource/object with the provided data.</span>
<span class="sd">    Calls ``obj_create`` with the provided data and returns a response</span>
<span class="sd">    with the new resource&#39;s location.</span>
<span class="sd">    If a new resource is created, return ``HttpCreated`` (201 Created).</span>
<span class="sd">    If ``Meta.always_return_data = True``, there will be a populated body</span>
<span class="sd">    of serialized data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">))</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_deserialized_detail_data</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">deserialized</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dict_strip_unicode_keys</span><span class="p">(</span><span class="n">deserialized</span><span class="p">),</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_create</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="n">location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_uri</span><span class="p">(</span><span class="n">updated_bundle</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">always_return_data</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpCreated</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">updated_bundle</span><span class="p">)</span>
        <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpCreated</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.prepare_es_hits">
    <p>def <span class="ident">prepare_es_hits</span>(</p><p>self, hits)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.prepare_es_hits">prepare_es_hits</a></code>
    </p>

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.prepare_es_hits', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.prepare_es_hits" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">prepare_es_hits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hits</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;objects&quot;</span><span class="p">:</span> 
                        <span class="p">[</span><span class="n">hit</span><span class="p">[</span><span class="s2">&quot;_source&quot;</span><span class="p">][</span><span class="s2">&quot;dataset&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">hit</span> <span class="ow">in</span> <span class="n">hits</span><span class="p">[</span><span class="s2">&quot;hits&quot;</span><span class="p">][</span><span class="s2">&quot;hits&quot;</span><span class="p">]],</span>
                        <span class="s2">&quot;meta&quot;</span> <span class="p">:</span> <span class="p">{</span><span class="s2">&quot;total_count&quot;</span> <span class="p">:</span> <span class="n">hits</span><span class="p">[</span><span class="s2">&quot;hits&quot;</span><span class="p">][</span><span class="s2">&quot;total&quot;</span><span class="p">]}</span>
                        <span class="p">}</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.prepend_urls">
    <p>def <span class="ident">prepend_urls</span>(</p><p>self)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.prepend_urls">prepend_urls</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A hook for adding your own URLs or matching before the default URLs.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.prepend_urls', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.prepend_urls" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">prepend_urls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook for adding your own URLs or matching before the default URLs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.put_detail">
    <p>def <span class="ident">put_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.put_detail">put_detail</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Either updates an existing resource or creates a new one with the
provided data.</p>
<p>Calls <code>obj_update</code> with the provided data first, but falls back to
<code>obj_create</code> if the object does not already exist.</p>
<p>If a new resource is created, return <code>HttpCreated</code> (201 Created).
If <code>Meta.always_return_data = True</code>, there will be a populated body
of serialized data.</p>
<p>If an existing resource is modified and
<code>Meta.always_return_data = False</code> (default), return <code>HttpNoContent</code>
(204 No Content).
If an existing resource is modified and
<code>Meta.always_return_data = True</code>, return <code>HttpAccepted</code> (200
OK).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.put_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.put_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">put_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Either updates an existing resource or creates a new one with the</span>
<span class="sd">    provided data.</span>
<span class="sd">    Calls ``obj_update`` with the provided data first, but falls back to</span>
<span class="sd">    ``obj_create`` if the object does not already exist.</span>
<span class="sd">    If a new resource is created, return ``HttpCreated`` (201 Created).</span>
<span class="sd">    If ``Meta.always_return_data = True``, there will be a populated body</span>
<span class="sd">    of serialized data.</span>
<span class="sd">    If an existing resource is modified and</span>
<span class="sd">    ``Meta.always_return_data = False`` (default), return ``HttpNoContent``</span>
<span class="sd">    (204 No Content).</span>
<span class="sd">    If an existing resource is modified and</span>
<span class="sd">    ``Meta.always_return_data = True``, return ``HttpAccepted`` (200</span>
<span class="sd">    OK).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">))</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_deserialized_detail_data</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">deserialized</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dict_strip_unicode_keys</span><span class="p">(</span><span class="n">deserialized</span><span class="p">),</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_update</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">always_return_data</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNoContent</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Invalidate prefetched_objects_cache for bundled object</span>
            <span class="c1"># because we might have changed a prefetched field</span>
            <span class="n">updated_bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_prefetched_objects_cache</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">updated_bundle</span><span class="p">)</span>
            <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="p">(</span><span class="n">NotFound</span><span class="p">,</span> <span class="n">MultipleObjectsReturned</span><span class="p">):</span>
        <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_create</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="n">location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_uri</span><span class="p">(</span><span class="n">updated_bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">always_return_data</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpCreated</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">updated_bundle</span><span class="p">)</span>
            <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpCreated</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.put_list">
    <p>def <span class="ident">put_list</span>(</p><p>self, request, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.put_list">put_list</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Replaces a collection of resources with another collection.</p>
<p>Calls <code>delete_list</code> to clear out the collection then <code>obj_create</code>
with the provided the data to create the new collection.</p>
<p>Return <code>HttpNoContent</code> (204 No Content) if
<code>Meta.always_return_data = False</code> (default).</p>
<p>Return <code>HttpAccepted</code> (200 OK) if
<code>Meta.always_return_data = True</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.put_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.put_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">put_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Replaces a collection of resources with another collection.</span>
<span class="sd">    Calls ``delete_list`` to clear out the collection then ``obj_create``</span>
<span class="sd">    with the provided the data to create the new collection.</span>
<span class="sd">    Return ``HttpNoContent`` (204 No Content) if</span>
<span class="sd">    ``Meta.always_return_data = False`` (default).</span>
<span class="sd">    Return ``HttpAccepted`` (200 OK) if</span>
<span class="sd">    ``Meta.always_return_data = True``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">))</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_deserialized_list_data</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">deserialized</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">deserialized</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">BadRequest</span><span class="p">(</span><span class="s2">&quot;Invalid data sent: missing &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">)</span>
    <span class="n">basic_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">obj_delete_list_for_update</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">basic_bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="n">bundles_seen</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">object_data</span> <span class="ow">in</span> <span class="n">deserialized</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">]:</span>
        <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dict_strip_unicode_keys</span><span class="p">(</span><span class="n">object_data</span><span class="p">),</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
        <span class="c1"># Attempt to be transactional, deleting any previously created</span>
        <span class="c1"># objects if validation fails.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">obj_create</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
            <span class="n">bundles_seen</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ImmediateHttpResponse</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rollback</span><span class="p">(</span><span class="n">bundles_seen</span><span class="p">)</span>
            <span class="k">raise</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">always_return_data</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNoContent</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">to_be_serialized</span> <span class="o">=</span> <span class="p">{</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">:</span> <span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">for_list</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">bundles_seen</span>
            <span class="p">]</span>
        <span class="p">}</span>
        <span class="n">to_be_serialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_list_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">to_be_serialized</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">to_be_serialized</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.remove_api_resource_names">
    <p>def <span class="ident">remove_api_resource_names</span>(</p><p>self, url_dict)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.remove_api_resource_names">remove_api_resource_names</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Given a dictionary of regex matches from a URLconf, removes
<code>api_name</code> and/or <code>resource_name</code> if found.</p>
<p>This is useful for converting URLconf matches into something suitable
for data lookup. For example::</p>
<div class="codehilite"><pre><span></span>Model.objects.filter(**self.remove_api_resource_names(matches))
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.remove_api_resource_names', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.remove_api_resource_names" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">remove_api_resource_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url_dict</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a dictionary of regex matches from a URLconf, removes</span>
<span class="sd">    ``api_name`` and/or ``resource_name`` if found.</span>
<span class="sd">    This is useful for converting URLconf matches into something suitable</span>
<span class="sd">    for data lookup. For example::</span>
<span class="sd">        Model.objects.filter(**self.remove_api_resource_names(matches))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kwargs_subset</span> <span class="o">=</span> <span class="n">url_dict</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;api_name&#39;</span><span class="p">,</span> <span class="s1">&#39;resource_name&#39;</span><span class="p">]:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">del</span><span class="p">(</span><span class="n">kwargs_subset</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">pass</span>
    <span class="k">return</span> <span class="n">kwargs_subset</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.resource_uri_kwargs">
    <p>def <span class="ident">resource_uri_kwargs</span>(</p><p>self, bundle_or_obj=None)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.resource_uri_kwargs">resource_uri_kwargs</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Builds a dictionary of kwargs to help generate URIs.</p>
<p>Automatically provides the <code>Resource.Meta.resource_name</code> (and
optionally the <code>Resource.Meta.api_name</code> if populated by an <code>Api</code>
object).</p>
<p>If the <code>bundle_or_obj</code> argument is provided, it calls
<code>Resource.detail_uri_kwargs</code> for additional bits to create</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.resource_uri_kwargs', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.resource_uri_kwargs" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">resource_uri_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle_or_obj</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Builds a dictionary of kwargs to help generate URIs.</span>
<span class="sd">    Automatically provides the ``Resource.Meta.resource_name`` (and</span>
<span class="sd">    optionally the ``Resource.Meta.api_name`` if populated by an ``Api``</span>
<span class="sd">    object).</span>
<span class="sd">    If the ``bundle_or_obj`` argument is provided, it calls</span>
<span class="sd">    ``Resource.detail_uri_kwargs`` for additional bits to create</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;resource_name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;api_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span>
    <span class="k">if</span> <span class="n">bundle_or_obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">detail_uri_kwargs</span><span class="p">(</span><span class="n">bundle_or_obj</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">kwargs</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.rollback">
    <p>def <span class="ident">rollback</span>(</p><p>self, bundles)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.rollback">rollback</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A ORM-specific implementation of <code>rollback</code>.</p>
<p>Given the list of bundles, delete all models pertaining to those
bundles.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.rollback', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.rollback" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">rollback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundles</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``rollback``.</span>
<span class="sd">    Given the list of bundles, delete all models pertaining to those</span>
<span class="sd">    bundles.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">bundle</span> <span class="ow">in</span> <span class="n">bundles</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bundle_detail_data</span><span class="p">(</span><span class="n">bundle</span><span class="p">):</span>
            <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.save">
    <p>def <span class="ident">save</span>(</p><p>self, bundle, skip_errors=False)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.save">save</a></code>
    </p>

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.save', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.save" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">skip_errors</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">via_uri</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">bundle</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">errors</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">skip_errors</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">error_response</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="o">.</span><span class="n">errors</span><span class="p">))</span>
    <span class="c1"># Check if they&#39;re authorized.</span>
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">pk</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">authorized_update_detail</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">),</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">authorized_create_detail</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">),</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="c1"># Save FKs just in case.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">save_related</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">print</span> <span class="s2">&quot;got&quot;</span>
    <span class="c1"># Save the main object.</span>
    <span class="n">obj_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_identifier</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">obj_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">bundle</span><span class="o">.</span><span class="n">objects_saved</span> <span class="ow">or</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_state</span><span class="o">.</span><span class="n">adding</span><span class="p">:</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">objects_saved</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">obj_id</span><span class="p">)</span>
    <span class="c1"># Now pick up the M2M bits.</span>
    <span class="n">m2m_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hydrate_m2m</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">save_m2m</span><span class="p">(</span><span class="n">m2m_bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.save_m2m">
    <p>def <span class="ident">save_m2m</span>(</p><p>self, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.save_m2m">save_m2m</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles the saving of related M2M data.</p>
<p>Due to the way Django works, the M2M data must be handled after the
main instance, which is why this isn't a part of the main <code>save</code> bits.</p>
<p>Currently slightly inefficient in that it will clear out the whole
relation and recreate the related data as needed.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.save_m2m', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.save_m2m" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">save_m2m</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles the saving of related M2M data.</span>
<span class="sd">    Due to the way Django works, the M2M data must be handled after the</span>
<span class="sd">    main instance, which is why this isn&#39;t a part of the main ``save`` bits.</span>
<span class="sd">    Currently slightly inefficient in that it will clear out the whole</span>
<span class="sd">    relation and recreate the related data as needed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">readonly</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># Get the manager.</span>
        <span class="n">related_mngr</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
            <span class="n">related_mngr</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">):</span>
            <span class="n">related_mngr</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">related_mngr</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">related_mngr</span><span class="p">,</span> <span class="s1">&#39;clear&#39;</span><span class="p">):</span>
            <span class="c1"># FIXME: Dupe the original bundle, copy in the new object &amp;</span>
            <span class="c1">#        check the perms on that (using the related resource)?</span>
            <span class="c1"># Clear it out, just to be safe.</span>
            <span class="n">related_mngr</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">related_objs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">related_bundle</span> <span class="ow">in</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">field_name</span><span class="p">]:</span>
            <span class="n">related_resource</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">get_related_resource</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
            <span class="c1"># Only build &amp; save if there&#39;s data, not just a URI.</span>
            <span class="n">updated_related_bundle</span> <span class="o">=</span> <span class="n">related_resource</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span>
                <span class="n">obj</span><span class="o">=</span><span class="n">related_bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="n">related_bundle</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                <span class="n">request</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">,</span>
                <span class="n">objects_saved</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">objects_saved</span><span class="p">,</span>
                <span class="n">via_uri</span><span class="o">=</span><span class="n">related_bundle</span><span class="o">.</span><span class="n">via_uri</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">related_resource</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">updated_related_bundle</span><span class="p">)</span>
            <span class="n">related_objs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">updated_related_bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
        <span class="n">related_mngr</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="o">*</span><span class="n">related_objs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.save_related">
    <p>def <span class="ident">save_related</span>(</p><p>self, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.save_related">save_related</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles the saving of related non-M2M data.
Calling assigning <code>child.parent = parent</code> &amp; then calling
<code>Child.save</code> isn't good enough to make sure the <code>parent</code>
is saved.
To get around this, we go through all our related fields &amp;
call <code>save</code> on them if they have related, non-M2M data.
M2M data is handled by the <code>ModelResource.save_m2m</code> method.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.save_related', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.save_related" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">save_related</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles the saving of related non-M2M data.</span>
<span class="sd">    Calling assigning ``child.parent = parent`` &amp; then calling</span>
<span class="sd">    ``Child.save`` isn&#39;t good enough to make sure the ``parent``</span>
<span class="sd">    is saved.</span>
<span class="sd">    To get around this, we go through all our related fields &amp;</span>
<span class="sd">    call ``save`` on them if they have related, non-M2M data.</span>
<span class="sd">    M2M data is handled by the ``ModelResource.save_m2m`` method.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_related</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">readonly</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">blank</span> <span class="ow">and</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># Get the object.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">related_obj</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ObjectDoesNotExist</span><span class="p">:</span>
            <span class="c1"># Django 1.8: unset related objects default to None, no error</span>
            <span class="n">related_obj</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="c1"># We didn&#39;t get it, so maybe we created it but haven&#39;t saved it</span>
        <span class="k">if</span> <span class="n">related_obj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">related_obj</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">related_objects_to_save</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">related_name</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bundle_detail_data</span><span class="p">(</span><span class="n">bundle</span><span class="p">):</span>
                <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">related_obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">related_name</span><span class="p">,</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
        <span class="n">related_resource</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">get_related_resource</span><span class="p">(</span><span class="n">related_obj</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_name</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">field_name</span><span class="p">],</span> <span class="s1">&#39;keys&#39;</span><span class="p">):</span>
            <span class="c1"># Only build &amp; save if there&#39;s data, not just a URI.</span>
            <span class="n">related_bundle</span> <span class="o">=</span> <span class="n">related_resource</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span>
                <span class="n">obj</span><span class="o">=</span><span class="n">related_obj</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_name</span><span class="p">),</span>
                <span class="n">request</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">,</span>
                <span class="n">objects_saved</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">objects_saved</span>
            <span class="p">)</span>
            <span class="n">related_resource</span><span class="o">.</span><span class="n">full_hydrate</span><span class="p">(</span><span class="n">related_bundle</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">field_name</span> <span class="o">!=</span> <span class="s2">&quot;project&quot;</span><span class="p">:</span>
                <span class="n">related_resource</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">related_bundle</span><span class="p">)</span>
            <span class="n">related_obj</span> <span class="o">=</span> <span class="n">related_bundle</span><span class="o">.</span><span class="n">obj</span>
        <span class="k">if</span> <span class="n">related_obj</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="n">related_obj</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.serialize">
    <p>def <span class="ident">serialize</span>(</p><p>self, request, data, format, options=None)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.serialize">serialize</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Given a request, data and a desired format, produces a serialized
version suitable for transfer over the wire.</p>
<p>Mostly a hook, this uses the <code>Serializer</code> from <code>Resource._meta</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.serialize', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.serialize" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">format</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a request, data and a desired format, produces a serialized</span>
<span class="sd">    version suitable for transfer over the wire.</span>
<span class="sd">    Mostly a hook, this uses the ``Serializer`` from ``Resource._meta``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span> <span class="o">=</span> <span class="n">options</span> <span class="ow">or</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="s1">&#39;text/javascript&#39;</span> <span class="ow">in</span> <span class="n">format</span><span class="p">:</span>
        <span class="c1"># get JSONP callback name. default to &quot;callback&quot;</span>
        <span class="n">callback</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;callback&#39;</span><span class="p">,</span> <span class="s1">&#39;callback&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_valid_jsonp_callback_value</span><span class="p">(</span><span class="n">callback</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">BadRequest</span><span class="p">(</span><span class="s1">&#39;JSONP callback name is invalid.&#39;</span><span class="p">)</span>
        <span class="n">options</span><span class="p">[</span><span class="s1">&#39;callback&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">callback</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">serializer</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">format</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.should_skip_field">
    <p>def <span class="ident">should_skip_field</span>(</p><p>cls, field)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.should_skip_field">should_skip_field</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Given a Django model field, return if it should be included in the
contributed ApiFields.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.should_skip_field', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.should_skip_field" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">should_skip_field</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">field</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a Django model field, return if it should be included in the</span>
<span class="sd">    contributed ApiFields.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Ignore certain fields (related fields).</span>
    <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="s1">&#39;rel&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">return</span> <span class="bp">False</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.throttle_check">
    <p>def <span class="ident">throttle_check</span>(</p><p>self, request)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.throttle_check">throttle_check</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles checking if the user should be throttled.</p>
<p>Mostly a hook, this uses class assigned to <code>throttle</code> from
<code>Resource._meta</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.throttle_check', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.throttle_check" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">throttle_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking if the user should be throttled.</span>
<span class="sd">    Mostly a hook, this uses class assigned to ``throttle`` from</span>
<span class="sd">    ``Resource._meta``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">identifier</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authentication</span><span class="o">.</span><span class="n">get_identifier</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="c1"># Check to see if they should be throttled.</span>
    <span class="n">throttle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">throttle</span><span class="o">.</span><span class="n">should_be_throttled</span><span class="p">(</span><span class="n">identifier</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">throttle</span><span class="p">:</span>
        <span class="c1"># Throttle limit exceeded.</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpTooManyRequests</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">throttle</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">throttle</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="n">response</span><span class="p">[</span><span class="s1">&#39;Retry-After&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">throttle</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">throttle</span><span class="p">,</span> <span class="n">datetime</span><span class="p">):</span>
            <span class="n">response</span><span class="p">[</span><span class="s1">&#39;Retry-After&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">format_date_time</span><span class="p">(</span><span class="n">mktime</span><span class="p">(</span><span class="n">throttle</span><span class="o">.</span><span class="n">timetuple</span><span class="p">()))</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.unauthorized_result">
    <p>def <span class="ident">unauthorized_result</span>(</p><p>self, exception)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.unauthorized_result">unauthorized_result</a></code>
    </p>

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.unauthorized_result', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.unauthorized_result" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">unauthorized_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exception</span><span class="p">):</span>
    <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpUnauthorized</span><span class="p">())</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.update_in_place">
    <p>def <span class="ident">update_in_place</span>(</p><p>self, request, original_bundle, new_data)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.update_in_place">update_in_place</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Update the object in original_bundle in-place using new_data.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.update_in_place', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.update_in_place" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">update_in_place</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">original_bundle</span><span class="p">,</span> <span class="n">new_data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Update the object in original_bundle in-place using new_data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">original_bundle</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">dict_strip_unicode_keys</span><span class="p">(</span><span class="n">new_data</span><span class="p">))</span>
    <span class="c1"># Now we&#39;ve got a bundle with the new data sitting in it and we&#39;re</span>
    <span class="c1"># we&#39;re basically in the same spot as a PUT request. SO the rest of this</span>
    <span class="c1"># function is cribbed from put_detail.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">alter_deserialized_detail_data</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">original_bundle</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bundle_detail_data</span><span class="p">(</span><span class="n">original_bundle</span><span class="p">),</span>
        <span class="s1">&#39;request&#39;</span><span class="p">:</span> <span class="n">request</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_update</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">original_bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHCompoundBatchResource.wrap_view">
    <p>def <span class="ident">wrap_view</span>(</p><p>self, view)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.wrap_view">wrap_view</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Wraps methods so they can be called in a more functional way as well
as handling exceptions better.</p>
<p>Note that if <code>BadRequest</code> or an exception with a <code>response</code> attr
are seen, there is special handling to either present a message back
to the user or return the response traveling with the exception.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHCompoundBatchResource.wrap_view', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHCompoundBatchResource.wrap_view" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">wrap_view</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">view</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wraps methods so they can be called in a more functional way as well</span>
<span class="sd">    as handling exceptions better.</span>
<span class="sd">    Note that if ``BadRequest`` or an exception with a ``response`` attr</span>
<span class="sd">    are seen, there is special handling to either present a message back</span>
<span class="sd">    to the user or return the response traveling with the exception.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nd">@csrf_exempt</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">callback</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">view</span><span class="p">)</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">callback</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="c1"># Our response can vary based on a number of factors, use</span>
            <span class="c1"># the cache class to determine what we should ``Vary`` on so</span>
            <span class="c1"># caches won&#39;t return the wrong (cached) version.</span>
            <span class="n">varies</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="p">,</span> <span class="s2">&quot;varies&quot;</span><span class="p">,</span> <span class="p">[])</span>
            <span class="k">if</span> <span class="n">varies</span><span class="p">:</span>
                <span class="n">patch_vary_headers</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">varies</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">cacheable</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">response</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">cache_control</span><span class="p">():</span>
                    <span class="c1"># If the request is cacheable and we have a</span>
                    <span class="c1"># ``Cache-Control`` available then patch the header.</span>
                    <span class="n">patch_cache_control</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">cache_control</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">is_ajax</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">response</span><span class="o">.</span><span class="n">has_header</span><span class="p">(</span><span class="s2">&quot;Cache-Control&quot;</span><span class="p">):</span>
                <span class="c1"># IE excessively caches XMLHttpRequests, so we&#39;re disabling</span>
                <span class="c1"># the browser cache here.</span>
                <span class="c1"># See http://www.enhanceie.com/ie/bugs.asp for details.</span>
                <span class="n">patch_cache_control</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">no_cache</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">response</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">BadRequest</span><span class="p">,</span> <span class="n">fields</span><span class="o">.</span><span class="n">ApiFieldError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="n">sanitize</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s1">&#39;args&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">}</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpBadRequest</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="n">sanitize</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">messages</span><span class="p">)}</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpBadRequest</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1"># Prevent muting non-django&#39;s exceptions</span>
            <span class="c1"># i.e. RequestException from &#39;requests&#39; library</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s1">&#39;response&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">response</span><span class="p">,</span> <span class="n">HttpResponse</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">e</span><span class="o">.</span><span class="n">response</span>
            <span class="c1"># A real, non-expected exception.</span>
            <span class="c1"># Handle the case where the full traceback is more helpful</span>
            <span class="c1"># than the serialized error.</span>
            <span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">DEBUG</span> <span class="ow">and</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">settings</span><span class="p">,</span> <span class="s1">&#39;TASTYPIE_FULL_DEBUG&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
                <span class="k">raise</span>
            <span class="c1"># Re-raise the error to get a proper traceback when the error</span>
            <span class="c1"># happend during a test case</span>
            <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SERVER_NAME&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;testserver&#39;</span><span class="p">:</span>
                <span class="k">raise</span>
            <span class="c1"># Rather than re-raising, we&#39;re going to things similar to</span>
            <span class="c1"># what Django does. The difference is returning a serialized</span>
            <span class="c1"># error message.</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_500</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wrapper</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="cbh_chem_api.resources.CBHMultipleBatchUploadResource" class="name">class <span class="ident">CBHMultipleBatchUploadResource</span></p>
      
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">CBHMultipleBatchUploadResource</span><span class="p">(</span><span class="n">ModelResource</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#cbh_chem_api.resources.CBHMultipleBatchUploadResource">CBHMultipleBatchUploadResource</a></li>
          <li>tastypie.resources.ModelResource</li>
          <li>tastypie.resources.BaseModelResource</li>
          <li>tastypie.resources.Resource</li>
          <li>__builtin__.object</li>
          </ul>
          <h3>Class variables</h3>
            <div class="item">
            <p id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.base_fields" class="name">var <span class="ident">base_fields</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.declared_fields" class="name">var <span class="ident">declared_fields</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.urls" class="name">var <span class="ident">urls</span></p>
            

            
  
    <div class="desc"><p>The endpoints this <code>Resource</code> responds to.</p>
<p>Mostly a standard URLconf, this is suitable for either automatic use
when registered with an <code>Api</code> class or for including directly in
a URLconf should you choose to.</p></div>
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, api_name=None)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.__init__', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">api_name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="c1"># this can cause:</span>
    <span class="c1"># TypeError: object.__new__(method-wrapper) is not safe, use method-wrapper.__new__()</span>
    <span class="c1"># when trying to copy a generator used as a default. Wrap call to</span>
    <span class="c1"># generator in lambda to get around this error.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_fields</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">api_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span> <span class="o">=</span> <span class="n">api_name</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.alter_deserialized_detail_data">
    <p>def <span class="ident">alter_deserialized_detail_data</span>(</p><p>self, request, data)</p>
    </div>
    

    
  
    <div class="desc"><p>A hook to alter detail data just after it has been received from the user &amp;
gets deserialized.</p>
<p>Useful for altering the user data before any hydration is applied.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.alter_deserialized_detail_data', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.alter_deserialized_detail_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">alter_deserialized_detail_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to alter detail data just after it has been received from the user &amp;</span>
<span class="sd">    gets deserialized.</span>
<span class="sd">    Useful for altering the user data before any hydration is applied.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.alter_deserialized_list_data">
    <p>def <span class="ident">alter_deserialized_list_data</span>(</p><p>self, request, data)</p>
    </div>
    

    
  
    <div class="desc"><p>A hook to alter list data just after it has been received from the user &amp;
gets deserialized.</p>
<p>Useful for altering the user data before any hydration is applied.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.alter_deserialized_list_data', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.alter_deserialized_list_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">alter_deserialized_list_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to alter list data just after it has been received from the user &amp;</span>
<span class="sd">    gets deserialized.</span>
<span class="sd">    Useful for altering the user data before any hydration is applied.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.alter_detail_data_to_serialize">
    <p>def <span class="ident">alter_detail_data_to_serialize</span>(</p><p>self, request, data)</p>
    </div>
    

    
  
    <div class="desc"><p>A hook to alter detail data just before it gets serialized &amp; sent to the user.</p>
<p>Useful for restructuring/renaming aspects of the what's going to be
sent.</p>
<p>Should accommodate for receiving a single bundle of data.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.alter_detail_data_to_serialize', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.alter_detail_data_to_serialize" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">alter_detail_data_to_serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to alter detail data just before it gets serialized &amp; sent to the user.</span>
<span class="sd">    Useful for restructuring/renaming aspects of the what&#39;s going to be</span>
<span class="sd">    sent.</span>
<span class="sd">    Should accommodate for receiving a single bundle of data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.alter_list_data_to_serialize">
    <p>def <span class="ident">alter_list_data_to_serialize</span>(</p><p>self, request, data)</p>
    </div>
    

    
  
    <div class="desc"><p>A hook to alter list data just before it gets serialized &amp; sent to the user.</p>
<p>Useful for restructuring/renaming aspects of the what's going to be
sent.</p>
<p>Should accommodate for a list of objects, generally also including
meta data.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.alter_list_data_to_serialize', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.alter_list_data_to_serialize" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">alter_list_data_to_serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to alter list data just before it gets serialized &amp; sent to the user.</span>
<span class="sd">    Useful for restructuring/renaming aspects of the what&#39;s going to be</span>
<span class="sd">    sent.</span>
<span class="sd">    Should accommodate for a list of objects, generally also including</span>
<span class="sd">    meta data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.api_field_from_django_field">
    <p>def <span class="ident">api_field_from_django_field</span>(</p><p>cls, f, default=&lt;class &#39;tastypie.fields.CharField&#39;&gt;)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns the field type that would likely be associated with each
Django type.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.api_field_from_django_field', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.api_field_from_django_field" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">api_field_from_django_field</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">fields</span><span class="o">.</span><span class="n">CharField</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the field type that would likely be associated with each</span>
<span class="sd">    Django type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">default</span>
    <span class="n">internal_type</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">get_internal_type</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">internal_type</span> <span class="o">==</span> <span class="s1">&#39;DateField&#39;</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">DateField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="o">==</span> <span class="s1">&#39;DateTimeField&#39;</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">DateTimeField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;BooleanField&#39;</span><span class="p">,</span> <span class="s1">&#39;NullBooleanField&#39;</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">BooleanField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;FloatField&#39;</span><span class="p">,):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">FloatField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;DecimalField&#39;</span><span class="p">,):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">DecimalField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;IntegerField&#39;</span><span class="p">,</span> <span class="s1">&#39;PositiveIntegerField&#39;</span><span class="p">,</span> <span class="s1">&#39;PositiveSmallIntegerField&#39;</span><span class="p">,</span> <span class="s1">&#39;SmallIntegerField&#39;</span><span class="p">,</span> <span class="s1">&#39;AutoField&#39;</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">IntegerField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;FileField&#39;</span><span class="p">,</span> <span class="s1">&#39;ImageField&#39;</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">FileField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="o">==</span> <span class="s1">&#39;TimeField&#39;</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">TimeField</span>
    <span class="c1"># TODO: Perhaps enable these via introspection. The reason they&#39;re not enabled</span>
    <span class="c1">#       by default is the very different ``__init__`` they have over</span>
    <span class="c1">#       the other fields.</span>
    <span class="c1"># elif internal_type == &#39;ForeignKey&#39;:</span>
    <span class="c1">#     result = ForeignKey</span>
    <span class="c1"># elif internal_type == &#39;ManyToManyField&#39;:</span>
    <span class="c1">#     result = ManyToManyField</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.apply_authorization_limits">
    <p>def <span class="ident">apply_authorization_limits</span>(</p><p>self, request, object_list)</p>
    </div>
    

    
  
    <div class="desc"><p>Deprecated.</p>
<p>FIXME: REMOVE BEFORE 1.0</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.apply_authorization_limits', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.apply_authorization_limits" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">apply_authorization_limits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">object_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Deprecated.</span>
<span class="sd">    FIXME: REMOVE BEFORE 1.0</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">apply_limits</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">object_list</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.apply_filters">
    <p>def <span class="ident">apply_filters</span>(</p><p>self, request, applicable_filters)</p>
    </div>
    

    
  
    <div class="desc"><p>An ORM-specific implementation of <code>apply_filters</code>.</p>
<p>The default simply applies the <code>applicable_filters</code> as <code>**kwargs</code>,
but should make it possible to do more advanced things.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.apply_filters', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.apply_filters" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">apply_filters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">applicable_filters</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An ORM-specific implementation of ``apply_filters``.</span>
<span class="sd">    The default simply applies the ``applicable_filters`` as ``**kwargs``,</span>
<span class="sd">    but should make it possible to do more advanced things.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">request</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="o">**</span><span class="n">applicable_filters</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.apply_sorting">
    <p>def <span class="ident">apply_sorting</span>(</p><p>self, obj_list, options=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a dictionary of options, apply some ORM-level sorting to the
provided <code>QuerySet</code>.</p>
<p>Looks for the <code>order_by</code> key and handles either ascending (just the
field name) or descending (the field name with a <code>-</code> in front).</p>
<p>The field name should be the resource field, <strong>NOT</strong> model field.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.apply_sorting', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.apply_sorting" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">apply_sorting</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_list</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a dictionary of options, apply some ORM-level sorting to the</span>
<span class="sd">    provided ``QuerySet``.</span>
<span class="sd">    Looks for the ``order_by`` key and handles either ascending (just the</span>
<span class="sd">    field name) or descending (the field name with a ``-`` in front).</span>
<span class="sd">    The field name should be the resource field, **NOT** model field.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">parameter_name</span> <span class="o">=</span> <span class="s1">&#39;order_by&#39;</span>
    <span class="k">if</span> <span class="s1">&#39;order_by&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;sort_by&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
            <span class="c1"># Nothing to alter the order. Return what we&#39;ve got.</span>
            <span class="k">return</span> <span class="n">obj_list</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;&#39;sort_by&#39; is a deprecated parameter. Please use &#39;order_by&#39; instead.&quot;</span><span class="p">)</span>
            <span class="n">parameter_name</span> <span class="o">=</span> <span class="s1">&#39;sort_by&#39;</span>
    <span class="n">order_by_args</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="s1">&#39;getlist&#39;</span><span class="p">):</span>
        <span class="n">order_bits</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">getlist</span><span class="p">(</span><span class="n">parameter_name</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">order_bits</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">parameter_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">order_bits</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="n">order_bits</span> <span class="o">=</span> <span class="p">[</span><span class="n">order_bits</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">order_by</span> <span class="ow">in</span> <span class="n">order_bits</span><span class="p">:</span>
        <span class="n">order_by_bits</span> <span class="o">=</span> <span class="n">order_by</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">LOOKUP_SEP</span><span class="p">)</span>
        <span class="n">field_name</span> <span class="o">=</span> <span class="n">order_by_bits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">order</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">order_by_bits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">):</span>
            <span class="n">field_name</span> <span class="o">=</span> <span class="n">order_by_bits</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
            <span class="n">order</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span>
        <span class="k">if</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
            <span class="c1"># It&#39;s not a field we know about. Move along citizen.</span>
            <span class="k">raise</span> <span class="n">InvalidSortError</span><span class="p">(</span><span class="s2">&quot;No matching &#39;</span><span class="si">%s</span><span class="s2">&#39; field for ordering on.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">ordering</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidSortError</span><span class="p">(</span><span class="s2">&quot;The &#39;</span><span class="si">%s</span><span class="s2">&#39; field does not allow ordering.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">attribute</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidSortError</span><span class="p">(</span><span class="s2">&quot;The &#39;</span><span class="si">%s</span><span class="s2">&#39; field has no &#39;attribute&#39; for ordering with.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="n">order_by_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">LOOKUP_SEP</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">attribute</span><span class="p">]</span> <span class="o">+</span> <span class="n">order_by_bits</span><span class="p">[</span><span class="mi">1</span><span class="p">:])))</span>
    <span class="k">return</span> <span class="n">obj_list</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="o">*</span><span class="n">order_by_args</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.authorized_create_detail">
    <p>def <span class="ident">authorized_create_detail</span>(</p><p>self, object_list, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking of permissions to see if the user has authorization
to POST this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.authorized_create_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.authorized_create_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_create_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to POST this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">create_detail</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">auth_result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.authorized_create_list">
    <p>def <span class="ident">authorized_create_list</span>(</p><p>self, object_list, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking of permissions to see if the user has authorization
to POST this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.authorized_create_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.authorized_create_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_create_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to POST this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">create_list</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.authorized_delete_detail">
    <p>def <span class="ident">authorized_delete_detail</span>(</p><p>self, object_list, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking of permissions to see if the user has authorization
to DELETE this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.authorized_delete_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.authorized_delete_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_delete_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to DELETE this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">delete_detail</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">auth_result</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.authorized_delete_list">
    <p>def <span class="ident">authorized_delete_list</span>(</p><p>self, object_list, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking of permissions to see if the user has authorization
to DELETE this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.authorized_delete_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.authorized_delete_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_delete_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to DELETE this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">delete_list</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.authorized_read_detail">
    <p>def <span class="ident">authorized_read_detail</span>(</p><p>self, object_list, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking of permissions to see if the user has authorization
to GET this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.authorized_read_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.authorized_read_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_read_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to GET this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">read_detail</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">auth_result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.authorized_read_list">
    <p>def <span class="ident">authorized_read_list</span>(</p><p>self, object_list, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking of permissions to see if the user has authorization
to GET this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.authorized_read_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.authorized_read_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_read_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to GET this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">read_list</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.authorized_update_detail">
    <p>def <span class="ident">authorized_update_detail</span>(</p><p>self, object_list, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking of permissions to see if the user has authorization
to PUT this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.authorized_update_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.authorized_update_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_update_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to PUT this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">update_detail</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">auth_result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.authorized_update_list">
    <p>def <span class="ident">authorized_update_list</span>(</p><p>self, object_list, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking of permissions to see if the user has authorization
to PUT this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.authorized_update_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.authorized_update_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_update_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to PUT this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">update_list</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.base_urls">
    <p>def <span class="ident">base_urls</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>The standard URLs this <code>Resource</code> should respond to.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.base_urls', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.base_urls" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">base_urls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The standard URLs this ``Resource`` should respond to.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="n">url</span><span class="p">(</span><span class="s2">r&quot;^(?P&lt;resource_name&gt;</span><span class="si">%s</span><span class="s2">)</span><span class="si">%s</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span> <span class="n">trailing_slash</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrap_view</span><span class="p">(</span><span class="s1">&#39;dispatch_list&#39;</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;api_dispatch_list&quot;</span><span class="p">),</span>
        <span class="n">url</span><span class="p">(</span><span class="s2">r&quot;^(?P&lt;resource_name&gt;</span><span class="si">%s</span><span class="s2">)/schema</span><span class="si">%s</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span> <span class="n">trailing_slash</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrap_view</span><span class="p">(</span><span class="s1">&#39;get_schema&#39;</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;api_get_schema&quot;</span><span class="p">),</span>
        <span class="n">url</span><span class="p">(</span><span class="s2">r&quot;^(?P&lt;resource_name&gt;</span><span class="si">%s</span><span class="s2">)/set/(?P&lt;</span><span class="si">%s</span><span class="s2">_list&gt;.*?)</span><span class="si">%s</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">,</span> <span class="n">trailing_slash</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrap_view</span><span class="p">(</span><span class="s1">&#39;get_multiple&#39;</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;api_get_multiple&quot;</span><span class="p">),</span>
        <span class="n">url</span><span class="p">(</span><span class="s2">r&quot;^(?P&lt;resource_name&gt;</span><span class="si">%s</span><span class="s2">)/(?P&lt;</span><span class="si">%s</span><span class="s2">&gt;.*?)</span><span class="si">%s</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">,</span> <span class="n">trailing_slash</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrap_view</span><span class="p">(</span><span class="s1">&#39;dispatch_detail&#39;</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;api_dispatch_detail&quot;</span><span class="p">),</span>
    <span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.build_bundle">
    <p>def <span class="ident">build_bundle</span>(</p><p>self, obj=None, data=None, request=None, objects_saved=None, via_uri=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Given either an object, a data dictionary or both, builds a <code>Bundle</code>
for use throughout the <code>dehydrate/hydrate</code> cycle.</p>
<p>If no object is provided, an empty object from
<code>Resource._meta.object_class</code> is created so that attempts to access
<code>bundle.obj</code> do not fail.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.build_bundle', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.build_bundle" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">build_bundle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">objects_saved</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">via_uri</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given either an object, a data dictionary or both, builds a ``Bundle``</span>
<span class="sd">    for use throughout the ``dehydrate/hydrate`` cycle.</span>
<span class="sd">    If no object is provided, an empty object from</span>
<span class="sd">    ``Resource._meta.object_class`` is created so that attempts to access</span>
<span class="sd">    ``bundle.obj`` do not fail.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="p">:</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">Bundle</span><span class="p">(</span>
        <span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span>
        <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
        <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">,</span>
        <span class="n">objects_saved</span><span class="o">=</span><span class="n">objects_saved</span><span class="p">,</span>
        <span class="n">via_uri</span><span class="o">=</span><span class="n">via_uri</span>
    <span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.build_filters">
    <p>def <span class="ident">build_filters</span>(</p><p>self, filters=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a dictionary of filters, create the necessary ORM-level filters.</p>
<p>Keys should be resource fields, <strong>NOT</strong> model fields.</p>
<p>Valid values are either a list of Django filter types (i.e.
<code>['startswith', 'exact', 'lte']</code>), the <code>ALL</code> constant or the
<code>ALL_WITH_RELATIONS</code> constant.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.build_filters', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.build_filters" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">build_filters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a dictionary of filters, create the necessary ORM-level filters.</span>
<span class="sd">    Keys should be resource fields, **NOT** model fields.</span>
<span class="sd">    Valid values are either a list of Django filter types (i.e.</span>
<span class="sd">    ``[&#39;startswith&#39;, &#39;exact&#39;, &#39;lte&#39;]``), the ``ALL`` constant or the</span>
<span class="sd">    ``ALL_WITH_RELATIONS`` constant.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># At the declarative level:</span>
    <span class="c1">#     filtering = {</span>
    <span class="c1">#         &#39;resource_field_name&#39;: [&#39;exact&#39;, &#39;startswith&#39;, &#39;endswith&#39;, &#39;contains&#39;],</span>
    <span class="c1">#         &#39;resource_field_name_2&#39;: [&#39;exact&#39;, &#39;gt&#39;, &#39;gte&#39;, &#39;lt&#39;, &#39;lte&#39;, &#39;range&#39;],</span>
    <span class="c1">#         &#39;resource_field_name_3&#39;: ALL,</span>
    <span class="c1">#         &#39;resource_field_name_4&#39;: ALL_WITH_RELATIONS,</span>
    <span class="c1">#         ...</span>
    <span class="c1">#     }</span>
    <span class="c1"># Accepts the filters as a dict. None by default, meaning no filters.</span>
    <span class="k">if</span> <span class="n">filters</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">filters</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">qs_filters</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="p">,</span> <span class="s1">&#39;queryset&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="c1"># Get the possible query terms from the current QuerySet.</span>
        <span class="n">query_terms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">queryset</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">query_terms</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">query_terms</span> <span class="o">=</span> <span class="n">QUERY_TERMS</span>
    <span class="k">if</span> <span class="n">django</span><span class="o">.</span><span class="n">VERSION</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span> <span class="ow">and</span> <span class="n">GeometryField</span><span class="p">:</span>
        <span class="n">query_terms</span> <span class="o">=</span> <span class="n">query_terms</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="n">GeometryField</span><span class="o">.</span><span class="n">class_lookups</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="k">for</span> <span class="n">filter_expr</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">filters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">filter_bits</span> <span class="o">=</span> <span class="n">filter_expr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">LOOKUP_SEP</span><span class="p">)</span>
        <span class="n">field_name</span> <span class="o">=</span> <span class="n">filter_bits</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">filter_type</span> <span class="o">=</span> <span class="s1">&#39;exact&#39;</span>
        <span class="k">if</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
            <span class="c1"># It&#39;s not a field we know about. Move along citizen.</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filter_bits</span><span class="p">)</span> <span class="ow">and</span> <span class="n">filter_bits</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">query_terms</span><span class="p">:</span>
            <span class="n">filter_type</span> <span class="o">=</span> <span class="n">filter_bits</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="n">lookup_bits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_filtering</span><span class="p">(</span><span class="n">field_name</span><span class="p">,</span> <span class="n">filter_type</span><span class="p">,</span> <span class="n">filter_bits</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_value_to_python</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">filters</span><span class="p">,</span> <span class="n">filter_expr</span><span class="p">,</span> <span class="n">filter_type</span><span class="p">)</span>
        <span class="n">db_field_name</span> <span class="o">=</span> <span class="n">LOOKUP_SEP</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lookup_bits</span><span class="p">)</span>
        <span class="n">qs_filter</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">db_field_name</span><span class="p">,</span> <span class="n">LOOKUP_SEP</span><span class="p">,</span> <span class="n">filter_type</span><span class="p">)</span>
        <span class="n">qs_filters</span><span class="p">[</span><span class="n">qs_filter</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
    <span class="k">return</span> <span class="n">dict_strip_unicode_keys</span><span class="p">(</span><span class="n">qs_filters</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.build_schema">
    <p>def <span class="ident">build_schema</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns a dictionary of all the fields on the resource and some
properties about those fields.</p>
<p>Used by the <code>schema/</code> endpoint to describe what will be available.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.build_schema', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.build_schema" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">build_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a dictionary of all the fields on the resource and some</span>
<span class="sd">    properties about those fields.</span>
<span class="sd">    Used by the ``schema/`` endpoint to describe what will be available.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;fields&#39;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s1">&#39;default_format&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">default_format</span><span class="p">,</span>
        <span class="s1">&#39;allowed_list_http_methods&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">list_allowed_methods</span><span class="p">,</span>
        <span class="s1">&#39;allowed_detail_http_methods&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_allowed_methods</span><span class="p">,</span>
        <span class="s1">&#39;default_limit&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">limit</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">ordering</span><span class="p">:</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;ordering&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">ordering</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span><span class="p">:</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;filtering&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span>
    <span class="c1"># Skip assigning pk_field_name for non-model resources</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">pk_field_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">queryset</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">pk</span><span class="o">.</span><span class="n">name</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="n">pk_field_name</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;fields&#39;</span><span class="p">][</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">default</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">dehydrated_type</span><span class="p">,</span>
            <span class="s1">&#39;nullable&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">null</span><span class="p">,</span>
            <span class="s1">&#39;blank&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">blank</span><span class="p">,</span>
            <span class="s1">&#39;readonly&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">readonly</span><span class="p">,</span>
            <span class="s1">&#39;help_text&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">help_text</span><span class="p">,</span>
            <span class="s1">&#39;unique&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">unique</span><span class="p">,</span>
            <span class="s1">&#39;primary_key&#39;</span><span class="p">:</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">field_name</span> <span class="o">==</span> <span class="n">pk_field_name</span> <span class="k">else</span> <span class="bp">False</span><span class="p">,</span>
            <span class="s1">&#39;verbose_name&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">verbose_name</span> <span class="ow">or</span> <span class="n">field_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">),</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">dehydrated_type</span> <span class="o">==</span> <span class="s1">&#39;related&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
                <span class="n">related_type</span> <span class="o">=</span> <span class="s1">&#39;to_many&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">related_type</span> <span class="o">=</span> <span class="s1">&#39;to_one&#39;</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;fields&#39;</span><span class="p">][</span><span class="n">field_name</span><span class="p">][</span><span class="s1">&#39;related_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">related_type</span>
            <span class="n">uri</span> <span class="o">=</span> <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;api_get_schema&#39;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;api_name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span><span class="p">,</span> <span class="s1">&#39;resource_name&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">to_class</span><span class="p">()</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">})</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;fields&#39;</span><span class="p">][</span><span class="n">field_name</span><span class="p">][</span><span class="s1">&#39;related_schema&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">uri</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.cached_obj_get">
    <p>def <span class="ident">cached_obj_get</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A version of <code>obj_get</code> that uses the cache as a means to get
commonly-accessed data faster.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.cached_obj_get', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.cached_obj_get" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">cached_obj_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A version of ``obj_get`` that uses the cache as a means to get</span>
<span class="sd">    commonly-accessed data faster.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_cache_key</span><span class="p">(</span><span class="s1">&#39;detail&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">cached_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cache_key</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">cached_bundle</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">cached_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">cache_key</span><span class="p">,</span> <span class="n">cached_bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cached_bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.cached_obj_get_list">
    <p>def <span class="ident">cached_obj_get_list</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A version of <code>obj_get_list</code> that uses the cache as a means to get
commonly-accessed data faster.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.cached_obj_get_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.cached_obj_get_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">cached_obj_get_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A version of ``obj_get_list`` that uses the cache as a means to get</span>
<span class="sd">    commonly-accessed data faster.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_cache_key</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">obj_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cache_key</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">obj_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">obj_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">cache_key</span><span class="p">,</span> <span class="n">obj_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">obj_list</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.can_create">
    <p>def <span class="ident">can_create</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Checks to ensure <code>post</code> is within <code>allowed_methods</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.can_create', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.can_create" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">can_create</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks to ensure ``post`` is within ``allowed_methods``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">allowed</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">list_allowed_methods</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_allowed_methods</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">&#39;post&#39;</span> <span class="ow">in</span> <span class="n">allowed</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.can_delete">
    <p>def <span class="ident">can_delete</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Checks to ensure <code>delete</code> is within <code>allowed_methods</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.can_delete', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.can_delete" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">can_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks to ensure ``delete`` is within ``allowed_methods``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">allowed</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">list_allowed_methods</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_allowed_methods</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">&#39;delete&#39;</span> <span class="ow">in</span> <span class="n">allowed</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.can_update">
    <p>def <span class="ident">can_update</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Checks to ensure <code>put</code> is within <code>allowed_methods</code>.</p>
<p>Used when hydrating related data.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.can_update', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.can_update" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">can_update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks to ensure ``put`` is within ``allowed_methods``.</span>
<span class="sd">    Used when hydrating related data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">allowed</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">list_allowed_methods</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_allowed_methods</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">&#39;put&#39;</span> <span class="ow">in</span> <span class="n">allowed</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.check_filtering">
    <p>def <span class="ident">check_filtering</span>(</p><p>self, field_name, filter_type=u&#39;exact&#39;, filter_bits=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a field name, a optional filter type and an optional list of
additional relations, determine if a field can be filtered on.</p>
<p>If a filter does not meet the needed conditions, it should raise an
<code>InvalidFilterError</code>.</p>
<p>If the filter meets the conditions, a list of attribute names (not
field names) will be returned.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.check_filtering', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.check_filtering" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">check_filtering</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">filter_type</span><span class="o">=</span><span class="s1">&#39;exact&#39;</span><span class="p">,</span> <span class="n">filter_bits</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a field name, a optional filter type and an optional list of</span>
<span class="sd">    additional relations, determine if a field can be filtered on.</span>
<span class="sd">    If a filter does not meet the needed conditions, it should raise an</span>
<span class="sd">    ``InvalidFilterError``.</span>
<span class="sd">    If the filter meets the conditions, a list of attribute names (not</span>
<span class="sd">    field names) will be returned.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">filter_bits</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">filter_bits</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">InvalidFilterError</span><span class="p">(</span><span class="s2">&quot;The &#39;</span><span class="si">%s</span><span class="s2">&#39; field does not allow filtering.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
    <span class="c1"># Check to see if it&#39;s an allowed lookup type.</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">ALL</span><span class="p">,</span> <span class="n">ALL_WITH_RELATIONS</span><span class="p">):</span>
        <span class="c1"># Must be an explicit whitelist.</span>
        <span class="k">if</span> <span class="n">filter_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span><span class="p">[</span><span class="n">field_name</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">InvalidFilterError</span><span class="p">(</span><span class="s2">&quot;&#39;</span><span class="si">%s</span><span class="s2">&#39; is not an allowed filter on the &#39;</span><span class="si">%s</span><span class="s2">&#39; field.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">filter_type</span><span class="p">,</span> <span class="n">field_name</span><span class="p">))</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">attribute</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">InvalidFilterError</span><span class="p">(</span><span class="s2">&quot;The &#39;</span><span class="si">%s</span><span class="s2">&#39; field has no &#39;attribute&#39; for searching with.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
    <span class="c1"># Check to see if it&#39;s a relational lookup and if that&#39;s allowed.</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filter_bits</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">],</span> <span class="s1">&#39;is_related&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">InvalidFilterError</span><span class="p">(</span><span class="s2">&quot;The &#39;</span><span class="si">%s</span><span class="s2">&#39; field does not support relations.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">==</span> <span class="n">ALL_WITH_RELATIONS</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidFilterError</span><span class="p">(</span><span class="s2">&quot;Lookups are not allowed more than one level deep on the &#39;</span><span class="si">%s</span><span class="s2">&#39; field.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="c1"># Recursively descend through the remaining lookups in the filter,</span>
        <span class="c1"># if any. We should ensure that all along the way, we&#39;re allowed</span>
        <span class="c1"># to filter on that field by the related resource.</span>
        <span class="n">related_resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">get_related_resource</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">attribute</span><span class="p">]</span> <span class="o">+</span> <span class="n">related_resource</span><span class="o">.</span><span class="n">check_filtering</span><span class="p">(</span><span class="n">filter_bits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">filter_type</span><span class="p">,</span> <span class="n">filter_bits</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">attribute</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.create_identifier">
    <p>def <span class="ident">create_identifier</span>(</p><p>self, obj)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.create_identifier', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.create_identifier" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">create_identifier</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">u&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">app_label</span><span class="p">,</span> <span class="n">get_module_name</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">_meta</span><span class="p">),</span> <span class="n">obj</span><span class="o">.</span><span class="n">pk</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.create_response">
    <p>def <span class="ident">create_response</span>(</p><p>self, request, data, response_class=&lt;class &#39;django.http.response.HttpResponse&#39;&gt;, **response_kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Extracts the common "which-format/serialize/return-response" cycle.</p>
<p>Mostly a useful shortcut/hook.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.create_response', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.create_response" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">create_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">HttpResponse</span><span class="p">,</span> <span class="o">**</span><span class="n">response_kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extracts the common &quot;which-format/serialize/return-response&quot; cycle.</span>
<span class="sd">    Mostly a useful shortcut/hook.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">desired_format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">determine_format</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="n">serialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">desired_format</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response_class</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">serialized</span><span class="p">,</span> <span class="n">content_type</span><span class="o">=</span><span class="n">build_content_type</span><span class="p">(</span><span class="n">desired_format</span><span class="p">),</span> <span class="o">**</span><span class="n">response_kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.dehydrate">
    <p>def <span class="ident">dehydrate</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>A hook to allow a final manipulation of data once all fields/methods
have built out the dehydrated data.</p>
<p>Useful if you need to access more than one dehydrated field or want
to annotate on additional data.</p>
<p>Must return the modified bundle.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.dehydrate', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.dehydrate" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dehydrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to allow a final manipulation of data once all fields/methods</span>
<span class="sd">    have built out the dehydrated data.</span>
<span class="sd">    Useful if you need to access more than one dehydrated field or want</span>
<span class="sd">    to annotate on additional data.</span>
<span class="sd">    Must return the modified bundle.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.dehydrate_resource_uri">
    <p>def <span class="ident">dehydrate_resource_uri</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>For the automatically included <code>resource_uri</code> field, dehydrate
the URI for the given bundle.</p>
<p>Returns empty string if no URI can be generated.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.dehydrate_resource_uri', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.dehydrate_resource_uri" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dehydrate_resource_uri</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    For the automatically included ``resource_uri`` field, dehydrate</span>
<span class="sd">    the URI for the given bundle.</span>
<span class="sd">    Returns empty string if no URI can be generated.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_uri</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="k">except</span> <span class="n">NoReverseMatch</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.delete_detail">
    <p>def <span class="ident">delete_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Destroys a single resource/object.</p>
<p>Calls <code>obj_delete</code>.</p>
<p>If the resource is deleted, return <code>HttpNoContent</code> (204 No Content).
If the resource did not exist, return <code>Http404</code> (404 Not Found).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.delete_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.delete_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">delete_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Destroys a single resource/object.</span>
<span class="sd">    Calls ``obj_delete``.</span>
<span class="sd">    If the resource is deleted, return ``HttpNoContent`` (204 No Content).</span>
<span class="sd">    If the resource did not exist, return ``Http404`` (404 Not Found).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Manually construct the bundle here, since we don&#39;t want to try to</span>
    <span class="c1"># delete an empty instance.</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="n">Bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">obj_delete</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNoContent</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">NotFound</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNotFound</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.delete_list">
    <p>def <span class="ident">delete_list</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Destroys a collection of resources/objects.</p>
<p>Calls <code>obj_delete_list</code>.</p>
<p>If the resources are deleted, return <code>HttpNoContent</code> (204 No Content).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.delete_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.delete_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">delete_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Destroys a collection of resources/objects.</span>
<span class="sd">    Calls ``obj_delete_list``.</span>
<span class="sd">    If the resources are deleted, return ``HttpNoContent`` (204 No Content).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">obj_delete_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNoContent</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.deserialize">
    <p>def <span class="ident">deserialize</span>(</p><p>self, request, data, format=u&#39;application/json&#39;)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a request, data and a format, deserializes the given data.</p>
<p>It relies on the request properly sending a <code>CONTENT_TYPE</code> header,
falling back to <code>application/json</code> if not provided.</p>
<p>Mostly a hook, this uses the <code>Serializer</code> from <code>Resource._meta</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.deserialize', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.deserialize" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">deserialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s1">&#39;application/json&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a request, data and a format, deserializes the given data.</span>
<span class="sd">    It relies on the request properly sending a ``CONTENT_TYPE`` header,</span>
<span class="sd">    falling back to ``application/json`` if not provided.</span>
<span class="sd">    Mostly a hook, this uses the ``Serializer`` from ``Resource._meta``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">serializer</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="n">format</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">deserialized</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.detail_uri_kwargs">
    <p>def <span class="ident">detail_uri_kwargs</span>(</p><p>self, bundle_or_obj)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a <code>Bundle</code> or an object (typically a <code>Model</code> instance),
it returns the extra kwargs needed to generate a detail URI.</p>
<p>By default, it uses the model's <code>pk</code> in order to create the URI.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.detail_uri_kwargs', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.detail_uri_kwargs" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">detail_uri_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle_or_obj</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a ``Bundle`` or an object (typically a ``Model`` instance),</span>
<span class="sd">    it returns the extra kwargs needed to generate a detail URI.</span>
<span class="sd">    By default, it uses the model&#39;s ``pk`` in order to create the URI.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bundle_or_obj</span><span class="p">,</span> <span class="n">Bundle</span><span class="p">):</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">bundle_or_obj</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">bundle_or_obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">kwargs</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.determine_format">
    <p>def <span class="ident">determine_format</span>(</p><p>self, request)</p>
    </div>
    

    
  
    <div class="desc"><p>Used to determine the desired format.</p>
<p>Largely relies on <code>tastypie.utils.mime.determine_format</code> but here
as a point of extension.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.determine_format', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.determine_format" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">determine_format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Used to determine the desired format.</span>
<span class="sd">    Largely relies on ``tastypie.utils.mime.determine_format`` but here</span>
<span class="sd">    as a point of extension.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">determine_format</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">serializer</span><span class="p">,</span> <span class="n">default_format</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">default_format</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.dispatch">
    <p>def <span class="ident">dispatch</span>(</p><p>self, request_type, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles the common operations (allowed HTTP method, authentication,
throttling, method lookup) surrounding most CRUD interactions.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.dispatch', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.dispatch" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dispatch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request_type</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles the common operations (allowed HTTP method, authentication,</span>
<span class="sd">    throttling, method lookup) surrounding most CRUD interactions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">allowed_methods</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_allowed_methods&quot;</span> <span class="o">%</span> <span class="n">request_type</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;HTTP_X_HTTP_METHOD_OVERRIDE&#39;</span> <span class="ow">in</span> <span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="p">:</span>
        <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="p">[</span><span class="s1">&#39;HTTP_X_HTTP_METHOD_OVERRIDE&#39;</span><span class="p">]</span>
    <span class="n">request_method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">method_check</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">allowed</span><span class="o">=</span><span class="n">allowed_methods</span><span class="p">)</span>
    <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">request_method</span><span class="p">,</span> <span class="n">request_type</span><span class="p">),</span> <span class="bp">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">method</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpNotImplemented</span><span class="p">())</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">throttle_check</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="c1"># All clear. Process the request.</span>
    <span class="n">request</span> <span class="o">=</span> <span class="n">convert_post_to_put</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="c1"># Add the throttled request.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_throttled_access</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="c1"># If what comes back isn&#39;t a ``HttpResponse``, assume that the</span>
    <span class="c1"># request was accepted and that some action occurred. This also</span>
    <span class="c1"># prevents Django from freaking out.</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">HttpResponse</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNoContent</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">response</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.dispatch_detail">
    <p>def <span class="ident">dispatch_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A view for handling the various HTTP methods (GET/POST/PUT/DELETE) on
a single resource.</p>
<p>Relies on <code>Resource.dispatch</code> for the heavy-lifting.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.dispatch_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.dispatch_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dispatch_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A view for handling the various HTTP methods (GET/POST/PUT/DELETE) on</span>
<span class="sd">    a single resource.</span>
<span class="sd">    Relies on ``Resource.dispatch`` for the heavy-lifting.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span><span class="s1">&#39;detail&#39;</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.dispatch_list">
    <p>def <span class="ident">dispatch_list</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A view for handling the various HTTP methods (GET/POST/PUT/DELETE) over
the entire list of resources.</p>
<p>Relies on <code>Resource.dispatch</code> for the heavy-lifting.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.dispatch_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.dispatch_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dispatch_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A view for handling the various HTTP methods (GET/POST/PUT/DELETE) over</span>
<span class="sd">    the entire list of resources.</span>
<span class="sd">    Relies on ``Resource.dispatch`` for the heavy-lifting.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.error_response">
    <p>def <span class="ident">error_response</span>(</p><p>self, request, errors, response_class=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Extracts the common "which-format/serialize/return-error-response"
cycle.</p>
<p>Should be used as much as possible to return errors.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.error_response', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.error_response" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">error_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extracts the common &quot;which-format/serialize/return-error-response&quot;</span>
<span class="sd">    cycle.</span>
<span class="sd">    Should be used as much as possible to return errors.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">response_class</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">response_class</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpBadRequest</span>
    <span class="n">desired_format</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">if</span> <span class="n">request</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;callback&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">desired_format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">determine_format</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">BadRequest</span><span class="p">:</span>
                <span class="k">pass</span>  <span class="c1"># Fall through to default handler below</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># JSONP can cause extra breakage.</span>
            <span class="n">desired_format</span> <span class="o">=</span> <span class="s1">&#39;application/json&#39;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">desired_format</span><span class="p">:</span>
        <span class="n">desired_format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">default_format</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">serialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">desired_format</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">BadRequest</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">error</span> <span class="o">=</span> <span class="s2">&quot;Additional errors occurred, but serialization of those errors failed.&quot;</span>
        <span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">:</span>
            <span class="n">error</span> <span class="o">+=</span> <span class="s2">&quot; </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">e</span>
        <span class="k">return</span> <span class="n">response_class</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">error</span><span class="p">,</span> <span class="n">content_type</span><span class="o">=</span><span class="s1">&#39;text/plain&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response_class</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">serialized</span><span class="p">,</span> <span class="n">content_type</span><span class="o">=</span><span class="n">build_content_type</span><span class="p">(</span><span class="n">desired_format</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.filter_value_to_python">
    <p>def <span class="ident">filter_value_to_python</span>(</p><p>self, value, field_name, filters, filter_expr, filter_type)</p>
    </div>
    

    
  
    <div class="desc"><p>Turn the string <code>value</code> into a python object.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.filter_value_to_python', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.filter_value_to_python" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">filter_value_to_python</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">filters</span><span class="p">,</span> <span class="n">filter_expr</span><span class="p">,</span>
        <span class="n">filter_type</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Turn the string ``value`` into a python object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Simple values</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">string_to_python</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="c1"># Split on &#39;,&#39; if not empty string and either an in or range filter.</span>
    <span class="k">if</span> <span class="n">filter_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="s1">&#39;range&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">filters</span><span class="p">,</span> <span class="s1">&#39;getlist&#39;</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">filters</span><span class="o">.</span><span class="n">getlist</span><span class="p">(</span><span class="n">filter_expr</span><span class="p">):</span>
                <span class="n">value</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">part</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">value</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.full_dehydrate">
    <p>def <span class="ident">full_dehydrate</span>(</p><p>self, bundle, for_list=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a bundle with an object instance, extract the information from it
to populate the resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.full_dehydrate', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.full_dehydrate" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">full_dehydrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">for_list</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a bundle with an object instance, extract the information from it</span>
<span class="sd">    to populate the resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span>
    <span class="n">api_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span>
    <span class="n">resource_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span>
    <span class="c1"># Dehydrate each field.</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># If it&#39;s not for use in this mode, skip</span>
        <span class="n">field_use_in</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">use_in</span>
        <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_use_in</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">field_use_in</span><span class="p">(</span><span class="n">bundle</span><span class="p">):</span>
                <span class="k">continue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">field_use_in</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;list&#39;</span> <span class="k">if</span> <span class="n">for_list</span> <span class="k">else</span> <span class="s1">&#39;detail&#39;</span><span class="p">]:</span>
                <span class="k">continue</span>
        <span class="c1"># A touch leaky but it makes URI resolution work.</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">dehydrated_type</span> <span class="o">==</span> <span class="s1">&#39;related&#39;</span><span class="p">:</span>
            <span class="n">field_object</span><span class="o">.</span><span class="n">api_name</span> <span class="o">=</span> <span class="n">api_name</span>
            <span class="n">field_object</span><span class="o">.</span><span class="n">resource_name</span> <span class="o">=</span> <span class="n">resource_name</span>
        <span class="n">data</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="n">for_list</span><span class="o">=</span><span class="n">for_list</span><span class="p">)</span>
        <span class="c1"># Check for an optional method to do further dehydration.</span>
        <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;dehydrate_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.full_hydrate">
    <p>def <span class="ident">full_hydrate</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a populated bundle, distill it and turn it back into
a full-fledged object instance.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.full_hydrate', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.full_hydrate" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">full_hydrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a populated bundle, distill it and turn it back into</span>
<span class="sd">    a full-fledged object instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="p">()</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">readonly</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># Check for an optional method to do further hydration.</span>
        <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;hydrate_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
            <span class="n">bundle</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
            <span class="c1"># NOTE: We only get back a bundle when it is related field.</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Bundle</span><span class="p">)</span> <span class="ow">and</span> <span class="n">value</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_name</span><span class="p">):</span>
                <span class="n">bundle</span><span class="o">.</span><span class="n">errors</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">errors</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">field_object</span><span class="o">.</span><span class="n">null</span><span class="p">:</span>
                <span class="c1"># We need to avoid populating M2M data here as that will</span>
                <span class="c1"># cause things to blow up.</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_related</span><span class="p">:</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="k">elif</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                        <span class="c1"># NOTE: A bug fix in Django (ticket #18153) fixes incorrect behavior</span>
                        <span class="c1"># which Tastypie was relying on.  To fix this, we store value.obj to</span>
                        <span class="c1"># be saved later in save_related.</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="nb">setattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
                        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">ObjectDoesNotExist</span><span class="p">):</span>
                            <span class="n">bundle</span><span class="o">.</span><span class="n">related_objects_to_save</span><span class="p">[</span><span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">obj</span>
                    <span class="k">elif</span> <span class="n">field_object</span><span class="o">.</span><span class="n">blank</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="k">elif</span> <span class="n">field_object</span><span class="o">.</span><span class="n">null</span><span class="p">:</span>
                        <span class="nb">setattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.generate_cache_key">
    <p>def <span class="ident">generate_cache_key</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Creates a unique-enough cache key.</p>
<p>This is based off the current api_name/resource_name/args/kwargs.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.generate_cache_key', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.generate_cache_key" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">generate_cache_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a unique-enough cache key.</span>
<span class="sd">    This is based off the current api_name/resource_name/args/kwargs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">smooshed</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">=</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
    <span class="c1"># Use a list plus a ``.join()`` because it&#39;s faster than concatenation.</span>
    <span class="k">return</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">args</span><span class="p">),</span> <span class="s1">&#39;:&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">smooshed</span><span class="p">)))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.get_bundle_detail_data">
    <p>def <span class="ident">get_bundle_detail_data</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Convenience method to return the <code>detail_uri_name</code> attribute off
<code>bundle.obj</code>.</p>
<p>Usually just accesses <code>bundle.obj.pk</code> by default.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.get_bundle_detail_data', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.get_bundle_detail_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_bundle_detail_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convenience method to return the ``detail_uri_name`` attribute off</span>
<span class="sd">    ``bundle.obj``.</span>
<span class="sd">    Usually just accesses ``bundle.obj.pk`` by default.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.get_detail">
    <p>def <span class="ident">get_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns a single serialized resource.</p>
<p>Calls <code>cached_obj_get/obj_get</code> to provide the data, then handles that result
set and serializes it.</p>
<p>Should return a HttpResponse (200 OK).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.get_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.get_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a single serialized resource.</span>
<span class="sd">    Calls ``cached_obj_get/obj_get`` to provide the data, then handles that result</span>
<span class="sd">    set and serializes it.</span>
<span class="sd">    Should return a HttpResponse (200 OK).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">basic_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cached_obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">basic_bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="k">except</span> <span class="n">ObjectDoesNotExist</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNotFound</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">MultipleObjectsReturned</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpMultipleChoices</span><span class="p">(</span><span class="s2">&quot;More than one resource is found at this URI.&quot;</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.get_fields">
    <p>def <span class="ident">get_fields</span>(</p><p>cls, fields=None, excludes=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Given any explicit fields to include and fields to exclude, add
additional fields based on the associated model.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.get_fields', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.get_fields" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">get_fields</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">excludes</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given any explicit fields to include and fields to exclude, add</span>
<span class="sd">    additional fields based on the associated model.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">final_fields</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">fields</span> <span class="o">=</span> <span class="n">fields</span> <span class="ow">or</span> <span class="p">[]</span>
    <span class="n">excludes</span> <span class="o">=</span> <span class="n">excludes</span> <span class="ow">or</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">cls</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">final_fields</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">cls</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
        <span class="c1"># If the field name is already present, skip</span>
        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">cls</span><span class="o">.</span><span class="n">base_fields</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># If field is not present in explicit field listing, skip</span>
        <span class="k">if</span> <span class="n">fields</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># If field is in exclude list, skip</span>
        <span class="k">if</span> <span class="n">excludes</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">excludes</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">cls</span><span class="o">.</span><span class="n">should_skip_field</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="n">api_field_class</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">api_field_from_django_field</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;attribute&#39;</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s1">&#39;help_text&#39;</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">help_text</span><span class="p">,</span>
            <span class="s1">&#39;verbose_name&#39;</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">verbose_name</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">null</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;null&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;unique&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">unique</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">f</span><span class="o">.</span><span class="n">null</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">blank</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;blank&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">get_internal_type</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;TextField&#39;</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">has_default</span><span class="p">():</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">default</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;auto_now&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">auto_now</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;auto_now_add&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">auto_now_add</span>
        <span class="n">final_fields</span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">api_field_class</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">final_fields</span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">instance_name</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span>
    <span class="k">return</span> <span class="n">final_fields</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.get_list">
    <p>def <span class="ident">get_list</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns a serialized list of resources.</p>
<p>Calls <code>obj_get_list</code> to provide the data, then handles that result
set and serializes it.</p>
<p>Should return a HttpResponse (200 OK).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.get_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.get_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a serialized list of resources.</span>
<span class="sd">    Calls ``obj_get_list`` to provide the data, then handles that result</span>
<span class="sd">    set and serializes it.</span>
<span class="sd">    Should return a HttpResponse (200 OK).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO: Uncached for now. Invalidation that works for everyone may be</span>
    <span class="c1">#       impossible.</span>
    <span class="n">base_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="n">objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">base_bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="n">sorted_objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_sorting</span><span class="p">(</span><span class="n">objects</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="p">)</span>
    <span class="n">paginator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">paginator_class</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="p">,</span> <span class="n">sorted_objects</span><span class="p">,</span> <span class="n">resource_uri</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_resource_uri</span><span class="p">(),</span> <span class="n">limit</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">limit</span><span class="p">,</span> <span class="n">max_limit</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">max_limit</span><span class="p">,</span> <span class="n">collection_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">)</span>
    <span class="n">to_be_serialized</span> <span class="o">=</span> <span class="n">paginator</span><span class="o">.</span><span class="n">page</span><span class="p">()</span>
    <span class="c1"># Dehydrate the bundles in preparation for serialization.</span>
    <span class="n">bundles</span> <span class="o">=</span> <span class="p">[</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">),</span> <span class="n">for_list</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">to_be_serialized</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">]</span>
    <span class="p">]</span>
    <span class="n">to_be_serialized</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">bundles</span>
    <span class="n">to_be_serialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_list_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">to_be_serialized</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">to_be_serialized</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.get_multiple">
    <p>def <span class="ident">get_multiple</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns a serialized list of resources based on the identifiers
from the URL.</p>
<p>Calls <code>obj_get</code> to fetch only the objects requested. This method
only responds to HTTP GET.</p>
<p>Should return a HttpResponse (200 OK).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.get_multiple', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.get_multiple" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_multiple</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a serialized list of resources based on the identifiers</span>
<span class="sd">    from the URL.</span>
<span class="sd">    Calls ``obj_get`` to fetch only the objects requested. This method</span>
<span class="sd">    only responds to HTTP GET.</span>
<span class="sd">    Should return a HttpResponse (200 OK).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">method_check</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">allowed</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;get&#39;</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">throttle_check</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="c1"># Rip apart the list then iterate.</span>
    <span class="n">kwarg_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_list&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span>
    <span class="n">obj_identifiers</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">kwarg_name</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
    <span class="n">objects</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">not_found</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">base_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">identifier</span> <span class="ow">in</span> <span class="n">obj_identifiers</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">base_bundle</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">:</span> <span class="n">identifier</span><span class="p">})</span>
            <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
            <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="n">for_list</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="n">objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">ObjectDoesNotExist</span><span class="p">,</span> <span class="n">Unauthorized</span><span class="p">):</span>
            <span class="n">not_found</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">identifier</span><span class="p">)</span>
    <span class="n">object_list</span> <span class="o">=</span> <span class="p">{</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">:</span> <span class="n">objects</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">not_found</span><span class="p">):</span>
        <span class="n">object_list</span><span class="p">[</span><span class="s1">&#39;not_found&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">not_found</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_throttled_access</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">object_list</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.get_object_list">
    <p>def <span class="ident">get_object_list</span>(</p><p>self, request)</p>
    </div>
    

    
  
    <div class="desc"><p>An ORM-specific implementation of <code>get_object_list</code>.</p>
<p>Returns a queryset that may have been limited by other overrides.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.get_object_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.get_object_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_object_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An ORM-specific implementation of ``get_object_list``.</span>
<span class="sd">    Returns a queryset that may have been limited by other overrides.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">queryset</span><span class="o">.</span><span class="n">_clone</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.get_resource_uri">
    <p>def <span class="ident">get_resource_uri</span>(</p><p>self, bundle_or_obj=None, url_name=u&#39;api_dispatch_list&#39;)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles generating a resource URI.</p>
<p>If the <code>bundle_or_obj</code> argument is not provided, it builds the URI
for the list endpoint.</p>
<p>If the <code>bundle_or_obj</code> argument is provided, it builds the URI for
the detail endpoint.</p>
<p>Return the generated URI. If that URI can not be reversed (not found
in the URLconf), it will return an empty string.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.get_resource_uri', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.get_resource_uri" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_resource_uri</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle_or_obj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">url_name</span><span class="o">=</span><span class="s1">&#39;api_dispatch_list&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles generating a resource URI.</span>
<span class="sd">    If the ``bundle_or_obj`` argument is not provided, it builds the URI</span>
<span class="sd">    for the list endpoint.</span>
<span class="sd">    If the ``bundle_or_obj`` argument is provided, it builds the URI for</span>
<span class="sd">    the detail endpoint.</span>
<span class="sd">    Return the generated URI. If that URI can not be reversed (not found</span>
<span class="sd">    in the URLconf), it will return an empty string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">bundle_or_obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">url_name</span> <span class="o">=</span> <span class="s1">&#39;api_dispatch_detail&#39;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_reverse_url</span><span class="p">(</span><span class="n">url_name</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resource_uri_kwargs</span><span class="p">(</span><span class="n">bundle_or_obj</span><span class="p">))</span>
    <span class="k">except</span> <span class="n">NoReverseMatch</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.get_schema">
    <p>def <span class="ident">get_schema</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns a serialized form of the schema of the resource.</p>
<p>Calls <code>build_schema</code> to generate the data. This method only responds
to HTTP GET.</p>
<p>Should return a HttpResponse (200 OK).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.get_schema', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.get_schema" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a serialized form of the schema of the resource.</span>
<span class="sd">    Calls ``build_schema`` to generate the data. This method only responds</span>
<span class="sd">    to HTTP GET.</span>
<span class="sd">    Should return a HttpResponse (200 OK).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">method_check</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">allowed</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;get&#39;</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">throttle_check</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_throttled_access</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">authorized_read_detail</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">),</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_schema</span><span class="p">())</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.get_via_uri">
    <p>def <span class="ident">get_via_uri</span>(</p><p>self, uri, request=None)</p>
    </div>
    

    
  
    <div class="desc"><p>This pulls apart the salient bits of the URI and populates the
resource via a <code>obj_get</code>.</p>
<p>Optionally accepts a <code>request</code>.</p>
<p>If you need custom behavior based on other portions of the URI,
simply override this method.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.get_via_uri', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.get_via_uri" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_via_uri</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uri</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This pulls apart the salient bits of the URI and populates the</span>
<span class="sd">    resource via a ``obj_get``.</span>
<span class="sd">    Optionally accepts a ``request``.</span>
<span class="sd">    If you need custom behavior based on other portions of the URI,</span>
<span class="sd">    simply override this method.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="n">get_script_prefix</span><span class="p">()</span>
    <span class="n">chomped_uri</span> <span class="o">=</span> <span class="n">uri</span>
    <span class="k">if</span> <span class="n">prefix</span> <span class="ow">and</span> <span class="n">chomped_uri</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">prefix</span><span class="p">):</span>
        <span class="n">chomped_uri</span> <span class="o">=</span> <span class="n">chomped_uri</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:]</span>
    <span class="c1"># We mangle the path a bit further &amp; run URL resolution against *only*</span>
    <span class="c1"># the current class. This ought to prevent bad URLs from resolving to</span>
    <span class="c1"># incorrect data.</span>
    <span class="n">found_at</span> <span class="o">=</span> <span class="n">chomped_uri</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">found_at</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">NotFound</span><span class="p">(</span><span class="s2">&quot;An incorrect URL was provided &#39;</span><span class="si">%s</span><span class="s2">&#39; for the &#39;</span><span class="si">%s</span><span class="s2">&#39; resource.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">))</span>
    <span class="n">chomped_uri</span> <span class="o">=</span> <span class="n">chomped_uri</span><span class="p">[</span><span class="n">found_at</span><span class="p">:]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">url_resolver</span> <span class="ow">in</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;urls&#39;</span><span class="p">,</span> <span class="p">[]):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">url_resolver</span><span class="o">.</span><span class="n">resolve</span><span class="p">(</span><span class="n">chomped_uri</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">view</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span> <span class="o">=</span> <span class="n">result</span>
                <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Resolver404</span><span class="p">(</span><span class="s2">&quot;URI not found in &#39;self.urls&#39;.&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">Resolver404</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">NotFound</span><span class="p">(</span><span class="s2">&quot;The URL provided &#39;</span><span class="si">%s</span><span class="s2">&#39; was not a link to a valid resource.&quot;</span> <span class="o">%</span> <span class="n">uri</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.hydrate">
    <p>def <span class="ident">hydrate</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>A hook to allow an initial manipulation of data before all methods/fields
have built out the hydrated data.</p>
<p>Useful if you need to access more than one hydrated field or want
to annotate on additional data.</p>
<p>Must return the modified bundle.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.hydrate', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.hydrate" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">hydrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to allow an initial manipulation of data before all methods/fields</span>
<span class="sd">    have built out the hydrated data.</span>
<span class="sd">    Useful if you need to access more than one hydrated field or want</span>
<span class="sd">    to annotate on additional data.</span>
<span class="sd">    Must return the modified bundle.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.hydrate_m2m">
    <p>def <span class="ident">hydrate_m2m</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Populate the ManyToMany data on the instance.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.hydrate_m2m', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.hydrate_m2m" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">hydrate_m2m</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Populate the ManyToMany data on the instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrationError</span><span class="p">(</span><span class="s2">&quot;You must call &#39;full_hydrate&#39; before attempting to run &#39;hydrate_m2m&#39; on </span><span class="si">%r</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span>
            <span class="c1"># Note that we only hydrate the data, leaving the instance</span>
            <span class="c1"># unmodified. It&#39;s up to the user&#39;s code to handle this.</span>
            <span class="c1"># The ``ModelResource`` provides a working baseline</span>
            <span class="c1"># in this regard.</span>
            <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">hydrate_m2m</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;hydrate_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
            <span class="n">method</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.is_authenticated">
    <p>def <span class="ident">is_authenticated</span>(</p><p>self, request)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking if the user is authenticated and dealing with
unauthenticated users.</p>
<p>Mostly a hook, this uses class assigned to <code>authentication</code> from
<code>Resource._meta</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.is_authenticated', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.is_authenticated" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">is_authenticated</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking if the user is authenticated and dealing with</span>
<span class="sd">    unauthenticated users.</span>
<span class="sd">    Mostly a hook, this uses class assigned to ``authentication`` from</span>
<span class="sd">    ``Resource._meta``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Authenticate the request as needed.</span>
    <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authentication</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">auth_result</span><span class="p">,</span> <span class="n">HttpResponse</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">auth_result</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">auth_result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpUnauthorized</span><span class="p">())</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.is_valid">
    <p>def <span class="ident">is_valid</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking if the data provided by the user is valid.</p>
<p>Mostly a hook, this uses class assigned to <code>validation</code> from
<code>Resource._meta</code>.</p>
<p>If validation fails, an error is raised with the error messages
serialized inside it.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.is_valid', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.is_valid" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking if the data provided by the user is valid.</span>
<span class="sd">    Mostly a hook, this uses class assigned to ``validation`` from</span>
<span class="sd">    ``Resource._meta``.</span>
<span class="sd">    If validation fails, an error is raised with the error messages</span>
<span class="sd">    serialized inside it.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">validation</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">errors</span><span class="p">:</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">errors</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">errors</span>
        <span class="k">return</span> <span class="bp">False</span>
    <span class="k">return</span> <span class="bp">True</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.log_throttled_access">
    <p>def <span class="ident">log_throttled_access</span>(</p><p>self, request)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles the recording of the user's access for throttling purposes.</p>
<p>Mostly a hook, this uses class assigned to <code>throttle</code> from
<code>Resource._meta</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.log_throttled_access', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.log_throttled_access" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">log_throttled_access</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles the recording of the user&#39;s access for throttling purposes.</span>
<span class="sd">    Mostly a hook, this uses class assigned to ``throttle`` from</span>
<span class="sd">    ``Resource._meta``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">request_method</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">throttle</span><span class="o">.</span><span class="n">accessed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authentication</span><span class="o">.</span><span class="n">get_identifier</span><span class="p">(</span><span class="n">request</span><span class="p">),</span> <span class="n">url</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">get_full_path</span><span class="p">(),</span> <span class="n">request_method</span><span class="o">=</span><span class="n">request_method</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.lookup_kwargs_with_identifiers">
    <p>def <span class="ident">lookup_kwargs_with_identifiers</span>(</p><p>self, bundle, kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Kwargs here represent uri identifiers Ex: /repos/<user_id>/<repo_name>/
We need to turn those identifiers into Python objects for generating
lookup parameters that can find them in the DB</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.lookup_kwargs_with_identifiers', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.lookup_kwargs_with_identifiers" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">lookup_kwargs_with_identifiers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Kwargs here represent uri identifiers Ex: /repos/&lt;user_id&gt;/&lt;repo_name&gt;/</span>
<span class="sd">    We need to turn those identifiers into Python objects for generating</span>
<span class="sd">    lookup parameters that can find them in the DB</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lookup_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">)</span><span class="o">.</span><span class="n">model</span><span class="p">()</span>
    <span class="c1"># Override data values, we rely on uri identifiers</span>
    <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="c1"># We&#39;re going to manually hydrate, as opposed to calling</span>
    <span class="c1"># ``full_hydrate``, to ensure we don&#39;t try to flesh out related</span>
    <span class="c1"># resources &amp; keep things speedy.</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">identifier</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">identifier</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">:</span>
            <span class="n">lookup_kwargs</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span>
            <span class="k">continue</span>
        <span class="n">field_object</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span>
        <span class="c1"># Skip readonly or related fields.</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">readonly</span> <span class="ow">is</span> <span class="bp">True</span> <span class="ow">or</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_related</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># Check for an optional method to do further hydration.</span>
        <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;hydrate_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">identifier</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
            <span class="n">bundle</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="n">lookup_kwargs</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
    <span class="k">return</span> <span class="n">lookup_kwargs</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.method_check">
    <p>def <span class="ident">method_check</span>(</p><p>self, request, allowed=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Ensures that the HTTP method used on the request is allowed to be
handled by the resource.</p>
<p>Takes an <code>allowed</code> parameter, which should be a list of lowercase
HTTP methods to check against. Usually, this looks like::</p>
<div class="codehilite"><pre><span></span># The most generic lookup.
self.method_check(request, self._meta.allowed_methods)

# A lookup against what&#39;s allowed for list-type methods.
self.method_check(request, self._meta.list_allowed_methods)

# A useful check when creating a new endpoint that only handles
# GET.
self.method_check(request, [&#39;get&#39;])
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.method_check', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.method_check" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">method_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">allowed</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Ensures that the HTTP method used on the request is allowed to be</span>
<span class="sd">    handled by the resource.</span>
<span class="sd">    Takes an ``allowed`` parameter, which should be a list of lowercase</span>
<span class="sd">    HTTP methods to check against. Usually, this looks like::</span>
<span class="sd">        # The most generic lookup.</span>
<span class="sd">        self.method_check(request, self._meta.allowed_methods)</span>
<span class="sd">        # A lookup against what&#39;s allowed for list-type methods.</span>
<span class="sd">        self.method_check(request, self._meta.list_allowed_methods)</span>
<span class="sd">        # A useful check when creating a new endpoint that only handles</span>
<span class="sd">        # GET.</span>
<span class="sd">        self.method_check(request, [&#39;get&#39;])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">allowed</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">allowed</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">request_method</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">allows</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">meth</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">allowed</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">request_method</span> <span class="o">==</span> <span class="s2">&quot;options&quot;</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="n">allows</span><span class="p">)</span>
        <span class="n">response</span><span class="p">[</span><span class="s1">&#39;Allow&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">allows</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">request_method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpMethodNotAllowed</span><span class="p">(</span><span class="n">allows</span><span class="p">)</span>
        <span class="n">response</span><span class="p">[</span><span class="s1">&#39;Allow&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">allows</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">request_method</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.obj_create">
    <p>def <span class="ident">obj_create</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A ORM-specific implementation of <code>obj_create</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.obj_create', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.obj_create" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_create``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.obj_delete">
    <p>def <span class="ident">obj_delete</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A ORM-specific implementation of <code>obj_delete</code>.</p>
<p>Takes optional <code>kwargs</code>, which are used to narrow the query to find
the instance.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.obj_delete', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.obj_delete" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_delete``.</span>
<span class="sd">    Takes optional ``kwargs``, which are used to narrow the query to find</span>
<span class="sd">    the instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="s1">&#39;delete&#39;</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ObjectDoesNotExist</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NotFound</span><span class="p">(</span><span class="s2">&quot;A model instance matching the provided arguments could not be found.&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">authorized_delete_detail</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">),</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.obj_delete_list">
    <p>def <span class="ident">obj_delete_list</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A ORM-specific implementation of <code>obj_delete_list</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.obj_delete_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.obj_delete_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_delete_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_delete_list``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">objects_to_delete</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">deletable_objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">authorized_delete_list</span><span class="p">(</span><span class="n">objects_to_delete</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">deletable_objects</span><span class="p">,</span> <span class="s1">&#39;delete&#39;</span><span class="p">):</span>
        <span class="c1"># It&#39;s likely a ``QuerySet``. Call ``.delete()`` for efficiency.</span>
        <span class="n">deletable_objects</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">authed_obj</span> <span class="ow">in</span> <span class="n">deletable_objects</span><span class="p">:</span>
            <span class="n">authed_obj</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.obj_delete_list_for_update">
    <p>def <span class="ident">obj_delete_list_for_update</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A ORM-specific implementation of <code>obj_delete_list_for_update</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.obj_delete_list_for_update', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.obj_delete_list_for_update" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_delete_list_for_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_delete_list_for_update``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">objects_to_delete</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">deletable_objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">authorized_update_list</span><span class="p">(</span><span class="n">objects_to_delete</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">deletable_objects</span><span class="p">,</span> <span class="s1">&#39;delete&#39;</span><span class="p">):</span>
        <span class="c1"># It&#39;s likely a ``QuerySet``. Call ``.delete()`` for efficiency.</span>
        <span class="n">deletable_objects</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">authed_obj</span> <span class="ow">in</span> <span class="n">deletable_objects</span><span class="p">:</span>
            <span class="n">authed_obj</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.obj_get">
    <p>def <span class="ident">obj_get</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A ORM-specific implementation of <code>obj_get</code>.</p>
<p>Takes optional <code>kwargs</code>, which are used to narrow the query to find
the instance.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.obj_get', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.obj_get" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_get``.</span>
<span class="sd">    Takes optional ``kwargs``, which are used to narrow the query to find</span>
<span class="sd">    the instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># prevents FieldError when looking up nested resources containing extra data</span>
    <span class="n">field_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">get_all_field_names</span><span class="p">()</span>
    <span class="n">field_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;pk&#39;</span><span class="p">)</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">field_names</span><span class="p">}</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">object_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">stringified_kwargs</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">=</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">object_list</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="o">.</span><span class="n">DoesNotExist</span><span class="p">(</span><span class="s2">&quot;Couldn&#39;t find an instance of &#39;</span><span class="si">%s</span><span class="s2">&#39; which matched &#39;</span><span class="si">%s</span><span class="s2">&#39;.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">stringified_kwargs</span><span class="p">))</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">object_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MultipleObjectsReturned</span><span class="p">(</span><span class="s2">&quot;More than &#39;</span><span class="si">%s</span><span class="s2">&#39; matched &#39;</span><span class="si">%s</span><span class="s2">&#39;.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">stringified_kwargs</span><span class="p">))</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">object_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">authorized_read_detail</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">NotFound</span><span class="p">(</span><span class="s2">&quot;Invalid resource lookup data provided (mismatched type).&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.obj_get_list">
    <p>def <span class="ident">obj_get_list</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A ORM-specific implementation of <code>obj_get_list</code>.</p>
<p>Takes an optional <code>request</code> object, whose <code>GET</code> dictionary can be
used to narrow the query.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.obj_get_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.obj_get_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_get_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_get_list``.</span>
<span class="sd">    Takes an optional ``request`` object, whose ``GET`` dictionary can be</span>
<span class="sd">    used to narrow the query.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">filters</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;GET&#39;</span><span class="p">):</span>
        <span class="c1"># Grab a mutable copy.</span>
        <span class="n">filters</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="c1"># Update with the provided kwargs.</span>
    <span class="n">filters</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">applicable_filters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_filters</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_filters</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">,</span> <span class="n">applicable_filters</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">authorized_read_list</span><span class="p">(</span><span class="n">objects</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">BadRequest</span><span class="p">(</span><span class="s2">&quot;Invalid resource lookup data provided (mismatched type).&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.obj_update">
    <p>def <span class="ident">obj_update</span>(</p><p>self, bundle, skip_errors=False, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A ORM-specific implementation of <code>obj_update</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.obj_update', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.obj_update" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">skip_errors</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_update``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bundle_detail_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bundle_detail_data</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="n">arg_detail_data</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">bundle_detail_data</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">arg_detail_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="nb">str</span><span class="p">(</span><span class="n">bundle_detail_data</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">str</span><span class="p">(</span><span class="n">arg_detail_data</span><span class="p">)):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">lookup_kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lookup_kwargs_with_identifiers</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="c1"># if there is trouble hydrating the data, fall back to just</span>
            <span class="c1"># using kwargs by itself (usually it only contains a &quot;pk&quot; key</span>
            <span class="c1"># and this will work fine.</span>
            <span class="n">lookup_kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">lookup_kwargs</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ObjectDoesNotExist</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NotFound</span><span class="p">(</span><span class="s2">&quot;A model instance matching the provided arguments could not be found.&quot;</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="n">skip_errors</span><span class="o">=</span><span class="n">skip_errors</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.override_urls">
    <p>def <span class="ident">override_urls</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Deprecated. Will be removed by v1.0.0. Please use <code>prepend_urls</code> instead.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.override_urls', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.override_urls" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">override_urls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Deprecated. Will be removed by v1.0.0. Please use ``prepend_urls`` instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.patch_detail">
    <p>def <span class="ident">patch_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Updates a resource in-place.</p>
<p>Calls <code>obj_update</code>.</p>
<p>If the resource is updated, return <code>HttpAccepted</code> (202 Accepted).
If the resource did not exist, return <code>HttpNotFound</code> (404 Not Found).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.patch_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.patch_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">patch_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates a resource in-place.</span>
<span class="sd">    Calls ``obj_update``.</span>
<span class="sd">    If the resource is updated, return ``HttpAccepted`` (202 Accepted).</span>
<span class="sd">    If the resource did not exist, return ``HttpNotFound`` (404 Not Found).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">request</span> <span class="o">=</span> <span class="n">convert_post_to_patch</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="n">basic_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="c1"># We want to be able to validate the update, but we can&#39;t just pass</span>
    <span class="c1"># the partial data into the validator since all data needs to be</span>
    <span class="c1"># present. Instead, we basically simulate a PUT by pulling out the</span>
    <span class="c1"># original data and updating it in-place.</span>
    <span class="c1"># So first pull out the original object. This is essentially</span>
    <span class="c1"># ``get_detail``.</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cached_obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">basic_bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="k">except</span> <span class="n">ObjectDoesNotExist</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNotFound</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">MultipleObjectsReturned</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpMultipleChoices</span><span class="p">(</span><span class="s2">&quot;More than one resource is found at this URI.&quot;</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="c1"># Now update the bundle in-place.</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">update_in_place</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">deserialized</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">always_return_data</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpAccepted</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Invalidate prefetched_objects_cache for bundled object</span>
        <span class="c1"># because we might have changed a prefetched field</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_prefetched_objects_cache</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpAccepted</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.patch_list">
    <p>def <span class="ident">patch_list</span>(</p><p>*args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>An ORM-specific implementation of <code>patch_list</code>.</p>
<p>Necessary because PATCH should be atomic (all-success or all-fail)
and the only way to do this neatly is at the database level.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.patch_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.patch_list" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@wraps</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">assigned</span><span class="o">=</span><span class="n">available_attrs</span><span class="p">(</span><span class="n">func</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">with</span> <span class="bp">self</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.post_detail">
    <p>def <span class="ident">post_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Creates a new subcollection of the resource under a resource.</p>
<p>This is not implemented by default because most people's data models
aren't self-referential.</p>
<p>If a new resource is created, return <code>HttpCreated</code> (201 Created).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.post_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.post_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">post_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a new subcollection of the resource under a resource.</span>
<span class="sd">    This is not implemented by default because most people&#39;s data models</span>
<span class="sd">    aren&#39;t self-referential.</span>
<span class="sd">    If a new resource is created, return ``HttpCreated`` (201 Created).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNotImplemented</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.post_list">
    <p>def <span class="ident">post_list</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Creates a new resource/object with the provided data.</p>
<p>Calls <code>obj_create</code> with the provided data and returns a response
with the new resource's location.</p>
<p>If a new resource is created, return <code>HttpCreated</code> (201 Created).
If <code>Meta.always_return_data = True</code>, there will be a populated body
of serialized data.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.post_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.post_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">post_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a new resource/object with the provided data.</span>
<span class="sd">    Calls ``obj_create`` with the provided data and returns a response</span>
<span class="sd">    with the new resource&#39;s location.</span>
<span class="sd">    If a new resource is created, return ``HttpCreated`` (201 Created).</span>
<span class="sd">    If ``Meta.always_return_data = True``, there will be a populated body</span>
<span class="sd">    of serialized data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">))</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_deserialized_detail_data</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">deserialized</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dict_strip_unicode_keys</span><span class="p">(</span><span class="n">deserialized</span><span class="p">),</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_create</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="n">location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_uri</span><span class="p">(</span><span class="n">updated_bundle</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">always_return_data</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpCreated</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">updated_bundle</span><span class="p">)</span>
        <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpCreated</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.prepend_urls">
    <p>def <span class="ident">prepend_urls</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>A hook for adding your own URLs or matching before the default URLs.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.prepend_urls', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.prepend_urls" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">prepend_urls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook for adding your own URLs or matching before the default URLs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.put_detail">
    <p>def <span class="ident">put_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Either updates an existing resource or creates a new one with the
provided data.</p>
<p>Calls <code>obj_update</code> with the provided data first, but falls back to
<code>obj_create</code> if the object does not already exist.</p>
<p>If a new resource is created, return <code>HttpCreated</code> (201 Created).
If <code>Meta.always_return_data = True</code>, there will be a populated body
of serialized data.</p>
<p>If an existing resource is modified and
<code>Meta.always_return_data = False</code> (default), return <code>HttpNoContent</code>
(204 No Content).
If an existing resource is modified and
<code>Meta.always_return_data = True</code>, return <code>HttpAccepted</code> (200
OK).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.put_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.put_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">put_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Either updates an existing resource or creates a new one with the</span>
<span class="sd">    provided data.</span>
<span class="sd">    Calls ``obj_update`` with the provided data first, but falls back to</span>
<span class="sd">    ``obj_create`` if the object does not already exist.</span>
<span class="sd">    If a new resource is created, return ``HttpCreated`` (201 Created).</span>
<span class="sd">    If ``Meta.always_return_data = True``, there will be a populated body</span>
<span class="sd">    of serialized data.</span>
<span class="sd">    If an existing resource is modified and</span>
<span class="sd">    ``Meta.always_return_data = False`` (default), return ``HttpNoContent``</span>
<span class="sd">    (204 No Content).</span>
<span class="sd">    If an existing resource is modified and</span>
<span class="sd">    ``Meta.always_return_data = True``, return ``HttpAccepted`` (200</span>
<span class="sd">    OK).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">))</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_deserialized_detail_data</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">deserialized</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dict_strip_unicode_keys</span><span class="p">(</span><span class="n">deserialized</span><span class="p">),</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_update</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">always_return_data</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNoContent</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Invalidate prefetched_objects_cache for bundled object</span>
            <span class="c1"># because we might have changed a prefetched field</span>
            <span class="n">updated_bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_prefetched_objects_cache</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">updated_bundle</span><span class="p">)</span>
            <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="p">(</span><span class="n">NotFound</span><span class="p">,</span> <span class="n">MultipleObjectsReturned</span><span class="p">):</span>
        <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_create</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="n">location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_uri</span><span class="p">(</span><span class="n">updated_bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">always_return_data</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpCreated</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">updated_bundle</span><span class="p">)</span>
            <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpCreated</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.put_list">
    <p>def <span class="ident">put_list</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Replaces a collection of resources with another collection.</p>
<p>Calls <code>delete_list</code> to clear out the collection then <code>obj_create</code>
with the provided the data to create the new collection.</p>
<p>Return <code>HttpNoContent</code> (204 No Content) if
<code>Meta.always_return_data = False</code> (default).</p>
<p>Return <code>HttpAccepted</code> (200 OK) if
<code>Meta.always_return_data = True</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.put_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.put_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">put_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Replaces a collection of resources with another collection.</span>
<span class="sd">    Calls ``delete_list`` to clear out the collection then ``obj_create``</span>
<span class="sd">    with the provided the data to create the new collection.</span>
<span class="sd">    Return ``HttpNoContent`` (204 No Content) if</span>
<span class="sd">    ``Meta.always_return_data = False`` (default).</span>
<span class="sd">    Return ``HttpAccepted`` (200 OK) if</span>
<span class="sd">    ``Meta.always_return_data = True``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">))</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_deserialized_list_data</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">deserialized</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">deserialized</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">BadRequest</span><span class="p">(</span><span class="s2">&quot;Invalid data sent: missing &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">)</span>
    <span class="n">basic_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">obj_delete_list_for_update</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">basic_bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="n">bundles_seen</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">object_data</span> <span class="ow">in</span> <span class="n">deserialized</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">]:</span>
        <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dict_strip_unicode_keys</span><span class="p">(</span><span class="n">object_data</span><span class="p">),</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
        <span class="c1"># Attempt to be transactional, deleting any previously created</span>
        <span class="c1"># objects if validation fails.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">obj_create</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
            <span class="n">bundles_seen</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ImmediateHttpResponse</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rollback</span><span class="p">(</span><span class="n">bundles_seen</span><span class="p">)</span>
            <span class="k">raise</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">always_return_data</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNoContent</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">to_be_serialized</span> <span class="o">=</span> <span class="p">{</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">:</span> <span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">for_list</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">bundles_seen</span>
            <span class="p">]</span>
        <span class="p">}</span>
        <span class="n">to_be_serialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_list_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">to_be_serialized</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">to_be_serialized</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.remove_api_resource_names">
    <p>def <span class="ident">remove_api_resource_names</span>(</p><p>self, url_dict)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a dictionary of regex matches from a URLconf, removes
<code>api_name</code> and/or <code>resource_name</code> if found.</p>
<p>This is useful for converting URLconf matches into something suitable
for data lookup. For example::</p>
<div class="codehilite"><pre><span></span>Model.objects.filter(**self.remove_api_resource_names(matches))
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.remove_api_resource_names', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.remove_api_resource_names" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">remove_api_resource_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url_dict</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a dictionary of regex matches from a URLconf, removes</span>
<span class="sd">    ``api_name`` and/or ``resource_name`` if found.</span>
<span class="sd">    This is useful for converting URLconf matches into something suitable</span>
<span class="sd">    for data lookup. For example::</span>
<span class="sd">        Model.objects.filter(**self.remove_api_resource_names(matches))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kwargs_subset</span> <span class="o">=</span> <span class="n">url_dict</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;api_name&#39;</span><span class="p">,</span> <span class="s1">&#39;resource_name&#39;</span><span class="p">]:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">del</span><span class="p">(</span><span class="n">kwargs_subset</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">pass</span>
    <span class="k">return</span> <span class="n">kwargs_subset</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.resource_uri_kwargs">
    <p>def <span class="ident">resource_uri_kwargs</span>(</p><p>self, bundle_or_obj=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Builds a dictionary of kwargs to help generate URIs.</p>
<p>Automatically provides the <code>Resource.Meta.resource_name</code> (and
optionally the <code>Resource.Meta.api_name</code> if populated by an <code>Api</code>
object).</p>
<p>If the <code>bundle_or_obj</code> argument is provided, it calls
<code>Resource.detail_uri_kwargs</code> for additional bits to create</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.resource_uri_kwargs', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.resource_uri_kwargs" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">resource_uri_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle_or_obj</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Builds a dictionary of kwargs to help generate URIs.</span>
<span class="sd">    Automatically provides the ``Resource.Meta.resource_name`` (and</span>
<span class="sd">    optionally the ``Resource.Meta.api_name`` if populated by an ``Api``</span>
<span class="sd">    object).</span>
<span class="sd">    If the ``bundle_or_obj`` argument is provided, it calls</span>
<span class="sd">    ``Resource.detail_uri_kwargs`` for additional bits to create</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;resource_name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;api_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span>
    <span class="k">if</span> <span class="n">bundle_or_obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">detail_uri_kwargs</span><span class="p">(</span><span class="n">bundle_or_obj</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">kwargs</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.rollback">
    <p>def <span class="ident">rollback</span>(</p><p>self, bundles)</p>
    </div>
    

    
  
    <div class="desc"><p>A ORM-specific implementation of <code>rollback</code>.</p>
<p>Given the list of bundles, delete all models pertaining to those
bundles.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.rollback', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.rollback" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">rollback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundles</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``rollback``.</span>
<span class="sd">    Given the list of bundles, delete all models pertaining to those</span>
<span class="sd">    bundles.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">bundle</span> <span class="ow">in</span> <span class="n">bundles</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bundle_detail_data</span><span class="p">(</span><span class="n">bundle</span><span class="p">):</span>
            <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.save">
    <p>def <span class="ident">save</span>(</p><p>self, bundle, skip_errors=False)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.save', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.save" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">skip_errors</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">via_uri</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">bundle</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">errors</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">skip_errors</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">error_response</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="o">.</span><span class="n">errors</span><span class="p">))</span>
    <span class="c1"># Check if they&#39;re authorized.</span>
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">pk</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">authorized_update_detail</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">),</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">authorized_create_detail</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">),</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="c1"># Save FKs just in case.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">save_related</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="c1"># Save the main object.</span>
    <span class="n">obj_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_identifier</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">obj_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">bundle</span><span class="o">.</span><span class="n">objects_saved</span> <span class="ow">or</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_state</span><span class="o">.</span><span class="n">adding</span><span class="p">:</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">objects_saved</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">obj_id</span><span class="p">)</span>
    <span class="c1"># Now pick up the M2M bits.</span>
    <span class="n">m2m_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hydrate_m2m</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">save_m2m</span><span class="p">(</span><span class="n">m2m_bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.save_m2m">
    <p>def <span class="ident">save_m2m</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles the saving of related M2M data.</p>
<p>Due to the way Django works, the M2M data must be handled after the
main instance, which is why this isn't a part of the main <code>save</code> bits.</p>
<p>Currently slightly inefficient in that it will clear out the whole
relation and recreate the related data as needed.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.save_m2m', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.save_m2m" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">save_m2m</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles the saving of related M2M data.</span>
<span class="sd">    Due to the way Django works, the M2M data must be handled after the</span>
<span class="sd">    main instance, which is why this isn&#39;t a part of the main ``save`` bits.</span>
<span class="sd">    Currently slightly inefficient in that it will clear out the whole</span>
<span class="sd">    relation and recreate the related data as needed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">readonly</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># Get the manager.</span>
        <span class="n">related_mngr</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
            <span class="n">related_mngr</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">):</span>
            <span class="n">related_mngr</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">related_mngr</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">related_mngr</span><span class="p">,</span> <span class="s1">&#39;clear&#39;</span><span class="p">):</span>
            <span class="c1"># FIXME: Dupe the original bundle, copy in the new object &amp;</span>
            <span class="c1">#        check the perms on that (using the related resource)?</span>
            <span class="c1"># Clear it out, just to be safe.</span>
            <span class="n">related_mngr</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">related_objs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">related_bundle</span> <span class="ow">in</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">field_name</span><span class="p">]:</span>
            <span class="n">related_resource</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">get_related_resource</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
            <span class="c1"># Only build &amp; save if there&#39;s data, not just a URI.</span>
            <span class="n">updated_related_bundle</span> <span class="o">=</span> <span class="n">related_resource</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span>
                <span class="n">obj</span><span class="o">=</span><span class="n">related_bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="n">related_bundle</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                <span class="n">request</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">,</span>
                <span class="n">objects_saved</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">objects_saved</span><span class="p">,</span>
                <span class="n">via_uri</span><span class="o">=</span><span class="n">related_bundle</span><span class="o">.</span><span class="n">via_uri</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">related_resource</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">updated_related_bundle</span><span class="p">)</span>
            <span class="n">related_objs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">updated_related_bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
        <span class="n">related_mngr</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="o">*</span><span class="n">related_objs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.save_related">
    <p>def <span class="ident">save_related</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles the saving of related non-M2M data.</p>
<p>Calling assigning <code>child.parent = parent</code> &amp; then calling
<code>Child.save</code> isn't good enough to make sure the <code>parent</code>
is saved.</p>
<p>To get around this, we go through all our related fields &amp;
call <code>save</code> on them if they have related, non-M2M data.
M2M data is handled by the <code>ModelResource.save_m2m</code> method.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.save_related', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.save_related" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">save_related</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles the saving of related non-M2M data.</span>
<span class="sd">    Calling assigning ``child.parent = parent`` &amp; then calling</span>
<span class="sd">    ``Child.save`` isn&#39;t good enough to make sure the ``parent``</span>
<span class="sd">    is saved.</span>
<span class="sd">    To get around this, we go through all our related fields &amp;</span>
<span class="sd">    call ``save`` on them if they have related, non-M2M data.</span>
<span class="sd">    M2M data is handled by the ``ModelResource.save_m2m`` method.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_related</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">readonly</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">blank</span> <span class="ow">and</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># Get the object.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">related_obj</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ObjectDoesNotExist</span><span class="p">:</span>
            <span class="c1"># Django 1.8: unset related objects default to None, no error</span>
            <span class="n">related_obj</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="c1"># We didn&#39;t get it, so maybe we created it but haven&#39;t saved it</span>
        <span class="k">if</span> <span class="n">related_obj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">related_obj</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">related_objects_to_save</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">related_name</span><span class="p">:</span>
            <span class="c1"># this might be a reverse relation, so we need to save this</span>
            <span class="c1"># model, attach it to the related object, and save the related</span>
            <span class="c1"># object.</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bundle_detail_data</span><span class="p">(</span><span class="n">bundle</span><span class="p">):</span>
                <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">related_obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">related_name</span><span class="p">,</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
        <span class="n">related_resource</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">get_related_resource</span><span class="p">(</span><span class="n">related_obj</span><span class="p">)</span>
        <span class="c1"># Before we build the bundle &amp; try saving it, let&#39;s make sure we</span>
        <span class="c1"># haven&#39;t already saved it.</span>
        <span class="k">if</span> <span class="n">related_obj</span><span class="p">:</span>
            <span class="n">obj_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_identifier</span><span class="p">(</span><span class="n">related_obj</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">obj_id</span> <span class="ow">in</span> <span class="n">bundle</span><span class="o">.</span><span class="n">objects_saved</span><span class="p">:</span>
                <span class="c1"># It&#39;s already been saved. We&#39;re done here.</span>
                <span class="k">continue</span>
        <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_name</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">field_name</span><span class="p">],</span> <span class="s1">&#39;keys&#39;</span><span class="p">):</span>
                <span class="c1"># Only build &amp; save if there&#39;s data, not just a URI.</span>
                <span class="n">related_bundle</span> <span class="o">=</span> <span class="n">related_resource</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span>
                    <span class="n">obj</span><span class="o">=</span><span class="n">related_obj</span><span class="p">,</span>
                    <span class="n">data</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_name</span><span class="p">),</span>
                    <span class="n">request</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">,</span>
                    <span class="n">objects_saved</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">objects_saved</span>
                <span class="p">)</span>
                <span class="n">related_resource</span><span class="o">.</span><span class="n">full_hydrate</span><span class="p">(</span><span class="n">related_bundle</span><span class="p">)</span>
                <span class="n">related_resource</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">related_bundle</span><span class="p">)</span>
                <span class="n">related_obj</span> <span class="o">=</span> <span class="n">related_bundle</span><span class="o">.</span><span class="n">obj</span>
            <span class="k">elif</span> <span class="n">field_object</span><span class="o">.</span><span class="n">related_name</span><span class="p">:</span>
                <span class="c1"># This condition probably means a URI for a reverse</span>
                <span class="c1"># relation was provided.</span>
                <span class="n">related_bundle</span> <span class="o">=</span> <span class="n">related_resource</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span>
                    <span class="n">obj</span><span class="o">=</span><span class="n">related_obj</span><span class="p">,</span>
                    <span class="n">request</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">,</span>
                    <span class="n">objects_saved</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">objects_saved</span>
                <span class="p">)</span>
                <span class="n">related_resource</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">related_bundle</span><span class="p">)</span>
                <span class="n">related_obj</span> <span class="o">=</span> <span class="n">related_bundle</span><span class="o">.</span><span class="n">obj</span>
        <span class="k">if</span> <span class="n">related_obj</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="n">related_obj</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.serialize">
    <p>def <span class="ident">serialize</span>(</p><p>self, request, data, format, options=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a request, data and a desired format, produces a serialized
version suitable for transfer over the wire.</p>
<p>Mostly a hook, this uses the <code>Serializer</code> from <code>Resource._meta</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.serialize', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.serialize" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">format</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a request, data and a desired format, produces a serialized</span>
<span class="sd">    version suitable for transfer over the wire.</span>
<span class="sd">    Mostly a hook, this uses the ``Serializer`` from ``Resource._meta``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span> <span class="o">=</span> <span class="n">options</span> <span class="ow">or</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="s1">&#39;text/javascript&#39;</span> <span class="ow">in</span> <span class="n">format</span><span class="p">:</span>
        <span class="c1"># get JSONP callback name. default to &quot;callback&quot;</span>
        <span class="n">callback</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;callback&#39;</span><span class="p">,</span> <span class="s1">&#39;callback&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_valid_jsonp_callback_value</span><span class="p">(</span><span class="n">callback</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">BadRequest</span><span class="p">(</span><span class="s1">&#39;JSONP callback name is invalid.&#39;</span><span class="p">)</span>
        <span class="n">options</span><span class="p">[</span><span class="s1">&#39;callback&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">callback</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">serializer</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">format</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.should_skip_field">
    <p>def <span class="ident">should_skip_field</span>(</p><p>cls, field)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a Django model field, return if it should be included in the
contributed ApiFields.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.should_skip_field', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.should_skip_field" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">should_skip_field</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">field</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a Django model field, return if it should be included in the</span>
<span class="sd">    contributed ApiFields.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Ignore certain fields (related fields).</span>
    <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="s1">&#39;rel&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">return</span> <span class="bp">False</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.throttle_check">
    <p>def <span class="ident">throttle_check</span>(</p><p>self, request)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking if the user should be throttled.</p>
<p>Mostly a hook, this uses class assigned to <code>throttle</code> from
<code>Resource._meta</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.throttle_check', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.throttle_check" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">throttle_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking if the user should be throttled.</span>
<span class="sd">    Mostly a hook, this uses class assigned to ``throttle`` from</span>
<span class="sd">    ``Resource._meta``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">identifier</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authentication</span><span class="o">.</span><span class="n">get_identifier</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="c1"># Check to see if they should be throttled.</span>
    <span class="n">throttle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">throttle</span><span class="o">.</span><span class="n">should_be_throttled</span><span class="p">(</span><span class="n">identifier</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">throttle</span><span class="p">:</span>
        <span class="c1"># Throttle limit exceeded.</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpTooManyRequests</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">throttle</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">throttle</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="n">response</span><span class="p">[</span><span class="s1">&#39;Retry-After&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">throttle</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">throttle</span><span class="p">,</span> <span class="n">datetime</span><span class="p">):</span>
            <span class="n">response</span><span class="p">[</span><span class="s1">&#39;Retry-After&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">format_date_time</span><span class="p">(</span><span class="n">mktime</span><span class="p">(</span><span class="n">throttle</span><span class="o">.</span><span class="n">timetuple</span><span class="p">()))</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.unauthorized_result">
    <p>def <span class="ident">unauthorized_result</span>(</p><p>self, exception)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.unauthorized_result', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.unauthorized_result" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">unauthorized_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exception</span><span class="p">):</span>
    <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpUnauthorized</span><span class="p">())</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.update_in_place">
    <p>def <span class="ident">update_in_place</span>(</p><p>self, request, original_bundle, new_data)</p>
    </div>
    

    
  
    <div class="desc"><p>Update the object in original_bundle in-place using new_data.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.update_in_place', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.update_in_place" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">update_in_place</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">original_bundle</span><span class="p">,</span> <span class="n">new_data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Update the object in original_bundle in-place using new_data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">original_bundle</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">dict_strip_unicode_keys</span><span class="p">(</span><span class="n">new_data</span><span class="p">))</span>
    <span class="c1"># Now we&#39;ve got a bundle with the new data sitting in it and we&#39;re</span>
    <span class="c1"># we&#39;re basically in the same spot as a PUT request. SO the rest of this</span>
    <span class="c1"># function is cribbed from put_detail.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">alter_deserialized_detail_data</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">original_bundle</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bundle_detail_data</span><span class="p">(</span><span class="n">original_bundle</span><span class="p">),</span>
        <span class="s1">&#39;request&#39;</span><span class="p">:</span> <span class="n">request</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_update</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">original_bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHMultipleBatchUploadResource.wrap_view">
    <p>def <span class="ident">wrap_view</span>(</p><p>self, view)</p>
    </div>
    

    
  
    <div class="desc"><p>Wraps methods so they can be called in a more functional way as well
as handling exceptions better.</p>
<p>Note that if <code>BadRequest</code> or an exception with a <code>response</code> attr
are seen, there is special handling to either present a message back
to the user or return the response traveling with the exception.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.wrap_view', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHMultipleBatchUploadResource.wrap_view" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">wrap_view</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">view</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wraps methods so they can be called in a more functional way as well</span>
<span class="sd">    as handling exceptions better.</span>
<span class="sd">    Note that if ``BadRequest`` or an exception with a ``response`` attr</span>
<span class="sd">    are seen, there is special handling to either present a message back</span>
<span class="sd">    to the user or return the response traveling with the exception.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nd">@csrf_exempt</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">callback</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">view</span><span class="p">)</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">callback</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="c1"># Our response can vary based on a number of factors, use</span>
            <span class="c1"># the cache class to determine what we should ``Vary`` on so</span>
            <span class="c1"># caches won&#39;t return the wrong (cached) version.</span>
            <span class="n">varies</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="p">,</span> <span class="s2">&quot;varies&quot;</span><span class="p">,</span> <span class="p">[])</span>
            <span class="k">if</span> <span class="n">varies</span><span class="p">:</span>
                <span class="n">patch_vary_headers</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">varies</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">cacheable</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">response</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">cache_control</span><span class="p">():</span>
                    <span class="c1"># If the request is cacheable and we have a</span>
                    <span class="c1"># ``Cache-Control`` available then patch the header.</span>
                    <span class="n">patch_cache_control</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">cache_control</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">is_ajax</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">response</span><span class="o">.</span><span class="n">has_header</span><span class="p">(</span><span class="s2">&quot;Cache-Control&quot;</span><span class="p">):</span>
                <span class="c1"># IE excessively caches XMLHttpRequests, so we&#39;re disabling</span>
                <span class="c1"># the browser cache here.</span>
                <span class="c1"># See http://www.enhanceie.com/ie/bugs.asp for details.</span>
                <span class="n">patch_cache_control</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">no_cache</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">response</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">BadRequest</span><span class="p">,</span> <span class="n">fields</span><span class="o">.</span><span class="n">ApiFieldError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="n">sanitize</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s1">&#39;args&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">}</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpBadRequest</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="n">sanitize</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">messages</span><span class="p">)}</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpBadRequest</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1"># Prevent muting non-django&#39;s exceptions</span>
            <span class="c1"># i.e. RequestException from &#39;requests&#39; library</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s1">&#39;response&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">response</span><span class="p">,</span> <span class="n">HttpResponse</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">e</span><span class="o">.</span><span class="n">response</span>
            <span class="c1"># A real, non-expected exception.</span>
            <span class="c1"># Handle the case where the full traceback is more helpful</span>
            <span class="c1"># than the serialized error.</span>
            <span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">DEBUG</span> <span class="ow">and</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">settings</span><span class="p">,</span> <span class="s1">&#39;TASTYPIE_FULL_DEBUG&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
                <span class="k">raise</span>
            <span class="c1"># Re-raise the error to get a proper traceback when the error</span>
            <span class="c1"># happend during a test case</span>
            <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SERVER_NAME&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;testserver&#39;</span><span class="p">:</span>
                <span class="k">raise</span>
            <span class="c1"># Rather than re-raising, we&#39;re going to things similar to</span>
            <span class="c1"># what Django does. The difference is returning a serialized</span>
            <span class="c1"># error message.</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_500</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wrapper</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="cbh_chem_api.resources.CBHSavedSearchResource" class="name">class <span class="ident">CBHSavedSearchResource</span></p>
      
  
    <div class="desc"><p>Implementation of the compound batch API used for saved search objects,
filter out non saved searches form this list</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">CBHSavedSearchResource</span><span class="p">(</span><span class="n">BaseCBHCompoundBatchResource</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Implementation of the compound batch API used for saved search objects,</span>
<span class="sd">    filter out non saved searches form this list&quot;&quot;&quot;</span>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">(</span><span class="n">BaseCBHCompoundBatchResource</span><span class="o">.</span><span class="n">Meta</span><span class="p">):</span>
        <span class="n">resource_name</span> <span class="o">=</span> <span class="s1">&#39;cbh_saved_search&#39;</span>


    <span class="k">def</span> <span class="nf">get_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Request data where the project is of the saved search type&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">CBHSavedSearchResource</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_list</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">extra_queries</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;query_type&quot;</span><span class="p">:</span> <span class="s2">&quot;pick_from_list&quot;</span><span class="p">,</span> <span class="s2">&quot;field_path&quot;</span> <span class="p">:</span> <span class="s2">&quot;projectfull.project_type.saved_search_project_type&quot;</span><span class="p">,</span> <span class="s2">&quot;pick_from_list&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;true&quot;</span><span class="p">]</span> <span class="p">}])</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#cbh_chem_api.resources.CBHSavedSearchResource">CBHSavedSearchResource</a></li>
          <li><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></li>
          <li>tastypie.resources.ModelResource</li>
          <li>tastypie.resources.BaseModelResource</li>
          <li>tastypie.resources.Resource</li>
          <li>__builtin__.object</li>
          </ul>
          <h3>Class variables</h3>
            <div class="item">
            <p id="cbh_chem_api.resources.CBHSavedSearchResource.Meta" class="name">var <span class="ident">Meta</span></p>
            
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.Meta">Meta</a></code>
    </p>

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="cbh_chem_api.resources.CBHSavedSearchResource.base_fields" class="name">var <span class="ident">base_fields</span></p>
            
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.base_fields">base_fields</a></code>
    </p>

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="cbh_chem_api.resources.CBHSavedSearchResource.declared_fields" class="name">var <span class="ident">declared_fields</span></p>
            
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.declared_fields">declared_fields</a></code>
    </p>

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="cbh_chem_api.resources.CBHSavedSearchResource.urls" class="name">var <span class="ident">urls</span></p>
            
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.urls">urls</a></code>
    </p>

            
  
    <div class="desc inherited"><p>The endpoints this <code>Resource</code> responds to.</p>
<p>Mostly a standard URLconf, this is suitable for either automatic use
when registered with an <code>Api</code> class or for including directly in
a URLconf should you choose to.</p></div>
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, api_name=None)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.__init__">__init__</a></code>
    </p>

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.__init__', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">api_name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="c1"># this can cause:</span>
    <span class="c1"># TypeError: object.__new__(method-wrapper) is not safe, use method-wrapper.__new__()</span>
    <span class="c1"># when trying to copy a generator used as a default. Wrap call to</span>
    <span class="c1"># generator in lambda to get around this error.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_fields</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">api_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span> <span class="o">=</span> <span class="n">api_name</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.alter_deserialized_detail_data">
    <p>def <span class="ident">alter_deserialized_detail_data</span>(</p><p>self, request, data)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.alter_deserialized_detail_data">alter_deserialized_detail_data</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A hook to alter detail data just after it has been received from the user &amp;
gets deserialized.</p>
<p>Useful for altering the user data before any hydration is applied.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.alter_deserialized_detail_data', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.alter_deserialized_detail_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">alter_deserialized_detail_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to alter detail data just after it has been received from the user &amp;</span>
<span class="sd">    gets deserialized.</span>
<span class="sd">    Useful for altering the user data before any hydration is applied.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.alter_deserialized_list_data">
    <p>def <span class="ident">alter_deserialized_list_data</span>(</p><p>self, request, data)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.alter_deserialized_list_data">alter_deserialized_list_data</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A hook to alter list data just after it has been received from the user &amp;
gets deserialized.</p>
<p>Useful for altering the user data before any hydration is applied.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.alter_deserialized_list_data', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.alter_deserialized_list_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">alter_deserialized_list_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to alter list data just after it has been received from the user &amp;</span>
<span class="sd">    gets deserialized.</span>
<span class="sd">    Useful for altering the user data before any hydration is applied.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.alter_detail_data_to_serialize">
    <p>def <span class="ident">alter_detail_data_to_serialize</span>(</p><p>self, request, data)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.alter_detail_data_to_serialize">alter_detail_data_to_serialize</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A hook to alter detail data just before it gets serialized &amp; sent to the user.</p>
<p>Useful for restructuring/renaming aspects of the what's going to be
sent.</p>
<p>Should accommodate for receiving a single bundle of data.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.alter_detail_data_to_serialize', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.alter_detail_data_to_serialize" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">alter_detail_data_to_serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to alter detail data just before it gets serialized &amp; sent to the user.</span>
<span class="sd">    Useful for restructuring/renaming aspects of the what&#39;s going to be</span>
<span class="sd">    sent.</span>
<span class="sd">    Should accommodate for receiving a single bundle of data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.alter_list_data_to_serialize">
    <p>def <span class="ident">alter_list_data_to_serialize</span>(</p><p>self, request, data)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.alter_list_data_to_serialize">alter_list_data_to_serialize</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A hook to alter list data just before it gets serialized &amp; sent to the user.</p>
<p>Useful for restructuring/renaming aspects of the what's going to be
sent.</p>
<p>Should accommodate for a list of objects, generally also including
meta data.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.alter_list_data_to_serialize', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.alter_list_data_to_serialize" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">alter_list_data_to_serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to alter list data just before it gets serialized &amp; sent to the user.</span>
<span class="sd">    Useful for restructuring/renaming aspects of the what&#39;s going to be</span>
<span class="sd">    sent.</span>
<span class="sd">    Should accommodate for a list of objects, generally also including</span>
<span class="sd">    meta data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.api_field_from_django_field">
    <p>def <span class="ident">api_field_from_django_field</span>(</p><p>cls, f, default=&lt;class &#39;tastypie.fields.CharField&#39;&gt;)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.api_field_from_django_field">api_field_from_django_field</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Returns the field type that would likely be associated with each
Django type.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.api_field_from_django_field', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.api_field_from_django_field" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">api_field_from_django_field</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">fields</span><span class="o">.</span><span class="n">CharField</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the field type that would likely be associated with each</span>
<span class="sd">    Django type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">default</span>
    <span class="n">internal_type</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">get_internal_type</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">internal_type</span> <span class="o">==</span> <span class="s1">&#39;DateField&#39;</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">DateField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="o">==</span> <span class="s1">&#39;DateTimeField&#39;</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">DateTimeField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;BooleanField&#39;</span><span class="p">,</span> <span class="s1">&#39;NullBooleanField&#39;</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">BooleanField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;FloatField&#39;</span><span class="p">,):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">FloatField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;DecimalField&#39;</span><span class="p">,):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">DecimalField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;IntegerField&#39;</span><span class="p">,</span> <span class="s1">&#39;PositiveIntegerField&#39;</span><span class="p">,</span> <span class="s1">&#39;PositiveSmallIntegerField&#39;</span><span class="p">,</span> <span class="s1">&#39;SmallIntegerField&#39;</span><span class="p">,</span> <span class="s1">&#39;AutoField&#39;</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">IntegerField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;FileField&#39;</span><span class="p">,</span> <span class="s1">&#39;ImageField&#39;</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">FileField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="o">==</span> <span class="s1">&#39;TimeField&#39;</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">TimeField</span>
    <span class="c1"># TODO: Perhaps enable these via introspection. The reason they&#39;re not enabled</span>
    <span class="c1">#       by default is the very different ``__init__`` they have over</span>
    <span class="c1">#       the other fields.</span>
    <span class="c1"># elif internal_type == &#39;ForeignKey&#39;:</span>
    <span class="c1">#     result = ForeignKey</span>
    <span class="c1"># elif internal_type == &#39;ManyToManyField&#39;:</span>
    <span class="c1">#     result = ManyToManyField</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.apply_authorization_limits">
    <p>def <span class="ident">apply_authorization_limits</span>(</p><p>self, request, object_list)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.apply_authorization_limits">apply_authorization_limits</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Deprecated.</p>
<p>FIXME: REMOVE BEFORE 1.0</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.apply_authorization_limits', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.apply_authorization_limits" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">apply_authorization_limits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">object_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Deprecated.</span>
<span class="sd">    FIXME: REMOVE BEFORE 1.0</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">apply_limits</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">object_list</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.apply_filters">
    <p>def <span class="ident">apply_filters</span>(</p><p>self, request, applicable_filters)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.apply_filters">apply_filters</a></code>
    </p>

    
  
    <div class="desc inherited"><p>An ORM-specific implementation of <code>apply_filters</code>.</p>
<p>The default simply applies the <code>applicable_filters</code> as <code>**kwargs</code>,
but should make it possible to do more advanced things.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.apply_filters', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.apply_filters" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">apply_filters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">applicable_filters</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An ORM-specific implementation of ``apply_filters``.</span>
<span class="sd">    The default simply applies the ``applicable_filters`` as ``**kwargs``,</span>
<span class="sd">    but should make it possible to do more advanced things.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">request</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="o">**</span><span class="n">applicable_filters</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.apply_sorting">
    <p>def <span class="ident">apply_sorting</span>(</p><p>self, obj_list, options=None)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.apply_sorting">apply_sorting</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Given a dictionary of options, apply some ORM-level sorting to the
provided <code>QuerySet</code>.</p>
<p>Looks for the <code>order_by</code> key and handles either ascending (just the
field name) or descending (the field name with a <code>-</code> in front).</p>
<p>The field name should be the resource field, <strong>NOT</strong> model field.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.apply_sorting', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.apply_sorting" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">apply_sorting</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_list</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a dictionary of options, apply some ORM-level sorting to the</span>
<span class="sd">    provided ``QuerySet``.</span>
<span class="sd">    Looks for the ``order_by`` key and handles either ascending (just the</span>
<span class="sd">    field name) or descending (the field name with a ``-`` in front).</span>
<span class="sd">    The field name should be the resource field, **NOT** model field.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">parameter_name</span> <span class="o">=</span> <span class="s1">&#39;order_by&#39;</span>
    <span class="k">if</span> <span class="s1">&#39;order_by&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;sort_by&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
            <span class="c1"># Nothing to alter the order. Return what we&#39;ve got.</span>
            <span class="k">return</span> <span class="n">obj_list</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;&#39;sort_by&#39; is a deprecated parameter. Please use &#39;order_by&#39; instead.&quot;</span><span class="p">)</span>
            <span class="n">parameter_name</span> <span class="o">=</span> <span class="s1">&#39;sort_by&#39;</span>
    <span class="n">order_by_args</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="s1">&#39;getlist&#39;</span><span class="p">):</span>
        <span class="n">order_bits</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">getlist</span><span class="p">(</span><span class="n">parameter_name</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">order_bits</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">parameter_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">order_bits</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="n">order_bits</span> <span class="o">=</span> <span class="p">[</span><span class="n">order_bits</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">order_by</span> <span class="ow">in</span> <span class="n">order_bits</span><span class="p">:</span>
        <span class="n">order_by_bits</span> <span class="o">=</span> <span class="n">order_by</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">LOOKUP_SEP</span><span class="p">)</span>
        <span class="n">field_name</span> <span class="o">=</span> <span class="n">order_by_bits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">order</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">order_by_bits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">):</span>
            <span class="n">field_name</span> <span class="o">=</span> <span class="n">order_by_bits</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
            <span class="n">order</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span>
        <span class="k">if</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
            <span class="c1"># It&#39;s not a field we know about. Move along citizen.</span>
            <span class="k">raise</span> <span class="n">InvalidSortError</span><span class="p">(</span><span class="s2">&quot;No matching &#39;</span><span class="si">%s</span><span class="s2">&#39; field for ordering on.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">ordering</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidSortError</span><span class="p">(</span><span class="s2">&quot;The &#39;</span><span class="si">%s</span><span class="s2">&#39; field does not allow ordering.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">attribute</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidSortError</span><span class="p">(</span><span class="s2">&quot;The &#39;</span><span class="si">%s</span><span class="s2">&#39; field has no &#39;attribute&#39; for ordering with.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="n">order_by_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">LOOKUP_SEP</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">attribute</span><span class="p">]</span> <span class="o">+</span> <span class="n">order_by_bits</span><span class="p">[</span><span class="mi">1</span><span class="p">:])))</span>
    <span class="k">return</span> <span class="n">obj_list</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="o">*</span><span class="n">order_by_args</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.authorized_create_detail">
    <p>def <span class="ident">authorized_create_detail</span>(</p><p>self, object_list, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_create_detail">authorized_create_detail</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles checking of permissions to see if the user has authorization
to POST this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.authorized_create_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.authorized_create_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_create_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to POST this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">create_detail</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">auth_result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.authorized_create_list">
    <p>def <span class="ident">authorized_create_list</span>(</p><p>self, object_list, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_create_list">authorized_create_list</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles checking of permissions to see if the user has authorization
to POST this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.authorized_create_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.authorized_create_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_create_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to POST this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">create_list</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.authorized_delete_detail">
    <p>def <span class="ident">authorized_delete_detail</span>(</p><p>self, object_list, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_delete_detail">authorized_delete_detail</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles checking of permissions to see if the user has authorization
to DELETE this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.authorized_delete_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.authorized_delete_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_delete_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to DELETE this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">delete_detail</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">auth_result</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.authorized_delete_list">
    <p>def <span class="ident">authorized_delete_list</span>(</p><p>self, object_list, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_delete_list">authorized_delete_list</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles checking of permissions to see if the user has authorization
to DELETE this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.authorized_delete_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.authorized_delete_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_delete_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to DELETE this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">delete_list</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.authorized_read_detail">
    <p>def <span class="ident">authorized_read_detail</span>(</p><p>self, object_list, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_read_detail">authorized_read_detail</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles checking of permissions to see if the user has authorization
to GET this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.authorized_read_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.authorized_read_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_read_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to GET this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">read_detail</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">auth_result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.authorized_read_list">
    <p>def <span class="ident">authorized_read_list</span>(</p><p>self, object_list, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_read_list">authorized_read_list</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles checking of permissions to see if the user has authorization
to GET this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.authorized_read_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.authorized_read_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_read_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to GET this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">read_list</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.authorized_update_detail">
    <p>def <span class="ident">authorized_update_detail</span>(</p><p>self, object_list, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_update_detail">authorized_update_detail</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles checking of permissions to see if the user has authorization
to PUT this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.authorized_update_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.authorized_update_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_update_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to PUT this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">update_detail</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">auth_result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.authorized_update_list">
    <p>def <span class="ident">authorized_update_list</span>(</p><p>self, object_list, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_update_list">authorized_update_list</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles checking of permissions to see if the user has authorization
to PUT this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.authorized_update_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.authorized_update_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_update_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to PUT this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">update_list</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.base_urls">
    <p>def <span class="ident">base_urls</span>(</p><p>self)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.base_urls">base_urls</a></code>
    </p>

    
  
    <div class="desc inherited"><p>The standard URLs this <code>Resource</code> should respond to.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.base_urls', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.base_urls" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">base_urls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The standard URLs this ``Resource`` should respond to.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="n">url</span><span class="p">(</span><span class="s2">r&quot;^(?P&lt;resource_name&gt;</span><span class="si">%s</span><span class="s2">)</span><span class="si">%s</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span> <span class="n">trailing_slash</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrap_view</span><span class="p">(</span><span class="s1">&#39;dispatch_list&#39;</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;api_dispatch_list&quot;</span><span class="p">),</span>
        <span class="n">url</span><span class="p">(</span><span class="s2">r&quot;^(?P&lt;resource_name&gt;</span><span class="si">%s</span><span class="s2">)/schema</span><span class="si">%s</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span> <span class="n">trailing_slash</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrap_view</span><span class="p">(</span><span class="s1">&#39;get_schema&#39;</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;api_get_schema&quot;</span><span class="p">),</span>
        <span class="n">url</span><span class="p">(</span><span class="s2">r&quot;^(?P&lt;resource_name&gt;</span><span class="si">%s</span><span class="s2">)/set/(?P&lt;</span><span class="si">%s</span><span class="s2">_list&gt;.*?)</span><span class="si">%s</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">,</span> <span class="n">trailing_slash</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrap_view</span><span class="p">(</span><span class="s1">&#39;get_multiple&#39;</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;api_get_multiple&quot;</span><span class="p">),</span>
        <span class="n">url</span><span class="p">(</span><span class="s2">r&quot;^(?P&lt;resource_name&gt;</span><span class="si">%s</span><span class="s2">)/(?P&lt;</span><span class="si">%s</span><span class="s2">&gt;.*?)</span><span class="si">%s</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">,</span> <span class="n">trailing_slash</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrap_view</span><span class="p">(</span><span class="s1">&#39;dispatch_detail&#39;</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;api_dispatch_detail&quot;</span><span class="p">),</span>
    <span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.build_bundle">
    <p>def <span class="ident">build_bundle</span>(</p><p>self, obj=None, data=None, request=None, objects_saved=None, via_uri=None)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.build_bundle">build_bundle</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Given either an object, a data dictionary or both, builds a <code>Bundle</code>
for use throughout the <code>dehydrate/hydrate</code> cycle.</p>
<p>If no object is provided, an empty object from
<code>Resource._meta.object_class</code> is created so that attempts to access
<code>bundle.obj</code> do not fail.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.build_bundle', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.build_bundle" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">build_bundle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">objects_saved</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">via_uri</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given either an object, a data dictionary or both, builds a ``Bundle``</span>
<span class="sd">    for use throughout the ``dehydrate/hydrate`` cycle.</span>
<span class="sd">    If no object is provided, an empty object from</span>
<span class="sd">    ``Resource._meta.object_class`` is created so that attempts to access</span>
<span class="sd">    ``bundle.obj`` do not fail.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="p">:</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">Bundle</span><span class="p">(</span>
        <span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span>
        <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
        <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">,</span>
        <span class="n">objects_saved</span><span class="o">=</span><span class="n">objects_saved</span><span class="p">,</span>
        <span class="n">via_uri</span><span class="o">=</span><span class="n">via_uri</span>
    <span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.build_filters">
    <p>def <span class="ident">build_filters</span>(</p><p>self, filters=None)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.build_filters">build_filters</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Given a dictionary of filters, create the necessary ORM-level filters.</p>
<p>Keys should be resource fields, <strong>NOT</strong> model fields.</p>
<p>Valid values are either a list of Django filter types (i.e.
<code>['startswith', 'exact', 'lte']</code>), the <code>ALL</code> constant or the
<code>ALL_WITH_RELATIONS</code> constant.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.build_filters', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.build_filters" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">build_filters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a dictionary of filters, create the necessary ORM-level filters.</span>
<span class="sd">    Keys should be resource fields, **NOT** model fields.</span>
<span class="sd">    Valid values are either a list of Django filter types (i.e.</span>
<span class="sd">    ``[&#39;startswith&#39;, &#39;exact&#39;, &#39;lte&#39;]``), the ``ALL`` constant or the</span>
<span class="sd">    ``ALL_WITH_RELATIONS`` constant.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># At the declarative level:</span>
    <span class="c1">#     filtering = {</span>
    <span class="c1">#         &#39;resource_field_name&#39;: [&#39;exact&#39;, &#39;startswith&#39;, &#39;endswith&#39;, &#39;contains&#39;],</span>
    <span class="c1">#         &#39;resource_field_name_2&#39;: [&#39;exact&#39;, &#39;gt&#39;, &#39;gte&#39;, &#39;lt&#39;, &#39;lte&#39;, &#39;range&#39;],</span>
    <span class="c1">#         &#39;resource_field_name_3&#39;: ALL,</span>
    <span class="c1">#         &#39;resource_field_name_4&#39;: ALL_WITH_RELATIONS,</span>
    <span class="c1">#         ...</span>
    <span class="c1">#     }</span>
    <span class="c1"># Accepts the filters as a dict. None by default, meaning no filters.</span>
    <span class="k">if</span> <span class="n">filters</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">filters</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">qs_filters</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="p">,</span> <span class="s1">&#39;queryset&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="c1"># Get the possible query terms from the current QuerySet.</span>
        <span class="n">query_terms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">queryset</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">query_terms</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">query_terms</span> <span class="o">=</span> <span class="n">QUERY_TERMS</span>
    <span class="k">if</span> <span class="n">django</span><span class="o">.</span><span class="n">VERSION</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span> <span class="ow">and</span> <span class="n">GeometryField</span><span class="p">:</span>
        <span class="n">query_terms</span> <span class="o">=</span> <span class="n">query_terms</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="n">GeometryField</span><span class="o">.</span><span class="n">class_lookups</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="k">for</span> <span class="n">filter_expr</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">filters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">filter_bits</span> <span class="o">=</span> <span class="n">filter_expr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">LOOKUP_SEP</span><span class="p">)</span>
        <span class="n">field_name</span> <span class="o">=</span> <span class="n">filter_bits</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">filter_type</span> <span class="o">=</span> <span class="s1">&#39;exact&#39;</span>
        <span class="k">if</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
            <span class="c1"># It&#39;s not a field we know about. Move along citizen.</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filter_bits</span><span class="p">)</span> <span class="ow">and</span> <span class="n">filter_bits</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">query_terms</span><span class="p">:</span>
            <span class="n">filter_type</span> <span class="o">=</span> <span class="n">filter_bits</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="n">lookup_bits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_filtering</span><span class="p">(</span><span class="n">field_name</span><span class="p">,</span> <span class="n">filter_type</span><span class="p">,</span> <span class="n">filter_bits</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_value_to_python</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">filters</span><span class="p">,</span> <span class="n">filter_expr</span><span class="p">,</span> <span class="n">filter_type</span><span class="p">)</span>
        <span class="n">db_field_name</span> <span class="o">=</span> <span class="n">LOOKUP_SEP</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lookup_bits</span><span class="p">)</span>
        <span class="n">qs_filter</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">db_field_name</span><span class="p">,</span> <span class="n">LOOKUP_SEP</span><span class="p">,</span> <span class="n">filter_type</span><span class="p">)</span>
        <span class="n">qs_filters</span><span class="p">[</span><span class="n">qs_filter</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
    <span class="k">return</span> <span class="n">dict_strip_unicode_keys</span><span class="p">(</span><span class="n">qs_filters</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.build_schema">
    <p>def <span class="ident">build_schema</span>(</p><p>self)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.build_schema">build_schema</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Returns a dictionary of all the fields on the resource and some
properties about those fields.</p>
<p>Used by the <code>schema/</code> endpoint to describe what will be available.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.build_schema', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.build_schema" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">build_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a dictionary of all the fields on the resource and some</span>
<span class="sd">    properties about those fields.</span>
<span class="sd">    Used by the ``schema/`` endpoint to describe what will be available.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;fields&#39;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s1">&#39;default_format&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">default_format</span><span class="p">,</span>
        <span class="s1">&#39;allowed_list_http_methods&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">list_allowed_methods</span><span class="p">,</span>
        <span class="s1">&#39;allowed_detail_http_methods&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_allowed_methods</span><span class="p">,</span>
        <span class="s1">&#39;default_limit&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">limit</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">ordering</span><span class="p">:</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;ordering&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">ordering</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span><span class="p">:</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;filtering&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span>
    <span class="c1"># Skip assigning pk_field_name for non-model resources</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">pk_field_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">queryset</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">pk</span><span class="o">.</span><span class="n">name</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="n">pk_field_name</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;fields&#39;</span><span class="p">][</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">default</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">dehydrated_type</span><span class="p">,</span>
            <span class="s1">&#39;nullable&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">null</span><span class="p">,</span>
            <span class="s1">&#39;blank&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">blank</span><span class="p">,</span>
            <span class="s1">&#39;readonly&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">readonly</span><span class="p">,</span>
            <span class="s1">&#39;help_text&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">help_text</span><span class="p">,</span>
            <span class="s1">&#39;unique&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">unique</span><span class="p">,</span>
            <span class="s1">&#39;primary_key&#39;</span><span class="p">:</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">field_name</span> <span class="o">==</span> <span class="n">pk_field_name</span> <span class="k">else</span> <span class="bp">False</span><span class="p">,</span>
            <span class="s1">&#39;verbose_name&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">verbose_name</span> <span class="ow">or</span> <span class="n">field_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">),</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">dehydrated_type</span> <span class="o">==</span> <span class="s1">&#39;related&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
                <span class="n">related_type</span> <span class="o">=</span> <span class="s1">&#39;to_many&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">related_type</span> <span class="o">=</span> <span class="s1">&#39;to_one&#39;</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;fields&#39;</span><span class="p">][</span><span class="n">field_name</span><span class="p">][</span><span class="s1">&#39;related_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">related_type</span>
            <span class="n">uri</span> <span class="o">=</span> <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;api_get_schema&#39;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;api_name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span><span class="p">,</span> <span class="s1">&#39;resource_name&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">to_class</span><span class="p">()</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">})</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;fields&#39;</span><span class="p">][</span><span class="n">field_name</span><span class="p">][</span><span class="s1">&#39;related_schema&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">uri</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.cached_obj_get">
    <p>def <span class="ident">cached_obj_get</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.cached_obj_get">cached_obj_get</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A version of <code>obj_get</code> that uses the cache as a means to get
commonly-accessed data faster.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.cached_obj_get', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.cached_obj_get" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">cached_obj_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A version of ``obj_get`` that uses the cache as a means to get</span>
<span class="sd">    commonly-accessed data faster.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_cache_key</span><span class="p">(</span><span class="s1">&#39;detail&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">cached_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cache_key</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">cached_bundle</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">cached_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">cache_key</span><span class="p">,</span> <span class="n">cached_bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cached_bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.cached_obj_get_list">
    <p>def <span class="ident">cached_obj_get_list</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.cached_obj_get_list">cached_obj_get_list</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A version of <code>obj_get_list</code> that uses the cache as a means to get
commonly-accessed data faster.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.cached_obj_get_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.cached_obj_get_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">cached_obj_get_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A version of ``obj_get_list`` that uses the cache as a means to get</span>
<span class="sd">    commonly-accessed data faster.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_cache_key</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">obj_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cache_key</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">obj_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">obj_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">cache_key</span><span class="p">,</span> <span class="n">obj_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">obj_list</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.can_create">
    <p>def <span class="ident">can_create</span>(</p><p>self)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.can_create">can_create</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Checks to ensure <code>post</code> is within <code>allowed_methods</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.can_create', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.can_create" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">can_create</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks to ensure ``post`` is within ``allowed_methods``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">allowed</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">list_allowed_methods</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_allowed_methods</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">&#39;post&#39;</span> <span class="ow">in</span> <span class="n">allowed</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.can_delete">
    <p>def <span class="ident">can_delete</span>(</p><p>self)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.can_delete">can_delete</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Checks to ensure <code>delete</code> is within <code>allowed_methods</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.can_delete', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.can_delete" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">can_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks to ensure ``delete`` is within ``allowed_methods``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">allowed</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">list_allowed_methods</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_allowed_methods</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">&#39;delete&#39;</span> <span class="ow">in</span> <span class="n">allowed</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.can_update">
    <p>def <span class="ident">can_update</span>(</p><p>self)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.can_update">can_update</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Checks to ensure <code>put</code> is within <code>allowed_methods</code>.</p>
<p>Used when hydrating related data.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.can_update', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.can_update" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">can_update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks to ensure ``put`` is within ``allowed_methods``.</span>
<span class="sd">    Used when hydrating related data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">allowed</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">list_allowed_methods</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_allowed_methods</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">&#39;put&#39;</span> <span class="ow">in</span> <span class="n">allowed</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.check_filtering">
    <p>def <span class="ident">check_filtering</span>(</p><p>self, field_name, filter_type=u&#39;exact&#39;, filter_bits=None)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.check_filtering">check_filtering</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Given a field name, a optional filter type and an optional list of
additional relations, determine if a field can be filtered on.</p>
<p>If a filter does not meet the needed conditions, it should raise an
<code>InvalidFilterError</code>.</p>
<p>If the filter meets the conditions, a list of attribute names (not
field names) will be returned.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.check_filtering', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.check_filtering" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">check_filtering</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">filter_type</span><span class="o">=</span><span class="s1">&#39;exact&#39;</span><span class="p">,</span> <span class="n">filter_bits</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a field name, a optional filter type and an optional list of</span>
<span class="sd">    additional relations, determine if a field can be filtered on.</span>
<span class="sd">    If a filter does not meet the needed conditions, it should raise an</span>
<span class="sd">    ``InvalidFilterError``.</span>
<span class="sd">    If the filter meets the conditions, a list of attribute names (not</span>
<span class="sd">    field names) will be returned.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">filter_bits</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">filter_bits</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">InvalidFilterError</span><span class="p">(</span><span class="s2">&quot;The &#39;</span><span class="si">%s</span><span class="s2">&#39; field does not allow filtering.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
    <span class="c1"># Check to see if it&#39;s an allowed lookup type.</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">ALL</span><span class="p">,</span> <span class="n">ALL_WITH_RELATIONS</span><span class="p">):</span>
        <span class="c1"># Must be an explicit whitelist.</span>
        <span class="k">if</span> <span class="n">filter_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span><span class="p">[</span><span class="n">field_name</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">InvalidFilterError</span><span class="p">(</span><span class="s2">&quot;&#39;</span><span class="si">%s</span><span class="s2">&#39; is not an allowed filter on the &#39;</span><span class="si">%s</span><span class="s2">&#39; field.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">filter_type</span><span class="p">,</span> <span class="n">field_name</span><span class="p">))</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">attribute</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">InvalidFilterError</span><span class="p">(</span><span class="s2">&quot;The &#39;</span><span class="si">%s</span><span class="s2">&#39; field has no &#39;attribute&#39; for searching with.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
    <span class="c1"># Check to see if it&#39;s a relational lookup and if that&#39;s allowed.</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filter_bits</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">],</span> <span class="s1">&#39;is_related&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">InvalidFilterError</span><span class="p">(</span><span class="s2">&quot;The &#39;</span><span class="si">%s</span><span class="s2">&#39; field does not support relations.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">==</span> <span class="n">ALL_WITH_RELATIONS</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidFilterError</span><span class="p">(</span><span class="s2">&quot;Lookups are not allowed more than one level deep on the &#39;</span><span class="si">%s</span><span class="s2">&#39; field.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="c1"># Recursively descend through the remaining lookups in the filter,</span>
        <span class="c1"># if any. We should ensure that all along the way, we&#39;re allowed</span>
        <span class="c1"># to filter on that field by the related resource.</span>
        <span class="n">related_resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">get_related_resource</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">attribute</span><span class="p">]</span> <span class="o">+</span> <span class="n">related_resource</span><span class="o">.</span><span class="n">check_filtering</span><span class="p">(</span><span class="n">filter_bits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">filter_type</span><span class="p">,</span> <span class="n">filter_bits</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">attribute</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.create_identifier">
    <p>def <span class="ident">create_identifier</span>(</p><p>self, obj)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.create_identifier">create_identifier</a></code>
    </p>

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.create_identifier', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.create_identifier" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">create_identifier</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">u&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">app_label</span><span class="p">,</span> <span class="n">get_module_name</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">_meta</span><span class="p">),</span> <span class="n">obj</span><span class="o">.</span><span class="n">pk</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.create_response">
    <p>def <span class="ident">create_response</span>(</p><p>self, request, data, response_class=&lt;class &#39;django.http.response.HttpResponse&#39;&gt;, **response_kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.create_response">create_response</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Ensure that data is returned in the right format as an attachment if returning SDF or XLSX data
Should an object have been created or updated, now is the time to
reindex it in the elasticsearch index</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.create_response', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.create_response" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">create_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">HttpResponse</span><span class="p">,</span> <span class="o">**</span><span class="n">response_kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Ensure that data is returned in the right format as an attachment if returning SDF or XLSX data</span>
<span class="sd">    Should an object have been created or updated, now is the time to</span>
<span class="sd">    reindex it in the elasticsearch index</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">desired_format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">determine_format</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">response_class</span> <span class="o">==</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpCreated</span> <span class="ow">or</span> <span class="n">response_class</span> <span class="o">==</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpAccepted</span><span class="p">:</span>
        <span class="n">batches</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;objects&quot;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;objects&quot;</span><span class="p">):</span>
                <span class="n">batches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">batches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
        <span class="n">index_batches_in_new_index</span><span class="p">(</span><span class="n">batches</span><span class="p">)</span>
    <span class="n">serialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">desired_format</span><span class="p">)</span>
    <span class="n">rc</span> <span class="o">=</span> <span class="n">response_class</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">serialized</span><span class="p">,</span> <span class="n">content_type</span><span class="o">=</span><span class="n">build_content_type</span><span class="p">(</span>
        <span class="n">desired_format</span><span class="p">),</span> <span class="o">**</span><span class="n">response_kwargs</span><span class="p">)</span>
    <span class="k">if</span><span class="p">(</span><span class="n">desired_format</span> <span class="o">==</span> <span class="s1">&#39;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&#39;</span><span class="p">):</span>
        <span class="n">rc</span><span class="p">[</span><span class="s1">&#39;Content-Disposition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;attachment; filename=export_from_chembiohub_chemreg</span><span class="si">%d</span><span class="s1">.xlsx&#39;</span> <span class="o">%</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span>
    <span class="k">elif</span><span class="p">(</span><span class="n">desired_format</span> <span class="o">==</span> <span class="s1">&#39;chemical/x-mdl-sdfile&#39;</span><span class="p">):</span>
        <span class="n">rc</span><span class="p">[</span><span class="s1">&#39;Content-Disposition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;attachment; filename=export_from_chembiohub_chemreg</span><span class="si">%d</span><span class="s1">.sdf&#39;</span> <span class="o">%</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">rc</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.dehydrate">
    <p>def <span class="ident">dehydrate</span>(</p><p>self, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.dehydrate">dehydrate</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A hook to allow a final manipulation of data once all fields/methods
have built out the dehydrated data.</p>
<p>Useful if you need to access more than one dehydrated field or want
to annotate on additional data.</p>
<p>Must return the modified bundle.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.dehydrate', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.dehydrate" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dehydrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to allow a final manipulation of data once all fields/methods</span>
<span class="sd">    have built out the dehydrated data.</span>
<span class="sd">    Useful if you need to access more than one dehydrated field or want</span>
<span class="sd">    to annotate on additional data.</span>
<span class="sd">    Must return the modified bundle.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.dehydrate_properties">
    <p>def <span class="ident">dehydrate_properties</span>(</p><p>self, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.dehydrate_properties">dehydrate_properties</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Ensure that the archived property is always presented in a consistent way</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.dehydrate_properties', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.dehydrate_properties" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dehydrate_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Ensure that the archived property is always presented in a consistent way&quot;&quot;&quot;</span>
    <span class="n">archived</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;archived&quot;</span><span class="p">,</span> <span class="s2">&quot;false&quot;</span><span class="p">)</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">properties</span>
    <span class="n">value</span><span class="p">[</span><span class="s2">&quot;archived&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">archived</span>
    <span class="k">return</span> <span class="n">value</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.dehydrate_resource_uri">
    <p>def <span class="ident">dehydrate_resource_uri</span>(</p><p>self, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.dehydrate_resource_uri">dehydrate_resource_uri</a></code>
    </p>

    
  
    <div class="desc inherited"><p>For the automatically included <code>resource_uri</code> field, dehydrate
the URI for the given bundle.</p>
<p>Returns empty string if no URI can be generated.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.dehydrate_resource_uri', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.dehydrate_resource_uri" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dehydrate_resource_uri</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    For the automatically included ``resource_uri`` field, dehydrate</span>
<span class="sd">    the URI for the given bundle.</span>
<span class="sd">    Returns empty string if no URI can be generated.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_uri</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="k">except</span> <span class="n">NoReverseMatch</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.dehydrate_timestamp">
    <p>def <span class="ident">dehydrate_timestamp</span>(</p><p>self, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.dehydrate_timestamp">dehydrate_timestamp</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Provide a viewer-friendly timestamp</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.dehydrate_timestamp', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.dehydrate_timestamp" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dehydrate_timestamp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Provide a viewer-friendly timestamp&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">created</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.dehydrate_uuid">
    <p>def <span class="ident">dehydrate_uuid</span>(</p><p>self, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.dehydrate_uuid">dehydrate_uuid</a></code>
    </p>

    
  
    <div class="desc inherited"><p>This is either a blinded batch uuid or a uuid for the compound structure based on the INCHI key</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.dehydrate_uuid', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.dehydrate_uuid" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dehydrate_uuid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This is either a blinded batch uuid or a uuid for the compound structure based on the INCHI key&quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">related_molregno</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">related_molregno</span><span class="o">.</span><span class="n">chembl</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">related_molregno</span><span class="o">.</span><span class="n">chembl</span><span class="o">.</span><span class="n">chembl_id</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">related_molregno</span><span class="o">.</span><span class="n">chembl</span><span class="o">.</span><span class="n">chembl_id</span>
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">blinded_batch_id</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">blinded_batch_id</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.delete_detail">
    <p>def <span class="ident">delete_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.delete_detail">delete_detail</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Destroys a single resource/object.</p>
<p>Calls <code>obj_delete</code>.</p>
<p>If the resource is deleted, return <code>HttpNoContent</code> (204 No Content).
If the resource did not exist, return <code>Http404</code> (404 Not Found).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.delete_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.delete_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">delete_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Destroys a single resource/object.</span>
<span class="sd">    Calls ``obj_delete``.</span>
<span class="sd">    If the resource is deleted, return ``HttpNoContent`` (204 No Content).</span>
<span class="sd">    If the resource did not exist, return ``Http404`` (404 Not Found).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Manually construct the bundle here, since we don&#39;t want to try to</span>
    <span class="c1"># delete an empty instance.</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="n">Bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">obj_delete</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNoContent</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">NotFound</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNotFound</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.delete_list">
    <p>def <span class="ident">delete_list</span>(</p><p>self, request, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.delete_list">delete_list</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Destroys a collection of resources/objects.</p>
<p>Calls <code>obj_delete_list</code>.</p>
<p>If the resources are deleted, return <code>HttpNoContent</code> (204 No Content).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.delete_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.delete_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">delete_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Destroys a collection of resources/objects.</span>
<span class="sd">    Calls ``obj_delete_list``.</span>
<span class="sd">    If the resources are deleted, return ``HttpNoContent`` (204 No Content).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">obj_delete_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNoContent</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.deserialize">
    <p>def <span class="ident">deserialize</span>(</p><p>self, request, data, format=u&#39;application/json&#39;)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.deserialize">deserialize</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Given a request, data and a format, deserializes the given data.</p>
<p>It relies on the request properly sending a <code>CONTENT_TYPE</code> header,
falling back to <code>application/json</code> if not provided.</p>
<p>Mostly a hook, this uses the <code>Serializer</code> from <code>Resource._meta</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.deserialize', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.deserialize" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">deserialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s1">&#39;application/json&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a request, data and a format, deserializes the given data.</span>
<span class="sd">    It relies on the request properly sending a ``CONTENT_TYPE`` header,</span>
<span class="sd">    falling back to ``application/json`` if not provided.</span>
<span class="sd">    Mostly a hook, this uses the ``Serializer`` from ``Resource._meta``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">serializer</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="n">format</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">deserialized</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.detail_uri_kwargs">
    <p>def <span class="ident">detail_uri_kwargs</span>(</p><p>self, bundle_or_obj)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.detail_uri_kwargs">detail_uri_kwargs</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Given a <code>Bundle</code> or an object (typically a <code>Model</code> instance),
it returns the extra kwargs needed to generate a detail URI.</p>
<p>By default, it uses the model's <code>pk</code> in order to create the URI.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.detail_uri_kwargs', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.detail_uri_kwargs" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">detail_uri_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle_or_obj</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a ``Bundle`` or an object (typically a ``Model`` instance),</span>
<span class="sd">    it returns the extra kwargs needed to generate a detail URI.</span>
<span class="sd">    By default, it uses the model&#39;s ``pk`` in order to create the URI.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bundle_or_obj</span><span class="p">,</span> <span class="n">Bundle</span><span class="p">):</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">bundle_or_obj</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">bundle_or_obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">kwargs</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.determine_format">
    <p>def <span class="ident">determine_format</span>(</p><p>self, request)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.determine_format">determine_format</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Used to determine the desired format.</p>
<p>Largely relies on <code>tastypie.utils.mime.determine_format</code> but here
as a point of extension.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.determine_format', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.determine_format" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">determine_format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Used to determine the desired format.</span>
<span class="sd">    Largely relies on ``tastypie.utils.mime.determine_format`` but here</span>
<span class="sd">    as a point of extension.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">determine_format</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">serializer</span><span class="p">,</span> <span class="n">default_format</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">default_format</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.dispatch">
    <p>def <span class="ident">dispatch</span>(</p><p>self, request_type, request, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.dispatch">dispatch</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles the common operations (allowed HTTP method, authentication,
throttling, method lookup) surrounding most CRUD interactions.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.dispatch', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.dispatch" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dispatch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request_type</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles the common operations (allowed HTTP method, authentication,</span>
<span class="sd">    throttling, method lookup) surrounding most CRUD interactions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">allowed_methods</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_allowed_methods&quot;</span> <span class="o">%</span> <span class="n">request_type</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;HTTP_X_HTTP_METHOD_OVERRIDE&#39;</span> <span class="ow">in</span> <span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="p">:</span>
        <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="p">[</span><span class="s1">&#39;HTTP_X_HTTP_METHOD_OVERRIDE&#39;</span><span class="p">]</span>
    <span class="n">request_method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">method_check</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">allowed</span><span class="o">=</span><span class="n">allowed_methods</span><span class="p">)</span>
    <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">request_method</span><span class="p">,</span> <span class="n">request_type</span><span class="p">),</span> <span class="bp">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">method</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpNotImplemented</span><span class="p">())</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">throttle_check</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="c1"># All clear. Process the request.</span>
    <span class="n">request</span> <span class="o">=</span> <span class="n">convert_post_to_put</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="c1"># Add the throttled request.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_throttled_access</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="c1"># If what comes back isn&#39;t a ``HttpResponse``, assume that the</span>
    <span class="c1"># request was accepted and that some action occurred. This also</span>
    <span class="c1"># prevents Django from freaking out.</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">HttpResponse</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNoContent</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">response</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.dispatch_detail">
    <p>def <span class="ident">dispatch_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.dispatch_detail">dispatch_detail</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A view for handling the various HTTP methods (GET/POST/PUT/DELETE) on
a single resource.</p>
<p>Relies on <code>Resource.dispatch</code> for the heavy-lifting.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.dispatch_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.dispatch_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dispatch_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A view for handling the various HTTP methods (GET/POST/PUT/DELETE) on</span>
<span class="sd">    a single resource.</span>
<span class="sd">    Relies on ``Resource.dispatch`` for the heavy-lifting.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span><span class="s1">&#39;detail&#39;</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.dispatch_list">
    <p>def <span class="ident">dispatch_list</span>(</p><p>self, request, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.dispatch_list">dispatch_list</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A view for handling the various HTTP methods (GET/POST/PUT/DELETE) over
the entire list of resources.</p>
<p>Relies on <code>Resource.dispatch</code> for the heavy-lifting.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.dispatch_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.dispatch_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dispatch_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A view for handling the various HTTP methods (GET/POST/PUT/DELETE) over</span>
<span class="sd">    the entire list of resources.</span>
<span class="sd">    Relies on ``Resource.dispatch`` for the heavy-lifting.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.error_response">
    <p>def <span class="ident">error_response</span>(</p><p>self, request, errors, response_class=None)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.error_response">error_response</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Extracts the common "which-format/serialize/return-error-response"
cycle.</p>
<p>Should be used as much as possible to return errors.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.error_response', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.error_response" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">error_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extracts the common &quot;which-format/serialize/return-error-response&quot;</span>
<span class="sd">    cycle.</span>
<span class="sd">    Should be used as much as possible to return errors.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">response_class</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">response_class</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpBadRequest</span>
    <span class="n">desired_format</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">if</span> <span class="n">request</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;callback&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">desired_format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">determine_format</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">BadRequest</span><span class="p">:</span>
                <span class="k">pass</span>  <span class="c1"># Fall through to default handler below</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># JSONP can cause extra breakage.</span>
            <span class="n">desired_format</span> <span class="o">=</span> <span class="s1">&#39;application/json&#39;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">desired_format</span><span class="p">:</span>
        <span class="n">desired_format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">default_format</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">serialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">desired_format</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">BadRequest</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">error</span> <span class="o">=</span> <span class="s2">&quot;Additional errors occurred, but serialization of those errors failed.&quot;</span>
        <span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">:</span>
            <span class="n">error</span> <span class="o">+=</span> <span class="s2">&quot; </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">e</span>
        <span class="k">return</span> <span class="n">response_class</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">error</span><span class="p">,</span> <span class="n">content_type</span><span class="o">=</span><span class="s1">&#39;text/plain&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response_class</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">serialized</span><span class="p">,</span> <span class="n">content_type</span><span class="o">=</span><span class="n">build_content_type</span><span class="p">(</span><span class="n">desired_format</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.filter_value_to_python">
    <p>def <span class="ident">filter_value_to_python</span>(</p><p>self, value, field_name, filters, filter_expr, filter_type)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.filter_value_to_python">filter_value_to_python</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Turn the string <code>value</code> into a python object.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.filter_value_to_python', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.filter_value_to_python" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">filter_value_to_python</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">filters</span><span class="p">,</span> <span class="n">filter_expr</span><span class="p">,</span>
        <span class="n">filter_type</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Turn the string ``value`` into a python object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Simple values</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">string_to_python</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="c1"># Split on &#39;,&#39; if not empty string and either an in or range filter.</span>
    <span class="k">if</span> <span class="n">filter_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="s1">&#39;range&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">filters</span><span class="p">,</span> <span class="s1">&#39;getlist&#39;</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">filters</span><span class="o">.</span><span class="n">getlist</span><span class="p">(</span><span class="n">filter_expr</span><span class="p">):</span>
                <span class="n">value</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">part</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">value</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.full_dehydrate">
    <p>def <span class="ident">full_dehydrate</span>(</p><p>self, bundle, for_list=False)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.full_dehydrate">full_dehydrate</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Given a bundle with an object instance, extract the information from it
to populate the resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.full_dehydrate', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.full_dehydrate" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">full_dehydrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">for_list</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a bundle with an object instance, extract the information from it</span>
<span class="sd">    to populate the resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span>
    <span class="n">api_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span>
    <span class="n">resource_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span>
    <span class="c1"># Dehydrate each field.</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># If it&#39;s not for use in this mode, skip</span>
        <span class="n">field_use_in</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">use_in</span>
        <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_use_in</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">field_use_in</span><span class="p">(</span><span class="n">bundle</span><span class="p">):</span>
                <span class="k">continue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">field_use_in</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;list&#39;</span> <span class="k">if</span> <span class="n">for_list</span> <span class="k">else</span> <span class="s1">&#39;detail&#39;</span><span class="p">]:</span>
                <span class="k">continue</span>
        <span class="c1"># A touch leaky but it makes URI resolution work.</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">dehydrated_type</span> <span class="o">==</span> <span class="s1">&#39;related&#39;</span><span class="p">:</span>
            <span class="n">field_object</span><span class="o">.</span><span class="n">api_name</span> <span class="o">=</span> <span class="n">api_name</span>
            <span class="n">field_object</span><span class="o">.</span><span class="n">resource_name</span> <span class="o">=</span> <span class="n">resource_name</span>
        <span class="n">data</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="n">for_list</span><span class="o">=</span><span class="n">for_list</span><span class="p">)</span>
        <span class="c1"># Check for an optional method to do further dehydration.</span>
        <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;dehydrate_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.full_hydrate">
    <p>def <span class="ident">full_hydrate</span>(</p><p>self, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.full_hydrate">full_hydrate</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Given a populated bundle, distill it and turn it back into
a full-fledged object instance.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.full_hydrate', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.full_hydrate" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">full_hydrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a populated bundle, distill it and turn it back into</span>
<span class="sd">    a full-fledged object instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="p">()</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">readonly</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># Check for an optional method to do further hydration.</span>
        <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;hydrate_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
            <span class="n">bundle</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
            <span class="c1"># NOTE: We only get back a bundle when it is related field.</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Bundle</span><span class="p">)</span> <span class="ow">and</span> <span class="n">value</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_name</span><span class="p">):</span>
                <span class="n">bundle</span><span class="o">.</span><span class="n">errors</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">errors</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">field_object</span><span class="o">.</span><span class="n">null</span><span class="p">:</span>
                <span class="c1"># We need to avoid populating M2M data here as that will</span>
                <span class="c1"># cause things to blow up.</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_related</span><span class="p">:</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="k">elif</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                        <span class="c1"># NOTE: A bug fix in Django (ticket #18153) fixes incorrect behavior</span>
                        <span class="c1"># which Tastypie was relying on.  To fix this, we store value.obj to</span>
                        <span class="c1"># be saved later in save_related.</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="nb">setattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
                        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">ObjectDoesNotExist</span><span class="p">):</span>
                            <span class="n">bundle</span><span class="o">.</span><span class="n">related_objects_to_save</span><span class="p">[</span><span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">obj</span>
                    <span class="k">elif</span> <span class="n">field_object</span><span class="o">.</span><span class="n">blank</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="k">elif</span> <span class="n">field_object</span><span class="o">.</span><span class="n">null</span><span class="p">:</span>
                        <span class="nb">setattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.generate_cache_key">
    <p>def <span class="ident">generate_cache_key</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.generate_cache_key">generate_cache_key</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Creates a unique-enough cache key.</p>
<p>This is based off the current api_name/resource_name/args/kwargs.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.generate_cache_key', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.generate_cache_key" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">generate_cache_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a unique-enough cache key.</span>
<span class="sd">    This is based off the current api_name/resource_name/args/kwargs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">smooshed</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">=</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
    <span class="c1"># Use a list plus a ``.join()`` because it&#39;s faster than concatenation.</span>
    <span class="k">return</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">args</span><span class="p">),</span> <span class="s1">&#39;:&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">smooshed</span><span class="p">)))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.get_bundle_detail_data">
    <p>def <span class="ident">get_bundle_detail_data</span>(</p><p>self, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_bundle_detail_data">get_bundle_detail_data</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Convenience method to return the <code>detail_uri_name</code> attribute off
<code>bundle.obj</code>.</p>
<p>Usually just accesses <code>bundle.obj.pk</code> by default.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.get_bundle_detail_data', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.get_bundle_detail_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_bundle_detail_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convenience method to return the ``detail_uri_name`` attribute off</span>
<span class="sd">    ``bundle.obj``.</span>
<span class="sd">    Usually just accesses ``bundle.obj.pk`` by default.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.get_detail">
    <p>def <span class="ident">get_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_detail">get_detail</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Returns a single serialized resource.
Calls <code>cached_obj_get/obj_get</code> to provide the data, then handles that result
set and serializes it.
Should return a HttpResponse (200 OK).
Get a single CBHCompoundbatches from elasticsearch by running a query</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.get_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.get_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a single serialized resource.</span>
<span class="sd">    Calls ``cached_obj_get/obj_get`` to provide the data, then handles that result</span>
<span class="sd">    set and serializes it.</span>
<span class="sd">    Should return a HttpResponse (200 OK).</span>
<span class="sd">    Get a single CBHCompoundbatches from elasticsearch by running a query</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">basic_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">allowed_pids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">project_ids</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="n">concatenated_indices</span> <span class="o">=</span> <span class="n">elasticsearch_client</span><span class="o">.</span><span class="n">get_list_of_indicies</span><span class="p">(</span><span class="n">allowed_pids</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">elasticsearch_client</span><span class="o">.</span><span class="n">get_detail_data_elasticsearch</span><span class="p">(</span><span class="n">concatenated_indices</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;pk&quot;</span><span class="p">])</span>   
    
    <span class="n">requested_pid</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;projectfull&quot;</span><span class="p">][</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">requested_pid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_pids</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">(</span><span class="s2">&quot;No permissions for requested project&quot;</span><span class="p">)</span> 
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.get_fields">
    <p>def <span class="ident">get_fields</span>(</p><p>cls, fields=None, excludes=None)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_fields">get_fields</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Given any explicit fields to include and fields to exclude, add
additional fields based on the associated model.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.get_fields', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.get_fields" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">get_fields</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">excludes</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given any explicit fields to include and fields to exclude, add</span>
<span class="sd">    additional fields based on the associated model.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">final_fields</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">fields</span> <span class="o">=</span> <span class="n">fields</span> <span class="ow">or</span> <span class="p">[]</span>
    <span class="n">excludes</span> <span class="o">=</span> <span class="n">excludes</span> <span class="ow">or</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">cls</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">final_fields</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">cls</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
        <span class="c1"># If the field name is already present, skip</span>
        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">cls</span><span class="o">.</span><span class="n">base_fields</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># If field is not present in explicit field listing, skip</span>
        <span class="k">if</span> <span class="n">fields</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># If field is in exclude list, skip</span>
        <span class="k">if</span> <span class="n">excludes</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">excludes</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">cls</span><span class="o">.</span><span class="n">should_skip_field</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="n">api_field_class</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">api_field_from_django_field</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;attribute&#39;</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s1">&#39;help_text&#39;</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">help_text</span><span class="p">,</span>
            <span class="s1">&#39;verbose_name&#39;</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">verbose_name</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">null</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;null&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;unique&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">unique</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">f</span><span class="o">.</span><span class="n">null</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">blank</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;blank&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">get_internal_type</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;TextField&#39;</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">has_default</span><span class="p">():</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">default</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;auto_now&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">auto_now</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;auto_now_add&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">auto_now_add</span>
        <span class="n">final_fields</span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">api_field_class</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">final_fields</span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">instance_name</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span>
    <span class="k">return</span> <span class="n">final_fields</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.get_list">
    <p>def <span class="ident">get_list</span>(</p><p>self, request, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_list">get_list</a></code>
    </p>

    
  
    <div class="desc"><p>Request data where the project is of the saved search type</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.get_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.get_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Request data where the project is of the saved search type&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">CBHSavedSearchResource</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_list</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">extra_queries</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;query_type&quot;</span><span class="p">:</span> <span class="s2">&quot;pick_from_list&quot;</span><span class="p">,</span> <span class="s2">&quot;field_path&quot;</span> <span class="p">:</span> <span class="s2">&quot;projectfull.project_type.saved_search_project_type&quot;</span><span class="p">,</span> <span class="s2">&quot;pick_from_list&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;true&quot;</span><span class="p">]</span> <span class="p">}])</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.get_multiple">
    <p>def <span class="ident">get_multiple</span>(</p><p>self, request, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_multiple">get_multiple</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Returns a serialized list of resources based on the identifiers
from the URL.</p>
<p>Calls <code>obj_get</code> to fetch only the objects requested. This method
only responds to HTTP GET.</p>
<p>Should return a HttpResponse (200 OK).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.get_multiple', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.get_multiple" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_multiple</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a serialized list of resources based on the identifiers</span>
<span class="sd">    from the URL.</span>
<span class="sd">    Calls ``obj_get`` to fetch only the objects requested. This method</span>
<span class="sd">    only responds to HTTP GET.</span>
<span class="sd">    Should return a HttpResponse (200 OK).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">method_check</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">allowed</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;get&#39;</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">throttle_check</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="c1"># Rip apart the list then iterate.</span>
    <span class="n">kwarg_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_list&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span>
    <span class="n">obj_identifiers</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">kwarg_name</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
    <span class="n">objects</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">not_found</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">base_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">identifier</span> <span class="ow">in</span> <span class="n">obj_identifiers</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">base_bundle</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">:</span> <span class="n">identifier</span><span class="p">})</span>
            <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
            <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="n">for_list</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="n">objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">ObjectDoesNotExist</span><span class="p">,</span> <span class="n">Unauthorized</span><span class="p">):</span>
            <span class="n">not_found</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">identifier</span><span class="p">)</span>
    <span class="n">object_list</span> <span class="o">=</span> <span class="p">{</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">:</span> <span class="n">objects</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">not_found</span><span class="p">):</span>
        <span class="n">object_list</span><span class="p">[</span><span class="s1">&#39;not_found&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">not_found</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_throttled_access</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">object_list</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.get_object_list">
    <p>def <span class="ident">get_object_list</span>(</p><p>self, request)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_object_list">get_object_list</a></code>
    </p>

    
  
    <div class="desc inherited"><p>An ORM-specific implementation of <code>get_object_list</code>.</p>
<p>Returns a queryset that may have been limited by other overrides.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.get_object_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.get_object_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_object_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An ORM-specific implementation of ``get_object_list``.</span>
<span class="sd">    Returns a queryset that may have been limited by other overrides.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">queryset</span><span class="o">.</span><span class="n">_clone</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.get_project_specific_data">
    <p>def <span class="ident">get_project_specific_data</span>(</p><p>self, request, queries, pids, sorts, textsearch, batch_ids_by_project)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_project_specific_data">get_project_specific_data</a></code>
    </p>

    
  
    <div class="desc inherited"><p>When an Excel or SDF download is requested, 
present the data as a
project by project summary so that 
one spreadsheet can be used per project</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.get_project_specific_data', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.get_project_specific_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_project_specific_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">queries</span><span class="p">,</span> <span class="n">pids</span><span class="p">,</span> <span class="n">sorts</span><span class="p">,</span> <span class="n">textsearch</span><span class="p">,</span> <span class="n">batch_ids_by_project</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;When an Excel or SDF download is requested, </span>
<span class="sd">    present the data as a</span>
<span class="sd">    project by project summary so that </span>
<span class="sd">    one spreadsheet can be used per project&quot;&quot;&quot;</span>
    <span class="n">to_return</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">pids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pids</span><span class="p">)</span>
    <span class="n">table_schemata</span> <span class="o">=</span> <span class="n">get_schemata</span><span class="p">(</span><span class="n">pids</span><span class="p">,</span> <span class="s2">&quot;export&quot;</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="c1">#We have removed the schema from the index for data efficiency so</span>
    <span class="c1">#We need to pull it out of the project resource</span>
        
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">proj_data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">table_schemata</span><span class="p">):</span>
        <span class="n">table_schema_for_project</span> <span class="o">=</span> <span class="n">proj_data</span><span class="p">[</span><span class="s2">&quot;tabular_data_schema&quot;</span><span class="p">][</span><span class="s2">&quot;for_export&quot;</span><span class="p">]</span>
        <span class="n">pid</span> <span class="o">=</span> <span class="n">pids</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="n">proj_index</span> <span class="o">=</span> <span class="n">elasticsearch_client</span><span class="o">.</span><span class="n">get_project_index_name</span><span class="p">(</span><span class="n">pid</span><span class="p">)</span>
        <span class="n">es_data</span> <span class="o">=</span> <span class="n">elasticsearch_client</span><span class="o">.</span><span class="n">get_list_data_elasticsearch</span><span class="p">(</span><span class="n">queries</span><span class="p">,</span>
                <span class="n">proj_index</span><span class="p">,</span>
                <span class="n">sorts</span><span class="o">=</span><span class="n">sorts</span><span class="p">,</span> 
                <span class="n">textsearch</span><span class="o">=</span><span class="n">textsearch</span><span class="p">,</span>
                <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">limit</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
                <span class="n">batch_ids_by_project</span><span class="o">=</span><span class="n">batch_ids_by_project</span> <span class="p">)</span>
        <span class="n">standardised</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prepare_es_hits</span><span class="p">(</span><span class="n">es_data</span><span class="p">)</span>
        <span class="n">standardised</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">proj_data</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
        <span class="n">standardised</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pid</span>
        <span class="n">standardised</span><span class="p">[</span><span class="s2">&quot;schema&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">table_schema_for_project</span>
        <span class="n">base</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;wsgi.url_scheme&quot;</span><span class="p">,</span><span class="s2">&quot;http&quot;</span><span class="p">)</span> 
        <span class="n">base</span> <span class="o">+=</span> <span class="s2">&quot;://&quot;</span>
        <span class="n">base</span> <span class="o">+=</span> <span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;HTTP_HOST&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">standardised</span><span class="p">[</span><span class="s2">&quot;schema&quot;</span><span class="p">]:</span>
            <span class="n">field</span><span class="p">[</span><span class="s2">&quot;base_url&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">base</span>
        <span class="n">to_return</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">standardised</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;format&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;sdf&quot;</span><span class="p">:</span>
        <span class="c1">#For the Excel sheet print out the query used</span>
        <span class="n">query_reps</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;fieldn&quot;</span><span class="p">:</span> <span class="s2">&quot;Project&quot;</span><span class="p">,</span> <span class="s2">&quot;pick_from_list&quot;</span><span class="p">:</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">ret</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span> <span class="k">for</span> <span class="n">ret</span> <span class="ow">in</span> <span class="n">to_return</span><span class="p">])</span> <span class="p">}]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">q</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">queries</span><span class="p">):</span>
            <span class="n">qrep</span> <span class="o">=</span> <span class="p">{</span><span class="n">qtype</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="p">:</span> <span class="s2">u&quot;&quot;</span> <span class="k">for</span> <span class="n">qtype</span> <span class="ow">in</span> <span class="n">settings</span><span class="o">.</span><span class="n">CBH_QUERY_TYPES</span><span class="p">}</span>
            <span class="n">qrep</span><span class="p">[</span><span class="s2">&quot;fieldn&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">q</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;pick_from_list&quot;</span><span class="p">:</span>
                    <span class="n">qrep</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;field_path&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
                        <span class="n">knownBy</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">TABULAR_DATA_SETTINGS</span><span class="p">[</span><span class="s2">&quot;schema&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">value</span><span class="p">,{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;knownBy&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">knownBy</span><span class="p">:</span>
                            <span class="n">knownBy</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                        <span class="n">qrep</span><span class="p">[</span><span class="s2">&quot;fieldn&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">l</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">knownBy</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">qrep</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="n">qrep</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
            <span class="n">query_reps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">qrep</span><span class="p">)</span>
        <span class="n">schem</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;knownBy&quot;</span> <span class="p">:</span> <span class="s2">&quot;Row&quot;</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;fieldn&quot;</span><span class="p">,</span> <span class="s2">&quot;knownBy&quot;</span> <span class="p">:</span> <span class="s2">&quot;Col&quot;</span><span class="p">}]</span> <span class="o">+</span> <span class="p">[{</span><span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">qtype</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">],</span> <span class="s2">&quot;knownBy&quot;</span> <span class="p">:</span> <span class="n">qtype</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]}</span> <span class="k">for</span> <span class="n">qtype</span> <span class="ow">in</span> <span class="n">settings</span><span class="o">.</span><span class="n">CBH_QUERY_TYPES</span><span class="p">]</span>
        <span class="n">query_summary</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;_Query Used&quot;</span><span class="p">,</span>
                <span class="s2">&quot;objects&quot;</span> <span class="p">:</span> <span class="n">query_reps</span><span class="p">,</span>
                <span class="s2">&quot;schema&quot;</span> <span class="p">:</span> <span class="n">schem</span>
                <span class="p">}</span>
        <span class="n">to_return</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">query_summary</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">to_return</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.get_resource_uri">
    <p>def <span class="ident">get_resource_uri</span>(</p><p>self, bundle_or_obj=None, url_name=u&#39;api_dispatch_list&#39;)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_resource_uri">get_resource_uri</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles generating a resource URI.</p>
<p>If the <code>bundle_or_obj</code> argument is not provided, it builds the URI
for the list endpoint.</p>
<p>If the <code>bundle_or_obj</code> argument is provided, it builds the URI for
the detail endpoint.</p>
<p>Return the generated URI. If that URI can not be reversed (not found
in the URLconf), it will return an empty string.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.get_resource_uri', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.get_resource_uri" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_resource_uri</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle_or_obj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">url_name</span><span class="o">=</span><span class="s1">&#39;api_dispatch_list&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles generating a resource URI.</span>
<span class="sd">    If the ``bundle_or_obj`` argument is not provided, it builds the URI</span>
<span class="sd">    for the list endpoint.</span>
<span class="sd">    If the ``bundle_or_obj`` argument is provided, it builds the URI for</span>
<span class="sd">    the detail endpoint.</span>
<span class="sd">    Return the generated URI. If that URI can not be reversed (not found</span>
<span class="sd">    in the URLconf), it will return an empty string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">bundle_or_obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">url_name</span> <span class="o">=</span> <span class="s1">&#39;api_dispatch_detail&#39;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_reverse_url</span><span class="p">(</span><span class="n">url_name</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resource_uri_kwargs</span><span class="p">(</span><span class="n">bundle_or_obj</span><span class="p">))</span>
    <span class="k">except</span> <span class="n">NoReverseMatch</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.get_schema">
    <p>def <span class="ident">get_schema</span>(</p><p>self, request, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_schema">get_schema</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Returns a serialized form of the schema of the resource.</p>
<p>Calls <code>build_schema</code> to generate the data. This method only responds
to HTTP GET.</p>
<p>Should return a HttpResponse (200 OK).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.get_schema', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.get_schema" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a serialized form of the schema of the resource.</span>
<span class="sd">    Calls ``build_schema`` to generate the data. This method only responds</span>
<span class="sd">    to HTTP GET.</span>
<span class="sd">    Should return a HttpResponse (200 OK).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">method_check</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">allowed</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;get&#39;</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">throttle_check</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_throttled_access</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">authorized_read_detail</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">),</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_schema</span><span class="p">())</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.get_via_uri">
    <p>def <span class="ident">get_via_uri</span>(</p><p>self, uri, request=None)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_via_uri">get_via_uri</a></code>
    </p>

    
  
    <div class="desc inherited"><p>This pulls apart the salient bits of the URI and populates the
resource via a <code>obj_get</code>.</p>
<p>Optionally accepts a <code>request</code>.</p>
<p>If you need custom behavior based on other portions of the URI,
simply override this method.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.get_via_uri', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.get_via_uri" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_via_uri</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uri</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This pulls apart the salient bits of the URI and populates the</span>
<span class="sd">    resource via a ``obj_get``.</span>
<span class="sd">    Optionally accepts a ``request``.</span>
<span class="sd">    If you need custom behavior based on other portions of the URI,</span>
<span class="sd">    simply override this method.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="n">get_script_prefix</span><span class="p">()</span>
    <span class="n">chomped_uri</span> <span class="o">=</span> <span class="n">uri</span>
    <span class="k">if</span> <span class="n">prefix</span> <span class="ow">and</span> <span class="n">chomped_uri</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">prefix</span><span class="p">):</span>
        <span class="n">chomped_uri</span> <span class="o">=</span> <span class="n">chomped_uri</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:]</span>
    <span class="c1"># We mangle the path a bit further &amp; run URL resolution against *only*</span>
    <span class="c1"># the current class. This ought to prevent bad URLs from resolving to</span>
    <span class="c1"># incorrect data.</span>
    <span class="n">found_at</span> <span class="o">=</span> <span class="n">chomped_uri</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">found_at</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">NotFound</span><span class="p">(</span><span class="s2">&quot;An incorrect URL was provided &#39;</span><span class="si">%s</span><span class="s2">&#39; for the &#39;</span><span class="si">%s</span><span class="s2">&#39; resource.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">))</span>
    <span class="n">chomped_uri</span> <span class="o">=</span> <span class="n">chomped_uri</span><span class="p">[</span><span class="n">found_at</span><span class="p">:]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">url_resolver</span> <span class="ow">in</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;urls&#39;</span><span class="p">,</span> <span class="p">[]):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">url_resolver</span><span class="o">.</span><span class="n">resolve</span><span class="p">(</span><span class="n">chomped_uri</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">view</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span> <span class="o">=</span> <span class="n">result</span>
                <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Resolver404</span><span class="p">(</span><span class="s2">&quot;URI not found in &#39;self.urls&#39;.&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">Resolver404</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">NotFound</span><span class="p">(</span><span class="s2">&quot;The URL provided &#39;</span><span class="si">%s</span><span class="s2">&#39; was not a link to a valid resource.&quot;</span> <span class="o">%</span> <span class="n">uri</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.hydrate">
    <p>def <span class="ident">hydrate</span>(</p><p>self, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.hydrate">hydrate</a></code>
    </p>

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.hydrate', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.hydrate" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">hydrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">created_by_id</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.hydrate_blinded_batch_id">
    <p>def <span class="ident">hydrate_blinded_batch_id</span>(</p><p>self, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.hydrate_blinded_batch_id">hydrate_blinded_batch_id</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Hydrate functions are run before save of a new or updated model instance
This one ensures that the blinded batch id is filled in in cases where an inventory item 
with no ModelculeDictionary attribute (related_molregno)</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.hydrate_blinded_batch_id', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.hydrate_blinded_batch_id" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">hydrate_blinded_batch_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Hydrate functions are run before save of a new or updated model instance</span>
<span class="sd">    This one ensures that the blinded batch id is filled in in cases where an inventory item </span>
<span class="sd">    with no ModelculeDictionary attribute (related_molregno)&quot;&quot;&quot;</span> 
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;blinded_batch_id&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">u&quot;EMPTY_ID&quot;</span><span class="p">:</span>
        <span class="n">uox_id</span> <span class="o">=</span> <span class="n">generate_uox_id</span><span class="p">()</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;blinded_batch_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">uox_id</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">blinded_batch_id</span> <span class="o">=</span> <span class="n">uox_id</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.hydrate_m2m">
    <p>def <span class="ident">hydrate_m2m</span>(</p><p>self, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.hydrate_m2m">hydrate_m2m</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Populate the ManyToMany data on the instance.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.hydrate_m2m', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.hydrate_m2m" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">hydrate_m2m</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Populate the ManyToMany data on the instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrationError</span><span class="p">(</span><span class="s2">&quot;You must call &#39;full_hydrate&#39; before attempting to run &#39;hydrate_m2m&#39; on </span><span class="si">%r</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span>
            <span class="c1"># Note that we only hydrate the data, leaving the instance</span>
            <span class="c1"># unmodified. It&#39;s up to the user&#39;s code to handle this.</span>
            <span class="c1"># The ``ModelResource`` provides a working baseline</span>
            <span class="c1"># in this regard.</span>
            <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">hydrate_m2m</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;hydrate_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
            <span class="n">method</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.is_authenticated">
    <p>def <span class="ident">is_authenticated</span>(</p><p>self, request)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.is_authenticated">is_authenticated</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles checking if the user is authenticated and dealing with
unauthenticated users.</p>
<p>Mostly a hook, this uses class assigned to <code>authentication</code> from
<code>Resource._meta</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.is_authenticated', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.is_authenticated" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">is_authenticated</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking if the user is authenticated and dealing with</span>
<span class="sd">    unauthenticated users.</span>
<span class="sd">    Mostly a hook, this uses class assigned to ``authentication`` from</span>
<span class="sd">    ``Resource._meta``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Authenticate the request as needed.</span>
    <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authentication</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">auth_result</span><span class="p">,</span> <span class="n">HttpResponse</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">auth_result</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">auth_result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpUnauthorized</span><span class="p">())</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.is_valid">
    <p>def <span class="ident">is_valid</span>(</p><p>self, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.is_valid">is_valid</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles checking if the data provided by the user is valid.</p>
<p>Mostly a hook, this uses class assigned to <code>validation</code> from
<code>Resource._meta</code>.</p>
<p>If validation fails, an error is raised with the error messages
serialized inside it.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.is_valid', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.is_valid" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking if the data provided by the user is valid.</span>
<span class="sd">    Mostly a hook, this uses class assigned to ``validation`` from</span>
<span class="sd">    ``Resource._meta``.</span>
<span class="sd">    If validation fails, an error is raised with the error messages</span>
<span class="sd">    serialized inside it.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">validation</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">errors</span><span class="p">:</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">errors</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">errors</span>
        <span class="k">return</span> <span class="bp">False</span>
    <span class="k">return</span> <span class="bp">True</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.log_throttled_access">
    <p>def <span class="ident">log_throttled_access</span>(</p><p>self, request)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.log_throttled_access">log_throttled_access</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles the recording of the user's access for throttling purposes.</p>
<p>Mostly a hook, this uses class assigned to <code>throttle</code> from
<code>Resource._meta</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.log_throttled_access', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.log_throttled_access" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">log_throttled_access</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles the recording of the user&#39;s access for throttling purposes.</span>
<span class="sd">    Mostly a hook, this uses class assigned to ``throttle`` from</span>
<span class="sd">    ``Resource._meta``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">request_method</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">throttle</span><span class="o">.</span><span class="n">accessed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authentication</span><span class="o">.</span><span class="n">get_identifier</span><span class="p">(</span><span class="n">request</span><span class="p">),</span> <span class="n">url</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">get_full_path</span><span class="p">(),</span> <span class="n">request_method</span><span class="o">=</span><span class="n">request_method</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.lookup_kwargs_with_identifiers">
    <p>def <span class="ident">lookup_kwargs_with_identifiers</span>(</p><p>self, bundle, kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.lookup_kwargs_with_identifiers">lookup_kwargs_with_identifiers</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Kwargs here represent uri identifiers Ex: /repos/<user_id>/<repo_name>/
We need to turn those identifiers into Python objects for generating
lookup parameters that can find them in the DB</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.lookup_kwargs_with_identifiers', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.lookup_kwargs_with_identifiers" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">lookup_kwargs_with_identifiers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Kwargs here represent uri identifiers Ex: /repos/&lt;user_id&gt;/&lt;repo_name&gt;/</span>
<span class="sd">    We need to turn those identifiers into Python objects for generating</span>
<span class="sd">    lookup parameters that can find them in the DB</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lookup_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">)</span><span class="o">.</span><span class="n">model</span><span class="p">()</span>
    <span class="c1"># Override data values, we rely on uri identifiers</span>
    <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="c1"># We&#39;re going to manually hydrate, as opposed to calling</span>
    <span class="c1"># ``full_hydrate``, to ensure we don&#39;t try to flesh out related</span>
    <span class="c1"># resources &amp; keep things speedy.</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">identifier</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">identifier</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">:</span>
            <span class="n">lookup_kwargs</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span>
            <span class="k">continue</span>
        <span class="n">field_object</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span>
        <span class="c1"># Skip readonly or related fields.</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">readonly</span> <span class="ow">is</span> <span class="bp">True</span> <span class="ow">or</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_related</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># Check for an optional method to do further hydration.</span>
        <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;hydrate_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">identifier</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
            <span class="n">bundle</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="n">lookup_kwargs</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
    <span class="k">return</span> <span class="n">lookup_kwargs</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.method_check">
    <p>def <span class="ident">method_check</span>(</p><p>self, request, allowed=None)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.method_check">method_check</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Ensures that the HTTP method used on the request is allowed to be
handled by the resource.</p>
<p>Takes an <code>allowed</code> parameter, which should be a list of lowercase
HTTP methods to check against. Usually, this looks like::</p>
<div class="codehilite"><pre><span></span># The most generic lookup.
self.method_check(request, self._meta.allowed_methods)

# A lookup against what&#39;s allowed for list-type methods.
self.method_check(request, self._meta.list_allowed_methods)

# A useful check when creating a new endpoint that only handles
# GET.
self.method_check(request, [&#39;get&#39;])
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.method_check', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.method_check" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">method_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">allowed</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Ensures that the HTTP method used on the request is allowed to be</span>
<span class="sd">    handled by the resource.</span>
<span class="sd">    Takes an ``allowed`` parameter, which should be a list of lowercase</span>
<span class="sd">    HTTP methods to check against. Usually, this looks like::</span>
<span class="sd">        # The most generic lookup.</span>
<span class="sd">        self.method_check(request, self._meta.allowed_methods)</span>
<span class="sd">        # A lookup against what&#39;s allowed for list-type methods.</span>
<span class="sd">        self.method_check(request, self._meta.list_allowed_methods)</span>
<span class="sd">        # A useful check when creating a new endpoint that only handles</span>
<span class="sd">        # GET.</span>
<span class="sd">        self.method_check(request, [&#39;get&#39;])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">allowed</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">allowed</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">request_method</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">allows</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">meth</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">allowed</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">request_method</span> <span class="o">==</span> <span class="s2">&quot;options&quot;</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="n">allows</span><span class="p">)</span>
        <span class="n">response</span><span class="p">[</span><span class="s1">&#39;Allow&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">allows</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">request_method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpMethodNotAllowed</span><span class="p">(</span><span class="n">allows</span><span class="p">)</span>
        <span class="n">response</span><span class="p">[</span><span class="s1">&#39;Allow&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">allows</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">request_method</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.obj_create">
    <p>def <span class="ident">obj_create</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_create">obj_create</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A ORM-specific implementation of <code>obj_create</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.obj_create', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.obj_create" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_create``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.obj_delete">
    <p>def <span class="ident">obj_delete</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_delete">obj_delete</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A ORM-specific implementation of <code>obj_delete</code>.</p>
<p>Takes optional <code>kwargs</code>, which are used to narrow the query to find
the instance.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.obj_delete', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.obj_delete" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_delete``.</span>
<span class="sd">    Takes optional ``kwargs``, which are used to narrow the query to find</span>
<span class="sd">    the instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="s1">&#39;delete&#39;</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ObjectDoesNotExist</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NotFound</span><span class="p">(</span><span class="s2">&quot;A model instance matching the provided arguments could not be found.&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">authorized_delete_detail</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">),</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.obj_delete_list">
    <p>def <span class="ident">obj_delete_list</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_delete_list">obj_delete_list</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A ORM-specific implementation of <code>obj_delete_list</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.obj_delete_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.obj_delete_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_delete_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_delete_list``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">objects_to_delete</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">deletable_objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">authorized_delete_list</span><span class="p">(</span><span class="n">objects_to_delete</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">deletable_objects</span><span class="p">,</span> <span class="s1">&#39;delete&#39;</span><span class="p">):</span>
        <span class="c1"># It&#39;s likely a ``QuerySet``. Call ``.delete()`` for efficiency.</span>
        <span class="n">deletable_objects</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">authed_obj</span> <span class="ow">in</span> <span class="n">deletable_objects</span><span class="p">:</span>
            <span class="n">authed_obj</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.obj_delete_list_for_update">
    <p>def <span class="ident">obj_delete_list_for_update</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_delete_list_for_update">obj_delete_list_for_update</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A ORM-specific implementation of <code>obj_delete_list_for_update</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.obj_delete_list_for_update', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.obj_delete_list_for_update" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_delete_list_for_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_delete_list_for_update``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">objects_to_delete</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">deletable_objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">authorized_update_list</span><span class="p">(</span><span class="n">objects_to_delete</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">deletable_objects</span><span class="p">,</span> <span class="s1">&#39;delete&#39;</span><span class="p">):</span>
        <span class="c1"># It&#39;s likely a ``QuerySet``. Call ``.delete()`` for efficiency.</span>
        <span class="n">deletable_objects</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">authed_obj</span> <span class="ow">in</span> <span class="n">deletable_objects</span><span class="p">:</span>
            <span class="n">authed_obj</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.obj_get">
    <p>def <span class="ident">obj_get</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_get">obj_get</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A ORM-specific implementation of <code>obj_get</code>.</p>
<p>Takes optional <code>kwargs</code>, which are used to narrow the query to find
the instance.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.obj_get', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.obj_get" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_get``.</span>
<span class="sd">    Takes optional ``kwargs``, which are used to narrow the query to find</span>
<span class="sd">    the instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># prevents FieldError when looking up nested resources containing extra data</span>
    <span class="n">field_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">get_all_field_names</span><span class="p">()</span>
    <span class="n">field_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;pk&#39;</span><span class="p">)</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">field_names</span><span class="p">}</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">object_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">stringified_kwargs</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">=</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">object_list</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="o">.</span><span class="n">DoesNotExist</span><span class="p">(</span><span class="s2">&quot;Couldn&#39;t find an instance of &#39;</span><span class="si">%s</span><span class="s2">&#39; which matched &#39;</span><span class="si">%s</span><span class="s2">&#39;.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">stringified_kwargs</span><span class="p">))</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">object_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MultipleObjectsReturned</span><span class="p">(</span><span class="s2">&quot;More than &#39;</span><span class="si">%s</span><span class="s2">&#39; matched &#39;</span><span class="si">%s</span><span class="s2">&#39;.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">stringified_kwargs</span><span class="p">))</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">object_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">authorized_read_detail</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">NotFound</span><span class="p">(</span><span class="s2">&quot;Invalid resource lookup data provided (mismatched type).&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.obj_get_list">
    <p>def <span class="ident">obj_get_list</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_get_list">obj_get_list</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A ORM-specific implementation of <code>obj_get_list</code>.</p>
<p>Takes an optional <code>request</code> object, whose <code>GET</code> dictionary can be
used to narrow the query.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.obj_get_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.obj_get_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_get_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_get_list``.</span>
<span class="sd">    Takes an optional ``request`` object, whose ``GET`` dictionary can be</span>
<span class="sd">    used to narrow the query.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">filters</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;GET&#39;</span><span class="p">):</span>
        <span class="c1"># Grab a mutable copy.</span>
        <span class="n">filters</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="c1"># Update with the provided kwargs.</span>
    <span class="n">filters</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">applicable_filters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_filters</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_filters</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">,</span> <span class="n">applicable_filters</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">authorized_read_list</span><span class="p">(</span><span class="n">objects</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">BadRequest</span><span class="p">(</span><span class="s2">&quot;Invalid resource lookup data provided (mismatched type).&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.obj_update">
    <p>def <span class="ident">obj_update</span>(</p><p>self, bundle, skip_errors=False, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_update">obj_update</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A ORM-specific implementation of <code>obj_update</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.obj_update', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.obj_update" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">skip_errors</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_update``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bundle_detail_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bundle_detail_data</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="n">arg_detail_data</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">bundle_detail_data</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">arg_detail_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="nb">str</span><span class="p">(</span><span class="n">bundle_detail_data</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">str</span><span class="p">(</span><span class="n">arg_detail_data</span><span class="p">)):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">lookup_kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lookup_kwargs_with_identifiers</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="c1"># if there is trouble hydrating the data, fall back to just</span>
            <span class="c1"># using kwargs by itself (usually it only contains a &quot;pk&quot; key</span>
            <span class="c1"># and this will work fine.</span>
            <span class="n">lookup_kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">lookup_kwargs</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ObjectDoesNotExist</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NotFound</span><span class="p">(</span><span class="s2">&quot;A model instance matching the provided arguments could not be found.&quot;</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="n">skip_errors</span><span class="o">=</span><span class="n">skip_errors</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.override_urls">
    <p>def <span class="ident">override_urls</span>(</p><p>self)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.override_urls">override_urls</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Deprecated. Will be removed by v1.0.0. Please use <code>prepend_urls</code> instead.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.override_urls', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.override_urls" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">override_urls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Deprecated. Will be removed by v1.0.0. Please use ``prepend_urls`` instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.patch_detail">
    <p>def <span class="ident">patch_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.patch_detail">patch_detail</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Updates a resource in-place.</p>
<p>Calls <code>obj_update</code>.</p>
<p>If the resource is updated, return <code>HttpAccepted</code> (202 Accepted).
If the resource did not exist, return <code>HttpNotFound</code> (404 Not Found).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.patch_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.patch_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">patch_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates a resource in-place.</span>
<span class="sd">    Calls ``obj_update``.</span>
<span class="sd">    If the resource is updated, return ``HttpAccepted`` (202 Accepted).</span>
<span class="sd">    If the resource did not exist, return ``HttpNotFound`` (404 Not Found).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">request</span> <span class="o">=</span> <span class="n">convert_post_to_patch</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="n">basic_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="c1"># We want to be able to validate the update, but we can&#39;t just pass</span>
    <span class="c1"># the partial data into the validator since all data needs to be</span>
    <span class="c1"># present. Instead, we basically simulate a PUT by pulling out the</span>
    <span class="c1"># original data and updating it in-place.</span>
    <span class="c1"># So first pull out the original object. This is essentially</span>
    <span class="c1"># ``get_detail``.</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cached_obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">basic_bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="k">except</span> <span class="n">ObjectDoesNotExist</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNotFound</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">MultipleObjectsReturned</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpMultipleChoices</span><span class="p">(</span><span class="s2">&quot;More than one resource is found at this URI.&quot;</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="c1"># Now update the bundle in-place.</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">update_in_place</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">deserialized</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">always_return_data</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpAccepted</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Invalidate prefetched_objects_cache for bundled object</span>
        <span class="c1"># because we might have changed a prefetched field</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_prefetched_objects_cache</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpAccepted</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.patch_list">
    <p>def <span class="ident">patch_list</span>(</p><p>*args, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.patch_list">patch_list</a></code>
    </p>

    
  
    <div class="desc inherited"><p>An ORM-specific implementation of <code>patch_list</code>.</p>
<p>Necessary because PATCH should be atomic (all-success or all-fail)
and the only way to do this neatly is at the database level.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.patch_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.patch_list" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@wraps</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">assigned</span><span class="o">=</span><span class="n">available_attrs</span><span class="p">(</span><span class="n">func</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">with</span> <span class="bp">self</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.post_detail">
    <p>def <span class="ident">post_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.post_detail">post_detail</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Creates a new subcollection of the resource under a resource.</p>
<p>This is not implemented by default because most people's data models
aren't self-referential.</p>
<p>If a new resource is created, return <code>HttpCreated</code> (201 Created).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.post_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.post_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">post_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a new subcollection of the resource under a resource.</span>
<span class="sd">    This is not implemented by default because most people&#39;s data models</span>
<span class="sd">    aren&#39;t self-referential.</span>
<span class="sd">    If a new resource is created, return ``HttpCreated`` (201 Created).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNotImplemented</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.post_list">
    <p>def <span class="ident">post_list</span>(</p><p>self, request, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.post_list">post_list</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Creates a new resource/object with the provided data.</p>
<p>Calls <code>obj_create</code> with the provided data and returns a response
with the new resource's location.</p>
<p>If a new resource is created, return <code>HttpCreated</code> (201 Created).
If <code>Meta.always_return_data = True</code>, there will be a populated body
of serialized data.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.post_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.post_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">post_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a new resource/object with the provided data.</span>
<span class="sd">    Calls ``obj_create`` with the provided data and returns a response</span>
<span class="sd">    with the new resource&#39;s location.</span>
<span class="sd">    If a new resource is created, return ``HttpCreated`` (201 Created).</span>
<span class="sd">    If ``Meta.always_return_data = True``, there will be a populated body</span>
<span class="sd">    of serialized data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">))</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_deserialized_detail_data</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">deserialized</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dict_strip_unicode_keys</span><span class="p">(</span><span class="n">deserialized</span><span class="p">),</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_create</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="n">location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_uri</span><span class="p">(</span><span class="n">updated_bundle</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">always_return_data</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpCreated</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">updated_bundle</span><span class="p">)</span>
        <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpCreated</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.prepare_es_hits">
    <p>def <span class="ident">prepare_es_hits</span>(</p><p>self, hits)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.prepare_es_hits">prepare_es_hits</a></code>
    </p>

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.prepare_es_hits', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.prepare_es_hits" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">prepare_es_hits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hits</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;objects&quot;</span><span class="p">:</span> 
                        <span class="p">[</span><span class="n">hit</span><span class="p">[</span><span class="s2">&quot;_source&quot;</span><span class="p">][</span><span class="s2">&quot;dataset&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">hit</span> <span class="ow">in</span> <span class="n">hits</span><span class="p">[</span><span class="s2">&quot;hits&quot;</span><span class="p">][</span><span class="s2">&quot;hits&quot;</span><span class="p">]],</span>
                        <span class="s2">&quot;meta&quot;</span> <span class="p">:</span> <span class="p">{</span><span class="s2">&quot;total_count&quot;</span> <span class="p">:</span> <span class="n">hits</span><span class="p">[</span><span class="s2">&quot;hits&quot;</span><span class="p">][</span><span class="s2">&quot;total&quot;</span><span class="p">]}</span>
                        <span class="p">}</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.prepend_urls">
    <p>def <span class="ident">prepend_urls</span>(</p><p>self)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.prepend_urls">prepend_urls</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A hook for adding your own URLs or matching before the default URLs.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.prepend_urls', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.prepend_urls" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">prepend_urls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook for adding your own URLs or matching before the default URLs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.put_detail">
    <p>def <span class="ident">put_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.put_detail">put_detail</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Either updates an existing resource or creates a new one with the
provided data.</p>
<p>Calls <code>obj_update</code> with the provided data first, but falls back to
<code>obj_create</code> if the object does not already exist.</p>
<p>If a new resource is created, return <code>HttpCreated</code> (201 Created).
If <code>Meta.always_return_data = True</code>, there will be a populated body
of serialized data.</p>
<p>If an existing resource is modified and
<code>Meta.always_return_data = False</code> (default), return <code>HttpNoContent</code>
(204 No Content).
If an existing resource is modified and
<code>Meta.always_return_data = True</code>, return <code>HttpAccepted</code> (200
OK).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.put_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.put_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">put_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Either updates an existing resource or creates a new one with the</span>
<span class="sd">    provided data.</span>
<span class="sd">    Calls ``obj_update`` with the provided data first, but falls back to</span>
<span class="sd">    ``obj_create`` if the object does not already exist.</span>
<span class="sd">    If a new resource is created, return ``HttpCreated`` (201 Created).</span>
<span class="sd">    If ``Meta.always_return_data = True``, there will be a populated body</span>
<span class="sd">    of serialized data.</span>
<span class="sd">    If an existing resource is modified and</span>
<span class="sd">    ``Meta.always_return_data = False`` (default), return ``HttpNoContent``</span>
<span class="sd">    (204 No Content).</span>
<span class="sd">    If an existing resource is modified and</span>
<span class="sd">    ``Meta.always_return_data = True``, return ``HttpAccepted`` (200</span>
<span class="sd">    OK).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">))</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_deserialized_detail_data</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">deserialized</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dict_strip_unicode_keys</span><span class="p">(</span><span class="n">deserialized</span><span class="p">),</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_update</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">always_return_data</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNoContent</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Invalidate prefetched_objects_cache for bundled object</span>
            <span class="c1"># because we might have changed a prefetched field</span>
            <span class="n">updated_bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_prefetched_objects_cache</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">updated_bundle</span><span class="p">)</span>
            <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="p">(</span><span class="n">NotFound</span><span class="p">,</span> <span class="n">MultipleObjectsReturned</span><span class="p">):</span>
        <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_create</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="n">location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_uri</span><span class="p">(</span><span class="n">updated_bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">always_return_data</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpCreated</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">updated_bundle</span><span class="p">)</span>
            <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpCreated</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.put_list">
    <p>def <span class="ident">put_list</span>(</p><p>self, request, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.put_list">put_list</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Replaces a collection of resources with another collection.</p>
<p>Calls <code>delete_list</code> to clear out the collection then <code>obj_create</code>
with the provided the data to create the new collection.</p>
<p>Return <code>HttpNoContent</code> (204 No Content) if
<code>Meta.always_return_data = False</code> (default).</p>
<p>Return <code>HttpAccepted</code> (200 OK) if
<code>Meta.always_return_data = True</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.put_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.put_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">put_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Replaces a collection of resources with another collection.</span>
<span class="sd">    Calls ``delete_list`` to clear out the collection then ``obj_create``</span>
<span class="sd">    with the provided the data to create the new collection.</span>
<span class="sd">    Return ``HttpNoContent`` (204 No Content) if</span>
<span class="sd">    ``Meta.always_return_data = False`` (default).</span>
<span class="sd">    Return ``HttpAccepted`` (200 OK) if</span>
<span class="sd">    ``Meta.always_return_data = True``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">))</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_deserialized_list_data</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">deserialized</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">deserialized</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">BadRequest</span><span class="p">(</span><span class="s2">&quot;Invalid data sent: missing &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">)</span>
    <span class="n">basic_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">obj_delete_list_for_update</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">basic_bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="n">bundles_seen</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">object_data</span> <span class="ow">in</span> <span class="n">deserialized</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">]:</span>
        <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dict_strip_unicode_keys</span><span class="p">(</span><span class="n">object_data</span><span class="p">),</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
        <span class="c1"># Attempt to be transactional, deleting any previously created</span>
        <span class="c1"># objects if validation fails.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">obj_create</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
            <span class="n">bundles_seen</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ImmediateHttpResponse</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rollback</span><span class="p">(</span><span class="n">bundles_seen</span><span class="p">)</span>
            <span class="k">raise</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">always_return_data</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNoContent</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">to_be_serialized</span> <span class="o">=</span> <span class="p">{</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">:</span> <span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">for_list</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">bundles_seen</span>
            <span class="p">]</span>
        <span class="p">}</span>
        <span class="n">to_be_serialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_list_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">to_be_serialized</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">to_be_serialized</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.remove_api_resource_names">
    <p>def <span class="ident">remove_api_resource_names</span>(</p><p>self, url_dict)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.remove_api_resource_names">remove_api_resource_names</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Given a dictionary of regex matches from a URLconf, removes
<code>api_name</code> and/or <code>resource_name</code> if found.</p>
<p>This is useful for converting URLconf matches into something suitable
for data lookup. For example::</p>
<div class="codehilite"><pre><span></span>Model.objects.filter(**self.remove_api_resource_names(matches))
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.remove_api_resource_names', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.remove_api_resource_names" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">remove_api_resource_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url_dict</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a dictionary of regex matches from a URLconf, removes</span>
<span class="sd">    ``api_name`` and/or ``resource_name`` if found.</span>
<span class="sd">    This is useful for converting URLconf matches into something suitable</span>
<span class="sd">    for data lookup. For example::</span>
<span class="sd">        Model.objects.filter(**self.remove_api_resource_names(matches))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kwargs_subset</span> <span class="o">=</span> <span class="n">url_dict</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;api_name&#39;</span><span class="p">,</span> <span class="s1">&#39;resource_name&#39;</span><span class="p">]:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">del</span><span class="p">(</span><span class="n">kwargs_subset</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">pass</span>
    <span class="k">return</span> <span class="n">kwargs_subset</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.resource_uri_kwargs">
    <p>def <span class="ident">resource_uri_kwargs</span>(</p><p>self, bundle_or_obj=None)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.resource_uri_kwargs">resource_uri_kwargs</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Builds a dictionary of kwargs to help generate URIs.</p>
<p>Automatically provides the <code>Resource.Meta.resource_name</code> (and
optionally the <code>Resource.Meta.api_name</code> if populated by an <code>Api</code>
object).</p>
<p>If the <code>bundle_or_obj</code> argument is provided, it calls
<code>Resource.detail_uri_kwargs</code> for additional bits to create</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.resource_uri_kwargs', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.resource_uri_kwargs" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">resource_uri_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle_or_obj</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Builds a dictionary of kwargs to help generate URIs.</span>
<span class="sd">    Automatically provides the ``Resource.Meta.resource_name`` (and</span>
<span class="sd">    optionally the ``Resource.Meta.api_name`` if populated by an ``Api``</span>
<span class="sd">    object).</span>
<span class="sd">    If the ``bundle_or_obj`` argument is provided, it calls</span>
<span class="sd">    ``Resource.detail_uri_kwargs`` for additional bits to create</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;resource_name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;api_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span>
    <span class="k">if</span> <span class="n">bundle_or_obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">detail_uri_kwargs</span><span class="p">(</span><span class="n">bundle_or_obj</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">kwargs</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.rollback">
    <p>def <span class="ident">rollback</span>(</p><p>self, bundles)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.rollback">rollback</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A ORM-specific implementation of <code>rollback</code>.</p>
<p>Given the list of bundles, delete all models pertaining to those
bundles.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.rollback', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.rollback" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">rollback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundles</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``rollback``.</span>
<span class="sd">    Given the list of bundles, delete all models pertaining to those</span>
<span class="sd">    bundles.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">bundle</span> <span class="ow">in</span> <span class="n">bundles</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bundle_detail_data</span><span class="p">(</span><span class="n">bundle</span><span class="p">):</span>
            <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.save">
    <p>def <span class="ident">save</span>(</p><p>self, bundle, skip_errors=False)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.save">save</a></code>
    </p>

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.save', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.save" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">skip_errors</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">via_uri</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">bundle</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">errors</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">skip_errors</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">error_response</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="o">.</span><span class="n">errors</span><span class="p">))</span>
    <span class="c1"># Check if they&#39;re authorized.</span>
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">pk</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">authorized_update_detail</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">),</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">authorized_create_detail</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">),</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="c1"># Save FKs just in case.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">save_related</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">print</span> <span class="s2">&quot;got&quot;</span>
    <span class="c1"># Save the main object.</span>
    <span class="n">obj_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_identifier</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">obj_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">bundle</span><span class="o">.</span><span class="n">objects_saved</span> <span class="ow">or</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_state</span><span class="o">.</span><span class="n">adding</span><span class="p">:</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">objects_saved</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">obj_id</span><span class="p">)</span>
    <span class="c1"># Now pick up the M2M bits.</span>
    <span class="n">m2m_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hydrate_m2m</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">save_m2m</span><span class="p">(</span><span class="n">m2m_bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.save_m2m">
    <p>def <span class="ident">save_m2m</span>(</p><p>self, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.save_m2m">save_m2m</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles the saving of related M2M data.</p>
<p>Due to the way Django works, the M2M data must be handled after the
main instance, which is why this isn't a part of the main <code>save</code> bits.</p>
<p>Currently slightly inefficient in that it will clear out the whole
relation and recreate the related data as needed.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.save_m2m', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.save_m2m" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">save_m2m</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles the saving of related M2M data.</span>
<span class="sd">    Due to the way Django works, the M2M data must be handled after the</span>
<span class="sd">    main instance, which is why this isn&#39;t a part of the main ``save`` bits.</span>
<span class="sd">    Currently slightly inefficient in that it will clear out the whole</span>
<span class="sd">    relation and recreate the related data as needed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">readonly</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># Get the manager.</span>
        <span class="n">related_mngr</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
            <span class="n">related_mngr</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">):</span>
            <span class="n">related_mngr</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">related_mngr</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">related_mngr</span><span class="p">,</span> <span class="s1">&#39;clear&#39;</span><span class="p">):</span>
            <span class="c1"># FIXME: Dupe the original bundle, copy in the new object &amp;</span>
            <span class="c1">#        check the perms on that (using the related resource)?</span>
            <span class="c1"># Clear it out, just to be safe.</span>
            <span class="n">related_mngr</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">related_objs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">related_bundle</span> <span class="ow">in</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">field_name</span><span class="p">]:</span>
            <span class="n">related_resource</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">get_related_resource</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
            <span class="c1"># Only build &amp; save if there&#39;s data, not just a URI.</span>
            <span class="n">updated_related_bundle</span> <span class="o">=</span> <span class="n">related_resource</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span>
                <span class="n">obj</span><span class="o">=</span><span class="n">related_bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="n">related_bundle</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                <span class="n">request</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">,</span>
                <span class="n">objects_saved</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">objects_saved</span><span class="p">,</span>
                <span class="n">via_uri</span><span class="o">=</span><span class="n">related_bundle</span><span class="o">.</span><span class="n">via_uri</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">related_resource</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">updated_related_bundle</span><span class="p">)</span>
            <span class="n">related_objs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">updated_related_bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
        <span class="n">related_mngr</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="o">*</span><span class="n">related_objs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.save_related">
    <p>def <span class="ident">save_related</span>(</p><p>self, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.save_related">save_related</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles the saving of related non-M2M data.
Calling assigning <code>child.parent = parent</code> &amp; then calling
<code>Child.save</code> isn't good enough to make sure the <code>parent</code>
is saved.
To get around this, we go through all our related fields &amp;
call <code>save</code> on them if they have related, non-M2M data.
M2M data is handled by the <code>ModelResource.save_m2m</code> method.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.save_related', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.save_related" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">save_related</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles the saving of related non-M2M data.</span>
<span class="sd">    Calling assigning ``child.parent = parent`` &amp; then calling</span>
<span class="sd">    ``Child.save`` isn&#39;t good enough to make sure the ``parent``</span>
<span class="sd">    is saved.</span>
<span class="sd">    To get around this, we go through all our related fields &amp;</span>
<span class="sd">    call ``save`` on them if they have related, non-M2M data.</span>
<span class="sd">    M2M data is handled by the ``ModelResource.save_m2m`` method.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_related</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">readonly</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">blank</span> <span class="ow">and</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># Get the object.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">related_obj</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ObjectDoesNotExist</span><span class="p">:</span>
            <span class="c1"># Django 1.8: unset related objects default to None, no error</span>
            <span class="n">related_obj</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="c1"># We didn&#39;t get it, so maybe we created it but haven&#39;t saved it</span>
        <span class="k">if</span> <span class="n">related_obj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">related_obj</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">related_objects_to_save</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">related_name</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bundle_detail_data</span><span class="p">(</span><span class="n">bundle</span><span class="p">):</span>
                <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">related_obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">related_name</span><span class="p">,</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
        <span class="n">related_resource</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">get_related_resource</span><span class="p">(</span><span class="n">related_obj</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_name</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">field_name</span><span class="p">],</span> <span class="s1">&#39;keys&#39;</span><span class="p">):</span>
            <span class="c1"># Only build &amp; save if there&#39;s data, not just a URI.</span>
            <span class="n">related_bundle</span> <span class="o">=</span> <span class="n">related_resource</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span>
                <span class="n">obj</span><span class="o">=</span><span class="n">related_obj</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_name</span><span class="p">),</span>
                <span class="n">request</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">,</span>
                <span class="n">objects_saved</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">objects_saved</span>
            <span class="p">)</span>
            <span class="n">related_resource</span><span class="o">.</span><span class="n">full_hydrate</span><span class="p">(</span><span class="n">related_bundle</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">field_name</span> <span class="o">!=</span> <span class="s2">&quot;project&quot;</span><span class="p">:</span>
                <span class="n">related_resource</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">related_bundle</span><span class="p">)</span>
            <span class="n">related_obj</span> <span class="o">=</span> <span class="n">related_bundle</span><span class="o">.</span><span class="n">obj</span>
        <span class="k">if</span> <span class="n">related_obj</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="n">related_obj</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.serialize">
    <p>def <span class="ident">serialize</span>(</p><p>self, request, data, format, options=None)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.serialize">serialize</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Given a request, data and a desired format, produces a serialized
version suitable for transfer over the wire.</p>
<p>Mostly a hook, this uses the <code>Serializer</code> from <code>Resource._meta</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.serialize', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.serialize" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">format</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a request, data and a desired format, produces a serialized</span>
<span class="sd">    version suitable for transfer over the wire.</span>
<span class="sd">    Mostly a hook, this uses the ``Serializer`` from ``Resource._meta``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span> <span class="o">=</span> <span class="n">options</span> <span class="ow">or</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="s1">&#39;text/javascript&#39;</span> <span class="ow">in</span> <span class="n">format</span><span class="p">:</span>
        <span class="c1"># get JSONP callback name. default to &quot;callback&quot;</span>
        <span class="n">callback</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;callback&#39;</span><span class="p">,</span> <span class="s1">&#39;callback&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_valid_jsonp_callback_value</span><span class="p">(</span><span class="n">callback</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">BadRequest</span><span class="p">(</span><span class="s1">&#39;JSONP callback name is invalid.&#39;</span><span class="p">)</span>
        <span class="n">options</span><span class="p">[</span><span class="s1">&#39;callback&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">callback</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">serializer</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">format</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.should_skip_field">
    <p>def <span class="ident">should_skip_field</span>(</p><p>cls, field)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.should_skip_field">should_skip_field</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Given a Django model field, return if it should be included in the
contributed ApiFields.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.should_skip_field', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.should_skip_field" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">should_skip_field</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">field</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a Django model field, return if it should be included in the</span>
<span class="sd">    contributed ApiFields.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Ignore certain fields (related fields).</span>
    <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="s1">&#39;rel&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">return</span> <span class="bp">False</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.throttle_check">
    <p>def <span class="ident">throttle_check</span>(</p><p>self, request)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.throttle_check">throttle_check</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles checking if the user should be throttled.</p>
<p>Mostly a hook, this uses class assigned to <code>throttle</code> from
<code>Resource._meta</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.throttle_check', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.throttle_check" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">throttle_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking if the user should be throttled.</span>
<span class="sd">    Mostly a hook, this uses class assigned to ``throttle`` from</span>
<span class="sd">    ``Resource._meta``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">identifier</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authentication</span><span class="o">.</span><span class="n">get_identifier</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="c1"># Check to see if they should be throttled.</span>
    <span class="n">throttle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">throttle</span><span class="o">.</span><span class="n">should_be_throttled</span><span class="p">(</span><span class="n">identifier</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">throttle</span><span class="p">:</span>
        <span class="c1"># Throttle limit exceeded.</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpTooManyRequests</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">throttle</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">throttle</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="n">response</span><span class="p">[</span><span class="s1">&#39;Retry-After&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">throttle</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">throttle</span><span class="p">,</span> <span class="n">datetime</span><span class="p">):</span>
            <span class="n">response</span><span class="p">[</span><span class="s1">&#39;Retry-After&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">format_date_time</span><span class="p">(</span><span class="n">mktime</span><span class="p">(</span><span class="n">throttle</span><span class="o">.</span><span class="n">timetuple</span><span class="p">()))</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.unauthorized_result">
    <p>def <span class="ident">unauthorized_result</span>(</p><p>self, exception)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.unauthorized_result">unauthorized_result</a></code>
    </p>

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.unauthorized_result', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.unauthorized_result" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">unauthorized_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exception</span><span class="p">):</span>
    <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpUnauthorized</span><span class="p">())</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.update_in_place">
    <p>def <span class="ident">update_in_place</span>(</p><p>self, request, original_bundle, new_data)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.update_in_place">update_in_place</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Update the object in original_bundle in-place using new_data.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.update_in_place', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.update_in_place" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">update_in_place</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">original_bundle</span><span class="p">,</span> <span class="n">new_data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Update the object in original_bundle in-place using new_data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">original_bundle</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">dict_strip_unicode_keys</span><span class="p">(</span><span class="n">new_data</span><span class="p">))</span>
    <span class="c1"># Now we&#39;ve got a bundle with the new data sitting in it and we&#39;re</span>
    <span class="c1"># we&#39;re basically in the same spot as a PUT request. SO the rest of this</span>
    <span class="c1"># function is cribbed from put_detail.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">alter_deserialized_detail_data</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">original_bundle</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bundle_detail_data</span><span class="p">(</span><span class="n">original_bundle</span><span class="p">),</span>
        <span class="s1">&#39;request&#39;</span><span class="p">:</span> <span class="n">request</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_update</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">original_bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CBHSavedSearchResource.wrap_view">
    <p>def <span class="ident">wrap_view</span>(</p><p>self, view)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.wrap_view">wrap_view</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Wraps methods so they can be called in a more functional way as well
as handling exceptions better.</p>
<p>Note that if <code>BadRequest</code> or an exception with a <code>response</code> attr
are seen, there is special handling to either present a message back
to the user or return the response traveling with the exception.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CBHSavedSearchResource.wrap_view', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CBHSavedSearchResource.wrap_view" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">wrap_view</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">view</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wraps methods so they can be called in a more functional way as well</span>
<span class="sd">    as handling exceptions better.</span>
<span class="sd">    Note that if ``BadRequest`` or an exception with a ``response`` attr</span>
<span class="sd">    are seen, there is special handling to either present a message back</span>
<span class="sd">    to the user or return the response traveling with the exception.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nd">@csrf_exempt</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">callback</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">view</span><span class="p">)</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">callback</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="c1"># Our response can vary based on a number of factors, use</span>
            <span class="c1"># the cache class to determine what we should ``Vary`` on so</span>
            <span class="c1"># caches won&#39;t return the wrong (cached) version.</span>
            <span class="n">varies</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="p">,</span> <span class="s2">&quot;varies&quot;</span><span class="p">,</span> <span class="p">[])</span>
            <span class="k">if</span> <span class="n">varies</span><span class="p">:</span>
                <span class="n">patch_vary_headers</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">varies</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">cacheable</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">response</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">cache_control</span><span class="p">():</span>
                    <span class="c1"># If the request is cacheable and we have a</span>
                    <span class="c1"># ``Cache-Control`` available then patch the header.</span>
                    <span class="n">patch_cache_control</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">cache_control</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">is_ajax</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">response</span><span class="o">.</span><span class="n">has_header</span><span class="p">(</span><span class="s2">&quot;Cache-Control&quot;</span><span class="p">):</span>
                <span class="c1"># IE excessively caches XMLHttpRequests, so we&#39;re disabling</span>
                <span class="c1"># the browser cache here.</span>
                <span class="c1"># See http://www.enhanceie.com/ie/bugs.asp for details.</span>
                <span class="n">patch_cache_control</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">no_cache</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">response</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">BadRequest</span><span class="p">,</span> <span class="n">fields</span><span class="o">.</span><span class="n">ApiFieldError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="n">sanitize</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s1">&#39;args&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">}</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpBadRequest</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="n">sanitize</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">messages</span><span class="p">)}</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpBadRequest</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1"># Prevent muting non-django&#39;s exceptions</span>
            <span class="c1"># i.e. RequestException from &#39;requests&#39; library</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s1">&#39;response&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">response</span><span class="p">,</span> <span class="n">HttpResponse</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">e</span><span class="o">.</span><span class="n">response</span>
            <span class="c1"># A real, non-expected exception.</span>
            <span class="c1"># Handle the case where the full traceback is more helpful</span>
            <span class="c1"># than the serialized error.</span>
            <span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">DEBUG</span> <span class="ow">and</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">settings</span><span class="p">,</span> <span class="s1">&#39;TASTYPIE_FULL_DEBUG&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
                <span class="k">raise</span>
            <span class="c1"># Re-raise the error to get a proper traceback when the error</span>
            <span class="c1"># happend during a test case</span>
            <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SERVER_NAME&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;testserver&#39;</span><span class="p">:</span>
                <span class="k">raise</span>
            <span class="c1"># Rather than re-raising, we&#39;re going to things similar to</span>
            <span class="c1"># what Django does. The difference is returning a serialized</span>
            <span class="c1"># error message.</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_500</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wrapper</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="cbh_chem_api.resources.CompoundPropertiesResource" class="name">class <span class="ident">CompoundPropertiesResource</span></p>
      
  
    <div class="desc"><p>Resource to provide data about the compound properties 
as generated by the generateCompoundProperties task in 
ChEMBL business model
Used only for a related resource, not declared globally as this would be a security risk</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">CompoundPropertiesResource</span><span class="p">(</span><span class="n">ModelResource</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Resource to provide data about the compound properties </span>
<span class="sd">    as generated by the generateCompoundProperties task in </span>
<span class="sd">    ChEMBL business model</span>
<span class="sd">    Used only for a related resource, not declared globally as this would be a security risk</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">queryset</span> <span class="o">=</span> <span class="n">CompoundProperties</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;alogp&quot;</span><span class="p">,</span> <span class="s2">&quot;full_molformula&quot;</span><span class="p">,</span> <span class="s2">&quot;full_mwt&quot;</span><span class="p">]</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#cbh_chem_api.resources.CompoundPropertiesResource">CompoundPropertiesResource</a></li>
          <li>tastypie.resources.ModelResource</li>
          <li>tastypie.resources.BaseModelResource</li>
          <li>tastypie.resources.Resource</li>
          <li>__builtin__.object</li>
          </ul>
          <h3>Class variables</h3>
            <div class="item">
            <p id="cbh_chem_api.resources.CompoundPropertiesResource.Meta" class="name">var <span class="ident">Meta</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="cbh_chem_api.resources.CompoundPropertiesResource.base_fields" class="name">var <span class="ident">base_fields</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="cbh_chem_api.resources.CompoundPropertiesResource.declared_fields" class="name">var <span class="ident">declared_fields</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="cbh_chem_api.resources.CompoundPropertiesResource.urls" class="name">var <span class="ident">urls</span></p>
            

            
  
    <div class="desc"><p>The endpoints this <code>Resource</code> responds to.</p>
<p>Mostly a standard URLconf, this is suitable for either automatic use
when registered with an <code>Api</code> class or for including directly in
a URLconf should you choose to.</p></div>
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, api_name=None)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.__init__', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">api_name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="c1"># this can cause:</span>
    <span class="c1"># TypeError: object.__new__(method-wrapper) is not safe, use method-wrapper.__new__()</span>
    <span class="c1"># when trying to copy a generator used as a default. Wrap call to</span>
    <span class="c1"># generator in lambda to get around this error.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_fields</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">api_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span> <span class="o">=</span> <span class="n">api_name</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.alter_deserialized_detail_data">
    <p>def <span class="ident">alter_deserialized_detail_data</span>(</p><p>self, request, data)</p>
    </div>
    

    
  
    <div class="desc"><p>A hook to alter detail data just after it has been received from the user &amp;
gets deserialized.</p>
<p>Useful for altering the user data before any hydration is applied.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.alter_deserialized_detail_data', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.alter_deserialized_detail_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">alter_deserialized_detail_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to alter detail data just after it has been received from the user &amp;</span>
<span class="sd">    gets deserialized.</span>
<span class="sd">    Useful for altering the user data before any hydration is applied.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.alter_deserialized_list_data">
    <p>def <span class="ident">alter_deserialized_list_data</span>(</p><p>self, request, data)</p>
    </div>
    

    
  
    <div class="desc"><p>A hook to alter list data just after it has been received from the user &amp;
gets deserialized.</p>
<p>Useful for altering the user data before any hydration is applied.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.alter_deserialized_list_data', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.alter_deserialized_list_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">alter_deserialized_list_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to alter list data just after it has been received from the user &amp;</span>
<span class="sd">    gets deserialized.</span>
<span class="sd">    Useful for altering the user data before any hydration is applied.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.alter_detail_data_to_serialize">
    <p>def <span class="ident">alter_detail_data_to_serialize</span>(</p><p>self, request, data)</p>
    </div>
    

    
  
    <div class="desc"><p>A hook to alter detail data just before it gets serialized &amp; sent to the user.</p>
<p>Useful for restructuring/renaming aspects of the what's going to be
sent.</p>
<p>Should accommodate for receiving a single bundle of data.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.alter_detail_data_to_serialize', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.alter_detail_data_to_serialize" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">alter_detail_data_to_serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to alter detail data just before it gets serialized &amp; sent to the user.</span>
<span class="sd">    Useful for restructuring/renaming aspects of the what&#39;s going to be</span>
<span class="sd">    sent.</span>
<span class="sd">    Should accommodate for receiving a single bundle of data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.alter_list_data_to_serialize">
    <p>def <span class="ident">alter_list_data_to_serialize</span>(</p><p>self, request, data)</p>
    </div>
    

    
  
    <div class="desc"><p>A hook to alter list data just before it gets serialized &amp; sent to the user.</p>
<p>Useful for restructuring/renaming aspects of the what's going to be
sent.</p>
<p>Should accommodate for a list of objects, generally also including
meta data.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.alter_list_data_to_serialize', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.alter_list_data_to_serialize" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">alter_list_data_to_serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to alter list data just before it gets serialized &amp; sent to the user.</span>
<span class="sd">    Useful for restructuring/renaming aspects of the what&#39;s going to be</span>
<span class="sd">    sent.</span>
<span class="sd">    Should accommodate for a list of objects, generally also including</span>
<span class="sd">    meta data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.api_field_from_django_field">
    <p>def <span class="ident">api_field_from_django_field</span>(</p><p>cls, f, default=&lt;class &#39;tastypie.fields.CharField&#39;&gt;)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns the field type that would likely be associated with each
Django type.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.api_field_from_django_field', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.api_field_from_django_field" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">api_field_from_django_field</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">fields</span><span class="o">.</span><span class="n">CharField</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the field type that would likely be associated with each</span>
<span class="sd">    Django type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">default</span>
    <span class="n">internal_type</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">get_internal_type</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">internal_type</span> <span class="o">==</span> <span class="s1">&#39;DateField&#39;</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">DateField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="o">==</span> <span class="s1">&#39;DateTimeField&#39;</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">DateTimeField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;BooleanField&#39;</span><span class="p">,</span> <span class="s1">&#39;NullBooleanField&#39;</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">BooleanField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;FloatField&#39;</span><span class="p">,):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">FloatField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;DecimalField&#39;</span><span class="p">,):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">DecimalField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;IntegerField&#39;</span><span class="p">,</span> <span class="s1">&#39;PositiveIntegerField&#39;</span><span class="p">,</span> <span class="s1">&#39;PositiveSmallIntegerField&#39;</span><span class="p">,</span> <span class="s1">&#39;SmallIntegerField&#39;</span><span class="p">,</span> <span class="s1">&#39;AutoField&#39;</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">IntegerField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;FileField&#39;</span><span class="p">,</span> <span class="s1">&#39;ImageField&#39;</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">FileField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="o">==</span> <span class="s1">&#39;TimeField&#39;</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">TimeField</span>
    <span class="c1"># TODO: Perhaps enable these via introspection. The reason they&#39;re not enabled</span>
    <span class="c1">#       by default is the very different ``__init__`` they have over</span>
    <span class="c1">#       the other fields.</span>
    <span class="c1"># elif internal_type == &#39;ForeignKey&#39;:</span>
    <span class="c1">#     result = ForeignKey</span>
    <span class="c1"># elif internal_type == &#39;ManyToManyField&#39;:</span>
    <span class="c1">#     result = ManyToManyField</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.apply_authorization_limits">
    <p>def <span class="ident">apply_authorization_limits</span>(</p><p>self, request, object_list)</p>
    </div>
    

    
  
    <div class="desc"><p>Deprecated.</p>
<p>FIXME: REMOVE BEFORE 1.0</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.apply_authorization_limits', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.apply_authorization_limits" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">apply_authorization_limits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">object_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Deprecated.</span>
<span class="sd">    FIXME: REMOVE BEFORE 1.0</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">apply_limits</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">object_list</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.apply_filters">
    <p>def <span class="ident">apply_filters</span>(</p><p>self, request, applicable_filters)</p>
    </div>
    

    
  
    <div class="desc"><p>An ORM-specific implementation of <code>apply_filters</code>.</p>
<p>The default simply applies the <code>applicable_filters</code> as <code>**kwargs</code>,
but should make it possible to do more advanced things.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.apply_filters', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.apply_filters" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">apply_filters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">applicable_filters</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An ORM-specific implementation of ``apply_filters``.</span>
<span class="sd">    The default simply applies the ``applicable_filters`` as ``**kwargs``,</span>
<span class="sd">    but should make it possible to do more advanced things.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">request</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="o">**</span><span class="n">applicable_filters</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.apply_sorting">
    <p>def <span class="ident">apply_sorting</span>(</p><p>self, obj_list, options=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a dictionary of options, apply some ORM-level sorting to the
provided <code>QuerySet</code>.</p>
<p>Looks for the <code>order_by</code> key and handles either ascending (just the
field name) or descending (the field name with a <code>-</code> in front).</p>
<p>The field name should be the resource field, <strong>NOT</strong> model field.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.apply_sorting', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.apply_sorting" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">apply_sorting</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_list</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a dictionary of options, apply some ORM-level sorting to the</span>
<span class="sd">    provided ``QuerySet``.</span>
<span class="sd">    Looks for the ``order_by`` key and handles either ascending (just the</span>
<span class="sd">    field name) or descending (the field name with a ``-`` in front).</span>
<span class="sd">    The field name should be the resource field, **NOT** model field.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">parameter_name</span> <span class="o">=</span> <span class="s1">&#39;order_by&#39;</span>
    <span class="k">if</span> <span class="s1">&#39;order_by&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;sort_by&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
            <span class="c1"># Nothing to alter the order. Return what we&#39;ve got.</span>
            <span class="k">return</span> <span class="n">obj_list</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;&#39;sort_by&#39; is a deprecated parameter. Please use &#39;order_by&#39; instead.&quot;</span><span class="p">)</span>
            <span class="n">parameter_name</span> <span class="o">=</span> <span class="s1">&#39;sort_by&#39;</span>
    <span class="n">order_by_args</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="s1">&#39;getlist&#39;</span><span class="p">):</span>
        <span class="n">order_bits</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">getlist</span><span class="p">(</span><span class="n">parameter_name</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">order_bits</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">parameter_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">order_bits</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="n">order_bits</span> <span class="o">=</span> <span class="p">[</span><span class="n">order_bits</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">order_by</span> <span class="ow">in</span> <span class="n">order_bits</span><span class="p">:</span>
        <span class="n">order_by_bits</span> <span class="o">=</span> <span class="n">order_by</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">LOOKUP_SEP</span><span class="p">)</span>
        <span class="n">field_name</span> <span class="o">=</span> <span class="n">order_by_bits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">order</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">order_by_bits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">):</span>
            <span class="n">field_name</span> <span class="o">=</span> <span class="n">order_by_bits</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
            <span class="n">order</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span>
        <span class="k">if</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
            <span class="c1"># It&#39;s not a field we know about. Move along citizen.</span>
            <span class="k">raise</span> <span class="n">InvalidSortError</span><span class="p">(</span><span class="s2">&quot;No matching &#39;</span><span class="si">%s</span><span class="s2">&#39; field for ordering on.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">ordering</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidSortError</span><span class="p">(</span><span class="s2">&quot;The &#39;</span><span class="si">%s</span><span class="s2">&#39; field does not allow ordering.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">attribute</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidSortError</span><span class="p">(</span><span class="s2">&quot;The &#39;</span><span class="si">%s</span><span class="s2">&#39; field has no &#39;attribute&#39; for ordering with.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="n">order_by_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">LOOKUP_SEP</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">attribute</span><span class="p">]</span> <span class="o">+</span> <span class="n">order_by_bits</span><span class="p">[</span><span class="mi">1</span><span class="p">:])))</span>
    <span class="k">return</span> <span class="n">obj_list</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="o">*</span><span class="n">order_by_args</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.authorized_create_detail">
    <p>def <span class="ident">authorized_create_detail</span>(</p><p>self, object_list, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking of permissions to see if the user has authorization
to POST this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.authorized_create_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.authorized_create_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_create_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to POST this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">create_detail</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">auth_result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.authorized_create_list">
    <p>def <span class="ident">authorized_create_list</span>(</p><p>self, object_list, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking of permissions to see if the user has authorization
to POST this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.authorized_create_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.authorized_create_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_create_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to POST this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">create_list</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.authorized_delete_detail">
    <p>def <span class="ident">authorized_delete_detail</span>(</p><p>self, object_list, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking of permissions to see if the user has authorization
to DELETE this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.authorized_delete_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.authorized_delete_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_delete_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to DELETE this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">delete_detail</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">auth_result</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.authorized_delete_list">
    <p>def <span class="ident">authorized_delete_list</span>(</p><p>self, object_list, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking of permissions to see if the user has authorization
to DELETE this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.authorized_delete_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.authorized_delete_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_delete_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to DELETE this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">delete_list</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.authorized_read_detail">
    <p>def <span class="ident">authorized_read_detail</span>(</p><p>self, object_list, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking of permissions to see if the user has authorization
to GET this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.authorized_read_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.authorized_read_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_read_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to GET this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">read_detail</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">auth_result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.authorized_read_list">
    <p>def <span class="ident">authorized_read_list</span>(</p><p>self, object_list, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking of permissions to see if the user has authorization
to GET this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.authorized_read_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.authorized_read_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_read_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to GET this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">read_list</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.authorized_update_detail">
    <p>def <span class="ident">authorized_update_detail</span>(</p><p>self, object_list, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking of permissions to see if the user has authorization
to PUT this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.authorized_update_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.authorized_update_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_update_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to PUT this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">update_detail</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">auth_result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.authorized_update_list">
    <p>def <span class="ident">authorized_update_list</span>(</p><p>self, object_list, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking of permissions to see if the user has authorization
to PUT this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.authorized_update_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.authorized_update_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_update_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to PUT this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">update_list</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.base_urls">
    <p>def <span class="ident">base_urls</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>The standard URLs this <code>Resource</code> should respond to.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.base_urls', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.base_urls" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">base_urls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The standard URLs this ``Resource`` should respond to.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="n">url</span><span class="p">(</span><span class="s2">r&quot;^(?P&lt;resource_name&gt;</span><span class="si">%s</span><span class="s2">)</span><span class="si">%s</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span> <span class="n">trailing_slash</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrap_view</span><span class="p">(</span><span class="s1">&#39;dispatch_list&#39;</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;api_dispatch_list&quot;</span><span class="p">),</span>
        <span class="n">url</span><span class="p">(</span><span class="s2">r&quot;^(?P&lt;resource_name&gt;</span><span class="si">%s</span><span class="s2">)/schema</span><span class="si">%s</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span> <span class="n">trailing_slash</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrap_view</span><span class="p">(</span><span class="s1">&#39;get_schema&#39;</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;api_get_schema&quot;</span><span class="p">),</span>
        <span class="n">url</span><span class="p">(</span><span class="s2">r&quot;^(?P&lt;resource_name&gt;</span><span class="si">%s</span><span class="s2">)/set/(?P&lt;</span><span class="si">%s</span><span class="s2">_list&gt;.*?)</span><span class="si">%s</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">,</span> <span class="n">trailing_slash</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrap_view</span><span class="p">(</span><span class="s1">&#39;get_multiple&#39;</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;api_get_multiple&quot;</span><span class="p">),</span>
        <span class="n">url</span><span class="p">(</span><span class="s2">r&quot;^(?P&lt;resource_name&gt;</span><span class="si">%s</span><span class="s2">)/(?P&lt;</span><span class="si">%s</span><span class="s2">&gt;.*?)</span><span class="si">%s</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">,</span> <span class="n">trailing_slash</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrap_view</span><span class="p">(</span><span class="s1">&#39;dispatch_detail&#39;</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;api_dispatch_detail&quot;</span><span class="p">),</span>
    <span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.build_bundle">
    <p>def <span class="ident">build_bundle</span>(</p><p>self, obj=None, data=None, request=None, objects_saved=None, via_uri=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Given either an object, a data dictionary or both, builds a <code>Bundle</code>
for use throughout the <code>dehydrate/hydrate</code> cycle.</p>
<p>If no object is provided, an empty object from
<code>Resource._meta.object_class</code> is created so that attempts to access
<code>bundle.obj</code> do not fail.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.build_bundle', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.build_bundle" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">build_bundle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">objects_saved</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">via_uri</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given either an object, a data dictionary or both, builds a ``Bundle``</span>
<span class="sd">    for use throughout the ``dehydrate/hydrate`` cycle.</span>
<span class="sd">    If no object is provided, an empty object from</span>
<span class="sd">    ``Resource._meta.object_class`` is created so that attempts to access</span>
<span class="sd">    ``bundle.obj`` do not fail.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="p">:</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">Bundle</span><span class="p">(</span>
        <span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span>
        <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
        <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">,</span>
        <span class="n">objects_saved</span><span class="o">=</span><span class="n">objects_saved</span><span class="p">,</span>
        <span class="n">via_uri</span><span class="o">=</span><span class="n">via_uri</span>
    <span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.build_filters">
    <p>def <span class="ident">build_filters</span>(</p><p>self, filters=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a dictionary of filters, create the necessary ORM-level filters.</p>
<p>Keys should be resource fields, <strong>NOT</strong> model fields.</p>
<p>Valid values are either a list of Django filter types (i.e.
<code>['startswith', 'exact', 'lte']</code>), the <code>ALL</code> constant or the
<code>ALL_WITH_RELATIONS</code> constant.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.build_filters', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.build_filters" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">build_filters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a dictionary of filters, create the necessary ORM-level filters.</span>
<span class="sd">    Keys should be resource fields, **NOT** model fields.</span>
<span class="sd">    Valid values are either a list of Django filter types (i.e.</span>
<span class="sd">    ``[&#39;startswith&#39;, &#39;exact&#39;, &#39;lte&#39;]``), the ``ALL`` constant or the</span>
<span class="sd">    ``ALL_WITH_RELATIONS`` constant.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># At the declarative level:</span>
    <span class="c1">#     filtering = {</span>
    <span class="c1">#         &#39;resource_field_name&#39;: [&#39;exact&#39;, &#39;startswith&#39;, &#39;endswith&#39;, &#39;contains&#39;],</span>
    <span class="c1">#         &#39;resource_field_name_2&#39;: [&#39;exact&#39;, &#39;gt&#39;, &#39;gte&#39;, &#39;lt&#39;, &#39;lte&#39;, &#39;range&#39;],</span>
    <span class="c1">#         &#39;resource_field_name_3&#39;: ALL,</span>
    <span class="c1">#         &#39;resource_field_name_4&#39;: ALL_WITH_RELATIONS,</span>
    <span class="c1">#         ...</span>
    <span class="c1">#     }</span>
    <span class="c1"># Accepts the filters as a dict. None by default, meaning no filters.</span>
    <span class="k">if</span> <span class="n">filters</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">filters</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">qs_filters</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="p">,</span> <span class="s1">&#39;queryset&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="c1"># Get the possible query terms from the current QuerySet.</span>
        <span class="n">query_terms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">queryset</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">query_terms</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">query_terms</span> <span class="o">=</span> <span class="n">QUERY_TERMS</span>
    <span class="k">if</span> <span class="n">django</span><span class="o">.</span><span class="n">VERSION</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span> <span class="ow">and</span> <span class="n">GeometryField</span><span class="p">:</span>
        <span class="n">query_terms</span> <span class="o">=</span> <span class="n">query_terms</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="n">GeometryField</span><span class="o">.</span><span class="n">class_lookups</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="k">for</span> <span class="n">filter_expr</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">filters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">filter_bits</span> <span class="o">=</span> <span class="n">filter_expr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">LOOKUP_SEP</span><span class="p">)</span>
        <span class="n">field_name</span> <span class="o">=</span> <span class="n">filter_bits</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">filter_type</span> <span class="o">=</span> <span class="s1">&#39;exact&#39;</span>
        <span class="k">if</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
            <span class="c1"># It&#39;s not a field we know about. Move along citizen.</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filter_bits</span><span class="p">)</span> <span class="ow">and</span> <span class="n">filter_bits</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">query_terms</span><span class="p">:</span>
            <span class="n">filter_type</span> <span class="o">=</span> <span class="n">filter_bits</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="n">lookup_bits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_filtering</span><span class="p">(</span><span class="n">field_name</span><span class="p">,</span> <span class="n">filter_type</span><span class="p">,</span> <span class="n">filter_bits</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_value_to_python</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">filters</span><span class="p">,</span> <span class="n">filter_expr</span><span class="p">,</span> <span class="n">filter_type</span><span class="p">)</span>
        <span class="n">db_field_name</span> <span class="o">=</span> <span class="n">LOOKUP_SEP</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lookup_bits</span><span class="p">)</span>
        <span class="n">qs_filter</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">db_field_name</span><span class="p">,</span> <span class="n">LOOKUP_SEP</span><span class="p">,</span> <span class="n">filter_type</span><span class="p">)</span>
        <span class="n">qs_filters</span><span class="p">[</span><span class="n">qs_filter</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
    <span class="k">return</span> <span class="n">dict_strip_unicode_keys</span><span class="p">(</span><span class="n">qs_filters</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.build_schema">
    <p>def <span class="ident">build_schema</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns a dictionary of all the fields on the resource and some
properties about those fields.</p>
<p>Used by the <code>schema/</code> endpoint to describe what will be available.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.build_schema', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.build_schema" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">build_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a dictionary of all the fields on the resource and some</span>
<span class="sd">    properties about those fields.</span>
<span class="sd">    Used by the ``schema/`` endpoint to describe what will be available.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;fields&#39;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s1">&#39;default_format&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">default_format</span><span class="p">,</span>
        <span class="s1">&#39;allowed_list_http_methods&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">list_allowed_methods</span><span class="p">,</span>
        <span class="s1">&#39;allowed_detail_http_methods&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_allowed_methods</span><span class="p">,</span>
        <span class="s1">&#39;default_limit&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">limit</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">ordering</span><span class="p">:</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;ordering&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">ordering</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span><span class="p">:</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;filtering&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span>
    <span class="c1"># Skip assigning pk_field_name for non-model resources</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">pk_field_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">queryset</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">pk</span><span class="o">.</span><span class="n">name</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="n">pk_field_name</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;fields&#39;</span><span class="p">][</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">default</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">dehydrated_type</span><span class="p">,</span>
            <span class="s1">&#39;nullable&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">null</span><span class="p">,</span>
            <span class="s1">&#39;blank&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">blank</span><span class="p">,</span>
            <span class="s1">&#39;readonly&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">readonly</span><span class="p">,</span>
            <span class="s1">&#39;help_text&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">help_text</span><span class="p">,</span>
            <span class="s1">&#39;unique&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">unique</span><span class="p">,</span>
            <span class="s1">&#39;primary_key&#39;</span><span class="p">:</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">field_name</span> <span class="o">==</span> <span class="n">pk_field_name</span> <span class="k">else</span> <span class="bp">False</span><span class="p">,</span>
            <span class="s1">&#39;verbose_name&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">verbose_name</span> <span class="ow">or</span> <span class="n">field_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">),</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">dehydrated_type</span> <span class="o">==</span> <span class="s1">&#39;related&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
                <span class="n">related_type</span> <span class="o">=</span> <span class="s1">&#39;to_many&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">related_type</span> <span class="o">=</span> <span class="s1">&#39;to_one&#39;</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;fields&#39;</span><span class="p">][</span><span class="n">field_name</span><span class="p">][</span><span class="s1">&#39;related_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">related_type</span>
            <span class="n">uri</span> <span class="o">=</span> <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;api_get_schema&#39;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;api_name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span><span class="p">,</span> <span class="s1">&#39;resource_name&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">to_class</span><span class="p">()</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">})</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;fields&#39;</span><span class="p">][</span><span class="n">field_name</span><span class="p">][</span><span class="s1">&#39;related_schema&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">uri</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.cached_obj_get">
    <p>def <span class="ident">cached_obj_get</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A version of <code>obj_get</code> that uses the cache as a means to get
commonly-accessed data faster.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.cached_obj_get', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.cached_obj_get" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">cached_obj_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A version of ``obj_get`` that uses the cache as a means to get</span>
<span class="sd">    commonly-accessed data faster.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_cache_key</span><span class="p">(</span><span class="s1">&#39;detail&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">cached_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cache_key</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">cached_bundle</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">cached_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">cache_key</span><span class="p">,</span> <span class="n">cached_bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cached_bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.cached_obj_get_list">
    <p>def <span class="ident">cached_obj_get_list</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A version of <code>obj_get_list</code> that uses the cache as a means to get
commonly-accessed data faster.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.cached_obj_get_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.cached_obj_get_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">cached_obj_get_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A version of ``obj_get_list`` that uses the cache as a means to get</span>
<span class="sd">    commonly-accessed data faster.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_cache_key</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">obj_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cache_key</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">obj_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">obj_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">cache_key</span><span class="p">,</span> <span class="n">obj_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">obj_list</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.can_create">
    <p>def <span class="ident">can_create</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Checks to ensure <code>post</code> is within <code>allowed_methods</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.can_create', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.can_create" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">can_create</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks to ensure ``post`` is within ``allowed_methods``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">allowed</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">list_allowed_methods</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_allowed_methods</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">&#39;post&#39;</span> <span class="ow">in</span> <span class="n">allowed</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.can_delete">
    <p>def <span class="ident">can_delete</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Checks to ensure <code>delete</code> is within <code>allowed_methods</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.can_delete', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.can_delete" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">can_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks to ensure ``delete`` is within ``allowed_methods``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">allowed</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">list_allowed_methods</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_allowed_methods</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">&#39;delete&#39;</span> <span class="ow">in</span> <span class="n">allowed</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.can_update">
    <p>def <span class="ident">can_update</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Checks to ensure <code>put</code> is within <code>allowed_methods</code>.</p>
<p>Used when hydrating related data.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.can_update', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.can_update" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">can_update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks to ensure ``put`` is within ``allowed_methods``.</span>
<span class="sd">    Used when hydrating related data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">allowed</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">list_allowed_methods</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_allowed_methods</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">&#39;put&#39;</span> <span class="ow">in</span> <span class="n">allowed</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.check_filtering">
    <p>def <span class="ident">check_filtering</span>(</p><p>self, field_name, filter_type=u&#39;exact&#39;, filter_bits=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a field name, a optional filter type and an optional list of
additional relations, determine if a field can be filtered on.</p>
<p>If a filter does not meet the needed conditions, it should raise an
<code>InvalidFilterError</code>.</p>
<p>If the filter meets the conditions, a list of attribute names (not
field names) will be returned.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.check_filtering', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.check_filtering" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">check_filtering</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">filter_type</span><span class="o">=</span><span class="s1">&#39;exact&#39;</span><span class="p">,</span> <span class="n">filter_bits</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a field name, a optional filter type and an optional list of</span>
<span class="sd">    additional relations, determine if a field can be filtered on.</span>
<span class="sd">    If a filter does not meet the needed conditions, it should raise an</span>
<span class="sd">    ``InvalidFilterError``.</span>
<span class="sd">    If the filter meets the conditions, a list of attribute names (not</span>
<span class="sd">    field names) will be returned.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">filter_bits</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">filter_bits</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">InvalidFilterError</span><span class="p">(</span><span class="s2">&quot;The &#39;</span><span class="si">%s</span><span class="s2">&#39; field does not allow filtering.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
    <span class="c1"># Check to see if it&#39;s an allowed lookup type.</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">ALL</span><span class="p">,</span> <span class="n">ALL_WITH_RELATIONS</span><span class="p">):</span>
        <span class="c1"># Must be an explicit whitelist.</span>
        <span class="k">if</span> <span class="n">filter_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span><span class="p">[</span><span class="n">field_name</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">InvalidFilterError</span><span class="p">(</span><span class="s2">&quot;&#39;</span><span class="si">%s</span><span class="s2">&#39; is not an allowed filter on the &#39;</span><span class="si">%s</span><span class="s2">&#39; field.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">filter_type</span><span class="p">,</span> <span class="n">field_name</span><span class="p">))</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">attribute</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">InvalidFilterError</span><span class="p">(</span><span class="s2">&quot;The &#39;</span><span class="si">%s</span><span class="s2">&#39; field has no &#39;attribute&#39; for searching with.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
    <span class="c1"># Check to see if it&#39;s a relational lookup and if that&#39;s allowed.</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filter_bits</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">],</span> <span class="s1">&#39;is_related&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">InvalidFilterError</span><span class="p">(</span><span class="s2">&quot;The &#39;</span><span class="si">%s</span><span class="s2">&#39; field does not support relations.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">==</span> <span class="n">ALL_WITH_RELATIONS</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidFilterError</span><span class="p">(</span><span class="s2">&quot;Lookups are not allowed more than one level deep on the &#39;</span><span class="si">%s</span><span class="s2">&#39; field.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="c1"># Recursively descend through the remaining lookups in the filter,</span>
        <span class="c1"># if any. We should ensure that all along the way, we&#39;re allowed</span>
        <span class="c1"># to filter on that field by the related resource.</span>
        <span class="n">related_resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">get_related_resource</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">attribute</span><span class="p">]</span> <span class="o">+</span> <span class="n">related_resource</span><span class="o">.</span><span class="n">check_filtering</span><span class="p">(</span><span class="n">filter_bits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">filter_type</span><span class="p">,</span> <span class="n">filter_bits</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">attribute</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.create_identifier">
    <p>def <span class="ident">create_identifier</span>(</p><p>self, obj)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.create_identifier', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.create_identifier" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">create_identifier</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">u&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">app_label</span><span class="p">,</span> <span class="n">get_module_name</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">_meta</span><span class="p">),</span> <span class="n">obj</span><span class="o">.</span><span class="n">pk</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.create_response">
    <p>def <span class="ident">create_response</span>(</p><p>self, request, data, response_class=&lt;class &#39;django.http.response.HttpResponse&#39;&gt;, **response_kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Extracts the common "which-format/serialize/return-response" cycle.</p>
<p>Mostly a useful shortcut/hook.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.create_response', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.create_response" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">create_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">HttpResponse</span><span class="p">,</span> <span class="o">**</span><span class="n">response_kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extracts the common &quot;which-format/serialize/return-response&quot; cycle.</span>
<span class="sd">    Mostly a useful shortcut/hook.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">desired_format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">determine_format</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="n">serialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">desired_format</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response_class</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">serialized</span><span class="p">,</span> <span class="n">content_type</span><span class="o">=</span><span class="n">build_content_type</span><span class="p">(</span><span class="n">desired_format</span><span class="p">),</span> <span class="o">**</span><span class="n">response_kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.dehydrate">
    <p>def <span class="ident">dehydrate</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>A hook to allow a final manipulation of data once all fields/methods
have built out the dehydrated data.</p>
<p>Useful if you need to access more than one dehydrated field or want
to annotate on additional data.</p>
<p>Must return the modified bundle.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.dehydrate', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.dehydrate" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dehydrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to allow a final manipulation of data once all fields/methods</span>
<span class="sd">    have built out the dehydrated data.</span>
<span class="sd">    Useful if you need to access more than one dehydrated field or want</span>
<span class="sd">    to annotate on additional data.</span>
<span class="sd">    Must return the modified bundle.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.dehydrate_resource_uri">
    <p>def <span class="ident">dehydrate_resource_uri</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>For the automatically included <code>resource_uri</code> field, dehydrate
the URI for the given bundle.</p>
<p>Returns empty string if no URI can be generated.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.dehydrate_resource_uri', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.dehydrate_resource_uri" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dehydrate_resource_uri</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    For the automatically included ``resource_uri`` field, dehydrate</span>
<span class="sd">    the URI for the given bundle.</span>
<span class="sd">    Returns empty string if no URI can be generated.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_uri</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="k">except</span> <span class="n">NoReverseMatch</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.delete_detail">
    <p>def <span class="ident">delete_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Destroys a single resource/object.</p>
<p>Calls <code>obj_delete</code>.</p>
<p>If the resource is deleted, return <code>HttpNoContent</code> (204 No Content).
If the resource did not exist, return <code>Http404</code> (404 Not Found).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.delete_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.delete_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">delete_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Destroys a single resource/object.</span>
<span class="sd">    Calls ``obj_delete``.</span>
<span class="sd">    If the resource is deleted, return ``HttpNoContent`` (204 No Content).</span>
<span class="sd">    If the resource did not exist, return ``Http404`` (404 Not Found).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Manually construct the bundle here, since we don&#39;t want to try to</span>
    <span class="c1"># delete an empty instance.</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="n">Bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">obj_delete</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNoContent</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">NotFound</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNotFound</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.delete_list">
    <p>def <span class="ident">delete_list</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Destroys a collection of resources/objects.</p>
<p>Calls <code>obj_delete_list</code>.</p>
<p>If the resources are deleted, return <code>HttpNoContent</code> (204 No Content).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.delete_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.delete_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">delete_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Destroys a collection of resources/objects.</span>
<span class="sd">    Calls ``obj_delete_list``.</span>
<span class="sd">    If the resources are deleted, return ``HttpNoContent`` (204 No Content).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">obj_delete_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNoContent</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.deserialize">
    <p>def <span class="ident">deserialize</span>(</p><p>self, request, data, format=u&#39;application/json&#39;)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a request, data and a format, deserializes the given data.</p>
<p>It relies on the request properly sending a <code>CONTENT_TYPE</code> header,
falling back to <code>application/json</code> if not provided.</p>
<p>Mostly a hook, this uses the <code>Serializer</code> from <code>Resource._meta</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.deserialize', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.deserialize" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">deserialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s1">&#39;application/json&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a request, data and a format, deserializes the given data.</span>
<span class="sd">    It relies on the request properly sending a ``CONTENT_TYPE`` header,</span>
<span class="sd">    falling back to ``application/json`` if not provided.</span>
<span class="sd">    Mostly a hook, this uses the ``Serializer`` from ``Resource._meta``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">serializer</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="n">format</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">deserialized</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.detail_uri_kwargs">
    <p>def <span class="ident">detail_uri_kwargs</span>(</p><p>self, bundle_or_obj)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a <code>Bundle</code> or an object (typically a <code>Model</code> instance),
it returns the extra kwargs needed to generate a detail URI.</p>
<p>By default, it uses the model's <code>pk</code> in order to create the URI.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.detail_uri_kwargs', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.detail_uri_kwargs" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">detail_uri_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle_or_obj</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a ``Bundle`` or an object (typically a ``Model`` instance),</span>
<span class="sd">    it returns the extra kwargs needed to generate a detail URI.</span>
<span class="sd">    By default, it uses the model&#39;s ``pk`` in order to create the URI.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bundle_or_obj</span><span class="p">,</span> <span class="n">Bundle</span><span class="p">):</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">bundle_or_obj</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">bundle_or_obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">kwargs</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.determine_format">
    <p>def <span class="ident">determine_format</span>(</p><p>self, request)</p>
    </div>
    

    
  
    <div class="desc"><p>Used to determine the desired format.</p>
<p>Largely relies on <code>tastypie.utils.mime.determine_format</code> but here
as a point of extension.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.determine_format', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.determine_format" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">determine_format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Used to determine the desired format.</span>
<span class="sd">    Largely relies on ``tastypie.utils.mime.determine_format`` but here</span>
<span class="sd">    as a point of extension.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">determine_format</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">serializer</span><span class="p">,</span> <span class="n">default_format</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">default_format</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.dispatch">
    <p>def <span class="ident">dispatch</span>(</p><p>self, request_type, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles the common operations (allowed HTTP method, authentication,
throttling, method lookup) surrounding most CRUD interactions.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.dispatch', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.dispatch" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dispatch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request_type</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles the common operations (allowed HTTP method, authentication,</span>
<span class="sd">    throttling, method lookup) surrounding most CRUD interactions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">allowed_methods</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_allowed_methods&quot;</span> <span class="o">%</span> <span class="n">request_type</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;HTTP_X_HTTP_METHOD_OVERRIDE&#39;</span> <span class="ow">in</span> <span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="p">:</span>
        <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="p">[</span><span class="s1">&#39;HTTP_X_HTTP_METHOD_OVERRIDE&#39;</span><span class="p">]</span>
    <span class="n">request_method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">method_check</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">allowed</span><span class="o">=</span><span class="n">allowed_methods</span><span class="p">)</span>
    <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">request_method</span><span class="p">,</span> <span class="n">request_type</span><span class="p">),</span> <span class="bp">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">method</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpNotImplemented</span><span class="p">())</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">throttle_check</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="c1"># All clear. Process the request.</span>
    <span class="n">request</span> <span class="o">=</span> <span class="n">convert_post_to_put</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="c1"># Add the throttled request.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_throttled_access</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="c1"># If what comes back isn&#39;t a ``HttpResponse``, assume that the</span>
    <span class="c1"># request was accepted and that some action occurred. This also</span>
    <span class="c1"># prevents Django from freaking out.</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">HttpResponse</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNoContent</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">response</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.dispatch_detail">
    <p>def <span class="ident">dispatch_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A view for handling the various HTTP methods (GET/POST/PUT/DELETE) on
a single resource.</p>
<p>Relies on <code>Resource.dispatch</code> for the heavy-lifting.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.dispatch_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.dispatch_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dispatch_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A view for handling the various HTTP methods (GET/POST/PUT/DELETE) on</span>
<span class="sd">    a single resource.</span>
<span class="sd">    Relies on ``Resource.dispatch`` for the heavy-lifting.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span><span class="s1">&#39;detail&#39;</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.dispatch_list">
    <p>def <span class="ident">dispatch_list</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A view for handling the various HTTP methods (GET/POST/PUT/DELETE) over
the entire list of resources.</p>
<p>Relies on <code>Resource.dispatch</code> for the heavy-lifting.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.dispatch_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.dispatch_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dispatch_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A view for handling the various HTTP methods (GET/POST/PUT/DELETE) over</span>
<span class="sd">    the entire list of resources.</span>
<span class="sd">    Relies on ``Resource.dispatch`` for the heavy-lifting.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.error_response">
    <p>def <span class="ident">error_response</span>(</p><p>self, request, errors, response_class=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Extracts the common "which-format/serialize/return-error-response"
cycle.</p>
<p>Should be used as much as possible to return errors.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.error_response', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.error_response" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">error_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extracts the common &quot;which-format/serialize/return-error-response&quot;</span>
<span class="sd">    cycle.</span>
<span class="sd">    Should be used as much as possible to return errors.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">response_class</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">response_class</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpBadRequest</span>
    <span class="n">desired_format</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">if</span> <span class="n">request</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;callback&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">desired_format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">determine_format</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">BadRequest</span><span class="p">:</span>
                <span class="k">pass</span>  <span class="c1"># Fall through to default handler below</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># JSONP can cause extra breakage.</span>
            <span class="n">desired_format</span> <span class="o">=</span> <span class="s1">&#39;application/json&#39;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">desired_format</span><span class="p">:</span>
        <span class="n">desired_format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">default_format</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">serialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">desired_format</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">BadRequest</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">error</span> <span class="o">=</span> <span class="s2">&quot;Additional errors occurred, but serialization of those errors failed.&quot;</span>
        <span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">:</span>
            <span class="n">error</span> <span class="o">+=</span> <span class="s2">&quot; </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">e</span>
        <span class="k">return</span> <span class="n">response_class</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">error</span><span class="p">,</span> <span class="n">content_type</span><span class="o">=</span><span class="s1">&#39;text/plain&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response_class</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">serialized</span><span class="p">,</span> <span class="n">content_type</span><span class="o">=</span><span class="n">build_content_type</span><span class="p">(</span><span class="n">desired_format</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.filter_value_to_python">
    <p>def <span class="ident">filter_value_to_python</span>(</p><p>self, value, field_name, filters, filter_expr, filter_type)</p>
    </div>
    

    
  
    <div class="desc"><p>Turn the string <code>value</code> into a python object.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.filter_value_to_python', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.filter_value_to_python" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">filter_value_to_python</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">filters</span><span class="p">,</span> <span class="n">filter_expr</span><span class="p">,</span>
        <span class="n">filter_type</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Turn the string ``value`` into a python object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Simple values</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">string_to_python</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="c1"># Split on &#39;,&#39; if not empty string and either an in or range filter.</span>
    <span class="k">if</span> <span class="n">filter_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="s1">&#39;range&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">filters</span><span class="p">,</span> <span class="s1">&#39;getlist&#39;</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">filters</span><span class="o">.</span><span class="n">getlist</span><span class="p">(</span><span class="n">filter_expr</span><span class="p">):</span>
                <span class="n">value</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">part</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">value</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.full_dehydrate">
    <p>def <span class="ident">full_dehydrate</span>(</p><p>self, bundle, for_list=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a bundle with an object instance, extract the information from it
to populate the resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.full_dehydrate', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.full_dehydrate" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">full_dehydrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">for_list</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a bundle with an object instance, extract the information from it</span>
<span class="sd">    to populate the resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span>
    <span class="n">api_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span>
    <span class="n">resource_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span>
    <span class="c1"># Dehydrate each field.</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># If it&#39;s not for use in this mode, skip</span>
        <span class="n">field_use_in</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">use_in</span>
        <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_use_in</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">field_use_in</span><span class="p">(</span><span class="n">bundle</span><span class="p">):</span>
                <span class="k">continue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">field_use_in</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;list&#39;</span> <span class="k">if</span> <span class="n">for_list</span> <span class="k">else</span> <span class="s1">&#39;detail&#39;</span><span class="p">]:</span>
                <span class="k">continue</span>
        <span class="c1"># A touch leaky but it makes URI resolution work.</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">dehydrated_type</span> <span class="o">==</span> <span class="s1">&#39;related&#39;</span><span class="p">:</span>
            <span class="n">field_object</span><span class="o">.</span><span class="n">api_name</span> <span class="o">=</span> <span class="n">api_name</span>
            <span class="n">field_object</span><span class="o">.</span><span class="n">resource_name</span> <span class="o">=</span> <span class="n">resource_name</span>
        <span class="n">data</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="n">for_list</span><span class="o">=</span><span class="n">for_list</span><span class="p">)</span>
        <span class="c1"># Check for an optional method to do further dehydration.</span>
        <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;dehydrate_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.full_hydrate">
    <p>def <span class="ident">full_hydrate</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a populated bundle, distill it and turn it back into
a full-fledged object instance.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.full_hydrate', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.full_hydrate" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">full_hydrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a populated bundle, distill it and turn it back into</span>
<span class="sd">    a full-fledged object instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="p">()</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">readonly</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># Check for an optional method to do further hydration.</span>
        <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;hydrate_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
            <span class="n">bundle</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
            <span class="c1"># NOTE: We only get back a bundle when it is related field.</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Bundle</span><span class="p">)</span> <span class="ow">and</span> <span class="n">value</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_name</span><span class="p">):</span>
                <span class="n">bundle</span><span class="o">.</span><span class="n">errors</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">errors</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">field_object</span><span class="o">.</span><span class="n">null</span><span class="p">:</span>
                <span class="c1"># We need to avoid populating M2M data here as that will</span>
                <span class="c1"># cause things to blow up.</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_related</span><span class="p">:</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="k">elif</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                        <span class="c1"># NOTE: A bug fix in Django (ticket #18153) fixes incorrect behavior</span>
                        <span class="c1"># which Tastypie was relying on.  To fix this, we store value.obj to</span>
                        <span class="c1"># be saved later in save_related.</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="nb">setattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
                        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">ObjectDoesNotExist</span><span class="p">):</span>
                            <span class="n">bundle</span><span class="o">.</span><span class="n">related_objects_to_save</span><span class="p">[</span><span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">obj</span>
                    <span class="k">elif</span> <span class="n">field_object</span><span class="o">.</span><span class="n">blank</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="k">elif</span> <span class="n">field_object</span><span class="o">.</span><span class="n">null</span><span class="p">:</span>
                        <span class="nb">setattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.generate_cache_key">
    <p>def <span class="ident">generate_cache_key</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Creates a unique-enough cache key.</p>
<p>This is based off the current api_name/resource_name/args/kwargs.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.generate_cache_key', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.generate_cache_key" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">generate_cache_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a unique-enough cache key.</span>
<span class="sd">    This is based off the current api_name/resource_name/args/kwargs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">smooshed</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">=</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
    <span class="c1"># Use a list plus a ``.join()`` because it&#39;s faster than concatenation.</span>
    <span class="k">return</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">args</span><span class="p">),</span> <span class="s1">&#39;:&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">smooshed</span><span class="p">)))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.get_bundle_detail_data">
    <p>def <span class="ident">get_bundle_detail_data</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Convenience method to return the <code>detail_uri_name</code> attribute off
<code>bundle.obj</code>.</p>
<p>Usually just accesses <code>bundle.obj.pk</code> by default.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.get_bundle_detail_data', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.get_bundle_detail_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_bundle_detail_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convenience method to return the ``detail_uri_name`` attribute off</span>
<span class="sd">    ``bundle.obj``.</span>
<span class="sd">    Usually just accesses ``bundle.obj.pk`` by default.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.get_detail">
    <p>def <span class="ident">get_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns a single serialized resource.</p>
<p>Calls <code>cached_obj_get/obj_get</code> to provide the data, then handles that result
set and serializes it.</p>
<p>Should return a HttpResponse (200 OK).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.get_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.get_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a single serialized resource.</span>
<span class="sd">    Calls ``cached_obj_get/obj_get`` to provide the data, then handles that result</span>
<span class="sd">    set and serializes it.</span>
<span class="sd">    Should return a HttpResponse (200 OK).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">basic_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cached_obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">basic_bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="k">except</span> <span class="n">ObjectDoesNotExist</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNotFound</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">MultipleObjectsReturned</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpMultipleChoices</span><span class="p">(</span><span class="s2">&quot;More than one resource is found at this URI.&quot;</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.get_fields">
    <p>def <span class="ident">get_fields</span>(</p><p>cls, fields=None, excludes=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Given any explicit fields to include and fields to exclude, add
additional fields based on the associated model.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.get_fields', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.get_fields" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">get_fields</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">excludes</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given any explicit fields to include and fields to exclude, add</span>
<span class="sd">    additional fields based on the associated model.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">final_fields</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">fields</span> <span class="o">=</span> <span class="n">fields</span> <span class="ow">or</span> <span class="p">[]</span>
    <span class="n">excludes</span> <span class="o">=</span> <span class="n">excludes</span> <span class="ow">or</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">cls</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">final_fields</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">cls</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
        <span class="c1"># If the field name is already present, skip</span>
        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">cls</span><span class="o">.</span><span class="n">base_fields</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># If field is not present in explicit field listing, skip</span>
        <span class="k">if</span> <span class="n">fields</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># If field is in exclude list, skip</span>
        <span class="k">if</span> <span class="n">excludes</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">excludes</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">cls</span><span class="o">.</span><span class="n">should_skip_field</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="n">api_field_class</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">api_field_from_django_field</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;attribute&#39;</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s1">&#39;help_text&#39;</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">help_text</span><span class="p">,</span>
            <span class="s1">&#39;verbose_name&#39;</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">verbose_name</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">null</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;null&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;unique&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">unique</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">f</span><span class="o">.</span><span class="n">null</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">blank</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;blank&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">get_internal_type</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;TextField&#39;</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">has_default</span><span class="p">():</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">default</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;auto_now&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">auto_now</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;auto_now_add&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">auto_now_add</span>
        <span class="n">final_fields</span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">api_field_class</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">final_fields</span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">instance_name</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span>
    <span class="k">return</span> <span class="n">final_fields</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.get_list">
    <p>def <span class="ident">get_list</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns a serialized list of resources.</p>
<p>Calls <code>obj_get_list</code> to provide the data, then handles that result
set and serializes it.</p>
<p>Should return a HttpResponse (200 OK).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.get_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.get_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a serialized list of resources.</span>
<span class="sd">    Calls ``obj_get_list`` to provide the data, then handles that result</span>
<span class="sd">    set and serializes it.</span>
<span class="sd">    Should return a HttpResponse (200 OK).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO: Uncached for now. Invalidation that works for everyone may be</span>
    <span class="c1">#       impossible.</span>
    <span class="n">base_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="n">objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">base_bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="n">sorted_objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_sorting</span><span class="p">(</span><span class="n">objects</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="p">)</span>
    <span class="n">paginator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">paginator_class</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="p">,</span> <span class="n">sorted_objects</span><span class="p">,</span> <span class="n">resource_uri</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_resource_uri</span><span class="p">(),</span> <span class="n">limit</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">limit</span><span class="p">,</span> <span class="n">max_limit</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">max_limit</span><span class="p">,</span> <span class="n">collection_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">)</span>
    <span class="n">to_be_serialized</span> <span class="o">=</span> <span class="n">paginator</span><span class="o">.</span><span class="n">page</span><span class="p">()</span>
    <span class="c1"># Dehydrate the bundles in preparation for serialization.</span>
    <span class="n">bundles</span> <span class="o">=</span> <span class="p">[</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">),</span> <span class="n">for_list</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">to_be_serialized</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">]</span>
    <span class="p">]</span>
    <span class="n">to_be_serialized</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">bundles</span>
    <span class="n">to_be_serialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_list_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">to_be_serialized</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">to_be_serialized</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.get_multiple">
    <p>def <span class="ident">get_multiple</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns a serialized list of resources based on the identifiers
from the URL.</p>
<p>Calls <code>obj_get</code> to fetch only the objects requested. This method
only responds to HTTP GET.</p>
<p>Should return a HttpResponse (200 OK).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.get_multiple', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.get_multiple" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_multiple</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a serialized list of resources based on the identifiers</span>
<span class="sd">    from the URL.</span>
<span class="sd">    Calls ``obj_get`` to fetch only the objects requested. This method</span>
<span class="sd">    only responds to HTTP GET.</span>
<span class="sd">    Should return a HttpResponse (200 OK).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">method_check</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">allowed</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;get&#39;</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">throttle_check</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="c1"># Rip apart the list then iterate.</span>
    <span class="n">kwarg_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_list&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span>
    <span class="n">obj_identifiers</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">kwarg_name</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
    <span class="n">objects</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">not_found</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">base_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">identifier</span> <span class="ow">in</span> <span class="n">obj_identifiers</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">base_bundle</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">:</span> <span class="n">identifier</span><span class="p">})</span>
            <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
            <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="n">for_list</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="n">objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">ObjectDoesNotExist</span><span class="p">,</span> <span class="n">Unauthorized</span><span class="p">):</span>
            <span class="n">not_found</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">identifier</span><span class="p">)</span>
    <span class="n">object_list</span> <span class="o">=</span> <span class="p">{</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">:</span> <span class="n">objects</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">not_found</span><span class="p">):</span>
        <span class="n">object_list</span><span class="p">[</span><span class="s1">&#39;not_found&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">not_found</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_throttled_access</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">object_list</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.get_object_list">
    <p>def <span class="ident">get_object_list</span>(</p><p>self, request)</p>
    </div>
    

    
  
    <div class="desc"><p>An ORM-specific implementation of <code>get_object_list</code>.</p>
<p>Returns a queryset that may have been limited by other overrides.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.get_object_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.get_object_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_object_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An ORM-specific implementation of ``get_object_list``.</span>
<span class="sd">    Returns a queryset that may have been limited by other overrides.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">queryset</span><span class="o">.</span><span class="n">_clone</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.get_resource_uri">
    <p>def <span class="ident">get_resource_uri</span>(</p><p>self, bundle_or_obj=None, url_name=u&#39;api_dispatch_list&#39;)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles generating a resource URI.</p>
<p>If the <code>bundle_or_obj</code> argument is not provided, it builds the URI
for the list endpoint.</p>
<p>If the <code>bundle_or_obj</code> argument is provided, it builds the URI for
the detail endpoint.</p>
<p>Return the generated URI. If that URI can not be reversed (not found
in the URLconf), it will return an empty string.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.get_resource_uri', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.get_resource_uri" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_resource_uri</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle_or_obj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">url_name</span><span class="o">=</span><span class="s1">&#39;api_dispatch_list&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles generating a resource URI.</span>
<span class="sd">    If the ``bundle_or_obj`` argument is not provided, it builds the URI</span>
<span class="sd">    for the list endpoint.</span>
<span class="sd">    If the ``bundle_or_obj`` argument is provided, it builds the URI for</span>
<span class="sd">    the detail endpoint.</span>
<span class="sd">    Return the generated URI. If that URI can not be reversed (not found</span>
<span class="sd">    in the URLconf), it will return an empty string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">bundle_or_obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">url_name</span> <span class="o">=</span> <span class="s1">&#39;api_dispatch_detail&#39;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_reverse_url</span><span class="p">(</span><span class="n">url_name</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resource_uri_kwargs</span><span class="p">(</span><span class="n">bundle_or_obj</span><span class="p">))</span>
    <span class="k">except</span> <span class="n">NoReverseMatch</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.get_schema">
    <p>def <span class="ident">get_schema</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns a serialized form of the schema of the resource.</p>
<p>Calls <code>build_schema</code> to generate the data. This method only responds
to HTTP GET.</p>
<p>Should return a HttpResponse (200 OK).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.get_schema', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.get_schema" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a serialized form of the schema of the resource.</span>
<span class="sd">    Calls ``build_schema`` to generate the data. This method only responds</span>
<span class="sd">    to HTTP GET.</span>
<span class="sd">    Should return a HttpResponse (200 OK).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">method_check</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">allowed</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;get&#39;</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">throttle_check</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_throttled_access</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">authorized_read_detail</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">),</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_schema</span><span class="p">())</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.get_via_uri">
    <p>def <span class="ident">get_via_uri</span>(</p><p>self, uri, request=None)</p>
    </div>
    

    
  
    <div class="desc"><p>This pulls apart the salient bits of the URI and populates the
resource via a <code>obj_get</code>.</p>
<p>Optionally accepts a <code>request</code>.</p>
<p>If you need custom behavior based on other portions of the URI,
simply override this method.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.get_via_uri', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.get_via_uri" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_via_uri</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uri</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This pulls apart the salient bits of the URI and populates the</span>
<span class="sd">    resource via a ``obj_get``.</span>
<span class="sd">    Optionally accepts a ``request``.</span>
<span class="sd">    If you need custom behavior based on other portions of the URI,</span>
<span class="sd">    simply override this method.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="n">get_script_prefix</span><span class="p">()</span>
    <span class="n">chomped_uri</span> <span class="o">=</span> <span class="n">uri</span>
    <span class="k">if</span> <span class="n">prefix</span> <span class="ow">and</span> <span class="n">chomped_uri</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">prefix</span><span class="p">):</span>
        <span class="n">chomped_uri</span> <span class="o">=</span> <span class="n">chomped_uri</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:]</span>
    <span class="c1"># We mangle the path a bit further &amp; run URL resolution against *only*</span>
    <span class="c1"># the current class. This ought to prevent bad URLs from resolving to</span>
    <span class="c1"># incorrect data.</span>
    <span class="n">found_at</span> <span class="o">=</span> <span class="n">chomped_uri</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">found_at</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">NotFound</span><span class="p">(</span><span class="s2">&quot;An incorrect URL was provided &#39;</span><span class="si">%s</span><span class="s2">&#39; for the &#39;</span><span class="si">%s</span><span class="s2">&#39; resource.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">))</span>
    <span class="n">chomped_uri</span> <span class="o">=</span> <span class="n">chomped_uri</span><span class="p">[</span><span class="n">found_at</span><span class="p">:]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">url_resolver</span> <span class="ow">in</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;urls&#39;</span><span class="p">,</span> <span class="p">[]):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">url_resolver</span><span class="o">.</span><span class="n">resolve</span><span class="p">(</span><span class="n">chomped_uri</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">view</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span> <span class="o">=</span> <span class="n">result</span>
                <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Resolver404</span><span class="p">(</span><span class="s2">&quot;URI not found in &#39;self.urls&#39;.&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">Resolver404</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">NotFound</span><span class="p">(</span><span class="s2">&quot;The URL provided &#39;</span><span class="si">%s</span><span class="s2">&#39; was not a link to a valid resource.&quot;</span> <span class="o">%</span> <span class="n">uri</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.hydrate">
    <p>def <span class="ident">hydrate</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>A hook to allow an initial manipulation of data before all methods/fields
have built out the hydrated data.</p>
<p>Useful if you need to access more than one hydrated field or want
to annotate on additional data.</p>
<p>Must return the modified bundle.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.hydrate', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.hydrate" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">hydrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to allow an initial manipulation of data before all methods/fields</span>
<span class="sd">    have built out the hydrated data.</span>
<span class="sd">    Useful if you need to access more than one hydrated field or want</span>
<span class="sd">    to annotate on additional data.</span>
<span class="sd">    Must return the modified bundle.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.hydrate_m2m">
    <p>def <span class="ident">hydrate_m2m</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Populate the ManyToMany data on the instance.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.hydrate_m2m', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.hydrate_m2m" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">hydrate_m2m</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Populate the ManyToMany data on the instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrationError</span><span class="p">(</span><span class="s2">&quot;You must call &#39;full_hydrate&#39; before attempting to run &#39;hydrate_m2m&#39; on </span><span class="si">%r</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span>
            <span class="c1"># Note that we only hydrate the data, leaving the instance</span>
            <span class="c1"># unmodified. It&#39;s up to the user&#39;s code to handle this.</span>
            <span class="c1"># The ``ModelResource`` provides a working baseline</span>
            <span class="c1"># in this regard.</span>
            <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">hydrate_m2m</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;hydrate_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
            <span class="n">method</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.is_authenticated">
    <p>def <span class="ident">is_authenticated</span>(</p><p>self, request)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking if the user is authenticated and dealing with
unauthenticated users.</p>
<p>Mostly a hook, this uses class assigned to <code>authentication</code> from
<code>Resource._meta</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.is_authenticated', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.is_authenticated" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">is_authenticated</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking if the user is authenticated and dealing with</span>
<span class="sd">    unauthenticated users.</span>
<span class="sd">    Mostly a hook, this uses class assigned to ``authentication`` from</span>
<span class="sd">    ``Resource._meta``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Authenticate the request as needed.</span>
    <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authentication</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">auth_result</span><span class="p">,</span> <span class="n">HttpResponse</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">auth_result</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">auth_result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpUnauthorized</span><span class="p">())</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.is_valid">
    <p>def <span class="ident">is_valid</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking if the data provided by the user is valid.</p>
<p>Mostly a hook, this uses class assigned to <code>validation</code> from
<code>Resource._meta</code>.</p>
<p>If validation fails, an error is raised with the error messages
serialized inside it.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.is_valid', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.is_valid" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking if the data provided by the user is valid.</span>
<span class="sd">    Mostly a hook, this uses class assigned to ``validation`` from</span>
<span class="sd">    ``Resource._meta``.</span>
<span class="sd">    If validation fails, an error is raised with the error messages</span>
<span class="sd">    serialized inside it.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">validation</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">errors</span><span class="p">:</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">errors</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">errors</span>
        <span class="k">return</span> <span class="bp">False</span>
    <span class="k">return</span> <span class="bp">True</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.log_throttled_access">
    <p>def <span class="ident">log_throttled_access</span>(</p><p>self, request)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles the recording of the user's access for throttling purposes.</p>
<p>Mostly a hook, this uses class assigned to <code>throttle</code> from
<code>Resource._meta</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.log_throttled_access', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.log_throttled_access" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">log_throttled_access</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles the recording of the user&#39;s access for throttling purposes.</span>
<span class="sd">    Mostly a hook, this uses class assigned to ``throttle`` from</span>
<span class="sd">    ``Resource._meta``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">request_method</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">throttle</span><span class="o">.</span><span class="n">accessed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authentication</span><span class="o">.</span><span class="n">get_identifier</span><span class="p">(</span><span class="n">request</span><span class="p">),</span> <span class="n">url</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">get_full_path</span><span class="p">(),</span> <span class="n">request_method</span><span class="o">=</span><span class="n">request_method</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.lookup_kwargs_with_identifiers">
    <p>def <span class="ident">lookup_kwargs_with_identifiers</span>(</p><p>self, bundle, kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Kwargs here represent uri identifiers Ex: /repos/<user_id>/<repo_name>/
We need to turn those identifiers into Python objects for generating
lookup parameters that can find them in the DB</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.lookup_kwargs_with_identifiers', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.lookup_kwargs_with_identifiers" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">lookup_kwargs_with_identifiers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Kwargs here represent uri identifiers Ex: /repos/&lt;user_id&gt;/&lt;repo_name&gt;/</span>
<span class="sd">    We need to turn those identifiers into Python objects for generating</span>
<span class="sd">    lookup parameters that can find them in the DB</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lookup_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">)</span><span class="o">.</span><span class="n">model</span><span class="p">()</span>
    <span class="c1"># Override data values, we rely on uri identifiers</span>
    <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="c1"># We&#39;re going to manually hydrate, as opposed to calling</span>
    <span class="c1"># ``full_hydrate``, to ensure we don&#39;t try to flesh out related</span>
    <span class="c1"># resources &amp; keep things speedy.</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">identifier</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">identifier</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">:</span>
            <span class="n">lookup_kwargs</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span>
            <span class="k">continue</span>
        <span class="n">field_object</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span>
        <span class="c1"># Skip readonly or related fields.</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">readonly</span> <span class="ow">is</span> <span class="bp">True</span> <span class="ow">or</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_related</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># Check for an optional method to do further hydration.</span>
        <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;hydrate_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">identifier</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
            <span class="n">bundle</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="n">lookup_kwargs</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
    <span class="k">return</span> <span class="n">lookup_kwargs</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.method_check">
    <p>def <span class="ident">method_check</span>(</p><p>self, request, allowed=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Ensures that the HTTP method used on the request is allowed to be
handled by the resource.</p>
<p>Takes an <code>allowed</code> parameter, which should be a list of lowercase
HTTP methods to check against. Usually, this looks like::</p>
<div class="codehilite"><pre><span></span># The most generic lookup.
self.method_check(request, self._meta.allowed_methods)

# A lookup against what&#39;s allowed for list-type methods.
self.method_check(request, self._meta.list_allowed_methods)

# A useful check when creating a new endpoint that only handles
# GET.
self.method_check(request, [&#39;get&#39;])
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.method_check', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.method_check" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">method_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">allowed</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Ensures that the HTTP method used on the request is allowed to be</span>
<span class="sd">    handled by the resource.</span>
<span class="sd">    Takes an ``allowed`` parameter, which should be a list of lowercase</span>
<span class="sd">    HTTP methods to check against. Usually, this looks like::</span>
<span class="sd">        # The most generic lookup.</span>
<span class="sd">        self.method_check(request, self._meta.allowed_methods)</span>
<span class="sd">        # A lookup against what&#39;s allowed for list-type methods.</span>
<span class="sd">        self.method_check(request, self._meta.list_allowed_methods)</span>
<span class="sd">        # A useful check when creating a new endpoint that only handles</span>
<span class="sd">        # GET.</span>
<span class="sd">        self.method_check(request, [&#39;get&#39;])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">allowed</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">allowed</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">request_method</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">allows</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">meth</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">allowed</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">request_method</span> <span class="o">==</span> <span class="s2">&quot;options&quot;</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="n">allows</span><span class="p">)</span>
        <span class="n">response</span><span class="p">[</span><span class="s1">&#39;Allow&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">allows</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">request_method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpMethodNotAllowed</span><span class="p">(</span><span class="n">allows</span><span class="p">)</span>
        <span class="n">response</span><span class="p">[</span><span class="s1">&#39;Allow&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">allows</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">request_method</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.obj_create">
    <p>def <span class="ident">obj_create</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A ORM-specific implementation of <code>obj_create</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.obj_create', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.obj_create" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_create``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.obj_delete">
    <p>def <span class="ident">obj_delete</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A ORM-specific implementation of <code>obj_delete</code>.</p>
<p>Takes optional <code>kwargs</code>, which are used to narrow the query to find
the instance.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.obj_delete', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.obj_delete" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_delete``.</span>
<span class="sd">    Takes optional ``kwargs``, which are used to narrow the query to find</span>
<span class="sd">    the instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="s1">&#39;delete&#39;</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ObjectDoesNotExist</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NotFound</span><span class="p">(</span><span class="s2">&quot;A model instance matching the provided arguments could not be found.&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">authorized_delete_detail</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">),</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.obj_delete_list">
    <p>def <span class="ident">obj_delete_list</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A ORM-specific implementation of <code>obj_delete_list</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.obj_delete_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.obj_delete_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_delete_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_delete_list``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">objects_to_delete</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">deletable_objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">authorized_delete_list</span><span class="p">(</span><span class="n">objects_to_delete</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">deletable_objects</span><span class="p">,</span> <span class="s1">&#39;delete&#39;</span><span class="p">):</span>
        <span class="c1"># It&#39;s likely a ``QuerySet``. Call ``.delete()`` for efficiency.</span>
        <span class="n">deletable_objects</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">authed_obj</span> <span class="ow">in</span> <span class="n">deletable_objects</span><span class="p">:</span>
            <span class="n">authed_obj</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.obj_delete_list_for_update">
    <p>def <span class="ident">obj_delete_list_for_update</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A ORM-specific implementation of <code>obj_delete_list_for_update</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.obj_delete_list_for_update', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.obj_delete_list_for_update" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_delete_list_for_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_delete_list_for_update``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">objects_to_delete</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">deletable_objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">authorized_update_list</span><span class="p">(</span><span class="n">objects_to_delete</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">deletable_objects</span><span class="p">,</span> <span class="s1">&#39;delete&#39;</span><span class="p">):</span>
        <span class="c1"># It&#39;s likely a ``QuerySet``. Call ``.delete()`` for efficiency.</span>
        <span class="n">deletable_objects</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">authed_obj</span> <span class="ow">in</span> <span class="n">deletable_objects</span><span class="p">:</span>
            <span class="n">authed_obj</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.obj_get">
    <p>def <span class="ident">obj_get</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A ORM-specific implementation of <code>obj_get</code>.</p>
<p>Takes optional <code>kwargs</code>, which are used to narrow the query to find
the instance.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.obj_get', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.obj_get" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_get``.</span>
<span class="sd">    Takes optional ``kwargs``, which are used to narrow the query to find</span>
<span class="sd">    the instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># prevents FieldError when looking up nested resources containing extra data</span>
    <span class="n">field_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">get_all_field_names</span><span class="p">()</span>
    <span class="n">field_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;pk&#39;</span><span class="p">)</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">field_names</span><span class="p">}</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">object_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">stringified_kwargs</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">=</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">object_list</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="o">.</span><span class="n">DoesNotExist</span><span class="p">(</span><span class="s2">&quot;Couldn&#39;t find an instance of &#39;</span><span class="si">%s</span><span class="s2">&#39; which matched &#39;</span><span class="si">%s</span><span class="s2">&#39;.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">stringified_kwargs</span><span class="p">))</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">object_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MultipleObjectsReturned</span><span class="p">(</span><span class="s2">&quot;More than &#39;</span><span class="si">%s</span><span class="s2">&#39; matched &#39;</span><span class="si">%s</span><span class="s2">&#39;.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">stringified_kwargs</span><span class="p">))</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">object_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">authorized_read_detail</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">NotFound</span><span class="p">(</span><span class="s2">&quot;Invalid resource lookup data provided (mismatched type).&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.obj_get_list">
    <p>def <span class="ident">obj_get_list</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A ORM-specific implementation of <code>obj_get_list</code>.</p>
<p>Takes an optional <code>request</code> object, whose <code>GET</code> dictionary can be
used to narrow the query.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.obj_get_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.obj_get_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_get_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_get_list``.</span>
<span class="sd">    Takes an optional ``request`` object, whose ``GET`` dictionary can be</span>
<span class="sd">    used to narrow the query.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">filters</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;GET&#39;</span><span class="p">):</span>
        <span class="c1"># Grab a mutable copy.</span>
        <span class="n">filters</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="c1"># Update with the provided kwargs.</span>
    <span class="n">filters</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">applicable_filters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_filters</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_filters</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">,</span> <span class="n">applicable_filters</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">authorized_read_list</span><span class="p">(</span><span class="n">objects</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">BadRequest</span><span class="p">(</span><span class="s2">&quot;Invalid resource lookup data provided (mismatched type).&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.obj_update">
    <p>def <span class="ident">obj_update</span>(</p><p>self, bundle, skip_errors=False, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A ORM-specific implementation of <code>obj_update</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.obj_update', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.obj_update" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">skip_errors</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_update``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bundle_detail_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bundle_detail_data</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="n">arg_detail_data</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">bundle_detail_data</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">arg_detail_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="nb">str</span><span class="p">(</span><span class="n">bundle_detail_data</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">str</span><span class="p">(</span><span class="n">arg_detail_data</span><span class="p">)):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">lookup_kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lookup_kwargs_with_identifiers</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="c1"># if there is trouble hydrating the data, fall back to just</span>
            <span class="c1"># using kwargs by itself (usually it only contains a &quot;pk&quot; key</span>
            <span class="c1"># and this will work fine.</span>
            <span class="n">lookup_kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">lookup_kwargs</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ObjectDoesNotExist</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NotFound</span><span class="p">(</span><span class="s2">&quot;A model instance matching the provided arguments could not be found.&quot;</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="n">skip_errors</span><span class="o">=</span><span class="n">skip_errors</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.override_urls">
    <p>def <span class="ident">override_urls</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Deprecated. Will be removed by v1.0.0. Please use <code>prepend_urls</code> instead.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.override_urls', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.override_urls" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">override_urls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Deprecated. Will be removed by v1.0.0. Please use ``prepend_urls`` instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.patch_detail">
    <p>def <span class="ident">patch_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Updates a resource in-place.</p>
<p>Calls <code>obj_update</code>.</p>
<p>If the resource is updated, return <code>HttpAccepted</code> (202 Accepted).
If the resource did not exist, return <code>HttpNotFound</code> (404 Not Found).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.patch_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.patch_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">patch_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates a resource in-place.</span>
<span class="sd">    Calls ``obj_update``.</span>
<span class="sd">    If the resource is updated, return ``HttpAccepted`` (202 Accepted).</span>
<span class="sd">    If the resource did not exist, return ``HttpNotFound`` (404 Not Found).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">request</span> <span class="o">=</span> <span class="n">convert_post_to_patch</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="n">basic_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="c1"># We want to be able to validate the update, but we can&#39;t just pass</span>
    <span class="c1"># the partial data into the validator since all data needs to be</span>
    <span class="c1"># present. Instead, we basically simulate a PUT by pulling out the</span>
    <span class="c1"># original data and updating it in-place.</span>
    <span class="c1"># So first pull out the original object. This is essentially</span>
    <span class="c1"># ``get_detail``.</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cached_obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">basic_bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="k">except</span> <span class="n">ObjectDoesNotExist</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNotFound</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">MultipleObjectsReturned</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpMultipleChoices</span><span class="p">(</span><span class="s2">&quot;More than one resource is found at this URI.&quot;</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="c1"># Now update the bundle in-place.</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">update_in_place</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">deserialized</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">always_return_data</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpAccepted</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Invalidate prefetched_objects_cache for bundled object</span>
        <span class="c1"># because we might have changed a prefetched field</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_prefetched_objects_cache</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpAccepted</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.patch_list">
    <p>def <span class="ident">patch_list</span>(</p><p>*args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>An ORM-specific implementation of <code>patch_list</code>.</p>
<p>Necessary because PATCH should be atomic (all-success or all-fail)
and the only way to do this neatly is at the database level.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.patch_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.patch_list" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@wraps</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">assigned</span><span class="o">=</span><span class="n">available_attrs</span><span class="p">(</span><span class="n">func</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">with</span> <span class="bp">self</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.post_detail">
    <p>def <span class="ident">post_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Creates a new subcollection of the resource under a resource.</p>
<p>This is not implemented by default because most people's data models
aren't self-referential.</p>
<p>If a new resource is created, return <code>HttpCreated</code> (201 Created).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.post_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.post_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">post_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a new subcollection of the resource under a resource.</span>
<span class="sd">    This is not implemented by default because most people&#39;s data models</span>
<span class="sd">    aren&#39;t self-referential.</span>
<span class="sd">    If a new resource is created, return ``HttpCreated`` (201 Created).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNotImplemented</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.post_list">
    <p>def <span class="ident">post_list</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Creates a new resource/object with the provided data.</p>
<p>Calls <code>obj_create</code> with the provided data and returns a response
with the new resource's location.</p>
<p>If a new resource is created, return <code>HttpCreated</code> (201 Created).
If <code>Meta.always_return_data = True</code>, there will be a populated body
of serialized data.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.post_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.post_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">post_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a new resource/object with the provided data.</span>
<span class="sd">    Calls ``obj_create`` with the provided data and returns a response</span>
<span class="sd">    with the new resource&#39;s location.</span>
<span class="sd">    If a new resource is created, return ``HttpCreated`` (201 Created).</span>
<span class="sd">    If ``Meta.always_return_data = True``, there will be a populated body</span>
<span class="sd">    of serialized data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">))</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_deserialized_detail_data</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">deserialized</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dict_strip_unicode_keys</span><span class="p">(</span><span class="n">deserialized</span><span class="p">),</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_create</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="n">location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_uri</span><span class="p">(</span><span class="n">updated_bundle</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">always_return_data</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpCreated</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">updated_bundle</span><span class="p">)</span>
        <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpCreated</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.prepend_urls">
    <p>def <span class="ident">prepend_urls</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>A hook for adding your own URLs or matching before the default URLs.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.prepend_urls', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.prepend_urls" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">prepend_urls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook for adding your own URLs or matching before the default URLs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.put_detail">
    <p>def <span class="ident">put_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Either updates an existing resource or creates a new one with the
provided data.</p>
<p>Calls <code>obj_update</code> with the provided data first, but falls back to
<code>obj_create</code> if the object does not already exist.</p>
<p>If a new resource is created, return <code>HttpCreated</code> (201 Created).
If <code>Meta.always_return_data = True</code>, there will be a populated body
of serialized data.</p>
<p>If an existing resource is modified and
<code>Meta.always_return_data = False</code> (default), return <code>HttpNoContent</code>
(204 No Content).
If an existing resource is modified and
<code>Meta.always_return_data = True</code>, return <code>HttpAccepted</code> (200
OK).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.put_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.put_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">put_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Either updates an existing resource or creates a new one with the</span>
<span class="sd">    provided data.</span>
<span class="sd">    Calls ``obj_update`` with the provided data first, but falls back to</span>
<span class="sd">    ``obj_create`` if the object does not already exist.</span>
<span class="sd">    If a new resource is created, return ``HttpCreated`` (201 Created).</span>
<span class="sd">    If ``Meta.always_return_data = True``, there will be a populated body</span>
<span class="sd">    of serialized data.</span>
<span class="sd">    If an existing resource is modified and</span>
<span class="sd">    ``Meta.always_return_data = False`` (default), return ``HttpNoContent``</span>
<span class="sd">    (204 No Content).</span>
<span class="sd">    If an existing resource is modified and</span>
<span class="sd">    ``Meta.always_return_data = True``, return ``HttpAccepted`` (200</span>
<span class="sd">    OK).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">))</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_deserialized_detail_data</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">deserialized</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dict_strip_unicode_keys</span><span class="p">(</span><span class="n">deserialized</span><span class="p">),</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_update</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">always_return_data</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNoContent</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Invalidate prefetched_objects_cache for bundled object</span>
            <span class="c1"># because we might have changed a prefetched field</span>
            <span class="n">updated_bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_prefetched_objects_cache</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">updated_bundle</span><span class="p">)</span>
            <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="p">(</span><span class="n">NotFound</span><span class="p">,</span> <span class="n">MultipleObjectsReturned</span><span class="p">):</span>
        <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_create</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="n">location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_uri</span><span class="p">(</span><span class="n">updated_bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">always_return_data</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpCreated</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">updated_bundle</span><span class="p">)</span>
            <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpCreated</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.put_list">
    <p>def <span class="ident">put_list</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Replaces a collection of resources with another collection.</p>
<p>Calls <code>delete_list</code> to clear out the collection then <code>obj_create</code>
with the provided the data to create the new collection.</p>
<p>Return <code>HttpNoContent</code> (204 No Content) if
<code>Meta.always_return_data = False</code> (default).</p>
<p>Return <code>HttpAccepted</code> (200 OK) if
<code>Meta.always_return_data = True</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.put_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.put_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">put_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Replaces a collection of resources with another collection.</span>
<span class="sd">    Calls ``delete_list`` to clear out the collection then ``obj_create``</span>
<span class="sd">    with the provided the data to create the new collection.</span>
<span class="sd">    Return ``HttpNoContent`` (204 No Content) if</span>
<span class="sd">    ``Meta.always_return_data = False`` (default).</span>
<span class="sd">    Return ``HttpAccepted`` (200 OK) if</span>
<span class="sd">    ``Meta.always_return_data = True``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">))</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_deserialized_list_data</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">deserialized</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">deserialized</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">BadRequest</span><span class="p">(</span><span class="s2">&quot;Invalid data sent: missing &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">)</span>
    <span class="n">basic_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">obj_delete_list_for_update</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">basic_bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="n">bundles_seen</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">object_data</span> <span class="ow">in</span> <span class="n">deserialized</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">]:</span>
        <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dict_strip_unicode_keys</span><span class="p">(</span><span class="n">object_data</span><span class="p">),</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
        <span class="c1"># Attempt to be transactional, deleting any previously created</span>
        <span class="c1"># objects if validation fails.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">obj_create</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
            <span class="n">bundles_seen</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ImmediateHttpResponse</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rollback</span><span class="p">(</span><span class="n">bundles_seen</span><span class="p">)</span>
            <span class="k">raise</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">always_return_data</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNoContent</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">to_be_serialized</span> <span class="o">=</span> <span class="p">{</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">:</span> <span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">for_list</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">bundles_seen</span>
            <span class="p">]</span>
        <span class="p">}</span>
        <span class="n">to_be_serialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_list_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">to_be_serialized</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">to_be_serialized</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.remove_api_resource_names">
    <p>def <span class="ident">remove_api_resource_names</span>(</p><p>self, url_dict)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a dictionary of regex matches from a URLconf, removes
<code>api_name</code> and/or <code>resource_name</code> if found.</p>
<p>This is useful for converting URLconf matches into something suitable
for data lookup. For example::</p>
<div class="codehilite"><pre><span></span>Model.objects.filter(**self.remove_api_resource_names(matches))
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.remove_api_resource_names', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.remove_api_resource_names" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">remove_api_resource_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url_dict</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a dictionary of regex matches from a URLconf, removes</span>
<span class="sd">    ``api_name`` and/or ``resource_name`` if found.</span>
<span class="sd">    This is useful for converting URLconf matches into something suitable</span>
<span class="sd">    for data lookup. For example::</span>
<span class="sd">        Model.objects.filter(**self.remove_api_resource_names(matches))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kwargs_subset</span> <span class="o">=</span> <span class="n">url_dict</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;api_name&#39;</span><span class="p">,</span> <span class="s1">&#39;resource_name&#39;</span><span class="p">]:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">del</span><span class="p">(</span><span class="n">kwargs_subset</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">pass</span>
    <span class="k">return</span> <span class="n">kwargs_subset</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.resource_uri_kwargs">
    <p>def <span class="ident">resource_uri_kwargs</span>(</p><p>self, bundle_or_obj=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Builds a dictionary of kwargs to help generate URIs.</p>
<p>Automatically provides the <code>Resource.Meta.resource_name</code> (and
optionally the <code>Resource.Meta.api_name</code> if populated by an <code>Api</code>
object).</p>
<p>If the <code>bundle_or_obj</code> argument is provided, it calls
<code>Resource.detail_uri_kwargs</code> for additional bits to create</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.resource_uri_kwargs', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.resource_uri_kwargs" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">resource_uri_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle_or_obj</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Builds a dictionary of kwargs to help generate URIs.</span>
<span class="sd">    Automatically provides the ``Resource.Meta.resource_name`` (and</span>
<span class="sd">    optionally the ``Resource.Meta.api_name`` if populated by an ``Api``</span>
<span class="sd">    object).</span>
<span class="sd">    If the ``bundle_or_obj`` argument is provided, it calls</span>
<span class="sd">    ``Resource.detail_uri_kwargs`` for additional bits to create</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;resource_name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;api_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span>
    <span class="k">if</span> <span class="n">bundle_or_obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">detail_uri_kwargs</span><span class="p">(</span><span class="n">bundle_or_obj</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">kwargs</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.rollback">
    <p>def <span class="ident">rollback</span>(</p><p>self, bundles)</p>
    </div>
    

    
  
    <div class="desc"><p>A ORM-specific implementation of <code>rollback</code>.</p>
<p>Given the list of bundles, delete all models pertaining to those
bundles.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.rollback', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.rollback" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">rollback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundles</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``rollback``.</span>
<span class="sd">    Given the list of bundles, delete all models pertaining to those</span>
<span class="sd">    bundles.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">bundle</span> <span class="ow">in</span> <span class="n">bundles</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bundle_detail_data</span><span class="p">(</span><span class="n">bundle</span><span class="p">):</span>
            <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.save">
    <p>def <span class="ident">save</span>(</p><p>self, bundle, skip_errors=False)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.save', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.save" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">skip_errors</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">via_uri</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">bundle</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">errors</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">skip_errors</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">error_response</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="o">.</span><span class="n">errors</span><span class="p">))</span>
    <span class="c1"># Check if they&#39;re authorized.</span>
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">pk</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">authorized_update_detail</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">),</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">authorized_create_detail</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">),</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="c1"># Save FKs just in case.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">save_related</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="c1"># Save the main object.</span>
    <span class="n">obj_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_identifier</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">obj_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">bundle</span><span class="o">.</span><span class="n">objects_saved</span> <span class="ow">or</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_state</span><span class="o">.</span><span class="n">adding</span><span class="p">:</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">objects_saved</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">obj_id</span><span class="p">)</span>
    <span class="c1"># Now pick up the M2M bits.</span>
    <span class="n">m2m_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hydrate_m2m</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">save_m2m</span><span class="p">(</span><span class="n">m2m_bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.save_m2m">
    <p>def <span class="ident">save_m2m</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles the saving of related M2M data.</p>
<p>Due to the way Django works, the M2M data must be handled after the
main instance, which is why this isn't a part of the main <code>save</code> bits.</p>
<p>Currently slightly inefficient in that it will clear out the whole
relation and recreate the related data as needed.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.save_m2m', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.save_m2m" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">save_m2m</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles the saving of related M2M data.</span>
<span class="sd">    Due to the way Django works, the M2M data must be handled after the</span>
<span class="sd">    main instance, which is why this isn&#39;t a part of the main ``save`` bits.</span>
<span class="sd">    Currently slightly inefficient in that it will clear out the whole</span>
<span class="sd">    relation and recreate the related data as needed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">readonly</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># Get the manager.</span>
        <span class="n">related_mngr</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
            <span class="n">related_mngr</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">):</span>
            <span class="n">related_mngr</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">related_mngr</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">related_mngr</span><span class="p">,</span> <span class="s1">&#39;clear&#39;</span><span class="p">):</span>
            <span class="c1"># FIXME: Dupe the original bundle, copy in the new object &amp;</span>
            <span class="c1">#        check the perms on that (using the related resource)?</span>
            <span class="c1"># Clear it out, just to be safe.</span>
            <span class="n">related_mngr</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">related_objs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">related_bundle</span> <span class="ow">in</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">field_name</span><span class="p">]:</span>
            <span class="n">related_resource</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">get_related_resource</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
            <span class="c1"># Only build &amp; save if there&#39;s data, not just a URI.</span>
            <span class="n">updated_related_bundle</span> <span class="o">=</span> <span class="n">related_resource</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span>
                <span class="n">obj</span><span class="o">=</span><span class="n">related_bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="n">related_bundle</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                <span class="n">request</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">,</span>
                <span class="n">objects_saved</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">objects_saved</span><span class="p">,</span>
                <span class="n">via_uri</span><span class="o">=</span><span class="n">related_bundle</span><span class="o">.</span><span class="n">via_uri</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">related_resource</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">updated_related_bundle</span><span class="p">)</span>
            <span class="n">related_objs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">updated_related_bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
        <span class="n">related_mngr</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="o">*</span><span class="n">related_objs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.save_related">
    <p>def <span class="ident">save_related</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles the saving of related non-M2M data.</p>
<p>Calling assigning <code>child.parent = parent</code> &amp; then calling
<code>Child.save</code> isn't good enough to make sure the <code>parent</code>
is saved.</p>
<p>To get around this, we go through all our related fields &amp;
call <code>save</code> on them if they have related, non-M2M data.
M2M data is handled by the <code>ModelResource.save_m2m</code> method.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.save_related', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.save_related" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">save_related</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles the saving of related non-M2M data.</span>
<span class="sd">    Calling assigning ``child.parent = parent`` &amp; then calling</span>
<span class="sd">    ``Child.save`` isn&#39;t good enough to make sure the ``parent``</span>
<span class="sd">    is saved.</span>
<span class="sd">    To get around this, we go through all our related fields &amp;</span>
<span class="sd">    call ``save`` on them if they have related, non-M2M data.</span>
<span class="sd">    M2M data is handled by the ``ModelResource.save_m2m`` method.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_related</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">readonly</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">blank</span> <span class="ow">and</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># Get the object.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">related_obj</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ObjectDoesNotExist</span><span class="p">:</span>
            <span class="c1"># Django 1.8: unset related objects default to None, no error</span>
            <span class="n">related_obj</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="c1"># We didn&#39;t get it, so maybe we created it but haven&#39;t saved it</span>
        <span class="k">if</span> <span class="n">related_obj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">related_obj</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">related_objects_to_save</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">related_name</span><span class="p">:</span>
            <span class="c1"># this might be a reverse relation, so we need to save this</span>
            <span class="c1"># model, attach it to the related object, and save the related</span>
            <span class="c1"># object.</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bundle_detail_data</span><span class="p">(</span><span class="n">bundle</span><span class="p">):</span>
                <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">related_obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">related_name</span><span class="p">,</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
        <span class="n">related_resource</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">get_related_resource</span><span class="p">(</span><span class="n">related_obj</span><span class="p">)</span>
        <span class="c1"># Before we build the bundle &amp; try saving it, let&#39;s make sure we</span>
        <span class="c1"># haven&#39;t already saved it.</span>
        <span class="k">if</span> <span class="n">related_obj</span><span class="p">:</span>
            <span class="n">obj_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_identifier</span><span class="p">(</span><span class="n">related_obj</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">obj_id</span> <span class="ow">in</span> <span class="n">bundle</span><span class="o">.</span><span class="n">objects_saved</span><span class="p">:</span>
                <span class="c1"># It&#39;s already been saved. We&#39;re done here.</span>
                <span class="k">continue</span>
        <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_name</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">field_name</span><span class="p">],</span> <span class="s1">&#39;keys&#39;</span><span class="p">):</span>
                <span class="c1"># Only build &amp; save if there&#39;s data, not just a URI.</span>
                <span class="n">related_bundle</span> <span class="o">=</span> <span class="n">related_resource</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span>
                    <span class="n">obj</span><span class="o">=</span><span class="n">related_obj</span><span class="p">,</span>
                    <span class="n">data</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_name</span><span class="p">),</span>
                    <span class="n">request</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">,</span>
                    <span class="n">objects_saved</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">objects_saved</span>
                <span class="p">)</span>
                <span class="n">related_resource</span><span class="o">.</span><span class="n">full_hydrate</span><span class="p">(</span><span class="n">related_bundle</span><span class="p">)</span>
                <span class="n">related_resource</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">related_bundle</span><span class="p">)</span>
                <span class="n">related_obj</span> <span class="o">=</span> <span class="n">related_bundle</span><span class="o">.</span><span class="n">obj</span>
            <span class="k">elif</span> <span class="n">field_object</span><span class="o">.</span><span class="n">related_name</span><span class="p">:</span>
                <span class="c1"># This condition probably means a URI for a reverse</span>
                <span class="c1"># relation was provided.</span>
                <span class="n">related_bundle</span> <span class="o">=</span> <span class="n">related_resource</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span>
                    <span class="n">obj</span><span class="o">=</span><span class="n">related_obj</span><span class="p">,</span>
                    <span class="n">request</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">,</span>
                    <span class="n">objects_saved</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">objects_saved</span>
                <span class="p">)</span>
                <span class="n">related_resource</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">related_bundle</span><span class="p">)</span>
                <span class="n">related_obj</span> <span class="o">=</span> <span class="n">related_bundle</span><span class="o">.</span><span class="n">obj</span>
        <span class="k">if</span> <span class="n">related_obj</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="n">related_obj</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.serialize">
    <p>def <span class="ident">serialize</span>(</p><p>self, request, data, format, options=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a request, data and a desired format, produces a serialized
version suitable for transfer over the wire.</p>
<p>Mostly a hook, this uses the <code>Serializer</code> from <code>Resource._meta</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.serialize', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.serialize" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">format</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a request, data and a desired format, produces a serialized</span>
<span class="sd">    version suitable for transfer over the wire.</span>
<span class="sd">    Mostly a hook, this uses the ``Serializer`` from ``Resource._meta``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span> <span class="o">=</span> <span class="n">options</span> <span class="ow">or</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="s1">&#39;text/javascript&#39;</span> <span class="ow">in</span> <span class="n">format</span><span class="p">:</span>
        <span class="c1"># get JSONP callback name. default to &quot;callback&quot;</span>
        <span class="n">callback</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;callback&#39;</span><span class="p">,</span> <span class="s1">&#39;callback&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_valid_jsonp_callback_value</span><span class="p">(</span><span class="n">callback</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">BadRequest</span><span class="p">(</span><span class="s1">&#39;JSONP callback name is invalid.&#39;</span><span class="p">)</span>
        <span class="n">options</span><span class="p">[</span><span class="s1">&#39;callback&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">callback</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">serializer</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">format</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.should_skip_field">
    <p>def <span class="ident">should_skip_field</span>(</p><p>cls, field)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a Django model field, return if it should be included in the
contributed ApiFields.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.should_skip_field', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.should_skip_field" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">should_skip_field</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">field</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a Django model field, return if it should be included in the</span>
<span class="sd">    contributed ApiFields.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Ignore certain fields (related fields).</span>
    <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="s1">&#39;rel&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">return</span> <span class="bp">False</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.throttle_check">
    <p>def <span class="ident">throttle_check</span>(</p><p>self, request)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking if the user should be throttled.</p>
<p>Mostly a hook, this uses class assigned to <code>throttle</code> from
<code>Resource._meta</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.throttle_check', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.throttle_check" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">throttle_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking if the user should be throttled.</span>
<span class="sd">    Mostly a hook, this uses class assigned to ``throttle`` from</span>
<span class="sd">    ``Resource._meta``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">identifier</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authentication</span><span class="o">.</span><span class="n">get_identifier</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="c1"># Check to see if they should be throttled.</span>
    <span class="n">throttle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">throttle</span><span class="o">.</span><span class="n">should_be_throttled</span><span class="p">(</span><span class="n">identifier</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">throttle</span><span class="p">:</span>
        <span class="c1"># Throttle limit exceeded.</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpTooManyRequests</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">throttle</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">throttle</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="n">response</span><span class="p">[</span><span class="s1">&#39;Retry-After&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">throttle</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">throttle</span><span class="p">,</span> <span class="n">datetime</span><span class="p">):</span>
            <span class="n">response</span><span class="p">[</span><span class="s1">&#39;Retry-After&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">format_date_time</span><span class="p">(</span><span class="n">mktime</span><span class="p">(</span><span class="n">throttle</span><span class="o">.</span><span class="n">timetuple</span><span class="p">()))</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.unauthorized_result">
    <p>def <span class="ident">unauthorized_result</span>(</p><p>self, exception)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.unauthorized_result', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.unauthorized_result" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">unauthorized_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exception</span><span class="p">):</span>
    <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpUnauthorized</span><span class="p">())</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.update_in_place">
    <p>def <span class="ident">update_in_place</span>(</p><p>self, request, original_bundle, new_data)</p>
    </div>
    

    
  
    <div class="desc"><p>Update the object in original_bundle in-place using new_data.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.update_in_place', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.update_in_place" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">update_in_place</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">original_bundle</span><span class="p">,</span> <span class="n">new_data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Update the object in original_bundle in-place using new_data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">original_bundle</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">dict_strip_unicode_keys</span><span class="p">(</span><span class="n">new_data</span><span class="p">))</span>
    <span class="c1"># Now we&#39;ve got a bundle with the new data sitting in it and we&#39;re</span>
    <span class="c1"># we&#39;re basically in the same spot as a PUT request. SO the rest of this</span>
    <span class="c1"># function is cribbed from put_detail.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">alter_deserialized_detail_data</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">original_bundle</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bundle_detail_data</span><span class="p">(</span><span class="n">original_bundle</span><span class="p">),</span>
        <span class="s1">&#39;request&#39;</span><span class="p">:</span> <span class="n">request</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_update</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">original_bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.CompoundPropertiesResource.wrap_view">
    <p>def <span class="ident">wrap_view</span>(</p><p>self, view)</p>
    </div>
    

    
  
    <div class="desc"><p>Wraps methods so they can be called in a more functional way as well
as handling exceptions better.</p>
<p>Note that if <code>BadRequest</code> or an exception with a <code>response</code> attr
are seen, there is special handling to either present a message back
to the user or return the response traveling with the exception.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.CompoundPropertiesResource.wrap_view', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.CompoundPropertiesResource.wrap_view" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">wrap_view</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">view</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wraps methods so they can be called in a more functional way as well</span>
<span class="sd">    as handling exceptions better.</span>
<span class="sd">    Note that if ``BadRequest`` or an exception with a ``response`` attr</span>
<span class="sd">    are seen, there is special handling to either present a message back</span>
<span class="sd">    to the user or return the response traveling with the exception.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nd">@csrf_exempt</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">callback</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">view</span><span class="p">)</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">callback</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="c1"># Our response can vary based on a number of factors, use</span>
            <span class="c1"># the cache class to determine what we should ``Vary`` on so</span>
            <span class="c1"># caches won&#39;t return the wrong (cached) version.</span>
            <span class="n">varies</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="p">,</span> <span class="s2">&quot;varies&quot;</span><span class="p">,</span> <span class="p">[])</span>
            <span class="k">if</span> <span class="n">varies</span><span class="p">:</span>
                <span class="n">patch_vary_headers</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">varies</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">cacheable</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">response</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">cache_control</span><span class="p">():</span>
                    <span class="c1"># If the request is cacheable and we have a</span>
                    <span class="c1"># ``Cache-Control`` available then patch the header.</span>
                    <span class="n">patch_cache_control</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">cache_control</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">is_ajax</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">response</span><span class="o">.</span><span class="n">has_header</span><span class="p">(</span><span class="s2">&quot;Cache-Control&quot;</span><span class="p">):</span>
                <span class="c1"># IE excessively caches XMLHttpRequests, so we&#39;re disabling</span>
                <span class="c1"># the browser cache here.</span>
                <span class="c1"># See http://www.enhanceie.com/ie/bugs.asp for details.</span>
                <span class="n">patch_cache_control</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">no_cache</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">response</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">BadRequest</span><span class="p">,</span> <span class="n">fields</span><span class="o">.</span><span class="n">ApiFieldError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="n">sanitize</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s1">&#39;args&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">}</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpBadRequest</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="n">sanitize</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">messages</span><span class="p">)}</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpBadRequest</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1"># Prevent muting non-django&#39;s exceptions</span>
            <span class="c1"># i.e. RequestException from &#39;requests&#39; library</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s1">&#39;response&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">response</span><span class="p">,</span> <span class="n">HttpResponse</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">e</span><span class="o">.</span><span class="n">response</span>
            <span class="c1"># A real, non-expected exception.</span>
            <span class="c1"># Handle the case where the full traceback is more helpful</span>
            <span class="c1"># than the serialized error.</span>
            <span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">DEBUG</span> <span class="ow">and</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">settings</span><span class="p">,</span> <span class="s1">&#39;TASTYPIE_FULL_DEBUG&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
                <span class="k">raise</span>
            <span class="c1"># Re-raise the error to get a proper traceback when the error</span>
            <span class="c1"># happend during a test case</span>
            <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SERVER_NAME&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;testserver&#39;</span><span class="p">:</span>
                <span class="k">raise</span>
            <span class="c1"># Rather than re-raising, we&#39;re going to things similar to</span>
            <span class="c1"># what Django does. The difference is returning a serialized</span>
            <span class="c1"># error message.</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_500</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wrapper</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource" class="name">class <span class="ident">IndexingCBHCompoundBatchResource</span></p>
      
  
    <div class="desc"><p>Implementation of the BaseCBHCompoundBatchResource used to generate JSON objects to be
indexed in elasticsearch</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">IndexingCBHCompoundBatchResource</span><span class="p">(</span><span class="n">BaseCBHCompoundBatchResource</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Implementation of the BaseCBHCompoundBatchResource used to generate JSON objects to be</span>
<span class="sd">    indexed in elasticsearch&quot;&quot;&quot;</span>
    <span class="n">project</span> <span class="o">=</span> <span class="n">SimpleResourceURIField</span><span class="p">(</span><span class="n">ChemregProjectResource</span><span class="p">,</span> <span class="s2">&quot;project_id&quot;</span><span class="p">)</span>
    <span class="n">projectfull</span> <span class="o">=</span> <span class="n">SimpleResourceURIField</span><span class="p">(</span><span class="n">ChemregProjectResource</span><span class="p">,</span> <span class="s2">&quot;project_id&quot;</span><span class="p">)</span>
    <span class="n">userfull</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">DictField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="p">{})</span>

    <span class="k">def</span> <span class="nf">prepare_fields_for_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch_dicts</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Fields are stored as strings in hstore so convert the list or object fields back from JSON&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">bd</span> <span class="ow">in</span> <span class="n">batch_dicts</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">bd</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;related_molregno&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">):</span>
                <span class="n">bd</span><span class="p">[</span><span class="s2">&quot;related_molregno&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;compoundproperties&quot;</span> <span class="p">:</span> <span class="p">{}}</span>
            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">bd</span><span class="p">[</span><span class="s2">&quot;projectfull&quot;</span><span class="p">][</span><span class="s2">&quot;custom_field_config&quot;</span><span class="p">][</span><span class="s2">&quot;project_data_fields&quot;</span><span class="p">]:</span>
                
                <span class="k">if</span> <span class="n">field</span><span class="p">[</span><span class="s2">&quot;edit_schema&quot;</span><span class="p">][</span><span class="s2">&quot;properties&quot;</span><span class="p">][</span><span class="n">field</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]][</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;object&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">bd</span><span class="p">[</span><span class="s2">&quot;custom_fields&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="bp">False</span><span class="p">):</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">bd</span><span class="p">[</span><span class="s2">&quot;custom_fields&quot;</span><span class="p">][</span><span class="n">field</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">bd</span><span class="p">[</span><span class="s2">&quot;custom_fields&quot;</span><span class="p">][</span><span class="n">field</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]])</span>
                            <span class="k">continue</span>
                        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                            <span class="k">pass</span>
                    <span class="n">bd</span><span class="p">[</span><span class="s2">&quot;custom_fields&quot;</span><span class="p">][</span><span class="n">field</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">[</span><span class="s2">&quot;edit_schema&quot;</span><span class="p">][</span><span class="s2">&quot;properties&quot;</span><span class="p">][</span><span class="n">field</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]][</span><span class="s2">&quot;default&quot;</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">field</span><span class="p">[</span><span class="s2">&quot;edit_schema&quot;</span><span class="p">][</span><span class="s2">&quot;properties&quot;</span><span class="p">][</span><span class="n">field</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]][</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;array&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">bd</span><span class="p">[</span><span class="s2">&quot;custom_fields&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="bp">False</span><span class="p">):</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">bd</span><span class="p">[</span><span class="s2">&quot;custom_fields&quot;</span><span class="p">][</span><span class="n">field</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">bd</span><span class="p">[</span><span class="s2">&quot;custom_fields&quot;</span><span class="p">][</span><span class="n">field</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]])</span>
                            <span class="k">continue</span>
                        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                            <span class="k">pass</span>
                    <span class="n">bd</span><span class="p">[</span><span class="s2">&quot;custom_fields&quot;</span><span class="p">][</span><span class="n">field</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">elif</span> <span class="ow">not</span> <span class="n">bd</span><span class="p">[</span><span class="s2">&quot;custom_fields&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="bp">False</span><span class="p">):</span>
                    <span class="c1">#Clean up existing fields to a blank string</span>
                    <span class="n">bd</span><span class="p">[</span><span class="s2">&quot;custom_fields&quot;</span><span class="p">][</span><span class="n">field</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">[</span><span class="s2">&quot;edit_schema&quot;</span><span class="p">][</span><span class="s2">&quot;properties&quot;</span><span class="p">][</span><span class="n">field</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">batch_dicts</span>


    <span class="k">def</span> <span class="nf">index_batch_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">batch_list</span><span class="p">,</span> <span class="n">project_and_indexing_schemata</span><span class="p">,</span> <span class="n">refresh</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Index a list or queryset of compound batches into the elasticsearch indices (one index per project)&quot;&quot;&quot;</span>
        
        <span class="n">request</span><span class="o">.</span><span class="n">GET</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="p">[</span><span class="s2">&quot;limit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;10000&quot;</span>
        <span class="n">ids</span> <span class="o">=</span> <span class="p">{</span><span class="n">b</span><span class="o">.</span><span class="n">created_by_id</span>  <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">batch_list</span><span class="p">}</span>
        <span class="n">no_none</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">uid</span> <span class="ow">in</span> <span class="n">ids</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">uid</span><span class="p">:</span>
                <span class="n">no_none</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">uid</span><span class="p">))</span>
        <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="p">[</span><span class="s2">&quot;id__in&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">no_none</span><span class="p">)</span>
        <span class="n">user_list</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">UserResource</span><span class="p">()</span><span class="o">.</span><span class="n">get_list</span><span class="p">(</span><span class="n">request</span><span class="p">)</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">user_lookup</span> <span class="o">=</span> <span class="p">{</span> <span class="n">u</span><span class="p">[</span><span class="s2">&quot;resource_uri&quot;</span><span class="p">]:</span> <span class="n">u</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">user_list</span><span class="p">[</span><span class="s2">&quot;objects&quot;</span><span class="p">]</span> <span class="p">}</span>
        <span class="n">bundles</span> <span class="o">=</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">),</span> <span class="n">for_list</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">batch_list</span>
        <span class="p">]</span>

        <span class="c1">#retrieve schemas which tell the elasticsearch request which fields to index for each object (we avoid deserializing a single custom field config more than once)</span>
        <span class="c1">#Now make the schema list parallel to the batches list</span>
        <span class="n">batch_dicts</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Meta</span><span class="o">.</span><span class="n">serializer</span><span class="o">.</span><span class="n">to_simple</span><span class="p">(</span><span class="n">bun</span><span class="p">,</span> <span class="p">{})</span> <span class="k">for</span> <span class="n">bun</span> <span class="ow">in</span> <span class="n">bundles</span><span class="p">]</span>
        <span class="n">batch_dicts</span><span class="p">,</span> <span class="n">indexing_schemata</span> <span class="o">=</span> <span class="n">add_cached_projects_to_batch_list</span><span class="p">(</span><span class="n">batch_dicts</span><span class="p">,</span> <span class="n">project_and_indexing_schemata</span><span class="p">)</span>
        <span class="n">batch_dicts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prepare_fields_for_index</span><span class="p">(</span><span class="n">batch_dicts</span><span class="p">)</span>

        <span class="n">project_data_field_sets</span> <span class="o">=</span> <span class="p">[</span><span class="n">batch_dict</span><span class="p">[</span><span class="s2">&quot;projectfull&quot;</span><span class="p">][</span><span class="s2">&quot;custom_field_config&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;project_data_fields&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">batch_dict</span> <span class="ow">in</span> <span class="n">batch_dicts</span><span class="p">]</span>
        <span class="n">tab_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">batch_dict</span><span class="p">[</span><span class="s2">&quot;projectfull&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;tabular_data_schema&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">batch_dict</span> <span class="ow">in</span> <span class="n">batch_dicts</span><span class="p">]</span>

        <span class="n">index_names</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">batch_dicts</span><span class="p">:</span>
            <span class="n">batch</span><span class="p">[</span><span class="s2">&quot;projectfull&quot;</span><span class="p">][</span><span class="s2">&quot;custom_field_config&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="s2">&quot;projectfull&quot;</span><span class="p">][</span><span class="s2">&quot;custom_field_config&quot;</span><span class="p">][</span><span class="s2">&quot;resource_uri&quot;</span><span class="p">]</span>
            <span class="n">index_name</span> <span class="o">=</span> <span class="n">elasticsearch_client</span><span class="o">.</span><span class="n">get_project_index_name</span><span class="p">(</span><span class="n">batch</span><span class="p">[</span><span class="s2">&quot;projectfull&quot;</span><span class="p">][</span><span class="s2">&quot;id&quot;</span><span class="p">])</span>
            <span class="n">index_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">index_name</span><span class="p">)</span>
            <span class="n">batch</span><span class="p">[</span><span class="s2">&quot;userfull&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">user_lookup</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">batch</span><span class="p">[</span><span class="s2">&quot;creator&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s2">&quot;display_name&quot;</span> <span class="p">:</span> <span class="s2">&quot;User Deleted&quot;</span><span class="p">})</span>
        
        <span class="n">batch_dicts</span> <span class="o">=</span> <span class="n">elasticsearch_client</span><span class="o">.</span><span class="n">index_dataset</span><span class="p">(</span><span class="n">batch_dicts</span><span class="p">,</span> <span class="n">indexing_schemata</span><span class="p">,</span> <span class="n">index_names</span><span class="p">,</span> <span class="n">refresh</span><span class="o">=</span><span class="n">refresh</span><span class="p">)</span>
            

    <span class="k">def</span> <span class="nf">reindex_elasticsearch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reindex all of the data into elasticsearch&quot;&quot;&quot;</span>
        <span class="n">desired_format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">determine_format</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
        <span class="n">projects</span> <span class="o">=</span> <span class="n">Project</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">values_list</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">flat</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">pid</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">projects</span><span class="p">):</span>
            <span class="n">batches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">request</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">project_id</span><span class="o">=</span><span class="n">pid</span><span class="p">)</span>
            <span class="c1"># we only want to store certain fields in the search index</span>
            <span class="kn">from</span> <span class="nn">django.core.paginator</span> <span class="kn">import</span> <span class="n">Paginator</span>
            <span class="n">paginator</span> <span class="o">=</span> <span class="n">Paginator</span><span class="p">(</span><span class="n">batches</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span> <span class="c1"># chunks of 1000</span>
            <span class="c1">#Get all schemata for all projects </span>
            <span class="n">indexing_schemata</span> <span class="o">=</span> <span class="n">get_indexing_schemata</span><span class="p">([</span><span class="n">pid</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">paginator</span><span class="o">.</span><span class="n">num_pages</span> <span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        
                <span class="n">result_list</span> <span class="o">=</span> <span class="n">index_batches_in_new_index</span><span class="p">(</span><span class="n">paginator</span><span class="o">.</span><span class="n">page</span><span class="p">(</span><span class="n">page</span><span class="p">)</span><span class="o">.</span><span class="n">object_list</span><span class="p">,</span> <span class="n">project_and_indexing_schemata</span><span class="o">=</span><span class="n">indexing_schemata</span><span class="p">)</span>
                <span class="k">print</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> of </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">page</span><span class="p">,</span> <span class="n">paginator</span><span class="o">.</span><span class="n">num_pages</span><span class="p">)</span>
            <span class="k">print</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> projects of </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">projects</span><span class="p">))</span> 
        <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="p">)</span>
        
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">(</span><span class="n">BaseCBHCompoundBatchResource</span><span class="o">.</span><span class="n">Meta</span><span class="p">):</span>
        <span class="k">pass</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#cbh_chem_api.resources.IndexingCBHCompoundBatchResource">IndexingCBHCompoundBatchResource</a></li>
          <li><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></li>
          <li>tastypie.resources.ModelResource</li>
          <li>tastypie.resources.BaseModelResource</li>
          <li>tastypie.resources.Resource</li>
          <li>__builtin__.object</li>
          </ul>
          <h3>Class variables</h3>
            <div class="item">
            <p id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.Meta" class="name">var <span class="ident">Meta</span></p>
            
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.Meta">Meta</a></code>
    </p>

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.base_fields" class="name">var <span class="ident">base_fields</span></p>
            
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.base_fields">base_fields</a></code>
    </p>

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.declared_fields" class="name">var <span class="ident">declared_fields</span></p>
            
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.declared_fields">declared_fields</a></code>
    </p>

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.project" class="name">var <span class="ident">project</span></p>
            
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.project">project</a></code>
    </p>

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.projectfull" class="name">var <span class="ident">projectfull</span></p>
            
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.projectfull">projectfull</a></code>
    </p>

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.userfull" class="name">var <span class="ident">userfull</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.urls" class="name">var <span class="ident">urls</span></p>
            
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.urls">urls</a></code>
    </p>

            
  
    <div class="desc inherited"><p>The endpoints this <code>Resource</code> responds to.</p>
<p>Mostly a standard URLconf, this is suitable for either automatic use
when registered with an <code>Api</code> class or for including directly in
a URLconf should you choose to.</p></div>
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, api_name=None)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.__init__">__init__</a></code>
    </p>

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.__init__', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">api_name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="c1"># this can cause:</span>
    <span class="c1"># TypeError: object.__new__(method-wrapper) is not safe, use method-wrapper.__new__()</span>
    <span class="c1"># when trying to copy a generator used as a default. Wrap call to</span>
    <span class="c1"># generator in lambda to get around this error.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_fields</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">api_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span> <span class="o">=</span> <span class="n">api_name</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.alter_deserialized_detail_data">
    <p>def <span class="ident">alter_deserialized_detail_data</span>(</p><p>self, request, data)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.alter_deserialized_detail_data">alter_deserialized_detail_data</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A hook to alter detail data just after it has been received from the user &amp;
gets deserialized.</p>
<p>Useful for altering the user data before any hydration is applied.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.alter_deserialized_detail_data', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.alter_deserialized_detail_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">alter_deserialized_detail_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to alter detail data just after it has been received from the user &amp;</span>
<span class="sd">    gets deserialized.</span>
<span class="sd">    Useful for altering the user data before any hydration is applied.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.alter_deserialized_list_data">
    <p>def <span class="ident">alter_deserialized_list_data</span>(</p><p>self, request, data)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.alter_deserialized_list_data">alter_deserialized_list_data</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A hook to alter list data just after it has been received from the user &amp;
gets deserialized.</p>
<p>Useful for altering the user data before any hydration is applied.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.alter_deserialized_list_data', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.alter_deserialized_list_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">alter_deserialized_list_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to alter list data just after it has been received from the user &amp;</span>
<span class="sd">    gets deserialized.</span>
<span class="sd">    Useful for altering the user data before any hydration is applied.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.alter_detail_data_to_serialize">
    <p>def <span class="ident">alter_detail_data_to_serialize</span>(</p><p>self, request, data)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.alter_detail_data_to_serialize">alter_detail_data_to_serialize</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A hook to alter detail data just before it gets serialized &amp; sent to the user.</p>
<p>Useful for restructuring/renaming aspects of the what's going to be
sent.</p>
<p>Should accommodate for receiving a single bundle of data.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.alter_detail_data_to_serialize', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.alter_detail_data_to_serialize" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">alter_detail_data_to_serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to alter detail data just before it gets serialized &amp; sent to the user.</span>
<span class="sd">    Useful for restructuring/renaming aspects of the what&#39;s going to be</span>
<span class="sd">    sent.</span>
<span class="sd">    Should accommodate for receiving a single bundle of data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.alter_list_data_to_serialize">
    <p>def <span class="ident">alter_list_data_to_serialize</span>(</p><p>self, request, data)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.alter_list_data_to_serialize">alter_list_data_to_serialize</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A hook to alter list data just before it gets serialized &amp; sent to the user.</p>
<p>Useful for restructuring/renaming aspects of the what's going to be
sent.</p>
<p>Should accommodate for a list of objects, generally also including
meta data.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.alter_list_data_to_serialize', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.alter_list_data_to_serialize" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">alter_list_data_to_serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to alter list data just before it gets serialized &amp; sent to the user.</span>
<span class="sd">    Useful for restructuring/renaming aspects of the what&#39;s going to be</span>
<span class="sd">    sent.</span>
<span class="sd">    Should accommodate for a list of objects, generally also including</span>
<span class="sd">    meta data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.api_field_from_django_field">
    <p>def <span class="ident">api_field_from_django_field</span>(</p><p>cls, f, default=&lt;class &#39;tastypie.fields.CharField&#39;&gt;)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.api_field_from_django_field">api_field_from_django_field</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Returns the field type that would likely be associated with each
Django type.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.api_field_from_django_field', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.api_field_from_django_field" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">api_field_from_django_field</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">fields</span><span class="o">.</span><span class="n">CharField</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the field type that would likely be associated with each</span>
<span class="sd">    Django type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">default</span>
    <span class="n">internal_type</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">get_internal_type</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">internal_type</span> <span class="o">==</span> <span class="s1">&#39;DateField&#39;</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">DateField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="o">==</span> <span class="s1">&#39;DateTimeField&#39;</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">DateTimeField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;BooleanField&#39;</span><span class="p">,</span> <span class="s1">&#39;NullBooleanField&#39;</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">BooleanField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;FloatField&#39;</span><span class="p">,):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">FloatField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;DecimalField&#39;</span><span class="p">,):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">DecimalField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;IntegerField&#39;</span><span class="p">,</span> <span class="s1">&#39;PositiveIntegerField&#39;</span><span class="p">,</span> <span class="s1">&#39;PositiveSmallIntegerField&#39;</span><span class="p">,</span> <span class="s1">&#39;SmallIntegerField&#39;</span><span class="p">,</span> <span class="s1">&#39;AutoField&#39;</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">IntegerField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;FileField&#39;</span><span class="p">,</span> <span class="s1">&#39;ImageField&#39;</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">FileField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="o">==</span> <span class="s1">&#39;TimeField&#39;</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">TimeField</span>
    <span class="c1"># TODO: Perhaps enable these via introspection. The reason they&#39;re not enabled</span>
    <span class="c1">#       by default is the very different ``__init__`` they have over</span>
    <span class="c1">#       the other fields.</span>
    <span class="c1"># elif internal_type == &#39;ForeignKey&#39;:</span>
    <span class="c1">#     result = ForeignKey</span>
    <span class="c1"># elif internal_type == &#39;ManyToManyField&#39;:</span>
    <span class="c1">#     result = ManyToManyField</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.apply_authorization_limits">
    <p>def <span class="ident">apply_authorization_limits</span>(</p><p>self, request, object_list)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.apply_authorization_limits">apply_authorization_limits</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Deprecated.</p>
<p>FIXME: REMOVE BEFORE 1.0</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.apply_authorization_limits', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.apply_authorization_limits" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">apply_authorization_limits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">object_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Deprecated.</span>
<span class="sd">    FIXME: REMOVE BEFORE 1.0</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">apply_limits</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">object_list</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.apply_filters">
    <p>def <span class="ident">apply_filters</span>(</p><p>self, request, applicable_filters)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.apply_filters">apply_filters</a></code>
    </p>

    
  
    <div class="desc inherited"><p>An ORM-specific implementation of <code>apply_filters</code>.</p>
<p>The default simply applies the <code>applicable_filters</code> as <code>**kwargs</code>,
but should make it possible to do more advanced things.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.apply_filters', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.apply_filters" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">apply_filters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">applicable_filters</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An ORM-specific implementation of ``apply_filters``.</span>
<span class="sd">    The default simply applies the ``applicable_filters`` as ``**kwargs``,</span>
<span class="sd">    but should make it possible to do more advanced things.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">request</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="o">**</span><span class="n">applicable_filters</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.apply_sorting">
    <p>def <span class="ident">apply_sorting</span>(</p><p>self, obj_list, options=None)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.apply_sorting">apply_sorting</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Given a dictionary of options, apply some ORM-level sorting to the
provided <code>QuerySet</code>.</p>
<p>Looks for the <code>order_by</code> key and handles either ascending (just the
field name) or descending (the field name with a <code>-</code> in front).</p>
<p>The field name should be the resource field, <strong>NOT</strong> model field.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.apply_sorting', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.apply_sorting" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">apply_sorting</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_list</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a dictionary of options, apply some ORM-level sorting to the</span>
<span class="sd">    provided ``QuerySet``.</span>
<span class="sd">    Looks for the ``order_by`` key and handles either ascending (just the</span>
<span class="sd">    field name) or descending (the field name with a ``-`` in front).</span>
<span class="sd">    The field name should be the resource field, **NOT** model field.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">parameter_name</span> <span class="o">=</span> <span class="s1">&#39;order_by&#39;</span>
    <span class="k">if</span> <span class="s1">&#39;order_by&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;sort_by&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
            <span class="c1"># Nothing to alter the order. Return what we&#39;ve got.</span>
            <span class="k">return</span> <span class="n">obj_list</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;&#39;sort_by&#39; is a deprecated parameter. Please use &#39;order_by&#39; instead.&quot;</span><span class="p">)</span>
            <span class="n">parameter_name</span> <span class="o">=</span> <span class="s1">&#39;sort_by&#39;</span>
    <span class="n">order_by_args</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="s1">&#39;getlist&#39;</span><span class="p">):</span>
        <span class="n">order_bits</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">getlist</span><span class="p">(</span><span class="n">parameter_name</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">order_bits</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">parameter_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">order_bits</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="n">order_bits</span> <span class="o">=</span> <span class="p">[</span><span class="n">order_bits</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">order_by</span> <span class="ow">in</span> <span class="n">order_bits</span><span class="p">:</span>
        <span class="n">order_by_bits</span> <span class="o">=</span> <span class="n">order_by</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">LOOKUP_SEP</span><span class="p">)</span>
        <span class="n">field_name</span> <span class="o">=</span> <span class="n">order_by_bits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">order</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">order_by_bits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">):</span>
            <span class="n">field_name</span> <span class="o">=</span> <span class="n">order_by_bits</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
            <span class="n">order</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span>
        <span class="k">if</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
            <span class="c1"># It&#39;s not a field we know about. Move along citizen.</span>
            <span class="k">raise</span> <span class="n">InvalidSortError</span><span class="p">(</span><span class="s2">&quot;No matching &#39;</span><span class="si">%s</span><span class="s2">&#39; field for ordering on.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">ordering</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidSortError</span><span class="p">(</span><span class="s2">&quot;The &#39;</span><span class="si">%s</span><span class="s2">&#39; field does not allow ordering.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">attribute</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidSortError</span><span class="p">(</span><span class="s2">&quot;The &#39;</span><span class="si">%s</span><span class="s2">&#39; field has no &#39;attribute&#39; for ordering with.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="n">order_by_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">LOOKUP_SEP</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">attribute</span><span class="p">]</span> <span class="o">+</span> <span class="n">order_by_bits</span><span class="p">[</span><span class="mi">1</span><span class="p">:])))</span>
    <span class="k">return</span> <span class="n">obj_list</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="o">*</span><span class="n">order_by_args</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.authorized_create_detail">
    <p>def <span class="ident">authorized_create_detail</span>(</p><p>self, object_list, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_create_detail">authorized_create_detail</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles checking of permissions to see if the user has authorization
to POST this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.authorized_create_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.authorized_create_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_create_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to POST this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">create_detail</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">auth_result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.authorized_create_list">
    <p>def <span class="ident">authorized_create_list</span>(</p><p>self, object_list, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_create_list">authorized_create_list</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles checking of permissions to see if the user has authorization
to POST this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.authorized_create_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.authorized_create_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_create_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to POST this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">create_list</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.authorized_delete_detail">
    <p>def <span class="ident">authorized_delete_detail</span>(</p><p>self, object_list, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_delete_detail">authorized_delete_detail</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles checking of permissions to see if the user has authorization
to DELETE this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.authorized_delete_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.authorized_delete_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_delete_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to DELETE this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">delete_detail</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">auth_result</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.authorized_delete_list">
    <p>def <span class="ident">authorized_delete_list</span>(</p><p>self, object_list, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_delete_list">authorized_delete_list</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles checking of permissions to see if the user has authorization
to DELETE this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.authorized_delete_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.authorized_delete_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_delete_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to DELETE this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">delete_list</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.authorized_read_detail">
    <p>def <span class="ident">authorized_read_detail</span>(</p><p>self, object_list, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_read_detail">authorized_read_detail</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles checking of permissions to see if the user has authorization
to GET this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.authorized_read_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.authorized_read_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_read_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to GET this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">read_detail</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">auth_result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.authorized_read_list">
    <p>def <span class="ident">authorized_read_list</span>(</p><p>self, object_list, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_read_list">authorized_read_list</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles checking of permissions to see if the user has authorization
to GET this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.authorized_read_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.authorized_read_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_read_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to GET this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">read_list</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.authorized_update_detail">
    <p>def <span class="ident">authorized_update_detail</span>(</p><p>self, object_list, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_update_detail">authorized_update_detail</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles checking of permissions to see if the user has authorization
to PUT this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.authorized_update_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.authorized_update_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_update_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to PUT this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">update_detail</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">auth_result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.authorized_update_list">
    <p>def <span class="ident">authorized_update_list</span>(</p><p>self, object_list, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.authorized_update_list">authorized_update_list</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles checking of permissions to see if the user has authorization
to PUT this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.authorized_update_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.authorized_update_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_update_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to PUT this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">update_list</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.base_urls">
    <p>def <span class="ident">base_urls</span>(</p><p>self)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.base_urls">base_urls</a></code>
    </p>

    
  
    <div class="desc inherited"><p>The standard URLs this <code>Resource</code> should respond to.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.base_urls', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.base_urls" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">base_urls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The standard URLs this ``Resource`` should respond to.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="n">url</span><span class="p">(</span><span class="s2">r&quot;^(?P&lt;resource_name&gt;</span><span class="si">%s</span><span class="s2">)</span><span class="si">%s</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span> <span class="n">trailing_slash</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrap_view</span><span class="p">(</span><span class="s1">&#39;dispatch_list&#39;</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;api_dispatch_list&quot;</span><span class="p">),</span>
        <span class="n">url</span><span class="p">(</span><span class="s2">r&quot;^(?P&lt;resource_name&gt;</span><span class="si">%s</span><span class="s2">)/schema</span><span class="si">%s</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span> <span class="n">trailing_slash</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrap_view</span><span class="p">(</span><span class="s1">&#39;get_schema&#39;</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;api_get_schema&quot;</span><span class="p">),</span>
        <span class="n">url</span><span class="p">(</span><span class="s2">r&quot;^(?P&lt;resource_name&gt;</span><span class="si">%s</span><span class="s2">)/set/(?P&lt;</span><span class="si">%s</span><span class="s2">_list&gt;.*?)</span><span class="si">%s</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">,</span> <span class="n">trailing_slash</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrap_view</span><span class="p">(</span><span class="s1">&#39;get_multiple&#39;</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;api_get_multiple&quot;</span><span class="p">),</span>
        <span class="n">url</span><span class="p">(</span><span class="s2">r&quot;^(?P&lt;resource_name&gt;</span><span class="si">%s</span><span class="s2">)/(?P&lt;</span><span class="si">%s</span><span class="s2">&gt;.*?)</span><span class="si">%s</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">,</span> <span class="n">trailing_slash</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrap_view</span><span class="p">(</span><span class="s1">&#39;dispatch_detail&#39;</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;api_dispatch_detail&quot;</span><span class="p">),</span>
    <span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.build_bundle">
    <p>def <span class="ident">build_bundle</span>(</p><p>self, obj=None, data=None, request=None, objects_saved=None, via_uri=None)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.build_bundle">build_bundle</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Given either an object, a data dictionary or both, builds a <code>Bundle</code>
for use throughout the <code>dehydrate/hydrate</code> cycle.</p>
<p>If no object is provided, an empty object from
<code>Resource._meta.object_class</code> is created so that attempts to access
<code>bundle.obj</code> do not fail.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.build_bundle', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.build_bundle" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">build_bundle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">objects_saved</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">via_uri</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given either an object, a data dictionary or both, builds a ``Bundle``</span>
<span class="sd">    for use throughout the ``dehydrate/hydrate`` cycle.</span>
<span class="sd">    If no object is provided, an empty object from</span>
<span class="sd">    ``Resource._meta.object_class`` is created so that attempts to access</span>
<span class="sd">    ``bundle.obj`` do not fail.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="p">:</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">Bundle</span><span class="p">(</span>
        <span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span>
        <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
        <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">,</span>
        <span class="n">objects_saved</span><span class="o">=</span><span class="n">objects_saved</span><span class="p">,</span>
        <span class="n">via_uri</span><span class="o">=</span><span class="n">via_uri</span>
    <span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.build_filters">
    <p>def <span class="ident">build_filters</span>(</p><p>self, filters=None)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.build_filters">build_filters</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Given a dictionary of filters, create the necessary ORM-level filters.</p>
<p>Keys should be resource fields, <strong>NOT</strong> model fields.</p>
<p>Valid values are either a list of Django filter types (i.e.
<code>['startswith', 'exact', 'lte']</code>), the <code>ALL</code> constant or the
<code>ALL_WITH_RELATIONS</code> constant.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.build_filters', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.build_filters" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">build_filters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a dictionary of filters, create the necessary ORM-level filters.</span>
<span class="sd">    Keys should be resource fields, **NOT** model fields.</span>
<span class="sd">    Valid values are either a list of Django filter types (i.e.</span>
<span class="sd">    ``[&#39;startswith&#39;, &#39;exact&#39;, &#39;lte&#39;]``), the ``ALL`` constant or the</span>
<span class="sd">    ``ALL_WITH_RELATIONS`` constant.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># At the declarative level:</span>
    <span class="c1">#     filtering = {</span>
    <span class="c1">#         &#39;resource_field_name&#39;: [&#39;exact&#39;, &#39;startswith&#39;, &#39;endswith&#39;, &#39;contains&#39;],</span>
    <span class="c1">#         &#39;resource_field_name_2&#39;: [&#39;exact&#39;, &#39;gt&#39;, &#39;gte&#39;, &#39;lt&#39;, &#39;lte&#39;, &#39;range&#39;],</span>
    <span class="c1">#         &#39;resource_field_name_3&#39;: ALL,</span>
    <span class="c1">#         &#39;resource_field_name_4&#39;: ALL_WITH_RELATIONS,</span>
    <span class="c1">#         ...</span>
    <span class="c1">#     }</span>
    <span class="c1"># Accepts the filters as a dict. None by default, meaning no filters.</span>
    <span class="k">if</span> <span class="n">filters</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">filters</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">qs_filters</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="p">,</span> <span class="s1">&#39;queryset&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="c1"># Get the possible query terms from the current QuerySet.</span>
        <span class="n">query_terms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">queryset</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">query_terms</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">query_terms</span> <span class="o">=</span> <span class="n">QUERY_TERMS</span>
    <span class="k">if</span> <span class="n">django</span><span class="o">.</span><span class="n">VERSION</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span> <span class="ow">and</span> <span class="n">GeometryField</span><span class="p">:</span>
        <span class="n">query_terms</span> <span class="o">=</span> <span class="n">query_terms</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="n">GeometryField</span><span class="o">.</span><span class="n">class_lookups</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="k">for</span> <span class="n">filter_expr</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">filters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">filter_bits</span> <span class="o">=</span> <span class="n">filter_expr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">LOOKUP_SEP</span><span class="p">)</span>
        <span class="n">field_name</span> <span class="o">=</span> <span class="n">filter_bits</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">filter_type</span> <span class="o">=</span> <span class="s1">&#39;exact&#39;</span>
        <span class="k">if</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
            <span class="c1"># It&#39;s not a field we know about. Move along citizen.</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filter_bits</span><span class="p">)</span> <span class="ow">and</span> <span class="n">filter_bits</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">query_terms</span><span class="p">:</span>
            <span class="n">filter_type</span> <span class="o">=</span> <span class="n">filter_bits</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="n">lookup_bits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_filtering</span><span class="p">(</span><span class="n">field_name</span><span class="p">,</span> <span class="n">filter_type</span><span class="p">,</span> <span class="n">filter_bits</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_value_to_python</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">filters</span><span class="p">,</span> <span class="n">filter_expr</span><span class="p">,</span> <span class="n">filter_type</span><span class="p">)</span>
        <span class="n">db_field_name</span> <span class="o">=</span> <span class="n">LOOKUP_SEP</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lookup_bits</span><span class="p">)</span>
        <span class="n">qs_filter</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">db_field_name</span><span class="p">,</span> <span class="n">LOOKUP_SEP</span><span class="p">,</span> <span class="n">filter_type</span><span class="p">)</span>
        <span class="n">qs_filters</span><span class="p">[</span><span class="n">qs_filter</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
    <span class="k">return</span> <span class="n">dict_strip_unicode_keys</span><span class="p">(</span><span class="n">qs_filters</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.build_schema">
    <p>def <span class="ident">build_schema</span>(</p><p>self)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.build_schema">build_schema</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Returns a dictionary of all the fields on the resource and some
properties about those fields.</p>
<p>Used by the <code>schema/</code> endpoint to describe what will be available.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.build_schema', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.build_schema" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">build_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a dictionary of all the fields on the resource and some</span>
<span class="sd">    properties about those fields.</span>
<span class="sd">    Used by the ``schema/`` endpoint to describe what will be available.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;fields&#39;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s1">&#39;default_format&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">default_format</span><span class="p">,</span>
        <span class="s1">&#39;allowed_list_http_methods&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">list_allowed_methods</span><span class="p">,</span>
        <span class="s1">&#39;allowed_detail_http_methods&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_allowed_methods</span><span class="p">,</span>
        <span class="s1">&#39;default_limit&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">limit</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">ordering</span><span class="p">:</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;ordering&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">ordering</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span><span class="p">:</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;filtering&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span>
    <span class="c1"># Skip assigning pk_field_name for non-model resources</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">pk_field_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">queryset</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">pk</span><span class="o">.</span><span class="n">name</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="n">pk_field_name</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;fields&#39;</span><span class="p">][</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">default</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">dehydrated_type</span><span class="p">,</span>
            <span class="s1">&#39;nullable&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">null</span><span class="p">,</span>
            <span class="s1">&#39;blank&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">blank</span><span class="p">,</span>
            <span class="s1">&#39;readonly&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">readonly</span><span class="p">,</span>
            <span class="s1">&#39;help_text&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">help_text</span><span class="p">,</span>
            <span class="s1">&#39;unique&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">unique</span><span class="p">,</span>
            <span class="s1">&#39;primary_key&#39;</span><span class="p">:</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">field_name</span> <span class="o">==</span> <span class="n">pk_field_name</span> <span class="k">else</span> <span class="bp">False</span><span class="p">,</span>
            <span class="s1">&#39;verbose_name&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">verbose_name</span> <span class="ow">or</span> <span class="n">field_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">),</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">dehydrated_type</span> <span class="o">==</span> <span class="s1">&#39;related&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
                <span class="n">related_type</span> <span class="o">=</span> <span class="s1">&#39;to_many&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">related_type</span> <span class="o">=</span> <span class="s1">&#39;to_one&#39;</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;fields&#39;</span><span class="p">][</span><span class="n">field_name</span><span class="p">][</span><span class="s1">&#39;related_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">related_type</span>
            <span class="n">uri</span> <span class="o">=</span> <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;api_get_schema&#39;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;api_name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span><span class="p">,</span> <span class="s1">&#39;resource_name&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">to_class</span><span class="p">()</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">})</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;fields&#39;</span><span class="p">][</span><span class="n">field_name</span><span class="p">][</span><span class="s1">&#39;related_schema&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">uri</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.cached_obj_get">
    <p>def <span class="ident">cached_obj_get</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.cached_obj_get">cached_obj_get</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A version of <code>obj_get</code> that uses the cache as a means to get
commonly-accessed data faster.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.cached_obj_get', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.cached_obj_get" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">cached_obj_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A version of ``obj_get`` that uses the cache as a means to get</span>
<span class="sd">    commonly-accessed data faster.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_cache_key</span><span class="p">(</span><span class="s1">&#39;detail&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">cached_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cache_key</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">cached_bundle</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">cached_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">cache_key</span><span class="p">,</span> <span class="n">cached_bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cached_bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.cached_obj_get_list">
    <p>def <span class="ident">cached_obj_get_list</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.cached_obj_get_list">cached_obj_get_list</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A version of <code>obj_get_list</code> that uses the cache as a means to get
commonly-accessed data faster.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.cached_obj_get_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.cached_obj_get_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">cached_obj_get_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A version of ``obj_get_list`` that uses the cache as a means to get</span>
<span class="sd">    commonly-accessed data faster.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_cache_key</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">obj_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cache_key</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">obj_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">obj_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">cache_key</span><span class="p">,</span> <span class="n">obj_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">obj_list</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.can_create">
    <p>def <span class="ident">can_create</span>(</p><p>self)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.can_create">can_create</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Checks to ensure <code>post</code> is within <code>allowed_methods</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.can_create', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.can_create" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">can_create</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks to ensure ``post`` is within ``allowed_methods``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">allowed</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">list_allowed_methods</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_allowed_methods</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">&#39;post&#39;</span> <span class="ow">in</span> <span class="n">allowed</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.can_delete">
    <p>def <span class="ident">can_delete</span>(</p><p>self)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.can_delete">can_delete</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Checks to ensure <code>delete</code> is within <code>allowed_methods</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.can_delete', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.can_delete" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">can_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks to ensure ``delete`` is within ``allowed_methods``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">allowed</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">list_allowed_methods</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_allowed_methods</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">&#39;delete&#39;</span> <span class="ow">in</span> <span class="n">allowed</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.can_update">
    <p>def <span class="ident">can_update</span>(</p><p>self)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.can_update">can_update</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Checks to ensure <code>put</code> is within <code>allowed_methods</code>.</p>
<p>Used when hydrating related data.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.can_update', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.can_update" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">can_update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks to ensure ``put`` is within ``allowed_methods``.</span>
<span class="sd">    Used when hydrating related data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">allowed</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">list_allowed_methods</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_allowed_methods</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">&#39;put&#39;</span> <span class="ow">in</span> <span class="n">allowed</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.check_filtering">
    <p>def <span class="ident">check_filtering</span>(</p><p>self, field_name, filter_type=u&#39;exact&#39;, filter_bits=None)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.check_filtering">check_filtering</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Given a field name, a optional filter type and an optional list of
additional relations, determine if a field can be filtered on.</p>
<p>If a filter does not meet the needed conditions, it should raise an
<code>InvalidFilterError</code>.</p>
<p>If the filter meets the conditions, a list of attribute names (not
field names) will be returned.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.check_filtering', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.check_filtering" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">check_filtering</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">filter_type</span><span class="o">=</span><span class="s1">&#39;exact&#39;</span><span class="p">,</span> <span class="n">filter_bits</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a field name, a optional filter type and an optional list of</span>
<span class="sd">    additional relations, determine if a field can be filtered on.</span>
<span class="sd">    If a filter does not meet the needed conditions, it should raise an</span>
<span class="sd">    ``InvalidFilterError``.</span>
<span class="sd">    If the filter meets the conditions, a list of attribute names (not</span>
<span class="sd">    field names) will be returned.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">filter_bits</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">filter_bits</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">InvalidFilterError</span><span class="p">(</span><span class="s2">&quot;The &#39;</span><span class="si">%s</span><span class="s2">&#39; field does not allow filtering.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
    <span class="c1"># Check to see if it&#39;s an allowed lookup type.</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">ALL</span><span class="p">,</span> <span class="n">ALL_WITH_RELATIONS</span><span class="p">):</span>
        <span class="c1"># Must be an explicit whitelist.</span>
        <span class="k">if</span> <span class="n">filter_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span><span class="p">[</span><span class="n">field_name</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">InvalidFilterError</span><span class="p">(</span><span class="s2">&quot;&#39;</span><span class="si">%s</span><span class="s2">&#39; is not an allowed filter on the &#39;</span><span class="si">%s</span><span class="s2">&#39; field.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">filter_type</span><span class="p">,</span> <span class="n">field_name</span><span class="p">))</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">attribute</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">InvalidFilterError</span><span class="p">(</span><span class="s2">&quot;The &#39;</span><span class="si">%s</span><span class="s2">&#39; field has no &#39;attribute&#39; for searching with.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
    <span class="c1"># Check to see if it&#39;s a relational lookup and if that&#39;s allowed.</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filter_bits</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">],</span> <span class="s1">&#39;is_related&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">InvalidFilterError</span><span class="p">(</span><span class="s2">&quot;The &#39;</span><span class="si">%s</span><span class="s2">&#39; field does not support relations.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">==</span> <span class="n">ALL_WITH_RELATIONS</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidFilterError</span><span class="p">(</span><span class="s2">&quot;Lookups are not allowed more than one level deep on the &#39;</span><span class="si">%s</span><span class="s2">&#39; field.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="c1"># Recursively descend through the remaining lookups in the filter,</span>
        <span class="c1"># if any. We should ensure that all along the way, we&#39;re allowed</span>
        <span class="c1"># to filter on that field by the related resource.</span>
        <span class="n">related_resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">get_related_resource</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">attribute</span><span class="p">]</span> <span class="o">+</span> <span class="n">related_resource</span><span class="o">.</span><span class="n">check_filtering</span><span class="p">(</span><span class="n">filter_bits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">filter_type</span><span class="p">,</span> <span class="n">filter_bits</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">attribute</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.create_identifier">
    <p>def <span class="ident">create_identifier</span>(</p><p>self, obj)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.create_identifier">create_identifier</a></code>
    </p>

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.create_identifier', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.create_identifier" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">create_identifier</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">u&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">app_label</span><span class="p">,</span> <span class="n">get_module_name</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">_meta</span><span class="p">),</span> <span class="n">obj</span><span class="o">.</span><span class="n">pk</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.create_response">
    <p>def <span class="ident">create_response</span>(</p><p>self, request, data, response_class=&lt;class &#39;django.http.response.HttpResponse&#39;&gt;, **response_kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.create_response">create_response</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Ensure that data is returned in the right format as an attachment if returning SDF or XLSX data
Should an object have been created or updated, now is the time to
reindex it in the elasticsearch index</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.create_response', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.create_response" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">create_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">HttpResponse</span><span class="p">,</span> <span class="o">**</span><span class="n">response_kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Ensure that data is returned in the right format as an attachment if returning SDF or XLSX data</span>
<span class="sd">    Should an object have been created or updated, now is the time to</span>
<span class="sd">    reindex it in the elasticsearch index</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">desired_format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">determine_format</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">response_class</span> <span class="o">==</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpCreated</span> <span class="ow">or</span> <span class="n">response_class</span> <span class="o">==</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpAccepted</span><span class="p">:</span>
        <span class="n">batches</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;objects&quot;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;objects&quot;</span><span class="p">):</span>
                <span class="n">batches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">batches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
        <span class="n">index_batches_in_new_index</span><span class="p">(</span><span class="n">batches</span><span class="p">)</span>
    <span class="n">serialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">desired_format</span><span class="p">)</span>
    <span class="n">rc</span> <span class="o">=</span> <span class="n">response_class</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">serialized</span><span class="p">,</span> <span class="n">content_type</span><span class="o">=</span><span class="n">build_content_type</span><span class="p">(</span>
        <span class="n">desired_format</span><span class="p">),</span> <span class="o">**</span><span class="n">response_kwargs</span><span class="p">)</span>
    <span class="k">if</span><span class="p">(</span><span class="n">desired_format</span> <span class="o">==</span> <span class="s1">&#39;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&#39;</span><span class="p">):</span>
        <span class="n">rc</span><span class="p">[</span><span class="s1">&#39;Content-Disposition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;attachment; filename=export_from_chembiohub_chemreg</span><span class="si">%d</span><span class="s1">.xlsx&#39;</span> <span class="o">%</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span>
    <span class="k">elif</span><span class="p">(</span><span class="n">desired_format</span> <span class="o">==</span> <span class="s1">&#39;chemical/x-mdl-sdfile&#39;</span><span class="p">):</span>
        <span class="n">rc</span><span class="p">[</span><span class="s1">&#39;Content-Disposition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;attachment; filename=export_from_chembiohub_chemreg</span><span class="si">%d</span><span class="s1">.sdf&#39;</span> <span class="o">%</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">rc</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.dehydrate">
    <p>def <span class="ident">dehydrate</span>(</p><p>self, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.dehydrate">dehydrate</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A hook to allow a final manipulation of data once all fields/methods
have built out the dehydrated data.</p>
<p>Useful if you need to access more than one dehydrated field or want
to annotate on additional data.</p>
<p>Must return the modified bundle.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.dehydrate', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.dehydrate" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dehydrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to allow a final manipulation of data once all fields/methods</span>
<span class="sd">    have built out the dehydrated data.</span>
<span class="sd">    Useful if you need to access more than one dehydrated field or want</span>
<span class="sd">    to annotate on additional data.</span>
<span class="sd">    Must return the modified bundle.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.dehydrate_properties">
    <p>def <span class="ident">dehydrate_properties</span>(</p><p>self, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.dehydrate_properties">dehydrate_properties</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Ensure that the archived property is always presented in a consistent way</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.dehydrate_properties', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.dehydrate_properties" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dehydrate_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Ensure that the archived property is always presented in a consistent way&quot;&quot;&quot;</span>
    <span class="n">archived</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;archived&quot;</span><span class="p">,</span> <span class="s2">&quot;false&quot;</span><span class="p">)</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">properties</span>
    <span class="n">value</span><span class="p">[</span><span class="s2">&quot;archived&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">archived</span>
    <span class="k">return</span> <span class="n">value</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.dehydrate_resource_uri">
    <p>def <span class="ident">dehydrate_resource_uri</span>(</p><p>self, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.dehydrate_resource_uri">dehydrate_resource_uri</a></code>
    </p>

    
  
    <div class="desc inherited"><p>For the automatically included <code>resource_uri</code> field, dehydrate
the URI for the given bundle.</p>
<p>Returns empty string if no URI can be generated.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.dehydrate_resource_uri', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.dehydrate_resource_uri" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dehydrate_resource_uri</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    For the automatically included ``resource_uri`` field, dehydrate</span>
<span class="sd">    the URI for the given bundle.</span>
<span class="sd">    Returns empty string if no URI can be generated.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_uri</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="k">except</span> <span class="n">NoReverseMatch</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.dehydrate_timestamp">
    <p>def <span class="ident">dehydrate_timestamp</span>(</p><p>self, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.dehydrate_timestamp">dehydrate_timestamp</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Provide a viewer-friendly timestamp</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.dehydrate_timestamp', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.dehydrate_timestamp" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dehydrate_timestamp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Provide a viewer-friendly timestamp&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">created</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.dehydrate_uuid">
    <p>def <span class="ident">dehydrate_uuid</span>(</p><p>self, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.dehydrate_uuid">dehydrate_uuid</a></code>
    </p>

    
  
    <div class="desc inherited"><p>This is either a blinded batch uuid or a uuid for the compound structure based on the INCHI key</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.dehydrate_uuid', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.dehydrate_uuid" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dehydrate_uuid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This is either a blinded batch uuid or a uuid for the compound structure based on the INCHI key&quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">related_molregno</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">related_molregno</span><span class="o">.</span><span class="n">chembl</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">related_molregno</span><span class="o">.</span><span class="n">chembl</span><span class="o">.</span><span class="n">chembl_id</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">related_molregno</span><span class="o">.</span><span class="n">chembl</span><span class="o">.</span><span class="n">chembl_id</span>
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">blinded_batch_id</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">blinded_batch_id</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.delete_detail">
    <p>def <span class="ident">delete_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.delete_detail">delete_detail</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Destroys a single resource/object.</p>
<p>Calls <code>obj_delete</code>.</p>
<p>If the resource is deleted, return <code>HttpNoContent</code> (204 No Content).
If the resource did not exist, return <code>Http404</code> (404 Not Found).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.delete_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.delete_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">delete_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Destroys a single resource/object.</span>
<span class="sd">    Calls ``obj_delete``.</span>
<span class="sd">    If the resource is deleted, return ``HttpNoContent`` (204 No Content).</span>
<span class="sd">    If the resource did not exist, return ``Http404`` (404 Not Found).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Manually construct the bundle here, since we don&#39;t want to try to</span>
    <span class="c1"># delete an empty instance.</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="n">Bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">obj_delete</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNoContent</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">NotFound</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNotFound</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.delete_list">
    <p>def <span class="ident">delete_list</span>(</p><p>self, request, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.delete_list">delete_list</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Destroys a collection of resources/objects.</p>
<p>Calls <code>obj_delete_list</code>.</p>
<p>If the resources are deleted, return <code>HttpNoContent</code> (204 No Content).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.delete_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.delete_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">delete_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Destroys a collection of resources/objects.</span>
<span class="sd">    Calls ``obj_delete_list``.</span>
<span class="sd">    If the resources are deleted, return ``HttpNoContent`` (204 No Content).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">obj_delete_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNoContent</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.deserialize">
    <p>def <span class="ident">deserialize</span>(</p><p>self, request, data, format=u&#39;application/json&#39;)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.deserialize">deserialize</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Given a request, data and a format, deserializes the given data.</p>
<p>It relies on the request properly sending a <code>CONTENT_TYPE</code> header,
falling back to <code>application/json</code> if not provided.</p>
<p>Mostly a hook, this uses the <code>Serializer</code> from <code>Resource._meta</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.deserialize', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.deserialize" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">deserialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s1">&#39;application/json&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a request, data and a format, deserializes the given data.</span>
<span class="sd">    It relies on the request properly sending a ``CONTENT_TYPE`` header,</span>
<span class="sd">    falling back to ``application/json`` if not provided.</span>
<span class="sd">    Mostly a hook, this uses the ``Serializer`` from ``Resource._meta``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">serializer</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="n">format</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">deserialized</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.detail_uri_kwargs">
    <p>def <span class="ident">detail_uri_kwargs</span>(</p><p>self, bundle_or_obj)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.detail_uri_kwargs">detail_uri_kwargs</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Given a <code>Bundle</code> or an object (typically a <code>Model</code> instance),
it returns the extra kwargs needed to generate a detail URI.</p>
<p>By default, it uses the model's <code>pk</code> in order to create the URI.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.detail_uri_kwargs', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.detail_uri_kwargs" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">detail_uri_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle_or_obj</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a ``Bundle`` or an object (typically a ``Model`` instance),</span>
<span class="sd">    it returns the extra kwargs needed to generate a detail URI.</span>
<span class="sd">    By default, it uses the model&#39;s ``pk`` in order to create the URI.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bundle_or_obj</span><span class="p">,</span> <span class="n">Bundle</span><span class="p">):</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">bundle_or_obj</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">bundle_or_obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">kwargs</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.determine_format">
    <p>def <span class="ident">determine_format</span>(</p><p>self, request)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.determine_format">determine_format</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Used to determine the desired format.</p>
<p>Largely relies on <code>tastypie.utils.mime.determine_format</code> but here
as a point of extension.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.determine_format', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.determine_format" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">determine_format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Used to determine the desired format.</span>
<span class="sd">    Largely relies on ``tastypie.utils.mime.determine_format`` but here</span>
<span class="sd">    as a point of extension.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">determine_format</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">serializer</span><span class="p">,</span> <span class="n">default_format</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">default_format</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.dispatch">
    <p>def <span class="ident">dispatch</span>(</p><p>self, request_type, request, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.dispatch">dispatch</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles the common operations (allowed HTTP method, authentication,
throttling, method lookup) surrounding most CRUD interactions.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.dispatch', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.dispatch" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dispatch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request_type</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles the common operations (allowed HTTP method, authentication,</span>
<span class="sd">    throttling, method lookup) surrounding most CRUD interactions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">allowed_methods</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_allowed_methods&quot;</span> <span class="o">%</span> <span class="n">request_type</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;HTTP_X_HTTP_METHOD_OVERRIDE&#39;</span> <span class="ow">in</span> <span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="p">:</span>
        <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="p">[</span><span class="s1">&#39;HTTP_X_HTTP_METHOD_OVERRIDE&#39;</span><span class="p">]</span>
    <span class="n">request_method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">method_check</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">allowed</span><span class="o">=</span><span class="n">allowed_methods</span><span class="p">)</span>
    <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">request_method</span><span class="p">,</span> <span class="n">request_type</span><span class="p">),</span> <span class="bp">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">method</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpNotImplemented</span><span class="p">())</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">throttle_check</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="c1"># All clear. Process the request.</span>
    <span class="n">request</span> <span class="o">=</span> <span class="n">convert_post_to_put</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="c1"># Add the throttled request.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_throttled_access</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="c1"># If what comes back isn&#39;t a ``HttpResponse``, assume that the</span>
    <span class="c1"># request was accepted and that some action occurred. This also</span>
    <span class="c1"># prevents Django from freaking out.</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">HttpResponse</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNoContent</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">response</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.dispatch_detail">
    <p>def <span class="ident">dispatch_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.dispatch_detail">dispatch_detail</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A view for handling the various HTTP methods (GET/POST/PUT/DELETE) on
a single resource.</p>
<p>Relies on <code>Resource.dispatch</code> for the heavy-lifting.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.dispatch_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.dispatch_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dispatch_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A view for handling the various HTTP methods (GET/POST/PUT/DELETE) on</span>
<span class="sd">    a single resource.</span>
<span class="sd">    Relies on ``Resource.dispatch`` for the heavy-lifting.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span><span class="s1">&#39;detail&#39;</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.dispatch_list">
    <p>def <span class="ident">dispatch_list</span>(</p><p>self, request, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.dispatch_list">dispatch_list</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A view for handling the various HTTP methods (GET/POST/PUT/DELETE) over
the entire list of resources.</p>
<p>Relies on <code>Resource.dispatch</code> for the heavy-lifting.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.dispatch_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.dispatch_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dispatch_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A view for handling the various HTTP methods (GET/POST/PUT/DELETE) over</span>
<span class="sd">    the entire list of resources.</span>
<span class="sd">    Relies on ``Resource.dispatch`` for the heavy-lifting.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.error_response">
    <p>def <span class="ident">error_response</span>(</p><p>self, request, errors, response_class=None)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.error_response">error_response</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Extracts the common "which-format/serialize/return-error-response"
cycle.</p>
<p>Should be used as much as possible to return errors.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.error_response', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.error_response" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">error_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extracts the common &quot;which-format/serialize/return-error-response&quot;</span>
<span class="sd">    cycle.</span>
<span class="sd">    Should be used as much as possible to return errors.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">response_class</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">response_class</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpBadRequest</span>
    <span class="n">desired_format</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">if</span> <span class="n">request</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;callback&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">desired_format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">determine_format</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">BadRequest</span><span class="p">:</span>
                <span class="k">pass</span>  <span class="c1"># Fall through to default handler below</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># JSONP can cause extra breakage.</span>
            <span class="n">desired_format</span> <span class="o">=</span> <span class="s1">&#39;application/json&#39;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">desired_format</span><span class="p">:</span>
        <span class="n">desired_format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">default_format</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">serialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">desired_format</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">BadRequest</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">error</span> <span class="o">=</span> <span class="s2">&quot;Additional errors occurred, but serialization of those errors failed.&quot;</span>
        <span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">:</span>
            <span class="n">error</span> <span class="o">+=</span> <span class="s2">&quot; </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">e</span>
        <span class="k">return</span> <span class="n">response_class</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">error</span><span class="p">,</span> <span class="n">content_type</span><span class="o">=</span><span class="s1">&#39;text/plain&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response_class</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">serialized</span><span class="p">,</span> <span class="n">content_type</span><span class="o">=</span><span class="n">build_content_type</span><span class="p">(</span><span class="n">desired_format</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.filter_value_to_python">
    <p>def <span class="ident">filter_value_to_python</span>(</p><p>self, value, field_name, filters, filter_expr, filter_type)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.filter_value_to_python">filter_value_to_python</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Turn the string <code>value</code> into a python object.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.filter_value_to_python', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.filter_value_to_python" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">filter_value_to_python</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">filters</span><span class="p">,</span> <span class="n">filter_expr</span><span class="p">,</span>
        <span class="n">filter_type</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Turn the string ``value`` into a python object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Simple values</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">string_to_python</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="c1"># Split on &#39;,&#39; if not empty string and either an in or range filter.</span>
    <span class="k">if</span> <span class="n">filter_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="s1">&#39;range&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">filters</span><span class="p">,</span> <span class="s1">&#39;getlist&#39;</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">filters</span><span class="o">.</span><span class="n">getlist</span><span class="p">(</span><span class="n">filter_expr</span><span class="p">):</span>
                <span class="n">value</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">part</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">value</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.full_dehydrate">
    <p>def <span class="ident">full_dehydrate</span>(</p><p>self, bundle, for_list=False)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.full_dehydrate">full_dehydrate</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Given a bundle with an object instance, extract the information from it
to populate the resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.full_dehydrate', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.full_dehydrate" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">full_dehydrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">for_list</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a bundle with an object instance, extract the information from it</span>
<span class="sd">    to populate the resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span>
    <span class="n">api_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span>
    <span class="n">resource_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span>
    <span class="c1"># Dehydrate each field.</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># If it&#39;s not for use in this mode, skip</span>
        <span class="n">field_use_in</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">use_in</span>
        <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_use_in</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">field_use_in</span><span class="p">(</span><span class="n">bundle</span><span class="p">):</span>
                <span class="k">continue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">field_use_in</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;list&#39;</span> <span class="k">if</span> <span class="n">for_list</span> <span class="k">else</span> <span class="s1">&#39;detail&#39;</span><span class="p">]:</span>
                <span class="k">continue</span>
        <span class="c1"># A touch leaky but it makes URI resolution work.</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">dehydrated_type</span> <span class="o">==</span> <span class="s1">&#39;related&#39;</span><span class="p">:</span>
            <span class="n">field_object</span><span class="o">.</span><span class="n">api_name</span> <span class="o">=</span> <span class="n">api_name</span>
            <span class="n">field_object</span><span class="o">.</span><span class="n">resource_name</span> <span class="o">=</span> <span class="n">resource_name</span>
        <span class="n">data</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="n">for_list</span><span class="o">=</span><span class="n">for_list</span><span class="p">)</span>
        <span class="c1"># Check for an optional method to do further dehydration.</span>
        <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;dehydrate_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.full_hydrate">
    <p>def <span class="ident">full_hydrate</span>(</p><p>self, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.full_hydrate">full_hydrate</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Given a populated bundle, distill it and turn it back into
a full-fledged object instance.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.full_hydrate', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.full_hydrate" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">full_hydrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a populated bundle, distill it and turn it back into</span>
<span class="sd">    a full-fledged object instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="p">()</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">readonly</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># Check for an optional method to do further hydration.</span>
        <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;hydrate_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
            <span class="n">bundle</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
            <span class="c1"># NOTE: We only get back a bundle when it is related field.</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Bundle</span><span class="p">)</span> <span class="ow">and</span> <span class="n">value</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_name</span><span class="p">):</span>
                <span class="n">bundle</span><span class="o">.</span><span class="n">errors</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">errors</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">field_object</span><span class="o">.</span><span class="n">null</span><span class="p">:</span>
                <span class="c1"># We need to avoid populating M2M data here as that will</span>
                <span class="c1"># cause things to blow up.</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_related</span><span class="p">:</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="k">elif</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                        <span class="c1"># NOTE: A bug fix in Django (ticket #18153) fixes incorrect behavior</span>
                        <span class="c1"># which Tastypie was relying on.  To fix this, we store value.obj to</span>
                        <span class="c1"># be saved later in save_related.</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="nb">setattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
                        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">ObjectDoesNotExist</span><span class="p">):</span>
                            <span class="n">bundle</span><span class="o">.</span><span class="n">related_objects_to_save</span><span class="p">[</span><span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">obj</span>
                    <span class="k">elif</span> <span class="n">field_object</span><span class="o">.</span><span class="n">blank</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="k">elif</span> <span class="n">field_object</span><span class="o">.</span><span class="n">null</span><span class="p">:</span>
                        <span class="nb">setattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.generate_cache_key">
    <p>def <span class="ident">generate_cache_key</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.generate_cache_key">generate_cache_key</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Creates a unique-enough cache key.</p>
<p>This is based off the current api_name/resource_name/args/kwargs.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.generate_cache_key', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.generate_cache_key" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">generate_cache_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a unique-enough cache key.</span>
<span class="sd">    This is based off the current api_name/resource_name/args/kwargs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">smooshed</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">=</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
    <span class="c1"># Use a list plus a ``.join()`` because it&#39;s faster than concatenation.</span>
    <span class="k">return</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">args</span><span class="p">),</span> <span class="s1">&#39;:&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">smooshed</span><span class="p">)))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.get_bundle_detail_data">
    <p>def <span class="ident">get_bundle_detail_data</span>(</p><p>self, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_bundle_detail_data">get_bundle_detail_data</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Convenience method to return the <code>detail_uri_name</code> attribute off
<code>bundle.obj</code>.</p>
<p>Usually just accesses <code>bundle.obj.pk</code> by default.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.get_bundle_detail_data', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.get_bundle_detail_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_bundle_detail_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convenience method to return the ``detail_uri_name`` attribute off</span>
<span class="sd">    ``bundle.obj``.</span>
<span class="sd">    Usually just accesses ``bundle.obj.pk`` by default.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.get_detail">
    <p>def <span class="ident">get_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_detail">get_detail</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Returns a single serialized resource.
Calls <code>cached_obj_get/obj_get</code> to provide the data, then handles that result
set and serializes it.
Should return a HttpResponse (200 OK).
Get a single CBHCompoundbatches from elasticsearch by running a query</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.get_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.get_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a single serialized resource.</span>
<span class="sd">    Calls ``cached_obj_get/obj_get`` to provide the data, then handles that result</span>
<span class="sd">    set and serializes it.</span>
<span class="sd">    Should return a HttpResponse (200 OK).</span>
<span class="sd">    Get a single CBHCompoundbatches from elasticsearch by running a query</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">basic_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">allowed_pids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">project_ids</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="n">concatenated_indices</span> <span class="o">=</span> <span class="n">elasticsearch_client</span><span class="o">.</span><span class="n">get_list_of_indicies</span><span class="p">(</span><span class="n">allowed_pids</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">elasticsearch_client</span><span class="o">.</span><span class="n">get_detail_data_elasticsearch</span><span class="p">(</span><span class="n">concatenated_indices</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;pk&quot;</span><span class="p">])</span>   
    
    <span class="n">requested_pid</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;projectfull&quot;</span><span class="p">][</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">requested_pid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_pids</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">(</span><span class="s2">&quot;No permissions for requested project&quot;</span><span class="p">)</span> 
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.get_fields">
    <p>def <span class="ident">get_fields</span>(</p><p>cls, fields=None, excludes=None)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_fields">get_fields</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Given any explicit fields to include and fields to exclude, add
additional fields based on the associated model.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.get_fields', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.get_fields" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">get_fields</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">excludes</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given any explicit fields to include and fields to exclude, add</span>
<span class="sd">    additional fields based on the associated model.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">final_fields</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">fields</span> <span class="o">=</span> <span class="n">fields</span> <span class="ow">or</span> <span class="p">[]</span>
    <span class="n">excludes</span> <span class="o">=</span> <span class="n">excludes</span> <span class="ow">or</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">cls</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">final_fields</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">cls</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
        <span class="c1"># If the field name is already present, skip</span>
        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">cls</span><span class="o">.</span><span class="n">base_fields</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># If field is not present in explicit field listing, skip</span>
        <span class="k">if</span> <span class="n">fields</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># If field is in exclude list, skip</span>
        <span class="k">if</span> <span class="n">excludes</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">excludes</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">cls</span><span class="o">.</span><span class="n">should_skip_field</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="n">api_field_class</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">api_field_from_django_field</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;attribute&#39;</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s1">&#39;help_text&#39;</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">help_text</span><span class="p">,</span>
            <span class="s1">&#39;verbose_name&#39;</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">verbose_name</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">null</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;null&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;unique&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">unique</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">f</span><span class="o">.</span><span class="n">null</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">blank</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;blank&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">get_internal_type</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;TextField&#39;</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">has_default</span><span class="p">():</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">default</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;auto_now&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">auto_now</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;auto_now_add&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">auto_now_add</span>
        <span class="n">final_fields</span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">api_field_class</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">final_fields</span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">instance_name</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span>
    <span class="k">return</span> <span class="n">final_fields</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.get_list">
    <p>def <span class="ident">get_list</span>(</p><p>self, request, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_list">get_list</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Returns a serialized list of resources.
Calls <code>obj_get_list</code> to provide the data, then handles that result
set and serializes it.
Should return a HttpResponse (200 OK).
Get a list of CBHCompoundbatches from elasticsearch by running a query</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.get_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.get_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a serialized list of resources.</span>
<span class="sd">    Calls ``obj_get_list`` to provide the data, then handles that result</span>
<span class="sd">    set and serializes it.</span>
<span class="sd">    Should return a HttpResponse (200 OK).</span>
<span class="sd">    Get a list of CBHCompoundbatches from elasticsearch by running a query</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">base_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="n">pids</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pids&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">project_ids</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">pids</span><span class="p">:</span>
        <span class="n">project_ids</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">pid</span><span class="p">)</span> <span class="k">for</span> <span class="n">pid</span> <span class="ow">in</span> <span class="n">pids</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)]</span>
    
    <span class="n">allowed_pids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">project_ids</span><span class="p">(</span><span class="n">request</span><span class="p">))</span>
    
    <span class="k">for</span> <span class="n">requested_pid</span> <span class="ow">in</span> <span class="n">project_ids</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">requested_pid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_pids</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">(</span><span class="s2">&quot;No permissions for requested project&quot;</span><span class="p">)</span> 
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">project_ids</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">project_ids</span> <span class="o">=</span> <span class="n">allowed_pids</span>
    <span class="n">queries</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">b64decode</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;encoded_query&quot;</span><span class="p">,</span> <span class="n">EMPTY_ARRAY_B64</span><span class="p">)))</span>
    <span class="n">extra_queries</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;extra_queries&quot;</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">extra_queries</span><span class="p">:</span>
        <span class="c1">#extra queries can be added via kwargs</span>
        <span class="n">queries</span> <span class="o">+=</span> <span class="n">extra_queries</span>
    <span class="c1">#Search for whether this item is archived or not (&quot;archived is indexed as a string&quot;)</span>
    <span class="n">archived</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;archived&quot;</span><span class="p">,</span> <span class="s2">&quot;false&quot;</span><span class="p">)</span>
    <span class="n">queries</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;query_type&quot;</span><span class="p">:</span> <span class="s2">&quot;phrase&quot;</span><span class="p">,</span> <span class="s2">&quot;field_path&quot;</span><span class="p">:</span> <span class="s2">&quot;properties.archived&quot;</span><span class="p">,</span> <span class="s2">&quot;phrase&quot;</span><span class="p">:</span> <span class="n">archived</span><span class="p">})</span>
   
    <span class="n">sorts</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">b64decode</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;encoded_sorts&quot;</span><span class="p">,</span> <span class="n">EMPTY_ARRAY_B64</span><span class="p">)))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sorts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">sorts</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;field_path&quot;</span><span class="p">:</span><span class="s2">&quot;id&quot;</span><span class="p">,</span><span class="s2">&quot;sort_direction&quot;</span><span class="p">:</span><span class="s2">&quot;desc&quot;</span><span class="p">}]</span>
    <span class="n">textsearch</span> <span class="o">=</span> <span class="n">b64decode</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;textsearch&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
    <span class="n">limit</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;limit&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">offset</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;offset&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">autocomplete</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;autocomplete&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">autocomplete_field_path</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;autocomplete_field_path&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">autocomplete_size</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;autocomplete_size&quot;</span><span class="p">,</span> <span class="n">settings</span><span class="o">.</span><span class="n">MAX_AUTOCOMPLETE_SIZE</span><span class="p">)</span>
    <span class="n">pr</span> <span class="o">=</span> <span class="n">ChemregProjectResource</span><span class="p">()</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">get_list</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">do_cache</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">project_content</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
    <span class="n">restricted_fieldnames</span> <span class="o">=</span> <span class="n">project_content</span><span class="p">[</span><span class="s2">&quot;user_restricted_fieldnames&quot;</span><span class="p">]</span>
    <span class="c1">#The project ids list needs to be reduced down</span>
    <span class="c1">#Because we dont support OR queries then every time you query a project for </span>
    <span class="c1">#a field then only the projects that have that field (and unrestricted) need to be shown</span>
    <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">queries</span><span class="p">:</span>
         <span class="n">project_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">check_if_field_restricted</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="s2">&quot;field_path&quot;</span><span class="p">],</span> <span class="n">project_ids</span><span class="p">,</span> <span class="n">restricted_fieldnames</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">autocomplete_field_path</span><span class="p">:</span>
        <span class="n">project_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">check_if_field_restricted</span><span class="p">(</span><span class="n">autocomplete_field_path</span><span class="p">,</span> <span class="n">project_ids</span><span class="p">,</span> <span class="n">restricted_fieldnames</span><span class="p">)</span>
    <span class="n">concatenated_indices</span> <span class="o">=</span> <span class="n">elasticsearch_client</span><span class="o">.</span><span class="n">get_list_of_indicies</span><span class="p">(</span><span class="n">project_ids</span><span class="p">)</span>
    <span class="n">chemical_search_id</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;chemical_search_id&quot;</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
    <span class="n">batch_ids_by_project</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">if</span> <span class="n">chemical_search_id</span><span class="p">:</span>
        <span class="n">batch_result</span> <span class="o">=</span> <span class="n">result</span><span class="p">(</span><span class="n">chemical_search_id</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="mi">20000</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">batch_result</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s1">&#39;{&quot;error&quot;: &quot;Unable to process structure search&quot;}&#39;</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="mi">503</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span> <span class="n">batch_result</span>
            <span class="n">batch_ids_by_project</span> <span class="o">=</span> <span class="n">batch_result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;format&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;sdf&quot;</span> <span class="ow">and</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;format&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;xlsx&quot;</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">elasticsearch_client</span><span class="o">.</span><span class="n">get_list_data_elasticsearch</span><span class="p">(</span><span class="n">queries</span><span class="p">,</span>
            <span class="n">concatenated_indices</span><span class="p">,</span>
            <span class="n">sorts</span><span class="o">=</span><span class="n">sorts</span><span class="p">,</span> 
            <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">,</span> 
            <span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">,</span> 
            <span class="n">textsearch</span><span class="o">=</span><span class="n">textsearch</span><span class="p">,</span> 
            <span class="n">autocomplete</span><span class="o">=</span><span class="n">autocomplete</span><span class="p">,</span>
            <span class="n">autocomplete_field_path</span><span class="o">=</span><span class="n">autocomplete_field_path</span><span class="p">,</span>
            <span class="n">autocomplete_size</span><span class="o">=</span><span class="n">autocomplete_size</span><span class="p">,</span>
            <span class="n">batch_ids_by_project</span><span class="o">=</span><span class="n">batch_ids_by_project</span>
             <span class="p">)</span>
        
        
        <span class="k">if</span> <span class="n">autocomplete_field_path</span><span class="p">:</span>
        
            <span class="n">bucks</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;aggregations&quot;</span><span class="p">][</span><span class="s2">&quot;filtered_field_path&quot;</span><span class="p">][</span><span class="s2">&quot;field_path_terms&quot;</span><span class="p">][</span><span class="s2">&quot;buckets&quot;</span><span class="p">]</span>
            <span class="n">bundledata</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;items&quot;</span> <span class="p">:</span> <span class="n">bucks</span><span class="p">,</span>
                        <span class="s2">&quot;autocomplete&quot;</span> <span class="p">:</span> <span class="n">autocomplete</span><span class="p">,</span>
                        <span class="s2">&quot;unique_count&quot;</span> <span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;aggregations&quot;</span><span class="p">][</span><span class="s2">&quot;filtered_field_path&quot;</span><span class="p">][</span><span class="s2">&quot;unique_count&quot;</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">]}</span>
    
        <span class="k">else</span><span class="p">:</span>
            <span class="n">bundledata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prepare_es_hits</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">bundledata</span><span class="p">[</span><span class="s2">&quot;objects&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">removed_restricted_fields_if_present</span><span class="p">(</span><span class="n">bundledata</span><span class="p">[</span><span class="s2">&quot;objects&quot;</span><span class="p">],</span> <span class="n">restricted_fieldnames</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#Limit , offset and autocomplete have no effect for a project export</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_project_specific_data</span><span class="p">(</span><span class="n">request</span><span class="p">,</span>  <span class="n">queries</span><span class="p">,</span> <span class="n">project_ids</span><span class="p">,</span> <span class="n">sorts</span><span class="p">,</span> <span class="n">textsearch</span><span class="p">,</span> <span class="n">batch_ids_by_project</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span> 
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundledata</span><span class="p">)</span> 
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.get_multiple">
    <p>def <span class="ident">get_multiple</span>(</p><p>self, request, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_multiple">get_multiple</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Returns a serialized list of resources based on the identifiers
from the URL.</p>
<p>Calls <code>obj_get</code> to fetch only the objects requested. This method
only responds to HTTP GET.</p>
<p>Should return a HttpResponse (200 OK).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.get_multiple', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.get_multiple" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_multiple</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a serialized list of resources based on the identifiers</span>
<span class="sd">    from the URL.</span>
<span class="sd">    Calls ``obj_get`` to fetch only the objects requested. This method</span>
<span class="sd">    only responds to HTTP GET.</span>
<span class="sd">    Should return a HttpResponse (200 OK).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">method_check</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">allowed</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;get&#39;</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">throttle_check</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="c1"># Rip apart the list then iterate.</span>
    <span class="n">kwarg_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_list&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span>
    <span class="n">obj_identifiers</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">kwarg_name</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
    <span class="n">objects</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">not_found</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">base_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">identifier</span> <span class="ow">in</span> <span class="n">obj_identifiers</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">base_bundle</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">:</span> <span class="n">identifier</span><span class="p">})</span>
            <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
            <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="n">for_list</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="n">objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">ObjectDoesNotExist</span><span class="p">,</span> <span class="n">Unauthorized</span><span class="p">):</span>
            <span class="n">not_found</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">identifier</span><span class="p">)</span>
    <span class="n">object_list</span> <span class="o">=</span> <span class="p">{</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">:</span> <span class="n">objects</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">not_found</span><span class="p">):</span>
        <span class="n">object_list</span><span class="p">[</span><span class="s1">&#39;not_found&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">not_found</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_throttled_access</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">object_list</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.get_object_list">
    <p>def <span class="ident">get_object_list</span>(</p><p>self, request)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_object_list">get_object_list</a></code>
    </p>

    
  
    <div class="desc inherited"><p>An ORM-specific implementation of <code>get_object_list</code>.</p>
<p>Returns a queryset that may have been limited by other overrides.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.get_object_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.get_object_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_object_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An ORM-specific implementation of ``get_object_list``.</span>
<span class="sd">    Returns a queryset that may have been limited by other overrides.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">queryset</span><span class="o">.</span><span class="n">_clone</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.get_project_specific_data">
    <p>def <span class="ident">get_project_specific_data</span>(</p><p>self, request, queries, pids, sorts, textsearch, batch_ids_by_project)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_project_specific_data">get_project_specific_data</a></code>
    </p>

    
  
    <div class="desc inherited"><p>When an Excel or SDF download is requested, 
present the data as a
project by project summary so that 
one spreadsheet can be used per project</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.get_project_specific_data', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.get_project_specific_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_project_specific_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">queries</span><span class="p">,</span> <span class="n">pids</span><span class="p">,</span> <span class="n">sorts</span><span class="p">,</span> <span class="n">textsearch</span><span class="p">,</span> <span class="n">batch_ids_by_project</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;When an Excel or SDF download is requested, </span>
<span class="sd">    present the data as a</span>
<span class="sd">    project by project summary so that </span>
<span class="sd">    one spreadsheet can be used per project&quot;&quot;&quot;</span>
    <span class="n">to_return</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">pids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pids</span><span class="p">)</span>
    <span class="n">table_schemata</span> <span class="o">=</span> <span class="n">get_schemata</span><span class="p">(</span><span class="n">pids</span><span class="p">,</span> <span class="s2">&quot;export&quot;</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="c1">#We have removed the schema from the index for data efficiency so</span>
    <span class="c1">#We need to pull it out of the project resource</span>
        
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">proj_data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">table_schemata</span><span class="p">):</span>
        <span class="n">table_schema_for_project</span> <span class="o">=</span> <span class="n">proj_data</span><span class="p">[</span><span class="s2">&quot;tabular_data_schema&quot;</span><span class="p">][</span><span class="s2">&quot;for_export&quot;</span><span class="p">]</span>
        <span class="n">pid</span> <span class="o">=</span> <span class="n">pids</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="n">proj_index</span> <span class="o">=</span> <span class="n">elasticsearch_client</span><span class="o">.</span><span class="n">get_project_index_name</span><span class="p">(</span><span class="n">pid</span><span class="p">)</span>
        <span class="n">es_data</span> <span class="o">=</span> <span class="n">elasticsearch_client</span><span class="o">.</span><span class="n">get_list_data_elasticsearch</span><span class="p">(</span><span class="n">queries</span><span class="p">,</span>
                <span class="n">proj_index</span><span class="p">,</span>
                <span class="n">sorts</span><span class="o">=</span><span class="n">sorts</span><span class="p">,</span> 
                <span class="n">textsearch</span><span class="o">=</span><span class="n">textsearch</span><span class="p">,</span>
                <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">limit</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
                <span class="n">batch_ids_by_project</span><span class="o">=</span><span class="n">batch_ids_by_project</span> <span class="p">)</span>
        <span class="n">standardised</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prepare_es_hits</span><span class="p">(</span><span class="n">es_data</span><span class="p">)</span>
        <span class="n">standardised</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">proj_data</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
        <span class="n">standardised</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pid</span>
        <span class="n">standardised</span><span class="p">[</span><span class="s2">&quot;schema&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">table_schema_for_project</span>
        <span class="n">base</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;wsgi.url_scheme&quot;</span><span class="p">,</span><span class="s2">&quot;http&quot;</span><span class="p">)</span> 
        <span class="n">base</span> <span class="o">+=</span> <span class="s2">&quot;://&quot;</span>
        <span class="n">base</span> <span class="o">+=</span> <span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;HTTP_HOST&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">standardised</span><span class="p">[</span><span class="s2">&quot;schema&quot;</span><span class="p">]:</span>
            <span class="n">field</span><span class="p">[</span><span class="s2">&quot;base_url&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">base</span>
        <span class="n">to_return</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">standardised</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;format&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;sdf&quot;</span><span class="p">:</span>
        <span class="c1">#For the Excel sheet print out the query used</span>
        <span class="n">query_reps</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;fieldn&quot;</span><span class="p">:</span> <span class="s2">&quot;Project&quot;</span><span class="p">,</span> <span class="s2">&quot;pick_from_list&quot;</span><span class="p">:</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">ret</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span> <span class="k">for</span> <span class="n">ret</span> <span class="ow">in</span> <span class="n">to_return</span><span class="p">])</span> <span class="p">}]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">q</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">queries</span><span class="p">):</span>
            <span class="n">qrep</span> <span class="o">=</span> <span class="p">{</span><span class="n">qtype</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="p">:</span> <span class="s2">u&quot;&quot;</span> <span class="k">for</span> <span class="n">qtype</span> <span class="ow">in</span> <span class="n">settings</span><span class="o">.</span><span class="n">CBH_QUERY_TYPES</span><span class="p">}</span>
            <span class="n">qrep</span><span class="p">[</span><span class="s2">&quot;fieldn&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">q</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;pick_from_list&quot;</span><span class="p">:</span>
                    <span class="n">qrep</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;field_path&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
                        <span class="n">knownBy</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">TABULAR_DATA_SETTINGS</span><span class="p">[</span><span class="s2">&quot;schema&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">value</span><span class="p">,{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;knownBy&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">knownBy</span><span class="p">:</span>
                            <span class="n">knownBy</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                        <span class="n">qrep</span><span class="p">[</span><span class="s2">&quot;fieldn&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">l</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">knownBy</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">qrep</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="n">qrep</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
            <span class="n">query_reps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">qrep</span><span class="p">)</span>
        <span class="n">schem</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;knownBy&quot;</span> <span class="p">:</span> <span class="s2">&quot;Row&quot;</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;fieldn&quot;</span><span class="p">,</span> <span class="s2">&quot;knownBy&quot;</span> <span class="p">:</span> <span class="s2">&quot;Col&quot;</span><span class="p">}]</span> <span class="o">+</span> <span class="p">[{</span><span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">qtype</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">],</span> <span class="s2">&quot;knownBy&quot;</span> <span class="p">:</span> <span class="n">qtype</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]}</span> <span class="k">for</span> <span class="n">qtype</span> <span class="ow">in</span> <span class="n">settings</span><span class="o">.</span><span class="n">CBH_QUERY_TYPES</span><span class="p">]</span>
        <span class="n">query_summary</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;_Query Used&quot;</span><span class="p">,</span>
                <span class="s2">&quot;objects&quot;</span> <span class="p">:</span> <span class="n">query_reps</span><span class="p">,</span>
                <span class="s2">&quot;schema&quot;</span> <span class="p">:</span> <span class="n">schem</span>
                <span class="p">}</span>
        <span class="n">to_return</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">query_summary</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">to_return</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.get_resource_uri">
    <p>def <span class="ident">get_resource_uri</span>(</p><p>self, bundle_or_obj=None, url_name=u&#39;api_dispatch_list&#39;)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_resource_uri">get_resource_uri</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles generating a resource URI.</p>
<p>If the <code>bundle_or_obj</code> argument is not provided, it builds the URI
for the list endpoint.</p>
<p>If the <code>bundle_or_obj</code> argument is provided, it builds the URI for
the detail endpoint.</p>
<p>Return the generated URI. If that URI can not be reversed (not found
in the URLconf), it will return an empty string.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.get_resource_uri', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.get_resource_uri" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_resource_uri</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle_or_obj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">url_name</span><span class="o">=</span><span class="s1">&#39;api_dispatch_list&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles generating a resource URI.</span>
<span class="sd">    If the ``bundle_or_obj`` argument is not provided, it builds the URI</span>
<span class="sd">    for the list endpoint.</span>
<span class="sd">    If the ``bundle_or_obj`` argument is provided, it builds the URI for</span>
<span class="sd">    the detail endpoint.</span>
<span class="sd">    Return the generated URI. If that URI can not be reversed (not found</span>
<span class="sd">    in the URLconf), it will return an empty string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">bundle_or_obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">url_name</span> <span class="o">=</span> <span class="s1">&#39;api_dispatch_detail&#39;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_reverse_url</span><span class="p">(</span><span class="n">url_name</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resource_uri_kwargs</span><span class="p">(</span><span class="n">bundle_or_obj</span><span class="p">))</span>
    <span class="k">except</span> <span class="n">NoReverseMatch</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.get_schema">
    <p>def <span class="ident">get_schema</span>(</p><p>self, request, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_schema">get_schema</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Returns a serialized form of the schema of the resource.</p>
<p>Calls <code>build_schema</code> to generate the data. This method only responds
to HTTP GET.</p>
<p>Should return a HttpResponse (200 OK).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.get_schema', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.get_schema" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a serialized form of the schema of the resource.</span>
<span class="sd">    Calls ``build_schema`` to generate the data. This method only responds</span>
<span class="sd">    to HTTP GET.</span>
<span class="sd">    Should return a HttpResponse (200 OK).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">method_check</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">allowed</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;get&#39;</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">throttle_check</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_throttled_access</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">authorized_read_detail</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">),</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_schema</span><span class="p">())</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.get_via_uri">
    <p>def <span class="ident">get_via_uri</span>(</p><p>self, uri, request=None)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.get_via_uri">get_via_uri</a></code>
    </p>

    
  
    <div class="desc inherited"><p>This pulls apart the salient bits of the URI and populates the
resource via a <code>obj_get</code>.</p>
<p>Optionally accepts a <code>request</code>.</p>
<p>If you need custom behavior based on other portions of the URI,
simply override this method.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.get_via_uri', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.get_via_uri" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_via_uri</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uri</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This pulls apart the salient bits of the URI and populates the</span>
<span class="sd">    resource via a ``obj_get``.</span>
<span class="sd">    Optionally accepts a ``request``.</span>
<span class="sd">    If you need custom behavior based on other portions of the URI,</span>
<span class="sd">    simply override this method.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="n">get_script_prefix</span><span class="p">()</span>
    <span class="n">chomped_uri</span> <span class="o">=</span> <span class="n">uri</span>
    <span class="k">if</span> <span class="n">prefix</span> <span class="ow">and</span> <span class="n">chomped_uri</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">prefix</span><span class="p">):</span>
        <span class="n">chomped_uri</span> <span class="o">=</span> <span class="n">chomped_uri</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:]</span>
    <span class="c1"># We mangle the path a bit further &amp; run URL resolution against *only*</span>
    <span class="c1"># the current class. This ought to prevent bad URLs from resolving to</span>
    <span class="c1"># incorrect data.</span>
    <span class="n">found_at</span> <span class="o">=</span> <span class="n">chomped_uri</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">found_at</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">NotFound</span><span class="p">(</span><span class="s2">&quot;An incorrect URL was provided &#39;</span><span class="si">%s</span><span class="s2">&#39; for the &#39;</span><span class="si">%s</span><span class="s2">&#39; resource.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">))</span>
    <span class="n">chomped_uri</span> <span class="o">=</span> <span class="n">chomped_uri</span><span class="p">[</span><span class="n">found_at</span><span class="p">:]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">url_resolver</span> <span class="ow">in</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;urls&#39;</span><span class="p">,</span> <span class="p">[]):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">url_resolver</span><span class="o">.</span><span class="n">resolve</span><span class="p">(</span><span class="n">chomped_uri</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">view</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span> <span class="o">=</span> <span class="n">result</span>
                <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Resolver404</span><span class="p">(</span><span class="s2">&quot;URI not found in &#39;self.urls&#39;.&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">Resolver404</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">NotFound</span><span class="p">(</span><span class="s2">&quot;The URL provided &#39;</span><span class="si">%s</span><span class="s2">&#39; was not a link to a valid resource.&quot;</span> <span class="o">%</span> <span class="n">uri</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.hydrate">
    <p>def <span class="ident">hydrate</span>(</p><p>self, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.hydrate">hydrate</a></code>
    </p>

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.hydrate', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.hydrate" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">hydrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">created_by_id</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.hydrate_blinded_batch_id">
    <p>def <span class="ident">hydrate_blinded_batch_id</span>(</p><p>self, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.hydrate_blinded_batch_id">hydrate_blinded_batch_id</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Hydrate functions are run before save of a new or updated model instance
This one ensures that the blinded batch id is filled in in cases where an inventory item 
with no ModelculeDictionary attribute (related_molregno)</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.hydrate_blinded_batch_id', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.hydrate_blinded_batch_id" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">hydrate_blinded_batch_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Hydrate functions are run before save of a new or updated model instance</span>
<span class="sd">    This one ensures that the blinded batch id is filled in in cases where an inventory item </span>
<span class="sd">    with no ModelculeDictionary attribute (related_molregno)&quot;&quot;&quot;</span> 
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;blinded_batch_id&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">u&quot;EMPTY_ID&quot;</span><span class="p">:</span>
        <span class="n">uox_id</span> <span class="o">=</span> <span class="n">generate_uox_id</span><span class="p">()</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;blinded_batch_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">uox_id</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">blinded_batch_id</span> <span class="o">=</span> <span class="n">uox_id</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.hydrate_m2m">
    <p>def <span class="ident">hydrate_m2m</span>(</p><p>self, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.hydrate_m2m">hydrate_m2m</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Populate the ManyToMany data on the instance.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.hydrate_m2m', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.hydrate_m2m" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">hydrate_m2m</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Populate the ManyToMany data on the instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrationError</span><span class="p">(</span><span class="s2">&quot;You must call &#39;full_hydrate&#39; before attempting to run &#39;hydrate_m2m&#39; on </span><span class="si">%r</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span>
            <span class="c1"># Note that we only hydrate the data, leaving the instance</span>
            <span class="c1"># unmodified. It&#39;s up to the user&#39;s code to handle this.</span>
            <span class="c1"># The ``ModelResource`` provides a working baseline</span>
            <span class="c1"># in this regard.</span>
            <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">hydrate_m2m</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;hydrate_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
            <span class="n">method</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.index_batch_list">
    <p>def <span class="ident">index_batch_list</span>(</p><p>self, request, batch_list, project_and_indexing_schemata, refresh=True)</p>
    </div>
    

    
  
    <div class="desc"><p>Index a list or queryset of compound batches into the elasticsearch indices (one index per project)</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.index_batch_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.index_batch_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">index_batch_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">batch_list</span><span class="p">,</span> <span class="n">project_and_indexing_schemata</span><span class="p">,</span> <span class="n">refresh</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Index a list or queryset of compound batches into the elasticsearch indices (one index per project)&quot;&quot;&quot;</span>
    
    <span class="n">request</span><span class="o">.</span><span class="n">GET</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="p">[</span><span class="s2">&quot;limit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;10000&quot;</span>
    <span class="n">ids</span> <span class="o">=</span> <span class="p">{</span><span class="n">b</span><span class="o">.</span><span class="n">created_by_id</span>  <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">batch_list</span><span class="p">}</span>
    <span class="n">no_none</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">uid</span> <span class="ow">in</span> <span class="n">ids</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">uid</span><span class="p">:</span>
            <span class="n">no_none</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">uid</span><span class="p">))</span>
    <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="p">[</span><span class="s2">&quot;id__in&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">no_none</span><span class="p">)</span>
    <span class="n">user_list</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">UserResource</span><span class="p">()</span><span class="o">.</span><span class="n">get_list</span><span class="p">(</span><span class="n">request</span><span class="p">)</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
    <span class="n">user_lookup</span> <span class="o">=</span> <span class="p">{</span> <span class="n">u</span><span class="p">[</span><span class="s2">&quot;resource_uri&quot;</span><span class="p">]:</span> <span class="n">u</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">user_list</span><span class="p">[</span><span class="s2">&quot;objects&quot;</span><span class="p">]</span> <span class="p">}</span>
    <span class="n">bundles</span> <span class="o">=</span> <span class="p">[</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">),</span> <span class="n">for_list</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">batch_list</span>
    <span class="p">]</span>
    <span class="c1">#retrieve schemas which tell the elasticsearch request which fields to index for each object (we avoid deserializing a single custom field config more than once)</span>
    <span class="c1">#Now make the schema list parallel to the batches list</span>
    <span class="n">batch_dicts</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Meta</span><span class="o">.</span><span class="n">serializer</span><span class="o">.</span><span class="n">to_simple</span><span class="p">(</span><span class="n">bun</span><span class="p">,</span> <span class="p">{})</span> <span class="k">for</span> <span class="n">bun</span> <span class="ow">in</span> <span class="n">bundles</span><span class="p">]</span>
    <span class="n">batch_dicts</span><span class="p">,</span> <span class="n">indexing_schemata</span> <span class="o">=</span> <span class="n">add_cached_projects_to_batch_list</span><span class="p">(</span><span class="n">batch_dicts</span><span class="p">,</span> <span class="n">project_and_indexing_schemata</span><span class="p">)</span>
    <span class="n">batch_dicts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prepare_fields_for_index</span><span class="p">(</span><span class="n">batch_dicts</span><span class="p">)</span>
    <span class="n">project_data_field_sets</span> <span class="o">=</span> <span class="p">[</span><span class="n">batch_dict</span><span class="p">[</span><span class="s2">&quot;projectfull&quot;</span><span class="p">][</span><span class="s2">&quot;custom_field_config&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;project_data_fields&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">batch_dict</span> <span class="ow">in</span> <span class="n">batch_dicts</span><span class="p">]</span>
    <span class="n">tab_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">batch_dict</span><span class="p">[</span><span class="s2">&quot;projectfull&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;tabular_data_schema&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">batch_dict</span> <span class="ow">in</span> <span class="n">batch_dicts</span><span class="p">]</span>
    <span class="n">index_names</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">batch_dicts</span><span class="p">:</span>
        <span class="n">batch</span><span class="p">[</span><span class="s2">&quot;projectfull&quot;</span><span class="p">][</span><span class="s2">&quot;custom_field_config&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="s2">&quot;projectfull&quot;</span><span class="p">][</span><span class="s2">&quot;custom_field_config&quot;</span><span class="p">][</span><span class="s2">&quot;resource_uri&quot;</span><span class="p">]</span>
        <span class="n">index_name</span> <span class="o">=</span> <span class="n">elasticsearch_client</span><span class="o">.</span><span class="n">get_project_index_name</span><span class="p">(</span><span class="n">batch</span><span class="p">[</span><span class="s2">&quot;projectfull&quot;</span><span class="p">][</span><span class="s2">&quot;id&quot;</span><span class="p">])</span>
        <span class="n">index_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">index_name</span><span class="p">)</span>
        <span class="n">batch</span><span class="p">[</span><span class="s2">&quot;userfull&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">user_lookup</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">batch</span><span class="p">[</span><span class="s2">&quot;creator&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s2">&quot;display_name&quot;</span> <span class="p">:</span> <span class="s2">&quot;User Deleted&quot;</span><span class="p">})</span>
    
    <span class="n">batch_dicts</span> <span class="o">=</span> <span class="n">elasticsearch_client</span><span class="o">.</span><span class="n">index_dataset</span><span class="p">(</span><span class="n">batch_dicts</span><span class="p">,</span> <span class="n">indexing_schemata</span><span class="p">,</span> <span class="n">index_names</span><span class="p">,</span> <span class="n">refresh</span><span class="o">=</span><span class="n">refresh</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.is_authenticated">
    <p>def <span class="ident">is_authenticated</span>(</p><p>self, request)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.is_authenticated">is_authenticated</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles checking if the user is authenticated and dealing with
unauthenticated users.</p>
<p>Mostly a hook, this uses class assigned to <code>authentication</code> from
<code>Resource._meta</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.is_authenticated', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.is_authenticated" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">is_authenticated</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking if the user is authenticated and dealing with</span>
<span class="sd">    unauthenticated users.</span>
<span class="sd">    Mostly a hook, this uses class assigned to ``authentication`` from</span>
<span class="sd">    ``Resource._meta``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Authenticate the request as needed.</span>
    <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authentication</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">auth_result</span><span class="p">,</span> <span class="n">HttpResponse</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">auth_result</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">auth_result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpUnauthorized</span><span class="p">())</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.is_valid">
    <p>def <span class="ident">is_valid</span>(</p><p>self, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.is_valid">is_valid</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles checking if the data provided by the user is valid.</p>
<p>Mostly a hook, this uses class assigned to <code>validation</code> from
<code>Resource._meta</code>.</p>
<p>If validation fails, an error is raised with the error messages
serialized inside it.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.is_valid', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.is_valid" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking if the data provided by the user is valid.</span>
<span class="sd">    Mostly a hook, this uses class assigned to ``validation`` from</span>
<span class="sd">    ``Resource._meta``.</span>
<span class="sd">    If validation fails, an error is raised with the error messages</span>
<span class="sd">    serialized inside it.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">validation</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">errors</span><span class="p">:</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">errors</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">errors</span>
        <span class="k">return</span> <span class="bp">False</span>
    <span class="k">return</span> <span class="bp">True</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.log_throttled_access">
    <p>def <span class="ident">log_throttled_access</span>(</p><p>self, request)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.log_throttled_access">log_throttled_access</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles the recording of the user's access for throttling purposes.</p>
<p>Mostly a hook, this uses class assigned to <code>throttle</code> from
<code>Resource._meta</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.log_throttled_access', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.log_throttled_access" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">log_throttled_access</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles the recording of the user&#39;s access for throttling purposes.</span>
<span class="sd">    Mostly a hook, this uses class assigned to ``throttle`` from</span>
<span class="sd">    ``Resource._meta``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">request_method</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">throttle</span><span class="o">.</span><span class="n">accessed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authentication</span><span class="o">.</span><span class="n">get_identifier</span><span class="p">(</span><span class="n">request</span><span class="p">),</span> <span class="n">url</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">get_full_path</span><span class="p">(),</span> <span class="n">request_method</span><span class="o">=</span><span class="n">request_method</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.lookup_kwargs_with_identifiers">
    <p>def <span class="ident">lookup_kwargs_with_identifiers</span>(</p><p>self, bundle, kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.lookup_kwargs_with_identifiers">lookup_kwargs_with_identifiers</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Kwargs here represent uri identifiers Ex: /repos/<user_id>/<repo_name>/
We need to turn those identifiers into Python objects for generating
lookup parameters that can find them in the DB</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.lookup_kwargs_with_identifiers', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.lookup_kwargs_with_identifiers" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">lookup_kwargs_with_identifiers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Kwargs here represent uri identifiers Ex: /repos/&lt;user_id&gt;/&lt;repo_name&gt;/</span>
<span class="sd">    We need to turn those identifiers into Python objects for generating</span>
<span class="sd">    lookup parameters that can find them in the DB</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lookup_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">)</span><span class="o">.</span><span class="n">model</span><span class="p">()</span>
    <span class="c1"># Override data values, we rely on uri identifiers</span>
    <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="c1"># We&#39;re going to manually hydrate, as opposed to calling</span>
    <span class="c1"># ``full_hydrate``, to ensure we don&#39;t try to flesh out related</span>
    <span class="c1"># resources &amp; keep things speedy.</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">identifier</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">identifier</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">:</span>
            <span class="n">lookup_kwargs</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span>
            <span class="k">continue</span>
        <span class="n">field_object</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span>
        <span class="c1"># Skip readonly or related fields.</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">readonly</span> <span class="ow">is</span> <span class="bp">True</span> <span class="ow">or</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_related</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># Check for an optional method to do further hydration.</span>
        <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;hydrate_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">identifier</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
            <span class="n">bundle</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="n">lookup_kwargs</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
    <span class="k">return</span> <span class="n">lookup_kwargs</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.method_check">
    <p>def <span class="ident">method_check</span>(</p><p>self, request, allowed=None)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.method_check">method_check</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Ensures that the HTTP method used on the request is allowed to be
handled by the resource.</p>
<p>Takes an <code>allowed</code> parameter, which should be a list of lowercase
HTTP methods to check against. Usually, this looks like::</p>
<div class="codehilite"><pre><span></span># The most generic lookup.
self.method_check(request, self._meta.allowed_methods)

# A lookup against what&#39;s allowed for list-type methods.
self.method_check(request, self._meta.list_allowed_methods)

# A useful check when creating a new endpoint that only handles
# GET.
self.method_check(request, [&#39;get&#39;])
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.method_check', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.method_check" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">method_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">allowed</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Ensures that the HTTP method used on the request is allowed to be</span>
<span class="sd">    handled by the resource.</span>
<span class="sd">    Takes an ``allowed`` parameter, which should be a list of lowercase</span>
<span class="sd">    HTTP methods to check against. Usually, this looks like::</span>
<span class="sd">        # The most generic lookup.</span>
<span class="sd">        self.method_check(request, self._meta.allowed_methods)</span>
<span class="sd">        # A lookup against what&#39;s allowed for list-type methods.</span>
<span class="sd">        self.method_check(request, self._meta.list_allowed_methods)</span>
<span class="sd">        # A useful check when creating a new endpoint that only handles</span>
<span class="sd">        # GET.</span>
<span class="sd">        self.method_check(request, [&#39;get&#39;])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">allowed</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">allowed</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">request_method</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">allows</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">meth</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">allowed</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">request_method</span> <span class="o">==</span> <span class="s2">&quot;options&quot;</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="n">allows</span><span class="p">)</span>
        <span class="n">response</span><span class="p">[</span><span class="s1">&#39;Allow&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">allows</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">request_method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpMethodNotAllowed</span><span class="p">(</span><span class="n">allows</span><span class="p">)</span>
        <span class="n">response</span><span class="p">[</span><span class="s1">&#39;Allow&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">allows</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">request_method</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.obj_create">
    <p>def <span class="ident">obj_create</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_create">obj_create</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A ORM-specific implementation of <code>obj_create</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.obj_create', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.obj_create" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_create``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.obj_delete">
    <p>def <span class="ident">obj_delete</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_delete">obj_delete</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A ORM-specific implementation of <code>obj_delete</code>.</p>
<p>Takes optional <code>kwargs</code>, which are used to narrow the query to find
the instance.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.obj_delete', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.obj_delete" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_delete``.</span>
<span class="sd">    Takes optional ``kwargs``, which are used to narrow the query to find</span>
<span class="sd">    the instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="s1">&#39;delete&#39;</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ObjectDoesNotExist</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NotFound</span><span class="p">(</span><span class="s2">&quot;A model instance matching the provided arguments could not be found.&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">authorized_delete_detail</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">),</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.obj_delete_list">
    <p>def <span class="ident">obj_delete_list</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_delete_list">obj_delete_list</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A ORM-specific implementation of <code>obj_delete_list</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.obj_delete_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.obj_delete_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_delete_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_delete_list``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">objects_to_delete</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">deletable_objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">authorized_delete_list</span><span class="p">(</span><span class="n">objects_to_delete</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">deletable_objects</span><span class="p">,</span> <span class="s1">&#39;delete&#39;</span><span class="p">):</span>
        <span class="c1"># It&#39;s likely a ``QuerySet``. Call ``.delete()`` for efficiency.</span>
        <span class="n">deletable_objects</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">authed_obj</span> <span class="ow">in</span> <span class="n">deletable_objects</span><span class="p">:</span>
            <span class="n">authed_obj</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.obj_delete_list_for_update">
    <p>def <span class="ident">obj_delete_list_for_update</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_delete_list_for_update">obj_delete_list_for_update</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A ORM-specific implementation of <code>obj_delete_list_for_update</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.obj_delete_list_for_update', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.obj_delete_list_for_update" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_delete_list_for_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_delete_list_for_update``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">objects_to_delete</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">deletable_objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">authorized_update_list</span><span class="p">(</span><span class="n">objects_to_delete</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">deletable_objects</span><span class="p">,</span> <span class="s1">&#39;delete&#39;</span><span class="p">):</span>
        <span class="c1"># It&#39;s likely a ``QuerySet``. Call ``.delete()`` for efficiency.</span>
        <span class="n">deletable_objects</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">authed_obj</span> <span class="ow">in</span> <span class="n">deletable_objects</span><span class="p">:</span>
            <span class="n">authed_obj</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.obj_get">
    <p>def <span class="ident">obj_get</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_get">obj_get</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A ORM-specific implementation of <code>obj_get</code>.</p>
<p>Takes optional <code>kwargs</code>, which are used to narrow the query to find
the instance.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.obj_get', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.obj_get" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_get``.</span>
<span class="sd">    Takes optional ``kwargs``, which are used to narrow the query to find</span>
<span class="sd">    the instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># prevents FieldError when looking up nested resources containing extra data</span>
    <span class="n">field_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">get_all_field_names</span><span class="p">()</span>
    <span class="n">field_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;pk&#39;</span><span class="p">)</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">field_names</span><span class="p">}</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">object_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">stringified_kwargs</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">=</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">object_list</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="o">.</span><span class="n">DoesNotExist</span><span class="p">(</span><span class="s2">&quot;Couldn&#39;t find an instance of &#39;</span><span class="si">%s</span><span class="s2">&#39; which matched &#39;</span><span class="si">%s</span><span class="s2">&#39;.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">stringified_kwargs</span><span class="p">))</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">object_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MultipleObjectsReturned</span><span class="p">(</span><span class="s2">&quot;More than &#39;</span><span class="si">%s</span><span class="s2">&#39; matched &#39;</span><span class="si">%s</span><span class="s2">&#39;.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">stringified_kwargs</span><span class="p">))</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">object_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">authorized_read_detail</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">NotFound</span><span class="p">(</span><span class="s2">&quot;Invalid resource lookup data provided (mismatched type).&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.obj_get_list">
    <p>def <span class="ident">obj_get_list</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_get_list">obj_get_list</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A ORM-specific implementation of <code>obj_get_list</code>.</p>
<p>Takes an optional <code>request</code> object, whose <code>GET</code> dictionary can be
used to narrow the query.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.obj_get_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.obj_get_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_get_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_get_list``.</span>
<span class="sd">    Takes an optional ``request`` object, whose ``GET`` dictionary can be</span>
<span class="sd">    used to narrow the query.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">filters</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;GET&#39;</span><span class="p">):</span>
        <span class="c1"># Grab a mutable copy.</span>
        <span class="n">filters</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="c1"># Update with the provided kwargs.</span>
    <span class="n">filters</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">applicable_filters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_filters</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_filters</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">,</span> <span class="n">applicable_filters</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">authorized_read_list</span><span class="p">(</span><span class="n">objects</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">BadRequest</span><span class="p">(</span><span class="s2">&quot;Invalid resource lookup data provided (mismatched type).&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.obj_update">
    <p>def <span class="ident">obj_update</span>(</p><p>self, bundle, skip_errors=False, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.obj_update">obj_update</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A ORM-specific implementation of <code>obj_update</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.obj_update', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.obj_update" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">skip_errors</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_update``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bundle_detail_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bundle_detail_data</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="n">arg_detail_data</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">bundle_detail_data</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">arg_detail_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="nb">str</span><span class="p">(</span><span class="n">bundle_detail_data</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">str</span><span class="p">(</span><span class="n">arg_detail_data</span><span class="p">)):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">lookup_kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lookup_kwargs_with_identifiers</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="c1"># if there is trouble hydrating the data, fall back to just</span>
            <span class="c1"># using kwargs by itself (usually it only contains a &quot;pk&quot; key</span>
            <span class="c1"># and this will work fine.</span>
            <span class="n">lookup_kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">lookup_kwargs</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ObjectDoesNotExist</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NotFound</span><span class="p">(</span><span class="s2">&quot;A model instance matching the provided arguments could not be found.&quot;</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="n">skip_errors</span><span class="o">=</span><span class="n">skip_errors</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.override_urls">
    <p>def <span class="ident">override_urls</span>(</p><p>self)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.override_urls">override_urls</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Deprecated. Will be removed by v1.0.0. Please use <code>prepend_urls</code> instead.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.override_urls', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.override_urls" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">override_urls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Deprecated. Will be removed by v1.0.0. Please use ``prepend_urls`` instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.patch_detail">
    <p>def <span class="ident">patch_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.patch_detail">patch_detail</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Updates a resource in-place.</p>
<p>Calls <code>obj_update</code>.</p>
<p>If the resource is updated, return <code>HttpAccepted</code> (202 Accepted).
If the resource did not exist, return <code>HttpNotFound</code> (404 Not Found).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.patch_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.patch_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">patch_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates a resource in-place.</span>
<span class="sd">    Calls ``obj_update``.</span>
<span class="sd">    If the resource is updated, return ``HttpAccepted`` (202 Accepted).</span>
<span class="sd">    If the resource did not exist, return ``HttpNotFound`` (404 Not Found).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">request</span> <span class="o">=</span> <span class="n">convert_post_to_patch</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="n">basic_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="c1"># We want to be able to validate the update, but we can&#39;t just pass</span>
    <span class="c1"># the partial data into the validator since all data needs to be</span>
    <span class="c1"># present. Instead, we basically simulate a PUT by pulling out the</span>
    <span class="c1"># original data and updating it in-place.</span>
    <span class="c1"># So first pull out the original object. This is essentially</span>
    <span class="c1"># ``get_detail``.</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cached_obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">basic_bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="k">except</span> <span class="n">ObjectDoesNotExist</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNotFound</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">MultipleObjectsReturned</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpMultipleChoices</span><span class="p">(</span><span class="s2">&quot;More than one resource is found at this URI.&quot;</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="c1"># Now update the bundle in-place.</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">update_in_place</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">deserialized</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">always_return_data</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpAccepted</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Invalidate prefetched_objects_cache for bundled object</span>
        <span class="c1"># because we might have changed a prefetched field</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_prefetched_objects_cache</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpAccepted</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.patch_list">
    <p>def <span class="ident">patch_list</span>(</p><p>*args, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.patch_list">patch_list</a></code>
    </p>

    
  
    <div class="desc inherited"><p>An ORM-specific implementation of <code>patch_list</code>.</p>
<p>Necessary because PATCH should be atomic (all-success or all-fail)
and the only way to do this neatly is at the database level.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.patch_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.patch_list" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@wraps</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">assigned</span><span class="o">=</span><span class="n">available_attrs</span><span class="p">(</span><span class="n">func</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">with</span> <span class="bp">self</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.post_detail">
    <p>def <span class="ident">post_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.post_detail">post_detail</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Creates a new subcollection of the resource under a resource.</p>
<p>This is not implemented by default because most people's data models
aren't self-referential.</p>
<p>If a new resource is created, return <code>HttpCreated</code> (201 Created).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.post_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.post_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">post_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a new subcollection of the resource under a resource.</span>
<span class="sd">    This is not implemented by default because most people&#39;s data models</span>
<span class="sd">    aren&#39;t self-referential.</span>
<span class="sd">    If a new resource is created, return ``HttpCreated`` (201 Created).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNotImplemented</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.post_list">
    <p>def <span class="ident">post_list</span>(</p><p>self, request, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.post_list">post_list</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Creates a new resource/object with the provided data.</p>
<p>Calls <code>obj_create</code> with the provided data and returns a response
with the new resource's location.</p>
<p>If a new resource is created, return <code>HttpCreated</code> (201 Created).
If <code>Meta.always_return_data = True</code>, there will be a populated body
of serialized data.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.post_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.post_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">post_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a new resource/object with the provided data.</span>
<span class="sd">    Calls ``obj_create`` with the provided data and returns a response</span>
<span class="sd">    with the new resource&#39;s location.</span>
<span class="sd">    If a new resource is created, return ``HttpCreated`` (201 Created).</span>
<span class="sd">    If ``Meta.always_return_data = True``, there will be a populated body</span>
<span class="sd">    of serialized data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">))</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_deserialized_detail_data</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">deserialized</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dict_strip_unicode_keys</span><span class="p">(</span><span class="n">deserialized</span><span class="p">),</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_create</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="n">location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_uri</span><span class="p">(</span><span class="n">updated_bundle</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">always_return_data</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpCreated</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">updated_bundle</span><span class="p">)</span>
        <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpCreated</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.prepare_es_hits">
    <p>def <span class="ident">prepare_es_hits</span>(</p><p>self, hits)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.prepare_es_hits">prepare_es_hits</a></code>
    </p>

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.prepare_es_hits', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.prepare_es_hits" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">prepare_es_hits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hits</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;objects&quot;</span><span class="p">:</span> 
                        <span class="p">[</span><span class="n">hit</span><span class="p">[</span><span class="s2">&quot;_source&quot;</span><span class="p">][</span><span class="s2">&quot;dataset&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">hit</span> <span class="ow">in</span> <span class="n">hits</span><span class="p">[</span><span class="s2">&quot;hits&quot;</span><span class="p">][</span><span class="s2">&quot;hits&quot;</span><span class="p">]],</span>
                        <span class="s2">&quot;meta&quot;</span> <span class="p">:</span> <span class="p">{</span><span class="s2">&quot;total_count&quot;</span> <span class="p">:</span> <span class="n">hits</span><span class="p">[</span><span class="s2">&quot;hits&quot;</span><span class="p">][</span><span class="s2">&quot;total&quot;</span><span class="p">]}</span>
                        <span class="p">}</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.prepare_fields_for_index">
    <p>def <span class="ident">prepare_fields_for_index</span>(</p><p>self, batch_dicts)</p>
    </div>
    

    
  
    <div class="desc"><p>Fields are stored as strings in hstore so convert the list or object fields back from JSON</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.prepare_fields_for_index', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.prepare_fields_for_index" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">prepare_fields_for_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch_dicts</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Fields are stored as strings in hstore so convert the list or object fields back from JSON&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">bd</span> <span class="ow">in</span> <span class="n">batch_dicts</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">bd</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;related_molregno&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">):</span>
            <span class="n">bd</span><span class="p">[</span><span class="s2">&quot;related_molregno&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;compoundproperties&quot;</span> <span class="p">:</span> <span class="p">{}}</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">bd</span><span class="p">[</span><span class="s2">&quot;projectfull&quot;</span><span class="p">][</span><span class="s2">&quot;custom_field_config&quot;</span><span class="p">][</span><span class="s2">&quot;project_data_fields&quot;</span><span class="p">]:</span>
            
            <span class="k">if</span> <span class="n">field</span><span class="p">[</span><span class="s2">&quot;edit_schema&quot;</span><span class="p">][</span><span class="s2">&quot;properties&quot;</span><span class="p">][</span><span class="n">field</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]][</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;object&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">bd</span><span class="p">[</span><span class="s2">&quot;custom_fields&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="bp">False</span><span class="p">):</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">bd</span><span class="p">[</span><span class="s2">&quot;custom_fields&quot;</span><span class="p">][</span><span class="n">field</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">bd</span><span class="p">[</span><span class="s2">&quot;custom_fields&quot;</span><span class="p">][</span><span class="n">field</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]])</span>
                        <span class="k">continue</span>
                    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                        <span class="k">pass</span>
                <span class="n">bd</span><span class="p">[</span><span class="s2">&quot;custom_fields&quot;</span><span class="p">][</span><span class="n">field</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">[</span><span class="s2">&quot;edit_schema&quot;</span><span class="p">][</span><span class="s2">&quot;properties&quot;</span><span class="p">][</span><span class="n">field</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]][</span><span class="s2">&quot;default&quot;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">field</span><span class="p">[</span><span class="s2">&quot;edit_schema&quot;</span><span class="p">][</span><span class="s2">&quot;properties&quot;</span><span class="p">][</span><span class="n">field</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]][</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;array&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">bd</span><span class="p">[</span><span class="s2">&quot;custom_fields&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="bp">False</span><span class="p">):</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">bd</span><span class="p">[</span><span class="s2">&quot;custom_fields&quot;</span><span class="p">][</span><span class="n">field</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">bd</span><span class="p">[</span><span class="s2">&quot;custom_fields&quot;</span><span class="p">][</span><span class="n">field</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]])</span>
                        <span class="k">continue</span>
                    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                        <span class="k">pass</span>
                <span class="n">bd</span><span class="p">[</span><span class="s2">&quot;custom_fields&quot;</span><span class="p">][</span><span class="n">field</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">bd</span><span class="p">[</span><span class="s2">&quot;custom_fields&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="bp">False</span><span class="p">):</span>
                <span class="c1">#Clean up existing fields to a blank string</span>
                <span class="n">bd</span><span class="p">[</span><span class="s2">&quot;custom_fields&quot;</span><span class="p">][</span><span class="n">field</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">[</span><span class="s2">&quot;edit_schema&quot;</span><span class="p">][</span><span class="s2">&quot;properties&quot;</span><span class="p">][</span><span class="n">field</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">batch_dicts</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.prepend_urls">
    <p>def <span class="ident">prepend_urls</span>(</p><p>self)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.prepend_urls">prepend_urls</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A hook for adding your own URLs or matching before the default URLs.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.prepend_urls', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.prepend_urls" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">prepend_urls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook for adding your own URLs or matching before the default URLs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.put_detail">
    <p>def <span class="ident">put_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.put_detail">put_detail</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Either updates an existing resource or creates a new one with the
provided data.</p>
<p>Calls <code>obj_update</code> with the provided data first, but falls back to
<code>obj_create</code> if the object does not already exist.</p>
<p>If a new resource is created, return <code>HttpCreated</code> (201 Created).
If <code>Meta.always_return_data = True</code>, there will be a populated body
of serialized data.</p>
<p>If an existing resource is modified and
<code>Meta.always_return_data = False</code> (default), return <code>HttpNoContent</code>
(204 No Content).
If an existing resource is modified and
<code>Meta.always_return_data = True</code>, return <code>HttpAccepted</code> (200
OK).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.put_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.put_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">put_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Either updates an existing resource or creates a new one with the</span>
<span class="sd">    provided data.</span>
<span class="sd">    Calls ``obj_update`` with the provided data first, but falls back to</span>
<span class="sd">    ``obj_create`` if the object does not already exist.</span>
<span class="sd">    If a new resource is created, return ``HttpCreated`` (201 Created).</span>
<span class="sd">    If ``Meta.always_return_data = True``, there will be a populated body</span>
<span class="sd">    of serialized data.</span>
<span class="sd">    If an existing resource is modified and</span>
<span class="sd">    ``Meta.always_return_data = False`` (default), return ``HttpNoContent``</span>
<span class="sd">    (204 No Content).</span>
<span class="sd">    If an existing resource is modified and</span>
<span class="sd">    ``Meta.always_return_data = True``, return ``HttpAccepted`` (200</span>
<span class="sd">    OK).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">))</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_deserialized_detail_data</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">deserialized</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dict_strip_unicode_keys</span><span class="p">(</span><span class="n">deserialized</span><span class="p">),</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_update</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">always_return_data</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNoContent</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Invalidate prefetched_objects_cache for bundled object</span>
            <span class="c1"># because we might have changed a prefetched field</span>
            <span class="n">updated_bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_prefetched_objects_cache</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">updated_bundle</span><span class="p">)</span>
            <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="p">(</span><span class="n">NotFound</span><span class="p">,</span> <span class="n">MultipleObjectsReturned</span><span class="p">):</span>
        <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_create</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="n">location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_uri</span><span class="p">(</span><span class="n">updated_bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">always_return_data</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpCreated</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">updated_bundle</span><span class="p">)</span>
            <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpCreated</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.put_list">
    <p>def <span class="ident">put_list</span>(</p><p>self, request, **kwargs)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.put_list">put_list</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Replaces a collection of resources with another collection.</p>
<p>Calls <code>delete_list</code> to clear out the collection then <code>obj_create</code>
with the provided the data to create the new collection.</p>
<p>Return <code>HttpNoContent</code> (204 No Content) if
<code>Meta.always_return_data = False</code> (default).</p>
<p>Return <code>HttpAccepted</code> (200 OK) if
<code>Meta.always_return_data = True</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.put_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.put_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">put_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Replaces a collection of resources with another collection.</span>
<span class="sd">    Calls ``delete_list`` to clear out the collection then ``obj_create``</span>
<span class="sd">    with the provided the data to create the new collection.</span>
<span class="sd">    Return ``HttpNoContent`` (204 No Content) if</span>
<span class="sd">    ``Meta.always_return_data = False`` (default).</span>
<span class="sd">    Return ``HttpAccepted`` (200 OK) if</span>
<span class="sd">    ``Meta.always_return_data = True``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">))</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_deserialized_list_data</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">deserialized</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">deserialized</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">BadRequest</span><span class="p">(</span><span class="s2">&quot;Invalid data sent: missing &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">)</span>
    <span class="n">basic_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">obj_delete_list_for_update</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">basic_bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="n">bundles_seen</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">object_data</span> <span class="ow">in</span> <span class="n">deserialized</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">]:</span>
        <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dict_strip_unicode_keys</span><span class="p">(</span><span class="n">object_data</span><span class="p">),</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
        <span class="c1"># Attempt to be transactional, deleting any previously created</span>
        <span class="c1"># objects if validation fails.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">obj_create</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
            <span class="n">bundles_seen</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ImmediateHttpResponse</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rollback</span><span class="p">(</span><span class="n">bundles_seen</span><span class="p">)</span>
            <span class="k">raise</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">always_return_data</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNoContent</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">to_be_serialized</span> <span class="o">=</span> <span class="p">{</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">:</span> <span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">for_list</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">bundles_seen</span>
            <span class="p">]</span>
        <span class="p">}</span>
        <span class="n">to_be_serialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_list_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">to_be_serialized</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">to_be_serialized</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.reindex_elasticsearch">
    <p>def <span class="ident">reindex_elasticsearch</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Reindex all of the data into elasticsearch</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.reindex_elasticsearch', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.reindex_elasticsearch" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">reindex_elasticsearch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Reindex all of the data into elasticsearch&quot;&quot;&quot;</span>
    <span class="n">desired_format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">determine_format</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="n">projects</span> <span class="o">=</span> <span class="n">Project</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">values_list</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">flat</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">pid</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">projects</span><span class="p">):</span>
        <span class="n">batches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">request</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">project_id</span><span class="o">=</span><span class="n">pid</span><span class="p">)</span>
        <span class="c1"># we only want to store certain fields in the search index</span>
        <span class="kn">from</span> <span class="nn">django.core.paginator</span> <span class="kn">import</span> <span class="n">Paginator</span>
        <span class="n">paginator</span> <span class="o">=</span> <span class="n">Paginator</span><span class="p">(</span><span class="n">batches</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span> <span class="c1"># chunks of 1000</span>
        <span class="c1">#Get all schemata for all projects </span>
        <span class="n">indexing_schemata</span> <span class="o">=</span> <span class="n">get_indexing_schemata</span><span class="p">([</span><span class="n">pid</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">paginator</span><span class="o">.</span><span class="n">num_pages</span> <span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    
            <span class="n">result_list</span> <span class="o">=</span> <span class="n">index_batches_in_new_index</span><span class="p">(</span><span class="n">paginator</span><span class="o">.</span><span class="n">page</span><span class="p">(</span><span class="n">page</span><span class="p">)</span><span class="o">.</span><span class="n">object_list</span><span class="p">,</span> <span class="n">project_and_indexing_schemata</span><span class="o">=</span><span class="n">indexing_schemata</span><span class="p">)</span>
            <span class="k">print</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> of </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">page</span><span class="p">,</span> <span class="n">paginator</span><span class="o">.</span><span class="n">num_pages</span><span class="p">)</span>
        <span class="k">print</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> projects of </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">projects</span><span class="p">))</span> 
    <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.remove_api_resource_names">
    <p>def <span class="ident">remove_api_resource_names</span>(</p><p>self, url_dict)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.remove_api_resource_names">remove_api_resource_names</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Given a dictionary of regex matches from a URLconf, removes
<code>api_name</code> and/or <code>resource_name</code> if found.</p>
<p>This is useful for converting URLconf matches into something suitable
for data lookup. For example::</p>
<div class="codehilite"><pre><span></span>Model.objects.filter(**self.remove_api_resource_names(matches))
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.remove_api_resource_names', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.remove_api_resource_names" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">remove_api_resource_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url_dict</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a dictionary of regex matches from a URLconf, removes</span>
<span class="sd">    ``api_name`` and/or ``resource_name`` if found.</span>
<span class="sd">    This is useful for converting URLconf matches into something suitable</span>
<span class="sd">    for data lookup. For example::</span>
<span class="sd">        Model.objects.filter(**self.remove_api_resource_names(matches))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kwargs_subset</span> <span class="o">=</span> <span class="n">url_dict</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;api_name&#39;</span><span class="p">,</span> <span class="s1">&#39;resource_name&#39;</span><span class="p">]:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">del</span><span class="p">(</span><span class="n">kwargs_subset</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">pass</span>
    <span class="k">return</span> <span class="n">kwargs_subset</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.resource_uri_kwargs">
    <p>def <span class="ident">resource_uri_kwargs</span>(</p><p>self, bundle_or_obj=None)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.resource_uri_kwargs">resource_uri_kwargs</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Builds a dictionary of kwargs to help generate URIs.</p>
<p>Automatically provides the <code>Resource.Meta.resource_name</code> (and
optionally the <code>Resource.Meta.api_name</code> if populated by an <code>Api</code>
object).</p>
<p>If the <code>bundle_or_obj</code> argument is provided, it calls
<code>Resource.detail_uri_kwargs</code> for additional bits to create</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.resource_uri_kwargs', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.resource_uri_kwargs" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">resource_uri_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle_or_obj</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Builds a dictionary of kwargs to help generate URIs.</span>
<span class="sd">    Automatically provides the ``Resource.Meta.resource_name`` (and</span>
<span class="sd">    optionally the ``Resource.Meta.api_name`` if populated by an ``Api``</span>
<span class="sd">    object).</span>
<span class="sd">    If the ``bundle_or_obj`` argument is provided, it calls</span>
<span class="sd">    ``Resource.detail_uri_kwargs`` for additional bits to create</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;resource_name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;api_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span>
    <span class="k">if</span> <span class="n">bundle_or_obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">detail_uri_kwargs</span><span class="p">(</span><span class="n">bundle_or_obj</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">kwargs</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.rollback">
    <p>def <span class="ident">rollback</span>(</p><p>self, bundles)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.rollback">rollback</a></code>
    </p>

    
  
    <div class="desc inherited"><p>A ORM-specific implementation of <code>rollback</code>.</p>
<p>Given the list of bundles, delete all models pertaining to those
bundles.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.rollback', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.rollback" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">rollback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundles</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``rollback``.</span>
<span class="sd">    Given the list of bundles, delete all models pertaining to those</span>
<span class="sd">    bundles.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">bundle</span> <span class="ow">in</span> <span class="n">bundles</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bundle_detail_data</span><span class="p">(</span><span class="n">bundle</span><span class="p">):</span>
            <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.save">
    <p>def <span class="ident">save</span>(</p><p>self, bundle, skip_errors=False)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.save">save</a></code>
    </p>

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.save', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.save" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">skip_errors</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">via_uri</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">bundle</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">errors</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">skip_errors</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">error_response</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="o">.</span><span class="n">errors</span><span class="p">))</span>
    <span class="c1"># Check if they&#39;re authorized.</span>
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">pk</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">authorized_update_detail</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">),</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">authorized_create_detail</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">),</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="c1"># Save FKs just in case.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">save_related</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">print</span> <span class="s2">&quot;got&quot;</span>
    <span class="c1"># Save the main object.</span>
    <span class="n">obj_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_identifier</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">obj_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">bundle</span><span class="o">.</span><span class="n">objects_saved</span> <span class="ow">or</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_state</span><span class="o">.</span><span class="n">adding</span><span class="p">:</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">objects_saved</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">obj_id</span><span class="p">)</span>
    <span class="c1"># Now pick up the M2M bits.</span>
    <span class="n">m2m_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hydrate_m2m</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">save_m2m</span><span class="p">(</span><span class="n">m2m_bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.save_m2m">
    <p>def <span class="ident">save_m2m</span>(</p><p>self, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.save_m2m">save_m2m</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles the saving of related M2M data.</p>
<p>Due to the way Django works, the M2M data must be handled after the
main instance, which is why this isn't a part of the main <code>save</code> bits.</p>
<p>Currently slightly inefficient in that it will clear out the whole
relation and recreate the related data as needed.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.save_m2m', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.save_m2m" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">save_m2m</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles the saving of related M2M data.</span>
<span class="sd">    Due to the way Django works, the M2M data must be handled after the</span>
<span class="sd">    main instance, which is why this isn&#39;t a part of the main ``save`` bits.</span>
<span class="sd">    Currently slightly inefficient in that it will clear out the whole</span>
<span class="sd">    relation and recreate the related data as needed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">readonly</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># Get the manager.</span>
        <span class="n">related_mngr</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
            <span class="n">related_mngr</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">):</span>
            <span class="n">related_mngr</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">related_mngr</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">related_mngr</span><span class="p">,</span> <span class="s1">&#39;clear&#39;</span><span class="p">):</span>
            <span class="c1"># FIXME: Dupe the original bundle, copy in the new object &amp;</span>
            <span class="c1">#        check the perms on that (using the related resource)?</span>
            <span class="c1"># Clear it out, just to be safe.</span>
            <span class="n">related_mngr</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">related_objs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">related_bundle</span> <span class="ow">in</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">field_name</span><span class="p">]:</span>
            <span class="n">related_resource</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">get_related_resource</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
            <span class="c1"># Only build &amp; save if there&#39;s data, not just a URI.</span>
            <span class="n">updated_related_bundle</span> <span class="o">=</span> <span class="n">related_resource</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span>
                <span class="n">obj</span><span class="o">=</span><span class="n">related_bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="n">related_bundle</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                <span class="n">request</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">,</span>
                <span class="n">objects_saved</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">objects_saved</span><span class="p">,</span>
                <span class="n">via_uri</span><span class="o">=</span><span class="n">related_bundle</span><span class="o">.</span><span class="n">via_uri</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">related_resource</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">updated_related_bundle</span><span class="p">)</span>
            <span class="n">related_objs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">updated_related_bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
        <span class="n">related_mngr</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="o">*</span><span class="n">related_objs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.save_related">
    <p>def <span class="ident">save_related</span>(</p><p>self, bundle)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.save_related">save_related</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles the saving of related non-M2M data.
Calling assigning <code>child.parent = parent</code> &amp; then calling
<code>Child.save</code> isn't good enough to make sure the <code>parent</code>
is saved.
To get around this, we go through all our related fields &amp;
call <code>save</code> on them if they have related, non-M2M data.
M2M data is handled by the <code>ModelResource.save_m2m</code> method.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.save_related', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.save_related" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">save_related</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles the saving of related non-M2M data.</span>
<span class="sd">    Calling assigning ``child.parent = parent`` &amp; then calling</span>
<span class="sd">    ``Child.save`` isn&#39;t good enough to make sure the ``parent``</span>
<span class="sd">    is saved.</span>
<span class="sd">    To get around this, we go through all our related fields &amp;</span>
<span class="sd">    call ``save`` on them if they have related, non-M2M data.</span>
<span class="sd">    M2M data is handled by the ``ModelResource.save_m2m`` method.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_related</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">readonly</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">blank</span> <span class="ow">and</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># Get the object.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">related_obj</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ObjectDoesNotExist</span><span class="p">:</span>
            <span class="c1"># Django 1.8: unset related objects default to None, no error</span>
            <span class="n">related_obj</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="c1"># We didn&#39;t get it, so maybe we created it but haven&#39;t saved it</span>
        <span class="k">if</span> <span class="n">related_obj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">related_obj</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">related_objects_to_save</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">related_name</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bundle_detail_data</span><span class="p">(</span><span class="n">bundle</span><span class="p">):</span>
                <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">related_obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">related_name</span><span class="p">,</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
        <span class="n">related_resource</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">get_related_resource</span><span class="p">(</span><span class="n">related_obj</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_name</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">field_name</span><span class="p">],</span> <span class="s1">&#39;keys&#39;</span><span class="p">):</span>
            <span class="c1"># Only build &amp; save if there&#39;s data, not just a URI.</span>
            <span class="n">related_bundle</span> <span class="o">=</span> <span class="n">related_resource</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span>
                <span class="n">obj</span><span class="o">=</span><span class="n">related_obj</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_name</span><span class="p">),</span>
                <span class="n">request</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">,</span>
                <span class="n">objects_saved</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">objects_saved</span>
            <span class="p">)</span>
            <span class="n">related_resource</span><span class="o">.</span><span class="n">full_hydrate</span><span class="p">(</span><span class="n">related_bundle</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">field_name</span> <span class="o">!=</span> <span class="s2">&quot;project&quot;</span><span class="p">:</span>
                <span class="n">related_resource</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">related_bundle</span><span class="p">)</span>
            <span class="n">related_obj</span> <span class="o">=</span> <span class="n">related_bundle</span><span class="o">.</span><span class="n">obj</span>
        <span class="k">if</span> <span class="n">related_obj</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="n">related_obj</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.serialize">
    <p>def <span class="ident">serialize</span>(</p><p>self, request, data, format, options=None)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.serialize">serialize</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Given a request, data and a desired format, produces a serialized
version suitable for transfer over the wire.</p>
<p>Mostly a hook, this uses the <code>Serializer</code> from <code>Resource._meta</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.serialize', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.serialize" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">format</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a request, data and a desired format, produces a serialized</span>
<span class="sd">    version suitable for transfer over the wire.</span>
<span class="sd">    Mostly a hook, this uses the ``Serializer`` from ``Resource._meta``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span> <span class="o">=</span> <span class="n">options</span> <span class="ow">or</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="s1">&#39;text/javascript&#39;</span> <span class="ow">in</span> <span class="n">format</span><span class="p">:</span>
        <span class="c1"># get JSONP callback name. default to &quot;callback&quot;</span>
        <span class="n">callback</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;callback&#39;</span><span class="p">,</span> <span class="s1">&#39;callback&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_valid_jsonp_callback_value</span><span class="p">(</span><span class="n">callback</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">BadRequest</span><span class="p">(</span><span class="s1">&#39;JSONP callback name is invalid.&#39;</span><span class="p">)</span>
        <span class="n">options</span><span class="p">[</span><span class="s1">&#39;callback&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">callback</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">serializer</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">format</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.should_skip_field">
    <p>def <span class="ident">should_skip_field</span>(</p><p>cls, field)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.should_skip_field">should_skip_field</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Given a Django model field, return if it should be included in the
contributed ApiFields.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.should_skip_field', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.should_skip_field" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">should_skip_field</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">field</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a Django model field, return if it should be included in the</span>
<span class="sd">    contributed ApiFields.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Ignore certain fields (related fields).</span>
    <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="s1">&#39;rel&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">return</span> <span class="bp">False</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.throttle_check">
    <p>def <span class="ident">throttle_check</span>(</p><p>self, request)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.throttle_check">throttle_check</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Handles checking if the user should be throttled.</p>
<p>Mostly a hook, this uses class assigned to <code>throttle</code> from
<code>Resource._meta</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.throttle_check', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.throttle_check" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">throttle_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking if the user should be throttled.</span>
<span class="sd">    Mostly a hook, this uses class assigned to ``throttle`` from</span>
<span class="sd">    ``Resource._meta``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">identifier</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authentication</span><span class="o">.</span><span class="n">get_identifier</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="c1"># Check to see if they should be throttled.</span>
    <span class="n">throttle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">throttle</span><span class="o">.</span><span class="n">should_be_throttled</span><span class="p">(</span><span class="n">identifier</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">throttle</span><span class="p">:</span>
        <span class="c1"># Throttle limit exceeded.</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpTooManyRequests</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">throttle</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">throttle</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="n">response</span><span class="p">[</span><span class="s1">&#39;Retry-After&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">throttle</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">throttle</span><span class="p">,</span> <span class="n">datetime</span><span class="p">):</span>
            <span class="n">response</span><span class="p">[</span><span class="s1">&#39;Retry-After&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">format_date_time</span><span class="p">(</span><span class="n">mktime</span><span class="p">(</span><span class="n">throttle</span><span class="o">.</span><span class="n">timetuple</span><span class="p">()))</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.unauthorized_result">
    <p>def <span class="ident">unauthorized_result</span>(</p><p>self, exception)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.unauthorized_result">unauthorized_result</a></code>
    </p>

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.unauthorized_result', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.unauthorized_result" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">unauthorized_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exception</span><span class="p">):</span>
    <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpUnauthorized</span><span class="p">())</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.update_in_place">
    <p>def <span class="ident">update_in_place</span>(</p><p>self, request, original_bundle, new_data)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.update_in_place">update_in_place</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Update the object in original_bundle in-place using new_data.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.update_in_place', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.update_in_place" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">update_in_place</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">original_bundle</span><span class="p">,</span> <span class="n">new_data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Update the object in original_bundle in-place using new_data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">original_bundle</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">dict_strip_unicode_keys</span><span class="p">(</span><span class="n">new_data</span><span class="p">))</span>
    <span class="c1"># Now we&#39;ve got a bundle with the new data sitting in it and we&#39;re</span>
    <span class="c1"># we&#39;re basically in the same spot as a PUT request. SO the rest of this</span>
    <span class="c1"># function is cribbed from put_detail.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">alter_deserialized_detail_data</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">original_bundle</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bundle_detail_data</span><span class="p">(</span><span class="n">original_bundle</span><span class="p">),</span>
        <span class="s1">&#39;request&#39;</span><span class="p">:</span> <span class="n">request</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_update</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">original_bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.IndexingCBHCompoundBatchResource.wrap_view">
    <p>def <span class="ident">wrap_view</span>(</p><p>self, view)</p>
    </div>
    
    <p class="inheritance">
     <strong>Inheritance:</strong>
       <code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource">BaseCBHCompoundBatchResource</a></code>.<code><a href="#cbh_chem_api.resources.BaseCBHCompoundBatchResource.wrap_view">wrap_view</a></code>
    </p>

    
  
    <div class="desc inherited"><p>Wraps methods so they can be called in a more functional way as well
as handling exceptions better.</p>
<p>Note that if <code>BadRequest</code> or an exception with a <code>response</code> attr
are seen, there is special handling to either present a message back
to the user or return the response traveling with the exception.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.wrap_view', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.IndexingCBHCompoundBatchResource.wrap_view" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">wrap_view</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">view</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wraps methods so they can be called in a more functional way as well</span>
<span class="sd">    as handling exceptions better.</span>
<span class="sd">    Note that if ``BadRequest`` or an exception with a ``response`` attr</span>
<span class="sd">    are seen, there is special handling to either present a message back</span>
<span class="sd">    to the user or return the response traveling with the exception.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nd">@csrf_exempt</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">callback</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">view</span><span class="p">)</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">callback</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="c1"># Our response can vary based on a number of factors, use</span>
            <span class="c1"># the cache class to determine what we should ``Vary`` on so</span>
            <span class="c1"># caches won&#39;t return the wrong (cached) version.</span>
            <span class="n">varies</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="p">,</span> <span class="s2">&quot;varies&quot;</span><span class="p">,</span> <span class="p">[])</span>
            <span class="k">if</span> <span class="n">varies</span><span class="p">:</span>
                <span class="n">patch_vary_headers</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">varies</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">cacheable</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">response</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">cache_control</span><span class="p">():</span>
                    <span class="c1"># If the request is cacheable and we have a</span>
                    <span class="c1"># ``Cache-Control`` available then patch the header.</span>
                    <span class="n">patch_cache_control</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">cache_control</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">is_ajax</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">response</span><span class="o">.</span><span class="n">has_header</span><span class="p">(</span><span class="s2">&quot;Cache-Control&quot;</span><span class="p">):</span>
                <span class="c1"># IE excessively caches XMLHttpRequests, so we&#39;re disabling</span>
                <span class="c1"># the browser cache here.</span>
                <span class="c1"># See http://www.enhanceie.com/ie/bugs.asp for details.</span>
                <span class="n">patch_cache_control</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">no_cache</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">response</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">BadRequest</span><span class="p">,</span> <span class="n">fields</span><span class="o">.</span><span class="n">ApiFieldError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="n">sanitize</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s1">&#39;args&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">}</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpBadRequest</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="n">sanitize</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">messages</span><span class="p">)}</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpBadRequest</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1"># Prevent muting non-django&#39;s exceptions</span>
            <span class="c1"># i.e. RequestException from &#39;requests&#39; library</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s1">&#39;response&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">response</span><span class="p">,</span> <span class="n">HttpResponse</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">e</span><span class="o">.</span><span class="n">response</span>
            <span class="c1"># A real, non-expected exception.</span>
            <span class="c1"># Handle the case where the full traceback is more helpful</span>
            <span class="c1"># than the serialized error.</span>
            <span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">DEBUG</span> <span class="ow">and</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">settings</span><span class="p">,</span> <span class="s1">&#39;TASTYPIE_FULL_DEBUG&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
                <span class="k">raise</span>
            <span class="c1"># Re-raise the error to get a proper traceback when the error</span>
            <span class="c1"># happend during a test case</span>
            <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SERVER_NAME&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;testserver&#39;</span><span class="p">:</span>
                <span class="k">raise</span>
            <span class="c1"># Rather than re-raising, we&#39;re going to things similar to</span>
            <span class="c1"># what Django does. The difference is returning a serialized</span>
            <span class="c1"># error message.</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_500</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wrapper</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="cbh_chem_api.resources.MoleculeDictionaryResource" class="name">class <span class="ident">MoleculeDictionaryResource</span></p>
      
  
    <div class="desc"><p>Resource to provide data about the Molecule Dictionary
Provides access to the compoundproperties model for a given CompoundBatch instance
Used only for a related resource, not declared globally as this would be a security risk</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">MoleculeDictionaryResource</span><span class="p">(</span><span class="n">ModelResource</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Resource to provide data about the Molecule Dictionary</span>
<span class="sd">    Provides access to the compoundproperties model for a given CompoundBatch instance</span>
<span class="sd">    Used only for a related resource, not declared globally as this would be a security risk</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">compoundproperties</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">CompoundPropertiesResource</span><span class="p">,</span> <span class="s1">&#39;compoundproperties&#39;</span><span class="p">,</span>  <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">readonly</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">authorization</span> <span class="o">=</span> <span class="n">ProjectAuthorization</span><span class="p">()</span>
    <span class="n">project</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span>
        <span class="n">ChemregProjectResource</span><span class="p">,</span> <span class="s1">&#39;project&#39;</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>


    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">queryset</span> <span class="o">=</span> <span class="n">MoleculeDictionary</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;compoundproperties&quot;</span><span class="p">]</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#cbh_chem_api.resources.MoleculeDictionaryResource">MoleculeDictionaryResource</a></li>
          <li>tastypie.resources.ModelResource</li>
          <li>tastypie.resources.BaseModelResource</li>
          <li>tastypie.resources.Resource</li>
          <li>__builtin__.object</li>
          </ul>
          <h3>Class variables</h3>
            <div class="item">
            <p id="cbh_chem_api.resources.MoleculeDictionaryResource.Meta" class="name">var <span class="ident">Meta</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="cbh_chem_api.resources.MoleculeDictionaryResource.authorization" class="name">var <span class="ident">authorization</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="cbh_chem_api.resources.MoleculeDictionaryResource.base_fields" class="name">var <span class="ident">base_fields</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="cbh_chem_api.resources.MoleculeDictionaryResource.compoundproperties" class="name">var <span class="ident">compoundproperties</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="cbh_chem_api.resources.MoleculeDictionaryResource.declared_fields" class="name">var <span class="ident">declared_fields</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="cbh_chem_api.resources.MoleculeDictionaryResource.project" class="name">var <span class="ident">project</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="cbh_chem_api.resources.MoleculeDictionaryResource.urls" class="name">var <span class="ident">urls</span></p>
            

            
  
    <div class="desc"><p>The endpoints this <code>Resource</code> responds to.</p>
<p>Mostly a standard URLconf, this is suitable for either automatic use
when registered with an <code>Api</code> class or for including directly in
a URLconf should you choose to.</p></div>
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, api_name=None)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.__init__', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">api_name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="c1"># this can cause:</span>
    <span class="c1"># TypeError: object.__new__(method-wrapper) is not safe, use method-wrapper.__new__()</span>
    <span class="c1"># when trying to copy a generator used as a default. Wrap call to</span>
    <span class="c1"># generator in lambda to get around this error.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_fields</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">api_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span> <span class="o">=</span> <span class="n">api_name</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.alter_deserialized_detail_data">
    <p>def <span class="ident">alter_deserialized_detail_data</span>(</p><p>self, request, data)</p>
    </div>
    

    
  
    <div class="desc"><p>A hook to alter detail data just after it has been received from the user &amp;
gets deserialized.</p>
<p>Useful for altering the user data before any hydration is applied.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.alter_deserialized_detail_data', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.alter_deserialized_detail_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">alter_deserialized_detail_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to alter detail data just after it has been received from the user &amp;</span>
<span class="sd">    gets deserialized.</span>
<span class="sd">    Useful for altering the user data before any hydration is applied.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.alter_deserialized_list_data">
    <p>def <span class="ident">alter_deserialized_list_data</span>(</p><p>self, request, data)</p>
    </div>
    

    
  
    <div class="desc"><p>A hook to alter list data just after it has been received from the user &amp;
gets deserialized.</p>
<p>Useful for altering the user data before any hydration is applied.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.alter_deserialized_list_data', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.alter_deserialized_list_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">alter_deserialized_list_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to alter list data just after it has been received from the user &amp;</span>
<span class="sd">    gets deserialized.</span>
<span class="sd">    Useful for altering the user data before any hydration is applied.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.alter_detail_data_to_serialize">
    <p>def <span class="ident">alter_detail_data_to_serialize</span>(</p><p>self, request, data)</p>
    </div>
    

    
  
    <div class="desc"><p>A hook to alter detail data just before it gets serialized &amp; sent to the user.</p>
<p>Useful for restructuring/renaming aspects of the what's going to be
sent.</p>
<p>Should accommodate for receiving a single bundle of data.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.alter_detail_data_to_serialize', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.alter_detail_data_to_serialize" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">alter_detail_data_to_serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to alter detail data just before it gets serialized &amp; sent to the user.</span>
<span class="sd">    Useful for restructuring/renaming aspects of the what&#39;s going to be</span>
<span class="sd">    sent.</span>
<span class="sd">    Should accommodate for receiving a single bundle of data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.alter_list_data_to_serialize">
    <p>def <span class="ident">alter_list_data_to_serialize</span>(</p><p>self, request, data)</p>
    </div>
    

    
  
    <div class="desc"><p>A hook to alter list data just before it gets serialized &amp; sent to the user.</p>
<p>Useful for restructuring/renaming aspects of the what's going to be
sent.</p>
<p>Should accommodate for a list of objects, generally also including
meta data.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.alter_list_data_to_serialize', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.alter_list_data_to_serialize" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">alter_list_data_to_serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to alter list data just before it gets serialized &amp; sent to the user.</span>
<span class="sd">    Useful for restructuring/renaming aspects of the what&#39;s going to be</span>
<span class="sd">    sent.</span>
<span class="sd">    Should accommodate for a list of objects, generally also including</span>
<span class="sd">    meta data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.api_field_from_django_field">
    <p>def <span class="ident">api_field_from_django_field</span>(</p><p>cls, f, default=&lt;class &#39;tastypie.fields.CharField&#39;&gt;)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns the field type that would likely be associated with each
Django type.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.api_field_from_django_field', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.api_field_from_django_field" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">api_field_from_django_field</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">fields</span><span class="o">.</span><span class="n">CharField</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the field type that would likely be associated with each</span>
<span class="sd">    Django type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">default</span>
    <span class="n">internal_type</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">get_internal_type</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">internal_type</span> <span class="o">==</span> <span class="s1">&#39;DateField&#39;</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">DateField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="o">==</span> <span class="s1">&#39;DateTimeField&#39;</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">DateTimeField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;BooleanField&#39;</span><span class="p">,</span> <span class="s1">&#39;NullBooleanField&#39;</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">BooleanField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;FloatField&#39;</span><span class="p">,):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">FloatField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;DecimalField&#39;</span><span class="p">,):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">DecimalField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;IntegerField&#39;</span><span class="p">,</span> <span class="s1">&#39;PositiveIntegerField&#39;</span><span class="p">,</span> <span class="s1">&#39;PositiveSmallIntegerField&#39;</span><span class="p">,</span> <span class="s1">&#39;SmallIntegerField&#39;</span><span class="p">,</span> <span class="s1">&#39;AutoField&#39;</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">IntegerField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;FileField&#39;</span><span class="p">,</span> <span class="s1">&#39;ImageField&#39;</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">FileField</span>
    <span class="k">elif</span> <span class="n">internal_type</span> <span class="o">==</span> <span class="s1">&#39;TimeField&#39;</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">TimeField</span>
    <span class="c1"># TODO: Perhaps enable these via introspection. The reason they&#39;re not enabled</span>
    <span class="c1">#       by default is the very different ``__init__`` they have over</span>
    <span class="c1">#       the other fields.</span>
    <span class="c1"># elif internal_type == &#39;ForeignKey&#39;:</span>
    <span class="c1">#     result = ForeignKey</span>
    <span class="c1"># elif internal_type == &#39;ManyToManyField&#39;:</span>
    <span class="c1">#     result = ManyToManyField</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.apply_authorization_limits">
    <p>def <span class="ident">apply_authorization_limits</span>(</p><p>self, request, object_list)</p>
    </div>
    

    
  
    <div class="desc"><p>Deprecated.</p>
<p>FIXME: REMOVE BEFORE 1.0</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.apply_authorization_limits', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.apply_authorization_limits" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">apply_authorization_limits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">object_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Deprecated.</span>
<span class="sd">    FIXME: REMOVE BEFORE 1.0</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">apply_limits</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">object_list</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.apply_filters">
    <p>def <span class="ident">apply_filters</span>(</p><p>self, request, applicable_filters)</p>
    </div>
    

    
  
    <div class="desc"><p>An ORM-specific implementation of <code>apply_filters</code>.</p>
<p>The default simply applies the <code>applicable_filters</code> as <code>**kwargs</code>,
but should make it possible to do more advanced things.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.apply_filters', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.apply_filters" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">apply_filters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">applicable_filters</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An ORM-specific implementation of ``apply_filters``.</span>
<span class="sd">    The default simply applies the ``applicable_filters`` as ``**kwargs``,</span>
<span class="sd">    but should make it possible to do more advanced things.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">request</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="o">**</span><span class="n">applicable_filters</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.apply_sorting">
    <p>def <span class="ident">apply_sorting</span>(</p><p>self, obj_list, options=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a dictionary of options, apply some ORM-level sorting to the
provided <code>QuerySet</code>.</p>
<p>Looks for the <code>order_by</code> key and handles either ascending (just the
field name) or descending (the field name with a <code>-</code> in front).</p>
<p>The field name should be the resource field, <strong>NOT</strong> model field.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.apply_sorting', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.apply_sorting" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">apply_sorting</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_list</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a dictionary of options, apply some ORM-level sorting to the</span>
<span class="sd">    provided ``QuerySet``.</span>
<span class="sd">    Looks for the ``order_by`` key and handles either ascending (just the</span>
<span class="sd">    field name) or descending (the field name with a ``-`` in front).</span>
<span class="sd">    The field name should be the resource field, **NOT** model field.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">parameter_name</span> <span class="o">=</span> <span class="s1">&#39;order_by&#39;</span>
    <span class="k">if</span> <span class="s1">&#39;order_by&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;sort_by&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
            <span class="c1"># Nothing to alter the order. Return what we&#39;ve got.</span>
            <span class="k">return</span> <span class="n">obj_list</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;&#39;sort_by&#39; is a deprecated parameter. Please use &#39;order_by&#39; instead.&quot;</span><span class="p">)</span>
            <span class="n">parameter_name</span> <span class="o">=</span> <span class="s1">&#39;sort_by&#39;</span>
    <span class="n">order_by_args</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="s1">&#39;getlist&#39;</span><span class="p">):</span>
        <span class="n">order_bits</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">getlist</span><span class="p">(</span><span class="n">parameter_name</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">order_bits</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">parameter_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">order_bits</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="n">order_bits</span> <span class="o">=</span> <span class="p">[</span><span class="n">order_bits</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">order_by</span> <span class="ow">in</span> <span class="n">order_bits</span><span class="p">:</span>
        <span class="n">order_by_bits</span> <span class="o">=</span> <span class="n">order_by</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">LOOKUP_SEP</span><span class="p">)</span>
        <span class="n">field_name</span> <span class="o">=</span> <span class="n">order_by_bits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">order</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">order_by_bits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">):</span>
            <span class="n">field_name</span> <span class="o">=</span> <span class="n">order_by_bits</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
            <span class="n">order</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span>
        <span class="k">if</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
            <span class="c1"># It&#39;s not a field we know about. Move along citizen.</span>
            <span class="k">raise</span> <span class="n">InvalidSortError</span><span class="p">(</span><span class="s2">&quot;No matching &#39;</span><span class="si">%s</span><span class="s2">&#39; field for ordering on.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">ordering</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidSortError</span><span class="p">(</span><span class="s2">&quot;The &#39;</span><span class="si">%s</span><span class="s2">&#39; field does not allow ordering.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">attribute</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidSortError</span><span class="p">(</span><span class="s2">&quot;The &#39;</span><span class="si">%s</span><span class="s2">&#39; field has no &#39;attribute&#39; for ordering with.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="n">order_by_args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">LOOKUP_SEP</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">attribute</span><span class="p">]</span> <span class="o">+</span> <span class="n">order_by_bits</span><span class="p">[</span><span class="mi">1</span><span class="p">:])))</span>
    <span class="k">return</span> <span class="n">obj_list</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="o">*</span><span class="n">order_by_args</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.authorized_create_detail">
    <p>def <span class="ident">authorized_create_detail</span>(</p><p>self, object_list, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking of permissions to see if the user has authorization
to POST this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.authorized_create_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.authorized_create_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_create_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to POST this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">create_detail</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">auth_result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.authorized_create_list">
    <p>def <span class="ident">authorized_create_list</span>(</p><p>self, object_list, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking of permissions to see if the user has authorization
to POST this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.authorized_create_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.authorized_create_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_create_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to POST this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">create_list</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.authorized_delete_detail">
    <p>def <span class="ident">authorized_delete_detail</span>(</p><p>self, object_list, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking of permissions to see if the user has authorization
to DELETE this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.authorized_delete_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.authorized_delete_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_delete_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to DELETE this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">delete_detail</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">auth_result</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.authorized_delete_list">
    <p>def <span class="ident">authorized_delete_list</span>(</p><p>self, object_list, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking of permissions to see if the user has authorization
to DELETE this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.authorized_delete_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.authorized_delete_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_delete_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to DELETE this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">delete_list</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.authorized_read_detail">
    <p>def <span class="ident">authorized_read_detail</span>(</p><p>self, object_list, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking of permissions to see if the user has authorization
to GET this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.authorized_read_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.authorized_read_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_read_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to GET this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">read_detail</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">auth_result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.authorized_read_list">
    <p>def <span class="ident">authorized_read_list</span>(</p><p>self, object_list, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking of permissions to see if the user has authorization
to GET this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.authorized_read_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.authorized_read_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_read_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to GET this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">read_list</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.authorized_update_detail">
    <p>def <span class="ident">authorized_update_detail</span>(</p><p>self, object_list, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking of permissions to see if the user has authorization
to PUT this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.authorized_update_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.authorized_update_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_update_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to PUT this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">update_detail</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">auth_result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Unauthorized</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.authorized_update_list">
    <p>def <span class="ident">authorized_update_list</span>(</p><p>self, object_list, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking of permissions to see if the user has authorization
to PUT this resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.authorized_update_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.authorized_update_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">authorized_update_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking of permissions to see if the user has authorization</span>
<span class="sd">    to PUT this resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authorization</span><span class="o">.</span><span class="n">update_list</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">Unauthorized</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unauthorized_result</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">auth_result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.base_urls">
    <p>def <span class="ident">base_urls</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>The standard URLs this <code>Resource</code> should respond to.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.base_urls', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.base_urls" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">base_urls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The standard URLs this ``Resource`` should respond to.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="n">url</span><span class="p">(</span><span class="s2">r&quot;^(?P&lt;resource_name&gt;</span><span class="si">%s</span><span class="s2">)</span><span class="si">%s</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span> <span class="n">trailing_slash</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrap_view</span><span class="p">(</span><span class="s1">&#39;dispatch_list&#39;</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;api_dispatch_list&quot;</span><span class="p">),</span>
        <span class="n">url</span><span class="p">(</span><span class="s2">r&quot;^(?P&lt;resource_name&gt;</span><span class="si">%s</span><span class="s2">)/schema</span><span class="si">%s</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span> <span class="n">trailing_slash</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrap_view</span><span class="p">(</span><span class="s1">&#39;get_schema&#39;</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;api_get_schema&quot;</span><span class="p">),</span>
        <span class="n">url</span><span class="p">(</span><span class="s2">r&quot;^(?P&lt;resource_name&gt;</span><span class="si">%s</span><span class="s2">)/set/(?P&lt;</span><span class="si">%s</span><span class="s2">_list&gt;.*?)</span><span class="si">%s</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">,</span> <span class="n">trailing_slash</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrap_view</span><span class="p">(</span><span class="s1">&#39;get_multiple&#39;</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;api_get_multiple&quot;</span><span class="p">),</span>
        <span class="n">url</span><span class="p">(</span><span class="s2">r&quot;^(?P&lt;resource_name&gt;</span><span class="si">%s</span><span class="s2">)/(?P&lt;</span><span class="si">%s</span><span class="s2">&gt;.*?)</span><span class="si">%s</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">,</span> <span class="n">trailing_slash</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrap_view</span><span class="p">(</span><span class="s1">&#39;dispatch_detail&#39;</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;api_dispatch_detail&quot;</span><span class="p">),</span>
    <span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.build_bundle">
    <p>def <span class="ident">build_bundle</span>(</p><p>self, obj=None, data=None, request=None, objects_saved=None, via_uri=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Given either an object, a data dictionary or both, builds a <code>Bundle</code>
for use throughout the <code>dehydrate/hydrate</code> cycle.</p>
<p>If no object is provided, an empty object from
<code>Resource._meta.object_class</code> is created so that attempts to access
<code>bundle.obj</code> do not fail.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.build_bundle', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.build_bundle" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">build_bundle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">objects_saved</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">via_uri</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given either an object, a data dictionary or both, builds a ``Bundle``</span>
<span class="sd">    for use throughout the ``dehydrate/hydrate`` cycle.</span>
<span class="sd">    If no object is provided, an empty object from</span>
<span class="sd">    ``Resource._meta.object_class`` is created so that attempts to access</span>
<span class="sd">    ``bundle.obj`` do not fail.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="p">:</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">Bundle</span><span class="p">(</span>
        <span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span>
        <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
        <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">,</span>
        <span class="n">objects_saved</span><span class="o">=</span><span class="n">objects_saved</span><span class="p">,</span>
        <span class="n">via_uri</span><span class="o">=</span><span class="n">via_uri</span>
    <span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.build_filters">
    <p>def <span class="ident">build_filters</span>(</p><p>self, filters=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a dictionary of filters, create the necessary ORM-level filters.</p>
<p>Keys should be resource fields, <strong>NOT</strong> model fields.</p>
<p>Valid values are either a list of Django filter types (i.e.
<code>['startswith', 'exact', 'lte']</code>), the <code>ALL</code> constant or the
<code>ALL_WITH_RELATIONS</code> constant.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.build_filters', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.build_filters" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">build_filters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a dictionary of filters, create the necessary ORM-level filters.</span>
<span class="sd">    Keys should be resource fields, **NOT** model fields.</span>
<span class="sd">    Valid values are either a list of Django filter types (i.e.</span>
<span class="sd">    ``[&#39;startswith&#39;, &#39;exact&#39;, &#39;lte&#39;]``), the ``ALL`` constant or the</span>
<span class="sd">    ``ALL_WITH_RELATIONS`` constant.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># At the declarative level:</span>
    <span class="c1">#     filtering = {</span>
    <span class="c1">#         &#39;resource_field_name&#39;: [&#39;exact&#39;, &#39;startswith&#39;, &#39;endswith&#39;, &#39;contains&#39;],</span>
    <span class="c1">#         &#39;resource_field_name_2&#39;: [&#39;exact&#39;, &#39;gt&#39;, &#39;gte&#39;, &#39;lt&#39;, &#39;lte&#39;, &#39;range&#39;],</span>
    <span class="c1">#         &#39;resource_field_name_3&#39;: ALL,</span>
    <span class="c1">#         &#39;resource_field_name_4&#39;: ALL_WITH_RELATIONS,</span>
    <span class="c1">#         ...</span>
    <span class="c1">#     }</span>
    <span class="c1"># Accepts the filters as a dict. None by default, meaning no filters.</span>
    <span class="k">if</span> <span class="n">filters</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">filters</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">qs_filters</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="p">,</span> <span class="s1">&#39;queryset&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="c1"># Get the possible query terms from the current QuerySet.</span>
        <span class="n">query_terms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">queryset</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">query_terms</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">query_terms</span> <span class="o">=</span> <span class="n">QUERY_TERMS</span>
    <span class="k">if</span> <span class="n">django</span><span class="o">.</span><span class="n">VERSION</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span> <span class="ow">and</span> <span class="n">GeometryField</span><span class="p">:</span>
        <span class="n">query_terms</span> <span class="o">=</span> <span class="n">query_terms</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="n">GeometryField</span><span class="o">.</span><span class="n">class_lookups</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="k">for</span> <span class="n">filter_expr</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">filters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">filter_bits</span> <span class="o">=</span> <span class="n">filter_expr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">LOOKUP_SEP</span><span class="p">)</span>
        <span class="n">field_name</span> <span class="o">=</span> <span class="n">filter_bits</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">filter_type</span> <span class="o">=</span> <span class="s1">&#39;exact&#39;</span>
        <span class="k">if</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
            <span class="c1"># It&#39;s not a field we know about. Move along citizen.</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filter_bits</span><span class="p">)</span> <span class="ow">and</span> <span class="n">filter_bits</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">query_terms</span><span class="p">:</span>
            <span class="n">filter_type</span> <span class="o">=</span> <span class="n">filter_bits</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="n">lookup_bits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_filtering</span><span class="p">(</span><span class="n">field_name</span><span class="p">,</span> <span class="n">filter_type</span><span class="p">,</span> <span class="n">filter_bits</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_value_to_python</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">filters</span><span class="p">,</span> <span class="n">filter_expr</span><span class="p">,</span> <span class="n">filter_type</span><span class="p">)</span>
        <span class="n">db_field_name</span> <span class="o">=</span> <span class="n">LOOKUP_SEP</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lookup_bits</span><span class="p">)</span>
        <span class="n">qs_filter</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">db_field_name</span><span class="p">,</span> <span class="n">LOOKUP_SEP</span><span class="p">,</span> <span class="n">filter_type</span><span class="p">)</span>
        <span class="n">qs_filters</span><span class="p">[</span><span class="n">qs_filter</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
    <span class="k">return</span> <span class="n">dict_strip_unicode_keys</span><span class="p">(</span><span class="n">qs_filters</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.build_schema">
    <p>def <span class="ident">build_schema</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns a dictionary of all the fields on the resource and some
properties about those fields.</p>
<p>Used by the <code>schema/</code> endpoint to describe what will be available.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.build_schema', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.build_schema" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">build_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a dictionary of all the fields on the resource and some</span>
<span class="sd">    properties about those fields.</span>
<span class="sd">    Used by the ``schema/`` endpoint to describe what will be available.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;fields&#39;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s1">&#39;default_format&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">default_format</span><span class="p">,</span>
        <span class="s1">&#39;allowed_list_http_methods&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">list_allowed_methods</span><span class="p">,</span>
        <span class="s1">&#39;allowed_detail_http_methods&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_allowed_methods</span><span class="p">,</span>
        <span class="s1">&#39;default_limit&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">limit</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">ordering</span><span class="p">:</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;ordering&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">ordering</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span><span class="p">:</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;filtering&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span>
    <span class="c1"># Skip assigning pk_field_name for non-model resources</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">pk_field_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">queryset</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">pk</span><span class="o">.</span><span class="n">name</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="n">pk_field_name</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;fields&#39;</span><span class="p">][</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">default</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">dehydrated_type</span><span class="p">,</span>
            <span class="s1">&#39;nullable&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">null</span><span class="p">,</span>
            <span class="s1">&#39;blank&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">blank</span><span class="p">,</span>
            <span class="s1">&#39;readonly&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">readonly</span><span class="p">,</span>
            <span class="s1">&#39;help_text&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">help_text</span><span class="p">,</span>
            <span class="s1">&#39;unique&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">unique</span><span class="p">,</span>
            <span class="s1">&#39;primary_key&#39;</span><span class="p">:</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">field_name</span> <span class="o">==</span> <span class="n">pk_field_name</span> <span class="k">else</span> <span class="bp">False</span><span class="p">,</span>
            <span class="s1">&#39;verbose_name&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">verbose_name</span> <span class="ow">or</span> <span class="n">field_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">),</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">dehydrated_type</span> <span class="o">==</span> <span class="s1">&#39;related&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
                <span class="n">related_type</span> <span class="o">=</span> <span class="s1">&#39;to_many&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">related_type</span> <span class="o">=</span> <span class="s1">&#39;to_one&#39;</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;fields&#39;</span><span class="p">][</span><span class="n">field_name</span><span class="p">][</span><span class="s1">&#39;related_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">related_type</span>
            <span class="n">uri</span> <span class="o">=</span> <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;api_get_schema&#39;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;api_name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span><span class="p">,</span> <span class="s1">&#39;resource_name&#39;</span><span class="p">:</span> <span class="n">field_object</span><span class="o">.</span><span class="n">to_class</span><span class="p">()</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">})</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;fields&#39;</span><span class="p">][</span><span class="n">field_name</span><span class="p">][</span><span class="s1">&#39;related_schema&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">uri</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.cached_obj_get">
    <p>def <span class="ident">cached_obj_get</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A version of <code>obj_get</code> that uses the cache as a means to get
commonly-accessed data faster.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.cached_obj_get', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.cached_obj_get" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">cached_obj_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A version of ``obj_get`` that uses the cache as a means to get</span>
<span class="sd">    commonly-accessed data faster.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_cache_key</span><span class="p">(</span><span class="s1">&#39;detail&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">cached_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cache_key</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">cached_bundle</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">cached_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">cache_key</span><span class="p">,</span> <span class="n">cached_bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cached_bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.cached_obj_get_list">
    <p>def <span class="ident">cached_obj_get_list</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A version of <code>obj_get_list</code> that uses the cache as a means to get
commonly-accessed data faster.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.cached_obj_get_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.cached_obj_get_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">cached_obj_get_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A version of ``obj_get_list`` that uses the cache as a means to get</span>
<span class="sd">    commonly-accessed data faster.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_cache_key</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">obj_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cache_key</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">obj_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">obj_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">cache_key</span><span class="p">,</span> <span class="n">obj_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">obj_list</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.can_create">
    <p>def <span class="ident">can_create</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Checks to ensure <code>post</code> is within <code>allowed_methods</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.can_create', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.can_create" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">can_create</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks to ensure ``post`` is within ``allowed_methods``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">allowed</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">list_allowed_methods</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_allowed_methods</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">&#39;post&#39;</span> <span class="ow">in</span> <span class="n">allowed</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.can_delete">
    <p>def <span class="ident">can_delete</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Checks to ensure <code>delete</code> is within <code>allowed_methods</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.can_delete', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.can_delete" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">can_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks to ensure ``delete`` is within ``allowed_methods``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">allowed</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">list_allowed_methods</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_allowed_methods</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">&#39;delete&#39;</span> <span class="ow">in</span> <span class="n">allowed</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.can_update">
    <p>def <span class="ident">can_update</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Checks to ensure <code>put</code> is within <code>allowed_methods</code>.</p>
<p>Used when hydrating related data.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.can_update', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.can_update" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">can_update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks to ensure ``put`` is within ``allowed_methods``.</span>
<span class="sd">    Used when hydrating related data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">allowed</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">list_allowed_methods</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_allowed_methods</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">&#39;put&#39;</span> <span class="ow">in</span> <span class="n">allowed</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.check_filtering">
    <p>def <span class="ident">check_filtering</span>(</p><p>self, field_name, filter_type=u&#39;exact&#39;, filter_bits=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a field name, a optional filter type and an optional list of
additional relations, determine if a field can be filtered on.</p>
<p>If a filter does not meet the needed conditions, it should raise an
<code>InvalidFilterError</code>.</p>
<p>If the filter meets the conditions, a list of attribute names (not
field names) will be returned.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.check_filtering', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.check_filtering" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">check_filtering</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">filter_type</span><span class="o">=</span><span class="s1">&#39;exact&#39;</span><span class="p">,</span> <span class="n">filter_bits</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a field name, a optional filter type and an optional list of</span>
<span class="sd">    additional relations, determine if a field can be filtered on.</span>
<span class="sd">    If a filter does not meet the needed conditions, it should raise an</span>
<span class="sd">    ``InvalidFilterError``.</span>
<span class="sd">    If the filter meets the conditions, a list of attribute names (not</span>
<span class="sd">    field names) will be returned.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">filter_bits</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">filter_bits</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">InvalidFilterError</span><span class="p">(</span><span class="s2">&quot;The &#39;</span><span class="si">%s</span><span class="s2">&#39; field does not allow filtering.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
    <span class="c1"># Check to see if it&#39;s an allowed lookup type.</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">ALL</span><span class="p">,</span> <span class="n">ALL_WITH_RELATIONS</span><span class="p">):</span>
        <span class="c1"># Must be an explicit whitelist.</span>
        <span class="k">if</span> <span class="n">filter_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span><span class="p">[</span><span class="n">field_name</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">InvalidFilterError</span><span class="p">(</span><span class="s2">&quot;&#39;</span><span class="si">%s</span><span class="s2">&#39; is not an allowed filter on the &#39;</span><span class="si">%s</span><span class="s2">&#39; field.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">filter_type</span><span class="p">,</span> <span class="n">field_name</span><span class="p">))</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">attribute</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">InvalidFilterError</span><span class="p">(</span><span class="s2">&quot;The &#39;</span><span class="si">%s</span><span class="s2">&#39; field has no &#39;attribute&#39; for searching with.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
    <span class="c1"># Check to see if it&#39;s a relational lookup and if that&#39;s allowed.</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filter_bits</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">],</span> <span class="s1">&#39;is_related&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">InvalidFilterError</span><span class="p">(</span><span class="s2">&quot;The &#39;</span><span class="si">%s</span><span class="s2">&#39; field does not support relations.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">filtering</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">==</span> <span class="n">ALL_WITH_RELATIONS</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidFilterError</span><span class="p">(</span><span class="s2">&quot;Lookups are not allowed more than one level deep on the &#39;</span><span class="si">%s</span><span class="s2">&#39; field.&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
        <span class="c1"># Recursively descend through the remaining lookups in the filter,</span>
        <span class="c1"># if any. We should ensure that all along the way, we&#39;re allowed</span>
        <span class="c1"># to filter on that field by the related resource.</span>
        <span class="n">related_resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">get_related_resource</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">attribute</span><span class="p">]</span> <span class="o">+</span> <span class="n">related_resource</span><span class="o">.</span><span class="n">check_filtering</span><span class="p">(</span><span class="n">filter_bits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">filter_type</span><span class="p">,</span> <span class="n">filter_bits</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span><span class="o">.</span><span class="n">attribute</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.create_identifier">
    <p>def <span class="ident">create_identifier</span>(</p><p>self, obj)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.create_identifier', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.create_identifier" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">create_identifier</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">u&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">app_label</span><span class="p">,</span> <span class="n">get_module_name</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">_meta</span><span class="p">),</span> <span class="n">obj</span><span class="o">.</span><span class="n">pk</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.create_response">
    <p>def <span class="ident">create_response</span>(</p><p>self, request, data, response_class=&lt;class &#39;django.http.response.HttpResponse&#39;&gt;, **response_kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Extracts the common "which-format/serialize/return-response" cycle.</p>
<p>Mostly a useful shortcut/hook.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.create_response', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.create_response" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">create_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">HttpResponse</span><span class="p">,</span> <span class="o">**</span><span class="n">response_kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extracts the common &quot;which-format/serialize/return-response&quot; cycle.</span>
<span class="sd">    Mostly a useful shortcut/hook.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">desired_format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">determine_format</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="n">serialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">desired_format</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response_class</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">serialized</span><span class="p">,</span> <span class="n">content_type</span><span class="o">=</span><span class="n">build_content_type</span><span class="p">(</span><span class="n">desired_format</span><span class="p">),</span> <span class="o">**</span><span class="n">response_kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.dehydrate">
    <p>def <span class="ident">dehydrate</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>A hook to allow a final manipulation of data once all fields/methods
have built out the dehydrated data.</p>
<p>Useful if you need to access more than one dehydrated field or want
to annotate on additional data.</p>
<p>Must return the modified bundle.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.dehydrate', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.dehydrate" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dehydrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to allow a final manipulation of data once all fields/methods</span>
<span class="sd">    have built out the dehydrated data.</span>
<span class="sd">    Useful if you need to access more than one dehydrated field or want</span>
<span class="sd">    to annotate on additional data.</span>
<span class="sd">    Must return the modified bundle.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.dehydrate_resource_uri">
    <p>def <span class="ident">dehydrate_resource_uri</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>For the automatically included <code>resource_uri</code> field, dehydrate
the URI for the given bundle.</p>
<p>Returns empty string if no URI can be generated.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.dehydrate_resource_uri', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.dehydrate_resource_uri" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dehydrate_resource_uri</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    For the automatically included ``resource_uri`` field, dehydrate</span>
<span class="sd">    the URI for the given bundle.</span>
<span class="sd">    Returns empty string if no URI can be generated.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_uri</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="k">except</span> <span class="n">NoReverseMatch</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.delete_detail">
    <p>def <span class="ident">delete_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Destroys a single resource/object.</p>
<p>Calls <code>obj_delete</code>.</p>
<p>If the resource is deleted, return <code>HttpNoContent</code> (204 No Content).
If the resource did not exist, return <code>Http404</code> (404 Not Found).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.delete_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.delete_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">delete_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Destroys a single resource/object.</span>
<span class="sd">    Calls ``obj_delete``.</span>
<span class="sd">    If the resource is deleted, return ``HttpNoContent`` (204 No Content).</span>
<span class="sd">    If the resource did not exist, return ``Http404`` (404 Not Found).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Manually construct the bundle here, since we don&#39;t want to try to</span>
    <span class="c1"># delete an empty instance.</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="n">Bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">obj_delete</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNoContent</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">NotFound</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNotFound</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.delete_list">
    <p>def <span class="ident">delete_list</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Destroys a collection of resources/objects.</p>
<p>Calls <code>obj_delete_list</code>.</p>
<p>If the resources are deleted, return <code>HttpNoContent</code> (204 No Content).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.delete_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.delete_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">delete_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Destroys a collection of resources/objects.</span>
<span class="sd">    Calls ``obj_delete_list``.</span>
<span class="sd">    If the resources are deleted, return ``HttpNoContent`` (204 No Content).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">obj_delete_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNoContent</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.deserialize">
    <p>def <span class="ident">deserialize</span>(</p><p>self, request, data, format=u&#39;application/json&#39;)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a request, data and a format, deserializes the given data.</p>
<p>It relies on the request properly sending a <code>CONTENT_TYPE</code> header,
falling back to <code>application/json</code> if not provided.</p>
<p>Mostly a hook, this uses the <code>Serializer</code> from <code>Resource._meta</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.deserialize', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.deserialize" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">deserialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s1">&#39;application/json&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a request, data and a format, deserializes the given data.</span>
<span class="sd">    It relies on the request properly sending a ``CONTENT_TYPE`` header,</span>
<span class="sd">    falling back to ``application/json`` if not provided.</span>
<span class="sd">    Mostly a hook, this uses the ``Serializer`` from ``Resource._meta``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">serializer</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="n">format</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">deserialized</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.detail_uri_kwargs">
    <p>def <span class="ident">detail_uri_kwargs</span>(</p><p>self, bundle_or_obj)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a <code>Bundle</code> or an object (typically a <code>Model</code> instance),
it returns the extra kwargs needed to generate a detail URI.</p>
<p>By default, it uses the model's <code>pk</code> in order to create the URI.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.detail_uri_kwargs', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.detail_uri_kwargs" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">detail_uri_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle_or_obj</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a ``Bundle`` or an object (typically a ``Model`` instance),</span>
<span class="sd">    it returns the extra kwargs needed to generate a detail URI.</span>
<span class="sd">    By default, it uses the model&#39;s ``pk`` in order to create the URI.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bundle_or_obj</span><span class="p">,</span> <span class="n">Bundle</span><span class="p">):</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">bundle_or_obj</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">bundle_or_obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">kwargs</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.determine_format">
    <p>def <span class="ident">determine_format</span>(</p><p>self, request)</p>
    </div>
    

    
  
    <div class="desc"><p>Used to determine the desired format.</p>
<p>Largely relies on <code>tastypie.utils.mime.determine_format</code> but here
as a point of extension.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.determine_format', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.determine_format" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">determine_format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Used to determine the desired format.</span>
<span class="sd">    Largely relies on ``tastypie.utils.mime.determine_format`` but here</span>
<span class="sd">    as a point of extension.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">determine_format</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">serializer</span><span class="p">,</span> <span class="n">default_format</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">default_format</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.dispatch">
    <p>def <span class="ident">dispatch</span>(</p><p>self, request_type, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles the common operations (allowed HTTP method, authentication,
throttling, method lookup) surrounding most CRUD interactions.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.dispatch', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.dispatch" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dispatch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request_type</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles the common operations (allowed HTTP method, authentication,</span>
<span class="sd">    throttling, method lookup) surrounding most CRUD interactions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">allowed_methods</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_allowed_methods&quot;</span> <span class="o">%</span> <span class="n">request_type</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;HTTP_X_HTTP_METHOD_OVERRIDE&#39;</span> <span class="ow">in</span> <span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="p">:</span>
        <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="p">[</span><span class="s1">&#39;HTTP_X_HTTP_METHOD_OVERRIDE&#39;</span><span class="p">]</span>
    <span class="n">request_method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">method_check</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">allowed</span><span class="o">=</span><span class="n">allowed_methods</span><span class="p">)</span>
    <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">request_method</span><span class="p">,</span> <span class="n">request_type</span><span class="p">),</span> <span class="bp">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">method</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpNotImplemented</span><span class="p">())</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">throttle_check</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="c1"># All clear. Process the request.</span>
    <span class="n">request</span> <span class="o">=</span> <span class="n">convert_post_to_put</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="c1"># Add the throttled request.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_throttled_access</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="c1"># If what comes back isn&#39;t a ``HttpResponse``, assume that the</span>
    <span class="c1"># request was accepted and that some action occurred. This also</span>
    <span class="c1"># prevents Django from freaking out.</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">HttpResponse</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNoContent</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">response</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.dispatch_detail">
    <p>def <span class="ident">dispatch_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A view for handling the various HTTP methods (GET/POST/PUT/DELETE) on
a single resource.</p>
<p>Relies on <code>Resource.dispatch</code> for the heavy-lifting.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.dispatch_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.dispatch_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dispatch_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A view for handling the various HTTP methods (GET/POST/PUT/DELETE) on</span>
<span class="sd">    a single resource.</span>
<span class="sd">    Relies on ``Resource.dispatch`` for the heavy-lifting.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span><span class="s1">&#39;detail&#39;</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.dispatch_list">
    <p>def <span class="ident">dispatch_list</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A view for handling the various HTTP methods (GET/POST/PUT/DELETE) over
the entire list of resources.</p>
<p>Relies on <code>Resource.dispatch</code> for the heavy-lifting.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.dispatch_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.dispatch_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">dispatch_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A view for handling the various HTTP methods (GET/POST/PUT/DELETE) over</span>
<span class="sd">    the entire list of resources.</span>
<span class="sd">    Relies on ``Resource.dispatch`` for the heavy-lifting.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.error_response">
    <p>def <span class="ident">error_response</span>(</p><p>self, request, errors, response_class=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Extracts the common "which-format/serialize/return-error-response"
cycle.</p>
<p>Should be used as much as possible to return errors.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.error_response', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.error_response" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">error_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extracts the common &quot;which-format/serialize/return-error-response&quot;</span>
<span class="sd">    cycle.</span>
<span class="sd">    Should be used as much as possible to return errors.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">response_class</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">response_class</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpBadRequest</span>
    <span class="n">desired_format</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">if</span> <span class="n">request</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;callback&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">desired_format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">determine_format</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">BadRequest</span><span class="p">:</span>
                <span class="k">pass</span>  <span class="c1"># Fall through to default handler below</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># JSONP can cause extra breakage.</span>
            <span class="n">desired_format</span> <span class="o">=</span> <span class="s1">&#39;application/json&#39;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">desired_format</span><span class="p">:</span>
        <span class="n">desired_format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">default_format</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">serialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">desired_format</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">BadRequest</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">error</span> <span class="o">=</span> <span class="s2">&quot;Additional errors occurred, but serialization of those errors failed.&quot;</span>
        <span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">:</span>
            <span class="n">error</span> <span class="o">+=</span> <span class="s2">&quot; </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">e</span>
        <span class="k">return</span> <span class="n">response_class</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">error</span><span class="p">,</span> <span class="n">content_type</span><span class="o">=</span><span class="s1">&#39;text/plain&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response_class</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">serialized</span><span class="p">,</span> <span class="n">content_type</span><span class="o">=</span><span class="n">build_content_type</span><span class="p">(</span><span class="n">desired_format</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.filter_value_to_python">
    <p>def <span class="ident">filter_value_to_python</span>(</p><p>self, value, field_name, filters, filter_expr, filter_type)</p>
    </div>
    

    
  
    <div class="desc"><p>Turn the string <code>value</code> into a python object.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.filter_value_to_python', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.filter_value_to_python" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">filter_value_to_python</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">filters</span><span class="p">,</span> <span class="n">filter_expr</span><span class="p">,</span>
        <span class="n">filter_type</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Turn the string ``value`` into a python object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Simple values</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">string_to_python</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="c1"># Split on &#39;,&#39; if not empty string and either an in or range filter.</span>
    <span class="k">if</span> <span class="n">filter_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="s1">&#39;range&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">filters</span><span class="p">,</span> <span class="s1">&#39;getlist&#39;</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">filters</span><span class="o">.</span><span class="n">getlist</span><span class="p">(</span><span class="n">filter_expr</span><span class="p">):</span>
                <span class="n">value</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">part</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">value</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.full_dehydrate">
    <p>def <span class="ident">full_dehydrate</span>(</p><p>self, bundle, for_list=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a bundle with an object instance, extract the information from it
to populate the resource.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.full_dehydrate', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.full_dehydrate" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">full_dehydrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">for_list</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a bundle with an object instance, extract the information from it</span>
<span class="sd">    to populate the resource.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span>
    <span class="n">api_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span>
    <span class="n">resource_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span>
    <span class="c1"># Dehydrate each field.</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># If it&#39;s not for use in this mode, skip</span>
        <span class="n">field_use_in</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">use_in</span>
        <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_use_in</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">field_use_in</span><span class="p">(</span><span class="n">bundle</span><span class="p">):</span>
                <span class="k">continue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">field_use_in</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;list&#39;</span> <span class="k">if</span> <span class="n">for_list</span> <span class="k">else</span> <span class="s1">&#39;detail&#39;</span><span class="p">]:</span>
                <span class="k">continue</span>
        <span class="c1"># A touch leaky but it makes URI resolution work.</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">dehydrated_type</span> <span class="o">==</span> <span class="s1">&#39;related&#39;</span><span class="p">:</span>
            <span class="n">field_object</span><span class="o">.</span><span class="n">api_name</span> <span class="o">=</span> <span class="n">api_name</span>
            <span class="n">field_object</span><span class="o">.</span><span class="n">resource_name</span> <span class="o">=</span> <span class="n">resource_name</span>
        <span class="n">data</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="n">for_list</span><span class="o">=</span><span class="n">for_list</span><span class="p">)</span>
        <span class="c1"># Check for an optional method to do further dehydration.</span>
        <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;dehydrate_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.full_hydrate">
    <p>def <span class="ident">full_hydrate</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a populated bundle, distill it and turn it back into
a full-fledged object instance.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.full_hydrate', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.full_hydrate" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">full_hydrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a populated bundle, distill it and turn it back into</span>
<span class="sd">    a full-fledged object instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="p">()</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">readonly</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># Check for an optional method to do further hydration.</span>
        <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;hydrate_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
            <span class="n">bundle</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
            <span class="c1"># NOTE: We only get back a bundle when it is related field.</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Bundle</span><span class="p">)</span> <span class="ow">and</span> <span class="n">value</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_name</span><span class="p">):</span>
                <span class="n">bundle</span><span class="o">.</span><span class="n">errors</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">errors</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">field_object</span><span class="o">.</span><span class="n">null</span><span class="p">:</span>
                <span class="c1"># We need to avoid populating M2M data here as that will</span>
                <span class="c1"># cause things to blow up.</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_related</span><span class="p">:</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="k">elif</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                        <span class="c1"># NOTE: A bug fix in Django (ticket #18153) fixes incorrect behavior</span>
                        <span class="c1"># which Tastypie was relying on.  To fix this, we store value.obj to</span>
                        <span class="c1"># be saved later in save_related.</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="nb">setattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
                        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">ObjectDoesNotExist</span><span class="p">):</span>
                            <span class="n">bundle</span><span class="o">.</span><span class="n">related_objects_to_save</span><span class="p">[</span><span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">obj</span>
                    <span class="k">elif</span> <span class="n">field_object</span><span class="o">.</span><span class="n">blank</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="k">elif</span> <span class="n">field_object</span><span class="o">.</span><span class="n">null</span><span class="p">:</span>
                        <span class="nb">setattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.generate_cache_key">
    <p>def <span class="ident">generate_cache_key</span>(</p><p>self, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Creates a unique-enough cache key.</p>
<p>This is based off the current api_name/resource_name/args/kwargs.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.generate_cache_key', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.generate_cache_key" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">generate_cache_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a unique-enough cache key.</span>
<span class="sd">    This is based off the current api_name/resource_name/args/kwargs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">smooshed</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">=</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
    <span class="c1"># Use a list plus a ``.join()`` because it&#39;s faster than concatenation.</span>
    <span class="k">return</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">args</span><span class="p">),</span> <span class="s1">&#39;:&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">smooshed</span><span class="p">)))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.get_bundle_detail_data">
    <p>def <span class="ident">get_bundle_detail_data</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Convenience method to return the <code>detail_uri_name</code> attribute off
<code>bundle.obj</code>.</p>
<p>Usually just accesses <code>bundle.obj.pk</code> by default.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.get_bundle_detail_data', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.get_bundle_detail_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_bundle_detail_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convenience method to return the ``detail_uri_name`` attribute off</span>
<span class="sd">    ``bundle.obj``.</span>
<span class="sd">    Usually just accesses ``bundle.obj.pk`` by default.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.get_detail">
    <p>def <span class="ident">get_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns a single serialized resource.</p>
<p>Calls <code>cached_obj_get/obj_get</code> to provide the data, then handles that result
set and serializes it.</p>
<p>Should return a HttpResponse (200 OK).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.get_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.get_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a single serialized resource.</span>
<span class="sd">    Calls ``cached_obj_get/obj_get`` to provide the data, then handles that result</span>
<span class="sd">    set and serializes it.</span>
<span class="sd">    Should return a HttpResponse (200 OK).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">basic_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cached_obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">basic_bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="k">except</span> <span class="n">ObjectDoesNotExist</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNotFound</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">MultipleObjectsReturned</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpMultipleChoices</span><span class="p">(</span><span class="s2">&quot;More than one resource is found at this URI.&quot;</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.get_fields">
    <p>def <span class="ident">get_fields</span>(</p><p>cls, fields=None, excludes=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Given any explicit fields to include and fields to exclude, add
additional fields based on the associated model.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.get_fields', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.get_fields" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">get_fields</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">excludes</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given any explicit fields to include and fields to exclude, add</span>
<span class="sd">    additional fields based on the associated model.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">final_fields</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">fields</span> <span class="o">=</span> <span class="n">fields</span> <span class="ow">or</span> <span class="p">[]</span>
    <span class="n">excludes</span> <span class="o">=</span> <span class="n">excludes</span> <span class="ow">or</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">cls</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">final_fields</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">cls</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
        <span class="c1"># If the field name is already present, skip</span>
        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">cls</span><span class="o">.</span><span class="n">base_fields</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># If field is not present in explicit field listing, skip</span>
        <span class="k">if</span> <span class="n">fields</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># If field is in exclude list, skip</span>
        <span class="k">if</span> <span class="n">excludes</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">excludes</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">cls</span><span class="o">.</span><span class="n">should_skip_field</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="n">api_field_class</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">api_field_from_django_field</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;attribute&#39;</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s1">&#39;help_text&#39;</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">help_text</span><span class="p">,</span>
            <span class="s1">&#39;verbose_name&#39;</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">verbose_name</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">null</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;null&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;unique&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">unique</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">f</span><span class="o">.</span><span class="n">null</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">blank</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;blank&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">get_internal_type</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;TextField&#39;</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">has_default</span><span class="p">():</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">default</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;auto_now&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">auto_now</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;auto_now_add&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">auto_now_add</span>
        <span class="n">final_fields</span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">api_field_class</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">final_fields</span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">instance_name</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span>
    <span class="k">return</span> <span class="n">final_fields</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.get_list">
    <p>def <span class="ident">get_list</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns a serialized list of resources.</p>
<p>Calls <code>obj_get_list</code> to provide the data, then handles that result
set and serializes it.</p>
<p>Should return a HttpResponse (200 OK).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.get_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.get_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a serialized list of resources.</span>
<span class="sd">    Calls ``obj_get_list`` to provide the data, then handles that result</span>
<span class="sd">    set and serializes it.</span>
<span class="sd">    Should return a HttpResponse (200 OK).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO: Uncached for now. Invalidation that works for everyone may be</span>
    <span class="c1">#       impossible.</span>
    <span class="n">base_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="n">objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">base_bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="n">sorted_objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_sorting</span><span class="p">(</span><span class="n">objects</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="p">)</span>
    <span class="n">paginator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">paginator_class</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="p">,</span> <span class="n">sorted_objects</span><span class="p">,</span> <span class="n">resource_uri</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_resource_uri</span><span class="p">(),</span> <span class="n">limit</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">limit</span><span class="p">,</span> <span class="n">max_limit</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">max_limit</span><span class="p">,</span> <span class="n">collection_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">)</span>
    <span class="n">to_be_serialized</span> <span class="o">=</span> <span class="n">paginator</span><span class="o">.</span><span class="n">page</span><span class="p">()</span>
    <span class="c1"># Dehydrate the bundles in preparation for serialization.</span>
    <span class="n">bundles</span> <span class="o">=</span> <span class="p">[</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">),</span> <span class="n">for_list</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">to_be_serialized</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">]</span>
    <span class="p">]</span>
    <span class="n">to_be_serialized</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">bundles</span>
    <span class="n">to_be_serialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_list_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">to_be_serialized</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">to_be_serialized</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.get_multiple">
    <p>def <span class="ident">get_multiple</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns a serialized list of resources based on the identifiers
from the URL.</p>
<p>Calls <code>obj_get</code> to fetch only the objects requested. This method
only responds to HTTP GET.</p>
<p>Should return a HttpResponse (200 OK).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.get_multiple', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.get_multiple" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_multiple</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a serialized list of resources based on the identifiers</span>
<span class="sd">    from the URL.</span>
<span class="sd">    Calls ``obj_get`` to fetch only the objects requested. This method</span>
<span class="sd">    only responds to HTTP GET.</span>
<span class="sd">    Should return a HttpResponse (200 OK).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">method_check</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">allowed</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;get&#39;</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">throttle_check</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="c1"># Rip apart the list then iterate.</span>
    <span class="n">kwarg_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_list&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span>
    <span class="n">obj_identifiers</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">kwarg_name</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
    <span class="n">objects</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">not_found</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">base_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">identifier</span> <span class="ow">in</span> <span class="n">obj_identifiers</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">base_bundle</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">:</span> <span class="n">identifier</span><span class="p">})</span>
            <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
            <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="n">for_list</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="n">objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">ObjectDoesNotExist</span><span class="p">,</span> <span class="n">Unauthorized</span><span class="p">):</span>
            <span class="n">not_found</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">identifier</span><span class="p">)</span>
    <span class="n">object_list</span> <span class="o">=</span> <span class="p">{</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">:</span> <span class="n">objects</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">not_found</span><span class="p">):</span>
        <span class="n">object_list</span><span class="p">[</span><span class="s1">&#39;not_found&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">not_found</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_throttled_access</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">object_list</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.get_object_list">
    <p>def <span class="ident">get_object_list</span>(</p><p>self, request)</p>
    </div>
    

    
  
    <div class="desc"><p>An ORM-specific implementation of <code>get_object_list</code>.</p>
<p>Returns a queryset that may have been limited by other overrides.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.get_object_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.get_object_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_object_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An ORM-specific implementation of ``get_object_list``.</span>
<span class="sd">    Returns a queryset that may have been limited by other overrides.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">queryset</span><span class="o">.</span><span class="n">_clone</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.get_resource_uri">
    <p>def <span class="ident">get_resource_uri</span>(</p><p>self, bundle_or_obj=None, url_name=u&#39;api_dispatch_list&#39;)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles generating a resource URI.</p>
<p>If the <code>bundle_or_obj</code> argument is not provided, it builds the URI
for the list endpoint.</p>
<p>If the <code>bundle_or_obj</code> argument is provided, it builds the URI for
the detail endpoint.</p>
<p>Return the generated URI. If that URI can not be reversed (not found
in the URLconf), it will return an empty string.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.get_resource_uri', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.get_resource_uri" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_resource_uri</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle_or_obj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">url_name</span><span class="o">=</span><span class="s1">&#39;api_dispatch_list&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles generating a resource URI.</span>
<span class="sd">    If the ``bundle_or_obj`` argument is not provided, it builds the URI</span>
<span class="sd">    for the list endpoint.</span>
<span class="sd">    If the ``bundle_or_obj`` argument is provided, it builds the URI for</span>
<span class="sd">    the detail endpoint.</span>
<span class="sd">    Return the generated URI. If that URI can not be reversed (not found</span>
<span class="sd">    in the URLconf), it will return an empty string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">bundle_or_obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">url_name</span> <span class="o">=</span> <span class="s1">&#39;api_dispatch_detail&#39;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_reverse_url</span><span class="p">(</span><span class="n">url_name</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resource_uri_kwargs</span><span class="p">(</span><span class="n">bundle_or_obj</span><span class="p">))</span>
    <span class="k">except</span> <span class="n">NoReverseMatch</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.get_schema">
    <p>def <span class="ident">get_schema</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns a serialized form of the schema of the resource.</p>
<p>Calls <code>build_schema</code> to generate the data. This method only responds
to HTTP GET.</p>
<p>Should return a HttpResponse (200 OK).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.get_schema', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.get_schema" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a serialized form of the schema of the resource.</span>
<span class="sd">    Calls ``build_schema`` to generate the data. This method only responds</span>
<span class="sd">    to HTTP GET.</span>
<span class="sd">    Should return a HttpResponse (200 OK).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">method_check</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">allowed</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;get&#39;</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">throttle_check</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_throttled_access</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">authorized_read_detail</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">),</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_schema</span><span class="p">())</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.get_via_uri">
    <p>def <span class="ident">get_via_uri</span>(</p><p>self, uri, request=None)</p>
    </div>
    

    
  
    <div class="desc"><p>This pulls apart the salient bits of the URI and populates the
resource via a <code>obj_get</code>.</p>
<p>Optionally accepts a <code>request</code>.</p>
<p>If you need custom behavior based on other portions of the URI,
simply override this method.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.get_via_uri', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.get_via_uri" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_via_uri</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uri</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This pulls apart the salient bits of the URI and populates the</span>
<span class="sd">    resource via a ``obj_get``.</span>
<span class="sd">    Optionally accepts a ``request``.</span>
<span class="sd">    If you need custom behavior based on other portions of the URI,</span>
<span class="sd">    simply override this method.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="n">get_script_prefix</span><span class="p">()</span>
    <span class="n">chomped_uri</span> <span class="o">=</span> <span class="n">uri</span>
    <span class="k">if</span> <span class="n">prefix</span> <span class="ow">and</span> <span class="n">chomped_uri</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">prefix</span><span class="p">):</span>
        <span class="n">chomped_uri</span> <span class="o">=</span> <span class="n">chomped_uri</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:]</span>
    <span class="c1"># We mangle the path a bit further &amp; run URL resolution against *only*</span>
    <span class="c1"># the current class. This ought to prevent bad URLs from resolving to</span>
    <span class="c1"># incorrect data.</span>
    <span class="n">found_at</span> <span class="o">=</span> <span class="n">chomped_uri</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">found_at</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">NotFound</span><span class="p">(</span><span class="s2">&quot;An incorrect URL was provided &#39;</span><span class="si">%s</span><span class="s2">&#39; for the &#39;</span><span class="si">%s</span><span class="s2">&#39; resource.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">))</span>
    <span class="n">chomped_uri</span> <span class="o">=</span> <span class="n">chomped_uri</span><span class="p">[</span><span class="n">found_at</span><span class="p">:]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">url_resolver</span> <span class="ow">in</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;urls&#39;</span><span class="p">,</span> <span class="p">[]):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">url_resolver</span><span class="o">.</span><span class="n">resolve</span><span class="p">(</span><span class="n">chomped_uri</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">view</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span> <span class="o">=</span> <span class="n">result</span>
                <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Resolver404</span><span class="p">(</span><span class="s2">&quot;URI not found in &#39;self.urls&#39;.&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">Resolver404</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">NotFound</span><span class="p">(</span><span class="s2">&quot;The URL provided &#39;</span><span class="si">%s</span><span class="s2">&#39; was not a link to a valid resource.&quot;</span> <span class="o">%</span> <span class="n">uri</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.hydrate">
    <p>def <span class="ident">hydrate</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>A hook to allow an initial manipulation of data before all methods/fields
have built out the hydrated data.</p>
<p>Useful if you need to access more than one hydrated field or want
to annotate on additional data.</p>
<p>Must return the modified bundle.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.hydrate', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.hydrate" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">hydrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook to allow an initial manipulation of data before all methods/fields</span>
<span class="sd">    have built out the hydrated data.</span>
<span class="sd">    Useful if you need to access more than one hydrated field or want</span>
<span class="sd">    to annotate on additional data.</span>
<span class="sd">    Must return the modified bundle.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.hydrate_m2m">
    <p>def <span class="ident">hydrate_m2m</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Populate the ManyToMany data on the instance.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.hydrate_m2m', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.hydrate_m2m" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">hydrate_m2m</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Populate the ManyToMany data on the instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrationError</span><span class="p">(</span><span class="s2">&quot;You must call &#39;full_hydrate&#39; before attempting to run &#39;hydrate_m2m&#39; on </span><span class="si">%r</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span>
            <span class="c1"># Note that we only hydrate the data, leaving the instance</span>
            <span class="c1"># unmodified. It&#39;s up to the user&#39;s code to handle this.</span>
            <span class="c1"># The ``ModelResource`` provides a working baseline</span>
            <span class="c1"># in this regard.</span>
            <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">hydrate_m2m</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;hydrate_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
            <span class="n">method</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.is_authenticated">
    <p>def <span class="ident">is_authenticated</span>(</p><p>self, request)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking if the user is authenticated and dealing with
unauthenticated users.</p>
<p>Mostly a hook, this uses class assigned to <code>authentication</code> from
<code>Resource._meta</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.is_authenticated', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.is_authenticated" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">is_authenticated</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking if the user is authenticated and dealing with</span>
<span class="sd">    unauthenticated users.</span>
<span class="sd">    Mostly a hook, this uses class assigned to ``authentication`` from</span>
<span class="sd">    ``Resource._meta``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Authenticate the request as needed.</span>
    <span class="n">auth_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authentication</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">auth_result</span><span class="p">,</span> <span class="n">HttpResponse</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">auth_result</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">auth_result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpUnauthorized</span><span class="p">())</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.is_valid">
    <p>def <span class="ident">is_valid</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking if the data provided by the user is valid.</p>
<p>Mostly a hook, this uses class assigned to <code>validation</code> from
<code>Resource._meta</code>.</p>
<p>If validation fails, an error is raised with the error messages
serialized inside it.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.is_valid', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.is_valid" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking if the data provided by the user is valid.</span>
<span class="sd">    Mostly a hook, this uses class assigned to ``validation`` from</span>
<span class="sd">    ``Resource._meta``.</span>
<span class="sd">    If validation fails, an error is raised with the error messages</span>
<span class="sd">    serialized inside it.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">validation</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">errors</span><span class="p">:</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">errors</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">errors</span>
        <span class="k">return</span> <span class="bp">False</span>
    <span class="k">return</span> <span class="bp">True</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.log_throttled_access">
    <p>def <span class="ident">log_throttled_access</span>(</p><p>self, request)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles the recording of the user's access for throttling purposes.</p>
<p>Mostly a hook, this uses class assigned to <code>throttle</code> from
<code>Resource._meta</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.log_throttled_access', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.log_throttled_access" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">log_throttled_access</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles the recording of the user&#39;s access for throttling purposes.</span>
<span class="sd">    Mostly a hook, this uses class assigned to ``throttle`` from</span>
<span class="sd">    ``Resource._meta``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">request_method</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">throttle</span><span class="o">.</span><span class="n">accessed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authentication</span><span class="o">.</span><span class="n">get_identifier</span><span class="p">(</span><span class="n">request</span><span class="p">),</span> <span class="n">url</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">get_full_path</span><span class="p">(),</span> <span class="n">request_method</span><span class="o">=</span><span class="n">request_method</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.lookup_kwargs_with_identifiers">
    <p>def <span class="ident">lookup_kwargs_with_identifiers</span>(</p><p>self, bundle, kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Kwargs here represent uri identifiers Ex: /repos/<user_id>/<repo_name>/
We need to turn those identifiers into Python objects for generating
lookup parameters that can find them in the DB</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.lookup_kwargs_with_identifiers', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.lookup_kwargs_with_identifiers" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">lookup_kwargs_with_identifiers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Kwargs here represent uri identifiers Ex: /repos/&lt;user_id&gt;/&lt;repo_name&gt;/</span>
<span class="sd">    We need to turn those identifiers into Python objects for generating</span>
<span class="sd">    lookup parameters that can find them in the DB</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lookup_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">)</span><span class="o">.</span><span class="n">model</span><span class="p">()</span>
    <span class="c1"># Override data values, we rely on uri identifiers</span>
    <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="c1"># We&#39;re going to manually hydrate, as opposed to calling</span>
    <span class="c1"># ``full_hydrate``, to ensure we don&#39;t try to flesh out related</span>
    <span class="c1"># resources &amp; keep things speedy.</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">identifier</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">identifier</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">:</span>
            <span class="n">lookup_kwargs</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span>
            <span class="k">continue</span>
        <span class="n">field_object</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span>
        <span class="c1"># Skip readonly or related fields.</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">readonly</span> <span class="ow">is</span> <span class="bp">True</span> <span class="ow">or</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_related</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># Check for an optional method to do further hydration.</span>
        <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;hydrate_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">identifier</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">method</span><span class="p">:</span>
            <span class="n">bundle</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="n">lookup_kwargs</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
    <span class="k">return</span> <span class="n">lookup_kwargs</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.method_check">
    <p>def <span class="ident">method_check</span>(</p><p>self, request, allowed=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Ensures that the HTTP method used on the request is allowed to be
handled by the resource.</p>
<p>Takes an <code>allowed</code> parameter, which should be a list of lowercase
HTTP methods to check against. Usually, this looks like::</p>
<div class="codehilite"><pre><span></span># The most generic lookup.
self.method_check(request, self._meta.allowed_methods)

# A lookup against what&#39;s allowed for list-type methods.
self.method_check(request, self._meta.list_allowed_methods)

# A useful check when creating a new endpoint that only handles
# GET.
self.method_check(request, [&#39;get&#39;])
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.method_check', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.method_check" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">method_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">allowed</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Ensures that the HTTP method used on the request is allowed to be</span>
<span class="sd">    handled by the resource.</span>
<span class="sd">    Takes an ``allowed`` parameter, which should be a list of lowercase</span>
<span class="sd">    HTTP methods to check against. Usually, this looks like::</span>
<span class="sd">        # The most generic lookup.</span>
<span class="sd">        self.method_check(request, self._meta.allowed_methods)</span>
<span class="sd">        # A lookup against what&#39;s allowed for list-type methods.</span>
<span class="sd">        self.method_check(request, self._meta.list_allowed_methods)</span>
<span class="sd">        # A useful check when creating a new endpoint that only handles</span>
<span class="sd">        # GET.</span>
<span class="sd">        self.method_check(request, [&#39;get&#39;])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">allowed</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">allowed</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">request_method</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">allows</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">meth</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">allowed</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">request_method</span> <span class="o">==</span> <span class="s2">&quot;options&quot;</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="n">allows</span><span class="p">)</span>
        <span class="n">response</span><span class="p">[</span><span class="s1">&#39;Allow&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">allows</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">request_method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpMethodNotAllowed</span><span class="p">(</span><span class="n">allows</span><span class="p">)</span>
        <span class="n">response</span><span class="p">[</span><span class="s1">&#39;Allow&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">allows</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">request_method</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.obj_create">
    <p>def <span class="ident">obj_create</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A ORM-specific implementation of <code>obj_create</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.obj_create', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.obj_create" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_create``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.obj_delete">
    <p>def <span class="ident">obj_delete</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A ORM-specific implementation of <code>obj_delete</code>.</p>
<p>Takes optional <code>kwargs</code>, which are used to narrow the query to find
the instance.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.obj_delete', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.obj_delete" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_delete``.</span>
<span class="sd">    Takes optional ``kwargs``, which are used to narrow the query to find</span>
<span class="sd">    the instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="s1">&#39;delete&#39;</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ObjectDoesNotExist</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NotFound</span><span class="p">(</span><span class="s2">&quot;A model instance matching the provided arguments could not be found.&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">authorized_delete_detail</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">),</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.obj_delete_list">
    <p>def <span class="ident">obj_delete_list</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A ORM-specific implementation of <code>obj_delete_list</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.obj_delete_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.obj_delete_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_delete_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_delete_list``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">objects_to_delete</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">deletable_objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">authorized_delete_list</span><span class="p">(</span><span class="n">objects_to_delete</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">deletable_objects</span><span class="p">,</span> <span class="s1">&#39;delete&#39;</span><span class="p">):</span>
        <span class="c1"># It&#39;s likely a ``QuerySet``. Call ``.delete()`` for efficiency.</span>
        <span class="n">deletable_objects</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">authed_obj</span> <span class="ow">in</span> <span class="n">deletable_objects</span><span class="p">:</span>
            <span class="n">authed_obj</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.obj_delete_list_for_update">
    <p>def <span class="ident">obj_delete_list_for_update</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A ORM-specific implementation of <code>obj_delete_list_for_update</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.obj_delete_list_for_update', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.obj_delete_list_for_update" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_delete_list_for_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_delete_list_for_update``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">objects_to_delete</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">deletable_objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">authorized_update_list</span><span class="p">(</span><span class="n">objects_to_delete</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">deletable_objects</span><span class="p">,</span> <span class="s1">&#39;delete&#39;</span><span class="p">):</span>
        <span class="c1"># It&#39;s likely a ``QuerySet``. Call ``.delete()`` for efficiency.</span>
        <span class="n">deletable_objects</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">authed_obj</span> <span class="ow">in</span> <span class="n">deletable_objects</span><span class="p">:</span>
            <span class="n">authed_obj</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.obj_get">
    <p>def <span class="ident">obj_get</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A ORM-specific implementation of <code>obj_get</code>.</p>
<p>Takes optional <code>kwargs</code>, which are used to narrow the query to find
the instance.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.obj_get', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.obj_get" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_get``.</span>
<span class="sd">    Takes optional ``kwargs``, which are used to narrow the query to find</span>
<span class="sd">    the instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># prevents FieldError when looking up nested resources containing extra data</span>
    <span class="n">field_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">get_all_field_names</span><span class="p">()</span>
    <span class="n">field_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;pk&#39;</span><span class="p">)</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">field_names</span><span class="p">}</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">object_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">stringified_kwargs</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">=</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">object_list</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="o">.</span><span class="n">DoesNotExist</span><span class="p">(</span><span class="s2">&quot;Couldn&#39;t find an instance of &#39;</span><span class="si">%s</span><span class="s2">&#39; which matched &#39;</span><span class="si">%s</span><span class="s2">&#39;.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">stringified_kwargs</span><span class="p">))</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">object_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MultipleObjectsReturned</span><span class="p">(</span><span class="s2">&quot;More than &#39;</span><span class="si">%s</span><span class="s2">&#39; matched &#39;</span><span class="si">%s</span><span class="s2">&#39;.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">object_class</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">stringified_kwargs</span><span class="p">))</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">object_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">authorized_read_detail</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">NotFound</span><span class="p">(</span><span class="s2">&quot;Invalid resource lookup data provided (mismatched type).&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.obj_get_list">
    <p>def <span class="ident">obj_get_list</span>(</p><p>self, bundle, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A ORM-specific implementation of <code>obj_get_list</code>.</p>
<p>Takes an optional <code>request</code> object, whose <code>GET</code> dictionary can be
used to narrow the query.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.obj_get_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.obj_get_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_get_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_get_list``.</span>
<span class="sd">    Takes an optional ``request`` object, whose ``GET`` dictionary can be</span>
<span class="sd">    used to narrow the query.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">filters</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;GET&#39;</span><span class="p">):</span>
        <span class="c1"># Grab a mutable copy.</span>
        <span class="n">filters</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="c1"># Update with the provided kwargs.</span>
    <span class="n">filters</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">applicable_filters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_filters</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_filters</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">,</span> <span class="n">applicable_filters</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">authorized_read_list</span><span class="p">(</span><span class="n">objects</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">BadRequest</span><span class="p">(</span><span class="s2">&quot;Invalid resource lookup data provided (mismatched type).&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.obj_update">
    <p>def <span class="ident">obj_update</span>(</p><p>self, bundle, skip_errors=False, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>A ORM-specific implementation of <code>obj_update</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.obj_update', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.obj_update" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">obj_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">skip_errors</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``obj_update``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bundle_detail_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bundle_detail_data</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="n">arg_detail_data</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">bundle_detail_data</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">arg_detail_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="nb">str</span><span class="p">(</span><span class="n">bundle_detail_data</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">str</span><span class="p">(</span><span class="n">arg_detail_data</span><span class="p">)):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">lookup_kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lookup_kwargs_with_identifiers</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="c1"># if there is trouble hydrating the data, fall back to just</span>
            <span class="c1"># using kwargs by itself (usually it only contains a &quot;pk&quot; key</span>
            <span class="c1"># and this will work fine.</span>
            <span class="n">lookup_kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">lookup_kwargs</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ObjectDoesNotExist</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NotFound</span><span class="p">(</span><span class="s2">&quot;A model instance matching the provided arguments could not be found.&quot;</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_hydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="n">skip_errors</span><span class="o">=</span><span class="n">skip_errors</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.override_urls">
    <p>def <span class="ident">override_urls</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Deprecated. Will be removed by v1.0.0. Please use <code>prepend_urls</code> instead.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.override_urls', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.override_urls" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">override_urls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Deprecated. Will be removed by v1.0.0. Please use ``prepend_urls`` instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.patch_detail">
    <p>def <span class="ident">patch_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Updates a resource in-place.</p>
<p>Calls <code>obj_update</code>.</p>
<p>If the resource is updated, return <code>HttpAccepted</code> (202 Accepted).
If the resource did not exist, return <code>HttpNotFound</code> (404 Not Found).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.patch_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.patch_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">patch_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates a resource in-place.</span>
<span class="sd">    Calls ``obj_update``.</span>
<span class="sd">    If the resource is updated, return ``HttpAccepted`` (202 Accepted).</span>
<span class="sd">    If the resource did not exist, return ``HttpNotFound`` (404 Not Found).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">request</span> <span class="o">=</span> <span class="n">convert_post_to_patch</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="n">basic_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="c1"># We want to be able to validate the update, but we can&#39;t just pass</span>
    <span class="c1"># the partial data into the validator since all data needs to be</span>
    <span class="c1"># present. Instead, we basically simulate a PUT by pulling out the</span>
    <span class="c1"># original data and updating it in-place.</span>
    <span class="c1"># So first pull out the original object. This is essentially</span>
    <span class="c1"># ``get_detail``.</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cached_obj_get</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">basic_bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="k">except</span> <span class="n">ObjectDoesNotExist</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNotFound</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">MultipleObjectsReturned</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpMultipleChoices</span><span class="p">(</span><span class="s2">&quot;More than one resource is found at this URI.&quot;</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="c1"># Now update the bundle in-place.</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">update_in_place</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">deserialized</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">always_return_data</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpAccepted</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Invalidate prefetched_objects_cache for bundled object</span>
        <span class="c1"># because we might have changed a prefetched field</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_prefetched_objects_cache</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpAccepted</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.patch_list">
    <p>def <span class="ident">patch_list</span>(</p><p>*args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>An ORM-specific implementation of <code>patch_list</code>.</p>
<p>Necessary because PATCH should be atomic (all-success or all-fail)
and the only way to do this neatly is at the database level.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.patch_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.patch_list" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@wraps</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">assigned</span><span class="o">=</span><span class="n">available_attrs</span><span class="p">(</span><span class="n">func</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">with</span> <span class="bp">self</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.post_detail">
    <p>def <span class="ident">post_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Creates a new subcollection of the resource under a resource.</p>
<p>This is not implemented by default because most people's data models
aren't self-referential.</p>
<p>If a new resource is created, return <code>HttpCreated</code> (201 Created).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.post_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.post_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">post_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a new subcollection of the resource under a resource.</span>
<span class="sd">    This is not implemented by default because most people&#39;s data models</span>
<span class="sd">    aren&#39;t self-referential.</span>
<span class="sd">    If a new resource is created, return ``HttpCreated`` (201 Created).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNotImplemented</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.post_list">
    <p>def <span class="ident">post_list</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Creates a new resource/object with the provided data.</p>
<p>Calls <code>obj_create</code> with the provided data and returns a response
with the new resource's location.</p>
<p>If a new resource is created, return <code>HttpCreated</code> (201 Created).
If <code>Meta.always_return_data = True</code>, there will be a populated body
of serialized data.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.post_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.post_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">post_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a new resource/object with the provided data.</span>
<span class="sd">    Calls ``obj_create`` with the provided data and returns a response</span>
<span class="sd">    with the new resource&#39;s location.</span>
<span class="sd">    If a new resource is created, return ``HttpCreated`` (201 Created).</span>
<span class="sd">    If ``Meta.always_return_data = True``, there will be a populated body</span>
<span class="sd">    of serialized data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">))</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_deserialized_detail_data</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">deserialized</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dict_strip_unicode_keys</span><span class="p">(</span><span class="n">deserialized</span><span class="p">),</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_create</span><span class="p">(</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="n">location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_uri</span><span class="p">(</span><span class="n">updated_bundle</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">always_return_data</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpCreated</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">updated_bundle</span><span class="p">)</span>
        <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpCreated</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.prepend_urls">
    <p>def <span class="ident">prepend_urls</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>A hook for adding your own URLs or matching before the default URLs.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.prepend_urls', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.prepend_urls" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">prepend_urls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A hook for adding your own URLs or matching before the default URLs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.put_detail">
    <p>def <span class="ident">put_detail</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Either updates an existing resource or creates a new one with the
provided data.</p>
<p>Calls <code>obj_update</code> with the provided data first, but falls back to
<code>obj_create</code> if the object does not already exist.</p>
<p>If a new resource is created, return <code>HttpCreated</code> (201 Created).
If <code>Meta.always_return_data = True</code>, there will be a populated body
of serialized data.</p>
<p>If an existing resource is modified and
<code>Meta.always_return_data = False</code> (default), return <code>HttpNoContent</code>
(204 No Content).
If an existing resource is modified and
<code>Meta.always_return_data = True</code>, return <code>HttpAccepted</code> (200
OK).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.put_detail', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.put_detail" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">put_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Either updates an existing resource or creates a new one with the</span>
<span class="sd">    provided data.</span>
<span class="sd">    Calls ``obj_update`` with the provided data first, but falls back to</span>
<span class="sd">    ``obj_create`` if the object does not already exist.</span>
<span class="sd">    If a new resource is created, return ``HttpCreated`` (201 Created).</span>
<span class="sd">    If ``Meta.always_return_data = True``, there will be a populated body</span>
<span class="sd">    of serialized data.</span>
<span class="sd">    If an existing resource is modified and</span>
<span class="sd">    ``Meta.always_return_data = False`` (default), return ``HttpNoContent``</span>
<span class="sd">    (204 No Content).</span>
<span class="sd">    If an existing resource is modified and</span>
<span class="sd">    ``Meta.always_return_data = True``, return ``HttpAccepted`` (200</span>
<span class="sd">    OK).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">))</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_deserialized_detail_data</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">deserialized</span><span class="p">)</span>
    <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dict_strip_unicode_keys</span><span class="p">(</span><span class="n">deserialized</span><span class="p">),</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_update</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">always_return_data</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNoContent</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Invalidate prefetched_objects_cache for bundled object</span>
            <span class="c1"># because we might have changed a prefetched field</span>
            <span class="n">updated_bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_prefetched_objects_cache</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">updated_bundle</span><span class="p">)</span>
            <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">)</span>
    <span class="k">except</span> <span class="p">(</span><span class="n">NotFound</span><span class="p">,</span> <span class="n">MultipleObjectsReturned</span><span class="p">):</span>
        <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_create</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="n">location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_uri</span><span class="p">(</span><span class="n">updated_bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">always_return_data</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpCreated</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">updated_bundle</span><span class="p">)</span>
            <span class="n">updated_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_detail_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">updated_bundle</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpCreated</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.put_list">
    <p>def <span class="ident">put_list</span>(</p><p>self, request, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Replaces a collection of resources with another collection.</p>
<p>Calls <code>delete_list</code> to clear out the collection then <code>obj_create</code>
with the provided the data to create the new collection.</p>
<p>Return <code>HttpNoContent</code> (204 No Content) if
<code>Meta.always_return_data = False</code> (default).</p>
<p>Return <code>HttpAccepted</code> (200 OK) if
<code>Meta.always_return_data = True</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.put_list', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.put_list" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">put_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Replaces a collection of resources with another collection.</span>
<span class="sd">    Calls ``delete_list`` to clear out the collection then ``obj_create``</span>
<span class="sd">    with the provided the data to create the new collection.</span>
<span class="sd">    Return ``HttpNoContent`` (204 No Content) if</span>
<span class="sd">    ``Meta.always_return_data = False`` (default).</span>
<span class="sd">    Return ``HttpAccepted`` (200 OK) if</span>
<span class="sd">    ``Meta.always_return_data = True``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CONTENT_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">))</span>
    <span class="n">deserialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_deserialized_list_data</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">deserialized</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">deserialized</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">BadRequest</span><span class="p">(</span><span class="s2">&quot;Invalid data sent: missing &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">)</span>
    <span class="n">basic_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">obj_delete_list_for_update</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">basic_bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="n">bundles_seen</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">object_data</span> <span class="ow">in</span> <span class="n">deserialized</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">]:</span>
        <span class="n">bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dict_strip_unicode_keys</span><span class="p">(</span><span class="n">object_data</span><span class="p">),</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
        <span class="c1"># Attempt to be transactional, deleting any previously created</span>
        <span class="c1"># objects if validation fails.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">obj_create</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">bundle</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_api_resource_names</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
            <span class="n">bundles_seen</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ImmediateHttpResponse</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rollback</span><span class="p">(</span><span class="n">bundles_seen</span><span class="p">)</span>
            <span class="k">raise</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">always_return_data</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpNoContent</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">to_be_serialized</span> <span class="o">=</span> <span class="p">{</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">collection_name</span><span class="p">:</span> <span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">full_dehydrate</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">for_list</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">bundles_seen</span>
            <span class="p">]</span>
        <span class="p">}</span>
        <span class="n">to_be_serialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alter_list_data_to_serialize</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">to_be_serialized</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">to_be_serialized</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.remove_api_resource_names">
    <p>def <span class="ident">remove_api_resource_names</span>(</p><p>self, url_dict)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a dictionary of regex matches from a URLconf, removes
<code>api_name</code> and/or <code>resource_name</code> if found.</p>
<p>This is useful for converting URLconf matches into something suitable
for data lookup. For example::</p>
<div class="codehilite"><pre><span></span>Model.objects.filter(**self.remove_api_resource_names(matches))
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.remove_api_resource_names', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.remove_api_resource_names" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">remove_api_resource_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url_dict</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a dictionary of regex matches from a URLconf, removes</span>
<span class="sd">    ``api_name`` and/or ``resource_name`` if found.</span>
<span class="sd">    This is useful for converting URLconf matches into something suitable</span>
<span class="sd">    for data lookup. For example::</span>
<span class="sd">        Model.objects.filter(**self.remove_api_resource_names(matches))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kwargs_subset</span> <span class="o">=</span> <span class="n">url_dict</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;api_name&#39;</span><span class="p">,</span> <span class="s1">&#39;resource_name&#39;</span><span class="p">]:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">del</span><span class="p">(</span><span class="n">kwargs_subset</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">pass</span>
    <span class="k">return</span> <span class="n">kwargs_subset</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.resource_uri_kwargs">
    <p>def <span class="ident">resource_uri_kwargs</span>(</p><p>self, bundle_or_obj=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Builds a dictionary of kwargs to help generate URIs.</p>
<p>Automatically provides the <code>Resource.Meta.resource_name</code> (and
optionally the <code>Resource.Meta.api_name</code> if populated by an <code>Api</code>
object).</p>
<p>If the <code>bundle_or_obj</code> argument is provided, it calls
<code>Resource.detail_uri_kwargs</code> for additional bits to create</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.resource_uri_kwargs', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.resource_uri_kwargs" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">resource_uri_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle_or_obj</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Builds a dictionary of kwargs to help generate URIs.</span>
<span class="sd">    Automatically provides the ``Resource.Meta.resource_name`` (and</span>
<span class="sd">    optionally the ``Resource.Meta.api_name`` if populated by an ``Api``</span>
<span class="sd">    object).</span>
<span class="sd">    If the ``bundle_or_obj`` argument is provided, it calls</span>
<span class="sd">    ``Resource.detail_uri_kwargs`` for additional bits to create</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;resource_name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">resource_name</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;api_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">api_name</span>
    <span class="k">if</span> <span class="n">bundle_or_obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">detail_uri_kwargs</span><span class="p">(</span><span class="n">bundle_or_obj</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">kwargs</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.rollback">
    <p>def <span class="ident">rollback</span>(</p><p>self, bundles)</p>
    </div>
    

    
  
    <div class="desc"><p>A ORM-specific implementation of <code>rollback</code>.</p>
<p>Given the list of bundles, delete all models pertaining to those
bundles.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.rollback', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.rollback" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">rollback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundles</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ORM-specific implementation of ``rollback``.</span>
<span class="sd">    Given the list of bundles, delete all models pertaining to those</span>
<span class="sd">    bundles.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">bundle</span> <span class="ow">in</span> <span class="n">bundles</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bundle_detail_data</span><span class="p">(</span><span class="n">bundle</span><span class="p">):</span>
            <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.save">
    <p>def <span class="ident">save</span>(</p><p>self, bundle, skip_errors=False)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.save', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.save" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">skip_errors</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">via_uri</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">bundle</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">errors</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">skip_errors</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">error_response</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">,</span> <span class="n">bundle</span><span class="o">.</span><span class="n">errors</span><span class="p">))</span>
    <span class="c1"># Check if they&#39;re authorized.</span>
    <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">pk</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">authorized_update_detail</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">),</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">authorized_create_detail</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">),</span> <span class="n">bundle</span><span class="p">)</span>
    <span class="c1"># Save FKs just in case.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">save_related</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="c1"># Save the main object.</span>
    <span class="n">obj_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_identifier</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">obj_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">bundle</span><span class="o">.</span><span class="n">objects_saved</span> <span class="ow">or</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_state</span><span class="o">.</span><span class="n">adding</span><span class="p">:</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">objects_saved</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">obj_id</span><span class="p">)</span>
    <span class="c1"># Now pick up the M2M bits.</span>
    <span class="n">m2m_bundle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hydrate_m2m</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">save_m2m</span><span class="p">(</span><span class="n">m2m_bundle</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bundle</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.save_m2m">
    <p>def <span class="ident">save_m2m</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles the saving of related M2M data.</p>
<p>Due to the way Django works, the M2M data must be handled after the
main instance, which is why this isn't a part of the main <code>save</code> bits.</p>
<p>Currently slightly inefficient in that it will clear out the whole
relation and recreate the related data as needed.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.save_m2m', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.save_m2m" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">save_m2m</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles the saving of related M2M data.</span>
<span class="sd">    Due to the way Django works, the M2M data must be handled after the</span>
<span class="sd">    main instance, which is why this isn&#39;t a part of the main ``save`` bits.</span>
<span class="sd">    Currently slightly inefficient in that it will clear out the whole</span>
<span class="sd">    relation and recreate the related data as needed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">readonly</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># Get the manager.</span>
        <span class="n">related_mngr</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
            <span class="n">related_mngr</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">):</span>
            <span class="n">related_mngr</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">related_mngr</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">related_mngr</span><span class="p">,</span> <span class="s1">&#39;clear&#39;</span><span class="p">):</span>
            <span class="c1"># FIXME: Dupe the original bundle, copy in the new object &amp;</span>
            <span class="c1">#        check the perms on that (using the related resource)?</span>
            <span class="c1"># Clear it out, just to be safe.</span>
            <span class="n">related_mngr</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">related_objs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">related_bundle</span> <span class="ow">in</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">field_name</span><span class="p">]:</span>
            <span class="n">related_resource</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">get_related_resource</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
            <span class="c1"># Only build &amp; save if there&#39;s data, not just a URI.</span>
            <span class="n">updated_related_bundle</span> <span class="o">=</span> <span class="n">related_resource</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span>
                <span class="n">obj</span><span class="o">=</span><span class="n">related_bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="n">related_bundle</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                <span class="n">request</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">,</span>
                <span class="n">objects_saved</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">objects_saved</span><span class="p">,</span>
                <span class="n">via_uri</span><span class="o">=</span><span class="n">related_bundle</span><span class="o">.</span><span class="n">via_uri</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">related_resource</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">updated_related_bundle</span><span class="p">)</span>
            <span class="n">related_objs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">updated_related_bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
        <span class="n">related_mngr</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="o">*</span><span class="n">related_objs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.save_related">
    <p>def <span class="ident">save_related</span>(</p><p>self, bundle)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles the saving of related non-M2M data.</p>
<p>Calling assigning <code>child.parent = parent</code> &amp; then calling
<code>Child.save</code> isn't good enough to make sure the <code>parent</code>
is saved.</p>
<p>To get around this, we go through all our related fields &amp;
call <code>save</code> on them if they have related, non-M2M data.
M2M data is handled by the <code>ModelResource.save_m2m</code> method.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.save_related', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.save_related" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">save_related</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles the saving of related non-M2M data.</span>
<span class="sd">    Calling assigning ``child.parent = parent`` &amp; then calling</span>
<span class="sd">    ``Child.save`` isn&#39;t good enough to make sure the ``parent``</span>
<span class="sd">    is saved.</span>
<span class="sd">    To get around this, we go through all our related fields &amp;</span>
<span class="sd">    call ``save`` on them if they have related, non-M2M data.</span>
<span class="sd">    M2M data is handled by the ``ModelResource.save_m2m`` method.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_object</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_related</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">is_m2m</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">readonly</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">blank</span> <span class="ow">and</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># Get the object.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">related_obj</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ObjectDoesNotExist</span><span class="p">:</span>
            <span class="c1"># Django 1.8: unset related objects default to None, no error</span>
            <span class="n">related_obj</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="c1"># We didn&#39;t get it, so maybe we created it but haven&#39;t saved it</span>
        <span class="k">if</span> <span class="n">related_obj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">related_obj</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">related_objects_to_save</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">field_object</span><span class="o">.</span><span class="n">related_name</span><span class="p">:</span>
            <span class="c1"># this might be a reverse relation, so we need to save this</span>
            <span class="c1"># model, attach it to the related object, and save the related</span>
            <span class="c1"># object.</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bundle_detail_data</span><span class="p">(</span><span class="n">bundle</span><span class="p">):</span>
                <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">related_obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">related_name</span><span class="p">,</span> <span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
        <span class="n">related_resource</span> <span class="o">=</span> <span class="n">field_object</span><span class="o">.</span><span class="n">get_related_resource</span><span class="p">(</span><span class="n">related_obj</span><span class="p">)</span>
        <span class="c1"># Before we build the bundle &amp; try saving it, let&#39;s make sure we</span>
        <span class="c1"># haven&#39;t already saved it.</span>
        <span class="k">if</span> <span class="n">related_obj</span><span class="p">:</span>
            <span class="n">obj_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_identifier</span><span class="p">(</span><span class="n">related_obj</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">obj_id</span> <span class="ow">in</span> <span class="n">bundle</span><span class="o">.</span><span class="n">objects_saved</span><span class="p">:</span>
                <span class="c1"># It&#39;s already been saved. We&#39;re done here.</span>
                <span class="k">continue</span>
        <span class="k">if</span> <span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_name</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">field_name</span><span class="p">],</span> <span class="s1">&#39;keys&#39;</span><span class="p">):</span>
                <span class="c1"># Only build &amp; save if there&#39;s data, not just a URI.</span>
                <span class="n">related_bundle</span> <span class="o">=</span> <span class="n">related_resource</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span>
                    <span class="n">obj</span><span class="o">=</span><span class="n">related_obj</span><span class="p">,</span>
                    <span class="n">data</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field_name</span><span class="p">),</span>
                    <span class="n">request</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">,</span>
                    <span class="n">objects_saved</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">objects_saved</span>
                <span class="p">)</span>
                <span class="n">related_resource</span><span class="o">.</span><span class="n">full_hydrate</span><span class="p">(</span><span class="n">related_bundle</span><span class="p">)</span>
                <span class="n">related_resource</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">related_bundle</span><span class="p">)</span>
                <span class="n">related_obj</span> <span class="o">=</span> <span class="n">related_bundle</span><span class="o">.</span><span class="n">obj</span>
            <span class="k">elif</span> <span class="n">field_object</span><span class="o">.</span><span class="n">related_name</span><span class="p">:</span>
                <span class="c1"># This condition probably means a URI for a reverse</span>
                <span class="c1"># relation was provided.</span>
                <span class="n">related_bundle</span> <span class="o">=</span> <span class="n">related_resource</span><span class="o">.</span><span class="n">build_bundle</span><span class="p">(</span>
                    <span class="n">obj</span><span class="o">=</span><span class="n">related_obj</span><span class="p">,</span>
                    <span class="n">request</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">request</span><span class="p">,</span>
                    <span class="n">objects_saved</span><span class="o">=</span><span class="n">bundle</span><span class="o">.</span><span class="n">objects_saved</span>
                <span class="p">)</span>
                <span class="n">related_resource</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">related_bundle</span><span class="p">)</span>
                <span class="n">related_obj</span> <span class="o">=</span> <span class="n">related_bundle</span><span class="o">.</span><span class="n">obj</span>
        <span class="k">if</span> <span class="n">related_obj</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">bundle</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_object</span><span class="o">.</span><span class="n">attribute</span><span class="p">,</span> <span class="n">related_obj</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.serialize">
    <p>def <span class="ident">serialize</span>(</p><p>self, request, data, format, options=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a request, data and a desired format, produces a serialized
version suitable for transfer over the wire.</p>
<p>Mostly a hook, this uses the <code>Serializer</code> from <code>Resource._meta</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.serialize', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.serialize" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">format</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a request, data and a desired format, produces a serialized</span>
<span class="sd">    version suitable for transfer over the wire.</span>
<span class="sd">    Mostly a hook, this uses the ``Serializer`` from ``Resource._meta``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span> <span class="o">=</span> <span class="n">options</span> <span class="ow">or</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="s1">&#39;text/javascript&#39;</span> <span class="ow">in</span> <span class="n">format</span><span class="p">:</span>
        <span class="c1"># get JSONP callback name. default to &quot;callback&quot;</span>
        <span class="n">callback</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;callback&#39;</span><span class="p">,</span> <span class="s1">&#39;callback&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_valid_jsonp_callback_value</span><span class="p">(</span><span class="n">callback</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">BadRequest</span><span class="p">(</span><span class="s1">&#39;JSONP callback name is invalid.&#39;</span><span class="p">)</span>
        <span class="n">options</span><span class="p">[</span><span class="s1">&#39;callback&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">callback</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">serializer</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">format</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.should_skip_field">
    <p>def <span class="ident">should_skip_field</span>(</p><p>cls, field)</p>
    </div>
    

    
  
    <div class="desc"><p>Given a Django model field, return if it should be included in the
contributed ApiFields.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.should_skip_field', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.should_skip_field" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">should_skip_field</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">field</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a Django model field, return if it should be included in the</span>
<span class="sd">    contributed ApiFields.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Ignore certain fields (related fields).</span>
    <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="s1">&#39;rel&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">return</span> <span class="bp">False</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.throttle_check">
    <p>def <span class="ident">throttle_check</span>(</p><p>self, request)</p>
    </div>
    

    
  
    <div class="desc"><p>Handles checking if the user should be throttled.</p>
<p>Mostly a hook, this uses class assigned to <code>throttle</code> from
<code>Resource._meta</code>.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.throttle_check', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.throttle_check" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">throttle_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles checking if the user should be throttled.</span>
<span class="sd">    Mostly a hook, this uses class assigned to ``throttle`` from</span>
<span class="sd">    ``Resource._meta``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">identifier</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">authentication</span><span class="o">.</span><span class="n">get_identifier</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="c1"># Check to see if they should be throttled.</span>
    <span class="n">throttle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">throttle</span><span class="o">.</span><span class="n">should_be_throttled</span><span class="p">(</span><span class="n">identifier</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">throttle</span><span class="p">:</span>
        <span class="c1"># Throttle limit exceeded.</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpTooManyRequests</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">throttle</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">throttle</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="n">response</span><span class="p">[</span><span class="s1">&#39;Retry-After&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">throttle</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">throttle</span><span class="p">,</span> <span class="n">datetime</span><span class="p">):</span>
            <span class="n">response</span><span class="p">[</span><span class="s1">&#39;Retry-After&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">format_date_time</span><span class="p">(</span><span class="n">mktime</span><span class="p">(</span><span class="n">throttle</span><span class="o">.</span><span class="n">timetuple</span><span class="p">()))</span>
        <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.unauthorized_result">
    <p>def <span class="ident">unauthorized_result</span>(</p><p>self, exception)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.unauthorized_result', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.unauthorized_result" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">unauthorized_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exception</span><span class="p">):</span>
    <span class="k">raise</span> <span class="n">ImmediateHttpResponse</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpUnauthorized</span><span class="p">())</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.update_in_place">
    <p>def <span class="ident">update_in_place</span>(</p><p>self, request, original_bundle, new_data)</p>
    </div>
    

    
  
    <div class="desc"><p>Update the object in original_bundle in-place using new_data.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.update_in_place', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.update_in_place" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">update_in_place</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">original_bundle</span><span class="p">,</span> <span class="n">new_data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Update the object in original_bundle in-place using new_data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">original_bundle</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">dict_strip_unicode_keys</span><span class="p">(</span><span class="n">new_data</span><span class="p">))</span>
    <span class="c1"># Now we&#39;ve got a bundle with the new data sitting in it and we&#39;re</span>
    <span class="c1"># we&#39;re basically in the same spot as a PUT request. SO the rest of this</span>
    <span class="c1"># function is cribbed from put_detail.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">alter_deserialized_detail_data</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">original_bundle</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">detail_uri_name</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bundle_detail_data</span><span class="p">(</span><span class="n">original_bundle</span><span class="p">),</span>
        <span class="s1">&#39;request&#39;</span><span class="p">:</span> <span class="n">request</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_update</span><span class="p">(</span><span class="n">bundle</span><span class="o">=</span><span class="n">original_bundle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="cbh_chem_api.resources.MoleculeDictionaryResource.wrap_view">
    <p>def <span class="ident">wrap_view</span>(</p><p>self, view)</p>
    </div>
    

    
  
    <div class="desc"><p>Wraps methods so they can be called in a more functional way as well
as handling exceptions better.</p>
<p>Note that if <code>BadRequest</code> or an exception with a <code>response</code> attr
are seen, there is special handling to either present a message back
to the user or return the response traveling with the exception.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-cbh_chem_api.resources.MoleculeDictionaryResource.wrap_view', this);">Show source &equiv;</a></p>
  <div id="source-cbh_chem_api.resources.MoleculeDictionaryResource.wrap_view" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">wrap_view</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">view</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wraps methods so they can be called in a more functional way as well</span>
<span class="sd">    as handling exceptions better.</span>
<span class="sd">    Note that if ``BadRequest`` or an exception with a ``response`` attr</span>
<span class="sd">    are seen, there is special handling to either present a message back</span>
<span class="sd">    to the user or return the response traveling with the exception.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nd">@csrf_exempt</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">callback</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">view</span><span class="p">)</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">callback</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="c1"># Our response can vary based on a number of factors, use</span>
            <span class="c1"># the cache class to determine what we should ``Vary`` on so</span>
            <span class="c1"># caches won&#39;t return the wrong (cached) version.</span>
            <span class="n">varies</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="p">,</span> <span class="s2">&quot;varies&quot;</span><span class="p">,</span> <span class="p">[])</span>
            <span class="k">if</span> <span class="n">varies</span><span class="p">:</span>
                <span class="n">patch_vary_headers</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">varies</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">cacheable</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">response</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">cache_control</span><span class="p">():</span>
                    <span class="c1"># If the request is cacheable and we have a</span>
                    <span class="c1"># ``Cache-Control`` available then patch the header.</span>
                    <span class="n">patch_cache_control</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">cache_control</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">is_ajax</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">response</span><span class="o">.</span><span class="n">has_header</span><span class="p">(</span><span class="s2">&quot;Cache-Control&quot;</span><span class="p">):</span>
                <span class="c1"># IE excessively caches XMLHttpRequests, so we&#39;re disabling</span>
                <span class="c1"># the browser cache here.</span>
                <span class="c1"># See http://www.enhanceie.com/ie/bugs.asp for details.</span>
                <span class="n">patch_cache_control</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">no_cache</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">response</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">BadRequest</span><span class="p">,</span> <span class="n">fields</span><span class="o">.</span><span class="n">ApiFieldError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="n">sanitize</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s1">&#39;args&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">}</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpBadRequest</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="n">sanitize</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">messages</span><span class="p">)}</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">http</span><span class="o">.</span><span class="n">HttpBadRequest</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1"># Prevent muting non-django&#39;s exceptions</span>
            <span class="c1"># i.e. RequestException from &#39;requests&#39; library</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s1">&#39;response&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">response</span><span class="p">,</span> <span class="n">HttpResponse</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">e</span><span class="o">.</span><span class="n">response</span>
            <span class="c1"># A real, non-expected exception.</span>
            <span class="c1"># Handle the case where the full traceback is more helpful</span>
            <span class="c1"># than the serialized error.</span>
            <span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">DEBUG</span> <span class="ow">and</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">settings</span><span class="p">,</span> <span class="s1">&#39;TASTYPIE_FULL_DEBUG&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
                <span class="k">raise</span>
            <span class="c1"># Re-raise the error to get a proper traceback when the error</span>
            <span class="c1"># happend during a test case</span>
            <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SERVER_NAME&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;testserver&#39;</span><span class="p">:</span>
                <span class="k">raise</span>
            <span class="c1"># Rather than re-raising, we&#39;re going to things similar to</span>
            <span class="c1"># what Django does. The difference is returning a serialized</span>
            <span class="c1"># error message.</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_500</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wrapper</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>

  </section>

    </article>
  <div class="clear"> </div>
  <footer id="footer">
    <p>
      Documentation generated by
      <a href="https://github.com/BurntSushi/pdoc">pdoc 0.3.2</a>
    </p>

    <p>pdoc is in the public domain with the
      <a href="http://unlicense.org">UNLICENSE</a></p>

    <p>Design by <a href="http://nadh.in">Kailash Nadh</a></p>
  </footer>
</div>
</body>
</html>
